!function(a,b,c){"use strict";var d="ht",e=a[d],f=function(){return document},g=function(){return f().body},h=function(a,b,c){a.style.setProperty(b,c,null)},i=function(a){return f().createElement(a)},j=function(){return i("div")},k=function(){var a=i("canvas");return a},l=function(a,b){h(a,"-webkit-transform",b),h(a,"-ms-transform",b),h(a,"transform",b)},m=function(a,b){h(a,"-webkit-transform-origin",b),h(a,"-ms-transform-origin",b),h(a,"transform-origin",b)},n=function(a,b){a.appendChild(b)},o=function(a,b){a.removeChild(b)},p=a.parseInt,q=e.Default,r=q.getInternal(),s=r.addEventListener,t=(r.removeEventListener,Math.PI),u="white-space",v="visibility",w="left",x="top",y="width",z="height",A="position",B="display",C="z-index",D="px",E="0 0",F="absolute",G="visible",H="hidden",I="none",J="block",K="nowrap",L="rgba(0, 0, 0, 0.005)";q.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var M=e.graph.GraphView.prototype,N=M._42;M.adjustHtmlNodeIndex=!0,M._42=function(a,b){if(N.call(this,a,b),this.adjustHtmlNodeIndex)for(var c=this.getDataModel()._datas._as,d=c.length,e=1,f=0;d>f;f++){var g=c[f];if(g instanceof P){var i=this.getDataUI(g);h(i.$2f,C,e+""),h(i.$3f,C,e+1+""),e+=2}}};var O=e.HtmlNodeUI=function(a,b){var c=this;O.superClass.constructor.call(c,a,b);var d=c.$2f=j(),e=c.$3f=k();h(d,A,F),h(d,v,H),h(d,u,K),e.draggable=!1,h(e,A,F),h(e,B,I),m(e,E),s(d,"change",function(a){var d=a.target,e=d.bind||d.getAttribute("bind"),f=d.type&&"checkbox"===d.type?d.checked:d.value,g=b.getContext();e&&g&&(g[e]=f,c.$4f=JSON.stringify(g))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(a){s(d,a,this.$9f.bind(this))},c)};q.def(O,r.ui().NodeUI,{_visible:!0,$11f:function(){var a=this,b=a.$3f,c=a._data,d=c.getDraggerImageWidth(),e=c.getDraggerImageHeight(),f=c.getDraggerImage(),g=r.initContext(b);g.beginPath(),r.setCanvas(b,d,e),r.translateAndScale(g,0,0,1),g.clearRect(0,0,d,e),q.drawImage(g,q.getImage(f),0,0,d,e),g.restore()},_80o:function(a){O.superClass._80o.call(this,a);var b=this,c=b._data,d=c._padding,e=2*d,f=b.$2f,g=b.$3f,i=b.gv,k=i.getZoom(),m=i.getTranslateX(),o=i.getTranslateY(),q=i.getView(),r=b._83o,s=c._width,u=c._height,E=r.position,K=r.rotation,M=(s-e)/c.$5f*k,N=(u-e)/c.$6f*k,P=b._html,Q=c._html,R=c.getHtmlType();if("html"===R){var S=c.getContext()||{},T=b.$4f,U=c.$10f,V=JSON.stringify(S);P&&T&&P===Q&&T===V||(b.$4f=V,b._html=Q,f.innerHTML=U?U(S):Q)}else if(null!=R){var W=c.getHtml();"ht"===R&&(W=W.getView()),P&&P===W&&f.contains(P)||(b._html=W,f.innerHTML="",n(f,W))}if(!f.parentNode){var X=i.$1f;if(!X){var Y=j();h(Y,A,F),h(Y,C,"0"),X=i.$1f=Y;var Z=i._canvas.nextSibling;Z?q.insertBefore(Y,Z):n(q,Y)}n(X,f),n(X,g),c.onContentInitialized&&c.onContentInitialized(f)}if(c._scalable){var $=c.$5f,_=c.$6f;l(f,"rotate("+K/t*180+"deg) scale("+M+","+N+")"),h(f,y,""),h(f,z,""),h(f,w,(E.x-$/k/2)*k+m+D),h(f,x,(E.y-_/k/2)*k+o+D)}else{var aa=p(f.style.width),ba=p(f.style.height),ca=p((s-e)*k),da=p((u-e)*k),ea="100%",fa=f.children[0];h(fa,y,ea),h(fa,z,ea),(aa!==ca||ba!==da)&&(h(f,y,ca+D),h(f,z,da+D),"ht"===R&&Q.invalidate()),l(f,"rotate("+K/t*180+"deg)"),h(f,w,(E.x-ca/k/2)*k+m+D),h(f,x,(E.y-da/k/2)*k+o+D)}var ga=b.dragRect;i.isMovable(c)&&i.isSelected(c)&&ga?(a.save(),a.fillStyle=L,a.fillRect(ga.x,ga.y,ga.width,ga.height),a.restore(),h(g,w,ga.x*k+m+D),h(g,x,ga.y*k+o+D),l(g,"scale("+k+","+k+")"),h(g,B,J),b.$11f()):h(g,B,I),h(f,v,this._visible?G:H)},dispose:function(){var a=this.gv.$1f;this.$2f.parentNode===a&&a.removeChild(this.$2f),this.$3f.parentNode===a&&a.removeChild(this.$3f)},_84o:function(a){this._visible=a,h(this.$2f,v,a?G:H),h(this.$3f,B,a?J:I)},_3O:function(){var a=this,b=a.gv,c=a._data;O.superClass._3O.call(a);var d=c.getRect();b.isEditable(c)&&(a.dragRect={x:d.x+d.width+c._padding,y:d.y+10,width:c.getDraggerImageWidth(),height:c.getDraggerImageHeight()},a._68o(a.dragRect))},rectIntersects:function(a){var b=this._79o();return e.Default.intersection(b,a)?!0:void 0},$9f:function(a){var b=this.gv,c=this._data;b.sm().contains(c)&&a.stopPropagation()}});var P=e.HtmlNode=function(){P.superClass.constructor.call(this)};e.Default.def(P,e.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:e.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(b){var c=this,d=c._html;c._html=b,"html"===c.getHtmlType()&&"Handlebars"in a&&(c.$10f=Handlebars.compile(b)),c.$13f(),c.fp("html",d,b)},setContext:function(a){var b=this,c=b._context;b._context=a,b.fp("context",c,a),b.$13f()},setScalable:function(a){var b=this,c=b._scalable;b._scalable=a,b.fp("scalable",c,a),b.$13f()},getHtmlType:function(){var a=this._html;return a?"string"==typeof a?"html":a.getView?"ht":"dom":null},$13f:function(){var a=this,b=a._html,c=a.$10f;if(b){var d=j(),e=!1,f=a.getHtmlType();if(h(d,A,F),h(d,u,K),h(d,v,H),"html"===f?(c?d.innerHTML=c(a.getContext()||{}):d.innerHTML=b,e=!0):"ht"===f?(n(d,b.getView()),e=!0):"dom"===f&&(n(d,b),e=!0),e){var i=2*a._padding;n(g(),d),a.$5f=d.scrollWidth,a.$6f=d.scrollHeight,a._width=a.$5f+i,a._height=a.$6f+i,a._originWidth=a._width,a._originHeight=a._height,o(g(),d)}}},getUIClass:function(){return e.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);