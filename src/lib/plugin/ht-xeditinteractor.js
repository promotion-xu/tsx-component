!function(a,b,c){"use strict";var d="ht",e=a[d],f=e.Default,g=e.graph,h=f.getInternal(),i=h.ui(),j=i.NodeUI.prototype,k=i.ShapeUI.prototype,l=g.GraphView,m=l.prototype,n=i.EdgeUI.prototype,o=e.Node,p=e.Shape,q=e.Edge,r=e.Group,s=f.isTouchable,t=f.preventDefault,u=a.setTimeout,v=f.grow,w=f.isDragging,x=f.getDistance,y=null,z=e.List,A="undefined"!=typeof Float32Array?Float32Array:Array,B=Math,C=B.PI,D="Crossing",E="No Crossing",F=C/2,G=2*C,H=B.atan2,I=B.sqrt,J=B.pow,K=B.sin,L=B.cos,M=B.min,N=B.max,O=B.abs,P=B.ceil,Q=B.round,R=f.unionPoint,S=f.unionRect,T=f.containsPoint,U=f.clone,V="rgb(52, 152, 219)",W="red",X={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},Y={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var a=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],b=0;b<a.length;b++){var c=a[b];c=b%2===0?c/400*Y.width:c/100*Y.height,a[b]=c}return Y.width>120&&(a[4]=Y.width-26,a[6]=Y.width-40,a[10]=Y.width-40,a[12]=Y.width-26,a[18]=33),a}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},Z={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:V,rotation:.61},{type:"circle",rect:[200,120,70,70],background:V,rotation:.61},{type:"circle",rect:[200,220,70,70],background:V,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:V},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:V}]},$={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:W,rotation:.61}]},_={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:V},{type:"circle",rect:[0,210,90,90],background:V},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:V}]},aa={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:W},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:W}]},ba={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:V}]},ca={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:W}]},da={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},ea={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},fa=function(a){var b=a.touches[0];return b?b:a.changedTouches[0]},ga=function(a,b,c,d){return H(d-b,c-a)},ha=function(a,b){return{x:a.x*b,y:a.y*b}},ia=function(a,b){a.each(function(c){return a.isSelected(c)?b(c):void 0})},ja=function(a,b){a.reverseEach(function(c){return a.isSelected(c)?b(c):void 0})},ka=function(a,b,c){var d,e,f,g,h,i=this,j=b,k=i.gv;if(a instanceof p){f=a.getSegments();var l=k.getDataUI(a);h=l._55O.$15l,f&&f.size()||(f=ta(h)),a.isClosePath()&&f.indexOf(5)<0&&(f=new z(f._as),f.add(5)),d=Ra(a,l,j),e=h[d]}else{var m=k.getDataUI(a);h=ra(m,a.s("edge.points")),f=a.s("edge.segments"),f&&f.size()||(f=ta(h)),h=h._as,d=Ra(a,m,j),e=h[d]}if(f&&(g=f.get(j)),2===g||1===g||5===g){var n=h[d+1];5===g&&(n=h[0]);var o=ma(e,c,n);return o}return c},la=function(a,b,c,d){var e=b/2,f=c/2,g=na(a,-e,-f,d),h=na(a,e,-f,d),i=na(a,-e,f,d),j=na(a,e,f,d),k=na(a,0,-f,d),l=na(a,e,0,d),m=na(a,0,f,d),n=na(a,-e,0,d);return[g,h,i,j,k,l,m,n]},ma=function(a,b,c){var d={x:b.x-a.x,y:b.y-a.y},e={x:c.x-a.x,y:c.y-a.y},f=I(J(c.x-a.x,2)+J(c.y-a.y,2)),g={x:e.x/f,y:e.y/f},h=d.x*g.x+d.y*g.y,i={x:g.x*h,y:g.y*h};return{x:a.x+i.x,y:a.y+i.y}},na=function(a,b,c,d){var e=L(d)*b-K(d)*c,f=K(d)*b+L(d)*c;return a?{x:a.x+e,y:a.y+f}:{x:e,y:f}},oa=function(a,b){return b>2*a?a:b/2},pa=function(a,b,c,d){var e=x(a,b);return c=d?M(c,e):oa(c,e),e?c/=e:c=0,{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}},qa=function(a,b){var c,d,e=a.gv,f=a._data,g=f._40I,i=f._41I,j=f.s("edge.offset"),k=f.s("edge.source.position"),l=f.s("edge.target.position"),m=f.s("edge.source.offset.x"),n=f.s("edge.source.offset.y"),o=f.s("edge.target.offset.x"),p=f.s("edge.target.offset.y"),q=f.s("edge.source.anchor.x"),r=f.s("edge.source.anchor.y"),s=f.s("edge.target.anchor.x"),t=f.s("edge.target.anchor.y");if(b?(c=h.getEdgeAgentPosition(e,g,k,m,n,q,r),d=h.getEdgeAgentPosition(e,i,l,o,p,s,t)):(c=h.getEdgeAgentPosition(e,g,k,0,0,q,r),d=h.getEdgeAgentPosition(e,i,l,0,0,s,t)),"points"===f.s("edge.type")&&j&&!f.s("edge.center")&&c){var u=f.s("edge.points")||new z,v=u.size(),w=pa(c,v?u.get(0):d,j,v),x=pa(d,v?u.get(v-1):c,j,v);c=w,d=x}return[c,d]},ra=function(a,b,c){var d=a._78o,e=a._data,f=e.s("edge.type"),g=[d.sourcePoint,d.targetPoint];return"points"===f?c&&(g=qa(a)):g=d.center?f?c?qa(a):qa(a,!0):c?qa(a):[d.c1,d.c2]:c?qa(a):qa(a,!0),b=new z(b?b._as:y),b.add(g[0],0),b.add(g[1]),b},sa=function(a){return a=new z(a._as),a.removeAt(0),a.removeAt(a.size()-1),a},ta=function(a){a._as||(a=new z(a));var b=new z;b.add(1);for(var c=1;c<a.size();c++)b.add(2);return b},ua=function(a,b){return{x:(a.x+b.x)/2,y:(a.y+b.y)/2}},va=function(a,b){return{x:a.x+1*(b.x-a.x)/4,y:a.y+1*(b.y-a.y)/4}},wa=function(a,b){return{x:a.x+3*(b.x-a.x)/4,y:a.y+3*(b.y-a.y)/4}},xa=function(a,b,c,d){var e=b.x+b.width/2,f=b.y+b.height/2,g=I(e*e+f*f),h=H(f,e)+c;return{x:d.x+g*L(h),y:d.y+g*K(h)}},ya=m.validateImpl,za=m.isRectEditable,Aa=m.isPointEditable,Ba=m._42,Ca=k._79o,Da=n._79o,Ea=k._48O,Fa=k._47O,Ga=j._48O,Ha=j._80o,Ia=k._80o,Ja=j.getSelectWidth,Ka=j._47O,La=n._47O,Ma=m.isEditable,Na=["northwest","north","northeast","east","southeast","south","southwest","west"],Oa=function(a,b,c,d,e,f,g,h,i,j){var k=a.x,l=a.y,m=a.width,n=a.height,o={x:k+m/2,y:l+n/2};d=d||0,b=na(o,b.x-o.x,b.y-o.y,-d),g&&!h&&(b.x+=i,b.y+=j);var p=.01;if("northwest"===c?(b.x+e>k+m-p&&(b.x=k+m-e-p),b.y+e>l+n-p&&(b.y=l+n-e-p),a=R(b,{x:k+m,y:l+n})):"north"===c?(b.y+e>l+n-p&&(b.y=l+n-e-p),a=R({x:k,y:b.y},{x:k+m,y:l+n})):"northeast"===c?(b.x<k+e+p&&(b.x=k+e+p),b.y+e>l+n-p&&(b.y=l+n-e-p),a=R({x:k,y:b.y},{x:b.x,y:l+n})):"west"===c?(b.x+e>k+m-p&&(b.x=k+m-e-p),a=R({x:b.x,y:l},{x:k+m,y:l+n})):"east"===c?(b.x<k+e+p&&(b.x=k+e+p),a=R({x:k,y:l},{x:b.x,y:l+n})):"southwest"===c?(b.x+e>k+m-p&&(b.x=k+m-e-p),b.y<l+e+p&&(b.y=l+e+p),a=R({x:b.x,y:l},{x:k+m,y:b.y})):"south"===c?(b.y<l+e+p&&(b.y=l+e+p),a=R({x:k,y:l},{x:k+m,y:b.y})):"southeast"===c&&(b.x<k+e+p&&(b.x=k+e+p),b.y<l+e+p&&(b.y=l+e+p),a=R({x:k,y:l},b)),"keepRatio"===f&&(!g&&h||g&&!h)&&("northeast"===c||"southeast"===c||"northwest"===c||"southwest"===c)){var q=a.width,r=a.height,s=q/m,t=r/n,u=M(s,t);a.width=m*u,a.height=n*u,"northeast"===c?a.y=l+(n-a.height):"northwest"===c?(a.y=l+(n-a.height),a.x=k+(m-a.width)):"southwest"===c&&(a.x=k+(m-a.width))}a.x-=o.x,a.y-=o.y;var v=xa(y,a,d,o);return a.x=v.x-a.width/2,a.y=v.y-a.height/2,a},Pa=function(a,b,c,d){var e=a.getRotation(),f=b,g=f.x,h=f.y,i=f.width,j=f.height,k={x:g+f.width/2,y:h+f.height/2};d=na(k,d.x-k.x,d.y-k.y,-e),"northwest"===c?f=R(d,{x:g+i,y:h+j}):"north"===c?f=R({x:g,y:d.y},{x:g+i,y:h+j}):"northeast"===c?f=R({x:g,y:d.y},{x:d.x,y:h+j}):"west"===c?f=R({x:d.x,y:h},{x:g+i,y:h+j}):"east"===c?f=R({x:g,y:h},{x:d.x,y:h+j}):"southwest"===c?f=R({x:d.x,y:h},{x:g+i,y:d.y}):"south"===c?f=R({x:g,y:h},{x:g+i,y:d.y}):"southeast"===c&&(f=R({x:g,y:h},d)),a.setRect(f),f.x-=k.x,f.y-=k.y;var l=xa(a,f,e,k);a.p(l.x,l.y)},Qa=function(a,b,c,d,e,f,g,h){var i=y;f?(i=na(y,e.x-b.x,e.y-b.y,-c),i.x-=g.x,i.y-=g.y):i=na(y,e.x-b.x,e.y-b.y,0);var j={x:b.x+i.x,y:b.y+i.y};h&&(j=h(j.x,j.y)),j.e=a.getPoints().get(d).e,a.setPoint(d,j);var k=a.getWidth(),l=a.getHeight(),m=a.p().x-k/2,n=a.p().y-l/2;m-=b.x,n-=b.y;var o=xa(a,{x:m,y:n,width:k,height:l},c,b);a.p(o.x,o.y)},Ra=function(a,b,c){var d,e;if(a instanceof p?(d=a.getPoints(),e=a.getSegments()):a instanceof q&&"points"===a.s("edge.type")&&(d=a.s("edge.points"),e=a.s("edge.segments"),d=ra(b,d)),e&&e.size()||(e=ta(d)),a instanceof p&&a.isClosePath()&&e.indexOf(5)<0&&(e=new z(e._as),e.add(5)),e)for(var f=-1,g=0;g<e.size();g++){if(g===c)return f;var h=e.get(g);1===h?f+=1:2===h?f+=1:3===h?f+=2:4===h&&(f+=3)}},Sa=function(a,b,c){var d,e;if(a instanceof p?(d=a.getPoints(),e=a.getSegments()):a instanceof q&&"points"===a.s("edge.type")&&(d=a.s("edge.points"),e=a.s("edge.segments"),d=ra(b,d)),e&&e.size()||(e=ta(d)),e)for(var f=-1,g=0;g<e.size();g++){var h=e.get(g);if(1===h?f+=1:2===h?f+=1:3===h?f+=2:4===h&&(f+=3),f===c)return g}},Ta=function(a,b){var c=[a[0]-b[0],a[1]-b[1],a[2]-b[2]];return c},Ua=function(){var a=new A(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},Va=function(a,b){var c=a[0],d=a[1],e=a[2];return a[0]=b[0]*c+b[4]*d+b[8]*e+b[12],a[1]=b[1]*c+b[5]*d+b[9]*e+b[13],a[2]=b[2]*c+b[6]*d+b[10]*e+b[14],a},Wa=function(a,b){if(b){var c=K(b),d=L(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d}},Xa=function(a,b){for(var c=a.s("grid.row.count"),d=a.s("grid.column.count"),e=0;c>e;e++)for(var f=0;d>f;f++){var g=a.getCellRect(e,f);if(T(g,b))return{rowIndex:e,columnIndex:f,rect:g,grid:a}}return null},Ya=function(a,b,c,d,e,f){var g={},h=c-a,i=d-b,j=B.sqrt(h*h+i*i),k=h/j,l=i/j,m=(-a+e)*k+(-b+f)*l;return 0>=m?(g.x=a,g.y=b):m>=j?(g.x=c,g.y=d):(g.x=a+m*k,g.y=b+m*l),h=e-g.x,i=f-g.y,g.z=B.sqrt(h*h+i*i),g},Za=function(a,b){var c,d,e,f,g,h,i,j,k=a.getPoints(),l=a.getSegments(),m=a.p(),n=a.getRotation();if(!l||!(l.indexOf(3)>0||l.indexOf(4)>0)){for(j=0;j<=k.size()-1;j++)if(j===k.size()-1?(g=k.get(0),f=k.get(j)):(f=k.get(j),g=k.get(j+1)),f=na(m,f.x-m.x,f.y-m.y,n),g=na(m,g.x-m.x,g.y-m.y,n),h=Ya(f.x,f.y,g.x,g.y,b.x,b.y),i=h.z,i<(a.s("shape.border.width")||10)){d=f,e=g,c=j;break}if(c!=y){var o=Ya(d.x,d.y,e.x,e.y,b.x,b.y),p=x(d,o);return{attachIndex:c,attachOffset:p}}}},$a=function(a){for(var b=a._data,c=b.p(),d=b.getRotation(),e=b.getPoints(),f=y,g=[],h=0;h<e.size();h++)f=e.get(h),g.push(na(c,f.x-c.x,f.y-c.y,d));a._55O.$15l=g};f.setImage("xeditinteractor_parentIcon",Z),f.setImage("xeditinteractor_hostIcon",$),f.setImage("xeditinteractor_edgeIcon",_),f.setImage("xeditinteractor_removeIcon",aa),f.setImage("xeditinteractor_sourceIcon",ba),f.setImage("xeditinteractor_targetIcon",ca),f.setImage("xeditinteractor_elevationIcon",da),f.setImage("xeditinteractor_tallIcon",ea),m._editPointSize=s?24:9,m._edgeHelpers=["parent","remove","source","target"],m._leftTopHelpers=["parent"],m._rightTopHelpers=["host"],m._leftBottomHelpers=["edge"],m._rightBottomHelpers=["remove"],Na=Na.concat(Na).concat(Na),n._79o=function(){var a=this,b=a.gv,c=b.getZoom(),d=b._editInteractor,e=Da.call(a);if(!e)return null;var f=qa(a,!0),h=f[0],i=f[1],j={x:e.x,y:e.y,width:e.width,height:e.height},k=R(h,i);if(d instanceof g.XEditInteractor){j=S(j,k);var l=a._55O,m=b.getEditPointSize()/c+2,n=0;l&&l._43O&&(n+=m/2,v(j,n))}return j},n._47O=function(a){var b=this,c=b.gv,d=c._editInteractor;d instanceof g.XEditInteractor||La.call(b,a)},n.rectIntersects=function(a){var b=this,c=b._data,d=b.gv,e=d.getZoom(),f=b._55O,h=d._editInteractor;if(h instanceof g.XEditInteractor&&d.isEditable(c)&&f&&f._43O&&"points"===c.s("edge.type")){var i=c.s("edge.points"),j=c.s("edge.segments");i=ra(b,i),j&&j.size()||(j=ta(i)),i=i._as;var k=!1,l=s?5:1,m=a.x+l,n=a.y+l,o={x:m,y:n};if(h._edge===c&&h._hoverSegmentIndex>=0){var p=d._editInteractor._hoverSegmentIndex,q=j.get(p),r=Ra(c,b,p),t=y;if(r!=y&&r>=0){var u=i[r],v=d.getSegmentHoverWidth()/e;if(2===q||1===q){var w=i[r+1];t=mb(new bb(u.x,u.y),new bb(w.x,w.y),new bb(o.x-v,o.y-v),new bb(o.x+2*v,o.y+2*v)),t.$62l===D&&(k=!0)}else if(3===q){var x=i[r+1],w=i[r+2];t=jb(new bb(u.x,u.y),new bb(x.x,x.y),new bb(w.x,w.y),new bb(o.x-v,o.y-v),new bb(o.x+2*v,o.y+2*v)),t.$62l===D&&(k=!0)}else if(4===q){var z=i[r+1],A=i[r+2];w=i[r+3],t=lb(new bb(u.x,u.y),new bb(z.x,z.y),new bb(A.x,A.y),new bb(w.x,w.y),new bb(o.x-v,o.y-v),new bb(o.x+2*v,o.y+2*v)),t.$62l===D&&(k=!0)}}}if(k)return!0}return y},k._47O=function(a){var b=this,c=b.gv,d=c._editInteractor;d instanceof g.XEditInteractor||Fa.call(b,a)},k.rectIntersects=function(a){var b=this,c=b._data,d=b.gv,e=d.getZoom(),f=b._55O,h=d._editInteractor;if(h instanceof g.XEditInteractor&&d.isEditable(c)&&f&&f._43O){var i=f.$15l,j=!1,k=s?5:1,l=a.x+k,m=a.y+k,n={x:l,y:m};if(i&&i.length===c.getPoints().size()||($a(b),i=f.$15l),h._shape===c&&h._hoverSegmentIndex>=0){var o=c.getSegments();o&&o.size()||(o=ta(i));var p=d._editInteractor._hoverSegmentIndex,q=o.get(p),r=Ra(c,b,p),t=y;if(r!=y&&r>=0){var u=i[r],v=d.getSegmentHoverWidth()/e;if(2===q||1===q){var w=i[r+1];t=mb(new bb(u.x,u.y),new bb(w.x,w.y),new bb(n.x-v,n.y-v),new bb(n.x+2*v,n.y+2*v)),t.$62l===D&&(j=!0)}else if(3===q){var x=i[r+1],w=i[r+2];t=jb(new bb(u.x,u.y),new bb(x.x,x.y),new bb(w.x,w.y),new bb(n.x-v,n.y-v),new bb(n.x+2*v,n.y+2*v)),t.$62l===D&&(j=!0)}else if(4===q){var z=i[r+1],A=i[r+2];w=i[r+3],t=lb(new bb(u.x,u.y),new bb(z.x,z.y),new bb(A.x,A.y),new bb(w.x,w.y),new bb(n.x-v,n.y-v),new bb(n.x+2*v,n.y+2*v)),t.$62l===D&&(j=!0)}}}if(j)return!0}return y},k._48O=function(){var a=this,b=a.gv,c=b._editInteractor;c instanceof g.XEditInteractor?(j._48O.call(a),a._55O._43O&&$a(a)):Ea.call(a)},k._79o=function(){var a=this,b=a.gv,c=b.getZoom(),d=b._editInteractor,e=Ca.call(a);if(e){var f={x:e.x,y:e.y,width:e.width,height:e.height};if(d instanceof g.XEditInteractor){var h=a._55O,i=b.getEditPointSize()/c+2,j=0;h&&h._43O&&(j+=i/2,v(f,j))}return f}},j._47O=function(a){var b=this,c=b.gv,d=c._editInteractor;if(d instanceof g.XEditInteractor);else{var e=b._55O;e&&e._98o&&Ka.call(b,a)}},j.getSelectWidth=function(){var a=this,b=a.gv,c=b._editInteractor,d=a._data;return b.isEditable(d)&&c instanceof g.XEditInteractor?0:Ja.call(a)},j._80o=function(a){var b=this,c=b.gv._editInteractor;if(Ha.call(b,a),c&&c._debug){a.save(),a.beginPath(),a.lineWidth=1,a.strokeStyle="green";var d=b._79o();d&&(a.rect(d.x,d.y,d.width,d.height),a.stroke()),a.restore()}},k._80o=function(a){var b=this,c=b.gv._editInteractor;if(Ia.call(b,a),c&&c._debug){a.save(),a.beginPath(),a.lineWidth=1,a.strokeStyle="green";var d=b._79o();a.rect(d.x,d.y,d.width,d.height),a.stroke(),a.restore()}},j._48O=function(){var a=this,b=a.gv,c=a._data,d=b._editInteractor,e=a._55O,f=c.p(),h=c.getRotation();if(d instanceof g.XEditInteractor){if(e._42O){var i=la(f,c.getWidth(),c.getHeight(),h),j=i[0],k=i[1],l=i[2],m=i[3],n=i[4],o=i[5],p=i[6],q=i[7];e.$45l=[j,n,k,o,m,p,l,q]}}else Ga.call(a)},m.getResizeMode=function(){return this.$25l||"normal"},m.setResizeMode=function(a){var b=this.$25l;this.$25l=a,this.fp("resizeMode",b,a)},m.getSnapAngle=function(){return this.$26l||Math.PI/36},m.setSnapAngle=function(a){var b=this.$26l;this.$26l=a,this.fp("snapAngle",b,a)},m.getSnapSpacing=function(){return this.$27l},m.setSnapSpacing=function(a){var b=this.$27l;this.$27l=a,this.fp("snapSpacing",b,a)},m.getPointSnapSpacing=function(){return this._pointSnapSpacing},m.setPointSnapSpacing=function(a){var b=this._pointSnapSpacing;this._pointSnapSpacing=a,this.fp("pointSnapSpacing",b,a)},m.setHelperEditableFunc=function(a){var b=this._helperEditableFunc;this._helperEditableFunc=a,this.fp("helperEditableFunc",b,a)},m.getHelperEditableFunc=function(a){return this._helperEditableFunc},m.setLeftTopHelpers=function(a){var b=this._leftTopHelpers;this._leftTopHelpers=a,this.fp("leftTopHelpers",b,a)},m.getLeftTopHelpers=function(){return this._leftTopHelpers},m.setLeftTopHelpersAlign=function(a){var b=this._leftTopHelpersAlign;this._leftTopHelpersAlign=a,this.fp("leftTopHelpersAlign",b,a)},m.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},m.setRightTopHelpers=function(a){var b=this._rightTopHelpers;this._rightTopHelpers=a,this.fp("rightTopHelpers",b,a)},m.getRightTopHelpers=function(){return this._rightTopHelpers},m.setRightTopHelpersAlign=function(a){var b=this._rightTopHelpersAlign;this._rightTopHelpersAlign=a,this.fp("rightTopHelpersAlign",b,a)},m.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},m.setLeftBottomHelpers=function(a){var b=this._leftBottomHelpers;this._leftBottomHelpers=a,this.fp("leftBottomHelpers",b,a)},m.getLeftBottomHelpers=function(){return this._leftBottomHelpers},m.setLeftBottomHelpersAlign=function(a){var b=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=a,this.fp("leftBottomHelpersAlign",b,a)},m.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},m.setRightBottomHelpers=function(a){var b=this._rightBottomHelpers;this._rightBottomHelpers=a,this.fp("rightBottomHelpers",b,a)},m.getRightBottomHelpers=function(){return this._rightBottomHelpers},m.setRightBottomHelpersAlign=function(a){var b=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=a,this.fp("rightBottomHelpersAlign",b,a)},m.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},m.setEdgeHelpers=function(a){var b=this._edgeHelpers;this._edgeHelpers=a,this.fp("edgeHelpers",b,a)},m.getEdgeHelpers=function(){return this._edgeHelpers},m.isHelperEditable=function(a,b){return a instanceof q&&("host"===b||"edge"===b||"elevation"===b||"tall"===b)?!1:a instanceof o&&("source"===b||"target"===b)?!1:"pointElevation"===b?this._helperEditableFunc?this._helperEditableFunc(a,b):!1:this._helperEditableFunc?this._helperEditableFunc(a,b):!0},m.getEditHelperSize=function(){return this._editHelperSize||(s?28:16)},m.setEditHelperSize=function(a){var b=this._editHelperSize;this._editHelperSize=a,this.fp("editHelperSize",b,a)},m.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},m.setEditRectBorderColor=function(a){var b=this.$28l;this.$28l=a,this.fp("editRectBorderColor",b,a)},m.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},m.setNodeBorderColor=function(a){var b=this.$29l;this.$29l=a,this.fp("nodeBorderColor",b,a)},m.getEditRectBorderStyle=function(){return this.$30l||"dashed"},m.setEditRectBorderStyle=function(a){var b=this.$30l;this.$30l=a,this.fp("editRectBorderStyle",b,a)},m.getControlPointBackground=function(){return this.$31l||"#ff0"},m.setControlPointBackground=function(a){var b=this.$31l;this.$31l=a,this.fp("controlPointBackground",b,a)},m.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},m.setControlPointBorderColor=function(a){var b=this.$32l;this.$32l=a,this.fp("controlPointBorderColor",b,a)},m.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},m.setJoinPointBackground=function(a){var b=this.$33l;this.$33l=a,this.fp("joinPointBackground",b,a)},m.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},m.setJoinPointBorderColor=function(a){var b=this.$34l;this.$34l=a,this.fp("joinPointBorderColor",b,a)},m.getDirectionLineColor=function(){return this.$35l||"#888"},m.setDirectionLineColor=function(a){var b=this.$35l;this.$35l=a,this.fp("directionLineColor",b,a)},m.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},m.setSegmentHoverColor=function(a){var b=this.$36l;this.$36l=a,this.fp("segmentHoverColor",b,a)},m.getSegmentHoverWidth=function(){return this.$22l||(s?16:8)},m.setSegmentHoverWidth=function(a){var b=this.$22l;this.$22l=a,this.fp("segmentHoverWidth",b,a)},m.getSnapPointBorderColor=function(){return this.$38l||"#f00"},m.setSnapPointBorderColor=function(a){var b=this.$38l;this.$38l=a,this.fp("snapPointBorderColor",b,a)},m.getEditRectPadding=function(){return this.$39l!=y?this.$39l:6},m.setEditRectPadding=function(a){var b=this.$39l;this.$39l=a,this.fp("editRectPading",b,a)},m.isRectEditable=function(a){var b=this,c=b._editInteractor;return c instanceof g.XEditInteractor?b._rectEditableFunc?b._rectEditableFunc(a):!0:za.call(b,a)},m.isPointEditable=function(a){var b=this,c=b._editInteractor;return c instanceof g.XEditInteractor?b._pointEditableFunc?b._pointEditableFunc(a):!0:Aa.call(b,a)},m.validateImpl=function(){var a=this,b=a.$14l,c=a._editInteractor;if(b){var d=a.getWidth(),e=a.getHeight();(d!==b.clientWidth||e!==b.clientHeight)&&(c&&(c._68I=1),h.setCanvas(b,d,e),a._32I=1)}ya.call(this)},m.isEditable=function(a){var b=Ma.call(this,a),c=this._editInteractor;if(c instanceof g.XEditInteractor&&a instanceof q){if(!a.s("2d.editable"))return!1;var d=this.getEditableFunc();b=d?d(a):!0}return b},m._42=function(a,b){var c=this,d=c._editInteractor;Ba.call(c,a,b),d instanceof g.XEditInteractor&&d._68I&&d._42()},m.isSnapPoint=function(a){return!0};var _a=function(a){arguments.length>0&&this.$58l(a)},ab=_a.prototype;ab.$58l=function(a){this.$62l=a,this.points=new Array},ab.$56l=function(a){this.points.push(a)},ab.$57l=function(a){this.points=this.points.concat(a)};var bb=function(a,b){arguments.length>0&&this.$58l(a,b)},cb=bb.prototype;cb.$58l=function(a,b){this.x=a,this.y=b},cb.add=function(a){return new bb(this.x+a.x,this.y+a.y)},cb.addEquals=function(a){return this.x+=a.x,this.y+=a.y,this},cb.$55l=function(a){return new bb(this.x*a,this.y*a)},cb.eq=function(a){return this.x==a.x&&this.y==a.y},cb.lt=function(a){return this.x<a.x&&this.y<a.y},cb.lte=function(a){return this.x<=a.x&&this.y<=a.y},cb.gt=function(a){return this.x>a.x&&this.y>a.y},cb.gte=function(a){return this.x>=a.x&&this.y>=a.y},cb.lerp=function(a,b){return new bb(this.x+(a.x-this.x)*b,this.y+(a.y-this.y)*b)},cb.distanceFrom=function(a){var b=this.x-a.x,c=this.y-a.y;return I(b*b+c*c)},cb.min=function(a){return new bb(M(this.x,a.x),M(this.y,a.y))},cb.max=function(a){return new bb(N(this.x,a.x),N(this.y,a.y))},cb.toString=function(){return this.x+","+this.y};var db=function(){this.$58l(arguments)},eb=db.prototype;db.TO=1e-6,db.AC=6,eb.$58l=function(a){this.co=new Array;for(var b=a.length-1;b>=0;b--)this.co.push(a[b])},eb.$55l=function(a){for(var b=new db,c=0;c<=this.$50l()+a.$50l();c++)b.co.push(0);for(var c=0;c<=this.$50l();c++)for(var d=0;d<=a.$50l();d++)b.co[c+d]+=this.co[c]*a.co[d];return b},eb.$59l=function(){for(var a=this.$50l();a>=0&&O(this.co[a])<=db.TO;a--)this.co.pop()},eb.$50l=function(){return this.co.length-1},eb.$51l=function(){var a;switch(this.$59l(),this.$50l()){case 0:a=new Array;break;case 1:a=this.$52l();break;case 2:a=this.$53l();break;case 3:a=this.$54l();break;case 4:a=this.$63l();break;default:a=new Array}return a},eb.$52l=function(){var a=new Array,b=this.co[1];return 0!=b&&a.push(-this.co[0]/b),a},eb.$53l=function(){var a=new Array;if(2==this.$50l()){var b=this.co[2],c=this.co[1]/b,d=this.co[0]/b,e=c*c-4*d;if(e>0){var f=I(e);a.push(.5*(-c+f)),a.push(.5*(-c-f))}else 0==e&&a.push(.5*-c)}return a},eb.$63l=function(){var a=new Array;if(4==this.$50l()){var b=this.co[4],c=this.co[3]/b,d=this.co[2]/b,e=this.co[1]/b,f=this.co[0]/b,g=new db(1,-d,c*e-4*f,-c*c*f+4*d*f-e*e).$54l(),h=g[0],i=c*c/4-d+h;if(O(i)<=db.TO&&(i=0),i>0){var j=I(i),k=3*c*c/4-j*j-2*d,l=(4*c*d-8*e-c*c*c)/(4*j),m=k+l,n=k-l;if(O(m)<=db.TO&&(m=0),O(n)<=db.TO&&(n=0),m>=0){var o=I(m);a.push(-c/4+(j+o)/2),a.push(-c/4+(j-o)/2)}if(n>=0){var o=I(n);a.push(-c/4+(o-j)/2),a.push(-c/4-(o+j)/2)}}else if(0>i);else{var l=h*h-4*f;if(l>=-db.TO){if(0>l&&(l=0),l=2*I(l),k=3*c*c/4-2*d,k+l>=db.TO){var p=I(k+l);a.push(-c/4+p/2),a.push(-c/4-p/2)}if(k-l>=db.TO){var p=I(k-l);a.push(-c/4+p/2),a.push(-c/4-p/2)}}}}return a},eb.$54l=function(){var a=new Array;if(3==this.$50l()){var b=this.co[3],c=this.co[2]/b,d=this.co[1]/b,e=this.co[0]/b,f=(3*d-c*c)/3,g=(2*c*c*c-9*d*c+27*e)/27,h=c/3,i=g*g/4+f*f*f/27,j=g/2;if(O(i)<=db.TO&&(i=0),i>0){var k,l,m=I(i);k=-j+m,l=k>=0?J(k,1/3):-J(-k,1/3),k=-j-m,k>=0?l+=J(k,1/3):l-=J(-k,1/3),a.push(l-h)}else if(0>i){var n=I(-f/3),o=H(I(-i),-j)/3,p=L(o),q=K(o),r=I(3);a.push(2*n*p-h),a.push(-n*(p+r*q)-h),a.push(-n*(p-r*q)-h)}else{var k;k=j>=0?-J(j,1/3):J(-j,1/3),a.push(2*k-h),a.push(-k-h)}}return a};var fb=function(a,b){arguments.length>0&&this.$58l(a,b)},gb=fb.prototype;gb.$58l=function(a,b){this.x=a,this.y=b},gb.length=function(){return I(this.x*this.x+this.y*this.y)},gb.$60l=function(a){return this.x*a.x+this.y*a.y};var hb=function(a,b,c,d){var e,f=(d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x),g=(b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x),h=(d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y);if(0!=h){var i=f/h,j=g/h;i>=0&&1>=i&&j>=0&&1>=j?(e=new _a(D),e.points.push(new bb(a.x+i*(b.x-a.x),a.y+i*(b.y-a.y)))):e=new _a(E)}else e=new _a(0==f||0==g?"C":"P");return e},ib=function(a,b,c,d,e){var f,g,h,i,j,k,l,m=d.min(e),n=d.max(e),o=new _a(E);f=b.$55l(-2),h=a.add(f.add(c)),f=a.$55l(-2),g=b.$55l(2),i=f.add(g),j=new bb(a.x,a.y),l=new fb(d.y-e.y,e.x-d.x),k=d.x*e.y-e.x*d.y;for(var p=new db(l.$60l(h),l.$60l(i),l.$60l(j)+k).$51l(),q=0;q<p.length;q++){var r=p[q];if(r>=0&&1>=r){var s=a.lerp(b,r),t=b.lerp(c,r),u=s.lerp(t,r);d.x==e.x?m.y<=u.y&&u.y<=n.y&&(o.$62l=D,o.$56l(u)):d.y==e.y?m.x<=u.x&&u.x<=n.x&&(o.$62l=D,o.$56l(u)):u.gte(m)&&u.lte(n)&&(o.$62l=D,o.$56l(u))}}return o},jb=function(a,b,c,d,e){var f=d.min(e),g=d.max(e),h=new bb(g.x,f.y),i=new bb(f.x,g.y),j=ib(a,b,c,f,h),k=ib(a,b,c,h,g),l=ib(a,b,c,g,i),m=ib(a,b,c,i,f),n=new _a(E);return n.$57l(j.points),n.$57l(k.points),n.$57l(l.points),n.$57l(m.points),n.points.length>0&&(n.$62l=D),n},kb=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=e.min(f),r=e.max(f),s=new _a(E);g=a.$55l(-1),h=b.$55l(3),i=c.$55l(-3),j=g.add(h.add(i.add(d))),k=new fb(j.x,j.y),g=a.$55l(3),h=b.$55l(-6),i=c.$55l(3),j=g.add(h.add(i)),l=new fb(j.x,j.y),g=a.$55l(-3),h=b.$55l(3),i=g.add(h),m=new fb(i.x,i.y),n=new fb(a.x,a.y),p=new fb(e.y-f.y,f.x-e.x),o=e.x*f.y-f.x*e.y;for(var t=new db(p.$60l(k),p.$60l(l),p.$60l(m),p.$60l(n)+o).$51l(),u=0;u<t.length;u++){var v=t[u];if(v>=0&&1>=v){var w=a.lerp(b,v),x=b.lerp(c,v),y=c.lerp(d,v),z=w.lerp(x,v),A=x.lerp(y,v),B=z.lerp(A,v);e.x==f.x?q.y<=B.y&&B.y<=r.y&&(s.$62l=D,s.$56l(B)):e.y==f.y?q.x<=B.x&&B.x<=r.x&&(s.$62l=D,s.$56l(B)):B.gte(q)&&B.lte(r)&&(s.$62l=D,s.$56l(B))}}return s},lb=function(a,b,c,d,e,f){var g=e.min(f),h=e.max(f),i=new bb(h.x,g.y),j=new bb(g.x,h.y),k=kb(a,b,c,d,g,i),l=kb(a,b,c,d,i,h),m=kb(a,b,c,d,h,j),n=kb(a,b,c,d,j,g),o=new _a(E);return o.$57l(k.points),o.$57l(l.points),o.$57l(m.points),o.$57l(n.points),o.points.length>0&&(o.$62l=D),o},mb=function(a,b,c,d){var e=c.min(d),f=c.max(d),g=new bb(f.x,e.y),h=new bb(e.x,f.y),i=hb(e,g,a,b),j=hb(g,f,a,b),k=hb(f,h,a,b),l=hb(h,e,a,b),m=new _a(E);return m.$57l(i.points),m.$57l(j.points),m.$57l(k.points),m.$57l(l.points),m.points.length>0&&(m.$62l=D),m},nb=g.XEditInteractor=function(a){var b=this,c=b._view=document.createElement("canvas");c.className="editCanvas",c.style.position="absolute",nb.superClass.constructor.call(b,a)};f.def(nb,g.Interactor,{ms_edit:1,setUp:function(){var a=this,b=a.gv,c=b.getView(),d=a._view;nb.superClass.setUp.call(a),b.setEditInteractor(a),b.$14l=d,b._79O?c.insertBefore(d,b._79O):c.appendChild(d);var e=a.$49l=a.$11l.bind(a);b.dm().md(e),b.sm().ms(e),b.mp(e)},tearDown:function(){var a=this,b=a.gv,c=b.getView(),d=a.$49l;nb.superClass.tearDown.call(a),b.setEditInteractor(y),b.$14l=y,c.removeChild(a._view),b.dm().umd(d),b.sm().ums(d),b.ump(d)},clear:function(){var a=this,b=a.gv;delete a._hoverSegmentIndex,delete a._edge,delete a._shape,delete b._editing,delete a.$10l,delete a.$13l,delete a.$9l,delete a._removePointIndex,delete a._lp,a.$12l="",delete a.$40l,delete a.$67l,delete a.$72l,delete a.$73l,delete a.$75l,delete a.$1l,delete a.$3l,delete a.$2l,delete a.$92l,delete a.$93l,delete a.$94l,a.clearDragging()},handle_keydown:function(a){this.$48l!==a.shiftKey&&(this.$48l=a.shiftKey,this.handle_mousemove(a,c,!0))},handle_keyup:function(a){this.$48l!==a.shiftKey&&(this.$48l=a.shiftKey,this.handle_mousemove(a,c,!0))},handle_touchstart:function(a){this.handle_mousemove(a),this.handle_mousedown(a)},handle_mousedown:function(a){t(a);var b=this,c=b.$13l,d=b.gv,e=d.dm(),g=d.sm(),h=d.getZoom(),i=d.lp(a),j=f.isDoubleClick(a),k=f.isLeftButton(a),l=b.$7l,m=b._shape,n=b._hoverSegmentIndex,p=b._edge,q=b.$87l,r=b.$88l,s=function(){b._68I||q===b.$87l&&r===b.$88l||b.$43l()};if(7!==b.$67l&&(delete b.$87l,delete b.$88l),k&&(m||p)&&n>=0&&j&&(m&&g.contains(m)||p&&g.contains(p))){var v=ka.call(b,m||p,n,i);return b.addShapePoint(m||p,n,v),void u(function(){b.handle_mousemove(a)},40)}if(k&&(m||p)&&b._removePointIndex>=0&&j)return b.removeShapePoint(),b.$5l=1,void u(function(){b.handle_mousemove(a)},40);if(!k||!d._editing)return void s();if(m&&c>=0){var w=m.getPoints().get(c),x=m.p(),y=na(x,w.x-x.x,w.y-x.y,-l+m.getRotation());J=na(x,i.x-x.x,i.y-x.y,-l),b.$24l={x:J.x-y.x,y:J.y-y.y},b.startDragging(a),e.beginTransaction(),b.fi({kind:"beginEditPoint",event:a,data:m,index:c}),b.$88l=c,b.$87l=m}else if(b.$10l){var z=d.sm().getSelection(),A=b.$6l,B=b.$1l={},C=b.$3l={},D=b.$16l[X[b.$10l]],E={x:A.x,y:A.y},F={x:A.x+A.width/2,y:A.y+A.height/2};b.$24l={x:i.x-D.x/h,y:i.y-D.y/h},b.$2l=U(b.$8l),b.$4l=U(A),z.each(function(a){if(a instanceof o){var b=a.p(),c=a.getWidth(),d=a.getHeight(),e=na(F,b.x-F.x,b.y-F.y,-l);B[a.getId()]={x:b.x-c/2,y:b.y-d/2,width:c,height:d},C[a.getId()]={x:(e.x-E.x)/A.width,y:(e.y-E.y)/A.height}}}),b.startDragging(a),e.beginTransaction(),b.fi({kind:"beginEditRect",event:a,direction:b.$10l})}else if(p&&c>=0){var G=ra(d.getDataUI(p),p.s("edge.points")),w=G.get(c);b.$24l={x:i.x-w.x,y:i.y-w.y},b.startDragging(a),e.beginTransaction(),b.fi({kind:"beginEditPoint",event:a,data:p,index:c}),b.$88l=c,b.$87l=p}else if(b.$40l){var A=b.$6l,F={x:A.x+A.width/2,y:A.y+A.height/2},H=U(b.$23l);H.x/=h,H.y/=h;var I=na(F,H.x-F.x,H.y-F.y,-l),J=na(F,i.x-F.x,i.y-F.y,-l);b.$24l={x:J.x-I.x,y:J.y-I.y},b.startDragging(a),e.beginTransaction(),b.fi({kind:"beginEditRotation",event:a,data:b._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(b.$67l)>=0){var K=b.$67l;(7===K||8===K||9===K)&&e.beginTransaction(),b.startDragging(a)}else if(b.$71l&&j&&b.$79l(b.$71l,i)){var L=g.toSelection();e.beginTransaction(),L.each(function(a){e.remove(a)}),e.endTransaction()}s()},$11l:function(){var a=this,b=a.gv;b._editing&&(a.$13l==y||a._shape==y&&a._edge==y)&&(a.$73l==y||1!==a.$67l&&5!==a.$67l&&6!==a.$67l)||(a.$5l=1),a._68I=1},$46l:function(a){var b=this,c=b.gv,d=c.lp(a),e=[];return ja(c,function(a){var b=c.getDataUI(a);if(b){var f=b._79o();T(f,d)&&e.push(a)}}),e},$47l:function(a){var b=this,c=b.$13l,d=b.gv.dm();b.$10l?(b.fi({kind:"endEditRect",event:a,direction:b.$10l}),d.endTransaction()):b._shape&&c>=0?(b.fi({kind:"endEditPoint",event:a,data:b._shape,index:c}),d.endTransaction()):b._edge&&c>=0?(b.fi({kind:"endEditPoint",event:a,data:b._edge,index:c}),d.endTransaction()):b.$23l&&b.$40l&&(b.fi({kind:"endEditRotation",event:a}),d.endTransaction())},handleWindowTouchEnd:function(a){this.handleWindowMouseUp(a)},handleWindowMouseUp:function(a){var b=this,d=b.gv,f=d.dm(),g=b._shape,h=b._edge,i=b.$13l,j=b.$40l,k=b.$9l,l=b.$10l,m=b.$67l;if((g||h)&&i>=0&&k>=0){var n,p;if(g){var r=g.p(),t=g.getRotation();n=g.getPoints(),p=n.get(k),Qa(g,r,t,i,p,!1)}else if(n=ra(d.getDataUI(h),h.s("edge.points"),!0),p=n.get(k),0===i){var u=n.get(0);h.s("edge.source.offset.x",p.x-u.x),h.s("edge.source.offset.y",p.y-u.y)}else if(i===n.size()-1){var v=n.get(n.size()-1);h.s("edge.target.offset.x",p.x-v.x),h.s("edge.target.offset.y",p.y-v.y)}else"points"===h.s("edge.type")&&(n.set(i,p),h.s("edge.points",sa(n)))}b.$47l(a);var w=b.$73l;1===m?(f.beginTransaction(),w?d.sm().each(function(a){if(a.setHost&&d.isHelperEditable(a,"host")){a.setHost(w);var c=b.$75l,e=b.$74l;
c&&(a.s("attach.row.index",c.rowIndex),a.s("attach.column.index",c.columnIndex)),e&&(a.s("attach.index",e.attachIndex),a.s("attach.offset",e.attachOffset),a.s("attach.offset.relative",!1),a.s("attach.offset.opposite",!1))}}):d.sm().each(function(a){a.setHost&&d.isHelperEditable(a,"host")&&(a.setHost(y),a.s("attach.row.index",c),a.s("attach.column.index",c),a.s("attach.index",c),a.s("attach.offset",c),a.s("attach.offset.relative",!1),a.s("attach.offset.opposite",!1))}),f.endTransaction()):2===m?(f.beginTransaction(),w?d.sm().each(function(a){a.setParent&&d.isHelperEditable(a,"parent")&&a.setParent(w)}):d.sm().each(function(a){a.setParent&&d.isHelperEditable(a,"parent")&&a.setParent(y)}),f.endTransaction()):3===m?w&&(f.beginTransaction(),d.sm().each(function(c){if(d.isHelperEditable(c,"edge")&&c instanceof o&&w instanceof o){var g=new e.Edge;f.add(g),g.setSource(c),g.setTarget(w),b.onEdgeCreated&&b.onEdgeCreated(a,g)}}),f.endTransaction()):5===m||6===m?w&&(f.beginTransaction(),d.sm().each(function(a){a instanceof q&&w instanceof o&&(5===m&&d.isHelperEditable(a,"source")?a.setSource(w):6===m&&d.isHelperEditable(a,"source")&&a.setTarget(w))}),f.endTransaction()):(7===m||8===m||9===m)&&f.endTransaction(),(l||j)&&b.$43l(!0),s?(b.clear(),delete b.$64l,b._68I||b.$43l()):(b.handle_mousemove(a,!0),m&&!b._68I&&b.$43l())},handleWindowTouchMove:function(a){this.handleWindowMouseMove(a)},handleWindowMouseMove:function(a){this._78I(a)},handle_mousemove:function(a,b,c){if(!this._pause){if(!c){var d=s?fa(a):a;this.$61l={clientX:d.clientX,clientY:d.clientY}}if(b===!0||!w()){var e=this,f=e.gv,g=!1,h=y;e.clear(),f.sm().size()>0&&(h=f.lp(c?e.$61l:a),g=e._79I(a,h)),g&&(f._editing=1),e.$12l!==e.$65l&&(e.$65l=e.$12l,e.setCursor(e.$12l)),e.$40l!==e.$64l&&(e.$64l=e.$40l,e._68I||e.$43l()),e._hoverSegmentIndex!==e.$66l&&(e.$66l=e._hoverSegmentIndex,e._68I||e.$43l())}}},_78I:function(a){this.autoScroll(a);var b=this,c=b.gv,d=c.lp(a),e=c.getZoom(),g=b.$13l;if((b._shape||b._edge)&&g>=0){var h,i,j,k=b._shape,l=b._edge,m=b.$24l,n=c.getPointSnapSpacing(),r=function(a,b){return n==y||isNaN(n)?{x:a,y:b}:{x:Q(a/n)*n,y:Q(b/n)*n}};if(k){h=k.getPoints();var s=k.p(),t=k.getRotation(),v=0;i=na(s,d.x-s.x,d.y-s.y,-t),Qa(k,s,t,g,d,!0,m,r),b.fi({kind:"betweenEditPoint",event:a,data:k,index:g})}else if(l){h=ra(c.getDataUI(l),l.s("edge.points"),!0),d.x-=m.x,d.y-=m.y,i=d;var w,z,A=l.s("edge.offset"),B=h.size(),D=B>2;if(0===g){var E=h.get(0);A&&(E=pa(E,h.get(1),-A,D),d=pa(d,h.get(1),-A,D)),w=d.x-E.x,z=d.y-E.y,j=r(w,z),l.s("edge.source.offset.x",j.x),l.s("edge.source.offset.y",j.y)}else if(g===B-1){var J=h.get(B-1);A&&(J=pa(J,h.get(B-2),-A,D),d=pa(d,h.get(B-2),-A,D)),w=d.x-J.x,z=d.y-J.y,j=r(w,z),l.s("edge.target.offset.x",j.x),l.s("edge.target.offset.y",j.y)}else"points"===l.s("edge.type")&&(j=r(d.x,d.y),j.e=h.get(g).e,h.set(g,j),l.s("edge.points",sa(h)));b.fi({kind:"betweenEditPoint",event:a,data:l,index:g})}if(delete b.$9l,c.isSnapPoint(k)||c.isSnapPoint(l))for(v=0;v<h.size();v++)if(v!==g){var K=h.get(v);if(x(K,i)<c.getEditPointSize()/e){b.$9l=v;break}}}else if(b.$10l){var m=b.$24l;d.x-=m.x,d.y-=m.y;var L=c.sm().getSelection(),M=b.$1l,N=b.$7l,P=b.$10l,R=b.$4l,S=b.$2l,T=c.getEditRectPadding()/e,U=2*T,V=c.getSnapSpacing(),W=V!=y&&!isNaN(V),X=Oa(S,d,P,N,2*T,c.getResizeMode(),W,!0),Y=b.$6l;if(W){var Z=X.width-U,$=X.height-U,_=Q(Z/V)*V,aa=Q($/V)*V,ba=_-Z,ca=aa-$;("west"===P||"northwest"===P||"southwest"===P)&&(ba=-ba),("north"===P||"northwest"===P||"northeast"===P)&&(ca=-ca),X=Oa(S,d,P,N,2*T,c.getResizeMode(),W,!1,ba,ca)}b.$8l=X,Y.x=X.x+T,Y.y=X.y+T,Y.width=X.width-U,Y.height=X.height-U;var da=X.x+X.width/2,ea=X.y+X.height/2,fa=Y.x,ga=Y.y,ha=Y.width/R.width,ia=Y.height/R.height;L.each(function(a){if(a instanceof o&&c.isEditable(a)&&c.isRectEditable(a)){var d=M[a.getId()],e=b.$3l[a.getId()],f={x:d.x+d.width/2,y:d.y+d.height/2},g=0,h=0,i=P,j=180*O(N-a.getRotation())/C;"northeast"===P?j>=315||45>j?(g=d.width*ha+d.x,h=d.height*(1-ia)+d.y,i="northeast"):j>=45&&135>j?(g=d.width*(1-ia)+d.x,h=d.height*(1-ha)+d.y,i="northwest"):j>=135&&225>j?(g=d.width*(1-ha)+d.x,h=d.height*ia+d.y,i="southwest"):(g=d.width*ia+d.x,h=d.height*ha+d.y,i="southeast"):"north"===P?j>=315||45>j?(h=d.height*(1-ia)+d.y,i="north"):j>=45&&135>j?(g=d.width*(1-ia)+d.x,i="west"):j>=135&&225>j?(h=d.height*ia+d.y,i="south"):(g=d.width*ia+d.x,i="east"):"northwest"===P?j>=315||45>j?(g=d.width*(1-ha)+d.x,h=d.height*(1-ia)+d.y,i="northwest"):j>=45&&135>j?(g=d.width*(1-ia)+d.x,h=d.height*ha+d.y,i="southwest"):j>=135&&225>j?(g=d.width*ha+d.x,h=d.height*ia+d.y,i="southeast"):(g=d.width*ia+d.x,h=d.height*(1-ha)+d.y,i="northeast"):"west"===P?j>=315||45>j?(g=d.width*(1-ha)+d.x,i="west"):j>=45&&135>j?(h=d.height*ha+d.y,i="south"):j>=135&&225>j?(g=d.width*ha+d.x,i="east"):(h=d.height*(1-ha)+d.y,i="north"):"southwest"===P?j>=315||45>j?(g=d.width*(1-ha)+d.x,h=d.height*ia+d.y,i="southwest"):j>=45&&135>j?(g=d.width*ia+d.x,h=d.height*ha+d.y,i="southeast"):j>=135&&225>j?(g=d.width*ha+d.x,h=d.height*(1-ia)+d.y,i="northeast"):(g=d.width*(1-ia)+d.x,h=d.height*(1-ha)+d.y,i="northwest"):"east"===P?j>=315||45>j?(g=d.width*ha+d.x,i="east"):j>=45&&135>j?(h=d.height*(1-ha)+d.y,i="north"):j>=135&&225>j?(g=d.width*(1-ha)+d.x,i="west"):(h=d.height*ha+d.y,i="south"):"south"===P?j>=315||45>j?(h=d.height*ia+d.y,i="south"):j>=45&&135>j?(g=d.width*ia+d.x,i="east"):j>=135&&225>j?(h=d.height*(1-ia)+d.y,i="north"):(g=d.width*(1-ia)+d.x,i="west"):"southeast"===P&&(j>=315||45>j?(g=d.width*ha+d.x,h=d.height*ia+d.y,i="southeast"):j>=45&&135>j?(g=d.width*ia+d.x,h=d.height*(1-ha)+d.y,i="northeast"):j>=135&&225>j?(g=d.width*(1-ha)+d.x,h=d.height*(1-ia)+d.y,i="northwest"):(g=d.width*(1-ia)+d.x,h=d.height*ha+d.y,i="southwest"));var k=na(f,g-f.x,h-f.y,a.getRotation());Pa(a,d,i,{x:k.x,y:k.y});var l=fa+Y.width*e.x,m=ga+Y.height*e.y,n={x:l,y:m};n=na({x:da,y:ea},n.x-da,n.y-ea,N),a.p(n.x,n.y)}}),b.fi({kind:"betweenEditRect",event:a,direction:P})}else if(b.$23l&&b.$40l){var ja=b.$8l,ka=ja.width,la=ja.height,s={x:ja.x+ka/2,y:ja.y+la/2},m=b.$24l,ma=b.$23l,oa=ma.x/e-s.x,qa=ma.y/e-s.y,ta=I(oa*oa+qa*qa),ua=Math.asin(m.x/ta),va=c.sm().getSelection(),wa=F+H(d.y-s.y,d.x-s.x)-ua,xa=c.getSnapAngle(),wa=Q(wa/xa)*xa;0>wa&&(wa+=G);var ya=wa-b.$7l,za=[s.x,0,s.y];va.each(function(a){if(c.isEditable(a)&&c.isRotationEditable(a)&&c.isVisible(a)){var b=Ta(a.p3(),za),d=Ua();Wa(d,-ya),a.setRotation(a.getRotation()+ya),Va(b,d),a.p3(za[0]+b[0],za[1]+b[1],za[2]+b[2])}}),b.$7l=wa,b.fi({kind:"betweenEditRotation",event:a})}else if([1,2,3,5,6].indexOf(b.$67l)>=0)b.$72l=a,b.$78l||(b.$78l=1,u(function(){f.isDragging()&&b.$43l(),delete b.$78l},12));else if(7===b.$67l){if(b.$87l instanceof p){var k=b.$87l,Aa=b.$88l,Ba=f.clone(k.getPoints().get(Aa)),Ca=d.y-Ba.y;Ba.e||(Ba.e=0),b.$92l||(b.$92l=Ba.e),Ba.e=b.$92l-Ca,k.setPoint(Aa,Ba)}else if(b.$87l instanceof q){var l=b.$87l,Aa=b.$88l,h=ra(c.getDataUI(l),l.s("edge.points")),Ba=h.get(Aa),Ca=d.y-Ba.y;Ba.e||(Ba.e=0),b.$92l||(b.$92l=Ba.e),Ba.e=b.$92l-Ca,h.set(Aa,Ba),l.s("edge.points",sa(h))}}else if(8===b.$67l){var va=c.sm().getSelection(),Da=b.$93l;Da||(Da=b.$93l={}),va.each(function(a){if(a.p3){var c=a.p3(),f=Da[a.getId()];f==y&&(f=Da[a.getId()]=c[1]),a.p3([c[0],f-(d.y-b.$90l.y/e),c[2]])}})}else if(9===b.$67l){var va=c.sm().getSelection(),Ea=b.$94l;Ea||(Ea=b.$94l={}),va.each(function(a){if(a.s3){var c=a.s3(),f=Ea[a.getId()];f==y&&(f=Ea[a.getId()]=c[1]);var g=f-(d.y-b.$91l.y/e);0>g&&(g=.01),a.s3([c[0],g,c[2]])}})}},$79l:function(a,b){var c=this,d=c.gv,e=d.getZoom(),f=d.getEditHelperSize(),g=a.x/e,h=a.y/e,i=f/e,j=i/2;return T({x:g-j,y:h-j,width:i,height:i},b)?!0:void 0},getHelperCursor:function(a){return"crosshair"},_79I:function(a,b){for(var c=this,d=c.gv,e=d.getZoom(),f=d.getEditPointSize(),g=f/e,h=g/2,i=c.$46l(a),j=0;j<i.length;j++){var k,l,m=i[j],n=d.getDataUI(m);if(n&&n._55O){var o=n._55O;if(o._43O&&m instanceof q){if(k=m.s("edge.points"),k=ra(n,k),l=m.s("edge.segments"),l&&l.size()||(l=ta(k)),c.$42l(m,b,k._as,l,"edge"))return!0;if("points"===m.s("edge.type")&&c.$41l(m,b,k._as,l,"edge"))return}if(o._43O&&m instanceof p&&o.$15l&&o.$15l.length===m.getPoints().size()){if(k=o.$15l,l=m.getSegments(),l&&l.size()||(l=ta(k)),c.$42l(m,b,k,l,"shape"))return!0;if(c.$41l(m,b,k,l,"shape"))return}}}if(c.$16l){var k,r=c.$16l,s=r[3].x-r[7].x,t=r[3].y-r[7].y,u=I(s*s+t*t),v=r[1].x-r[5].x,w=r[1].y-r[5].y,x=I(v*v+w*w),y={x:b.x*e,y:b.y*e};if(c._80I(y,0,r[0],"northwest",u,x)||c._80I(y,1,r[1],"north",u,x)||c._80I(y,2,r[2],"northeast",u,x)||c._80I(y,7,r[7],"west",u,x)||c._80I(y,3,r[3],"east",u,x)||c._80I(y,6,r[6],"southwest",u,x)||c._80I(y,5,r[5],"south",u,x)||c._80I(y,4,r[4],"southeast",u,x))return!0}if(c.$23l){var z=c.$23l,A=z.x/e,B=z.y/e;if(T({x:A-h,y:B-h,width:g,height:g},b))return c.$40l=1,c.$12l=c.getHelperCursor("rotation")||"crosshair",!0}return c.$68l&&c.$79l(c.$68l,b)?(c.$67l=1,c.$12l=c.getHelperCursor("host")||"crosshair",!0):c.$69l&&c.$79l(c.$69l,b)?(c.$67l=2,c.$12l=c.getHelperCursor("parent")||"crosshair",!0):c.$70l&&c.$79l(c.$70l,b)?(c.$67l=3,c.$12l=c.getHelperCursor("edge")||"crosshair",!0):c.$71l&&c.$79l(c.$71l,b)?(c.$67l=4,c.$12l=c.getHelperCursor("remove")||"crosshair",!0):c.$82l&&c.$79l(c.$82l,b)?(c.$67l=5,c.$12l=c.getHelperCursor("source")||"crosshair",!0):c.$83l&&c.$79l(c.$83l,b)?(c.$67l=6,c.$12l=c.getHelperCursor("target")||"crosshair",!0):c._pointElevationHelperPoint&&c.$79l(c._pointElevationHelperPoint,b)?(c.$67l=7,c.$12l=c.getHelperCursor("pointElevation")||"crosshair",!0):c.$90l&&c.$79l(c.$90l,b)?(c.$67l=8,c.$12l=c.getHelperCursor("elevation")||"crosshair",!0):c.$91l&&c.$79l(c.$91l,b)?(c.$67l=9,c.$12l=c.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(a,b,c,d,e,f){var g=this,h=g.gv,i=h.getEditPointSize(),j=i/2,k=h.sm(),l=h.isDirectionEditable;if(l&&1===k.size()){var m=k.ld();if(l=l.bind(h),m instanceof o){if(!l(m,d))return!1;if("east"===d){if(l(m,"northeast")&&l(m,"southeast")&&2*i>=f)return!1}else if("west"===d){if(l(m,"northwest")&&l(m,"southwest")&&2*i>=f)return!1}else if("north"===d){if(l(m,"northwest")&&l(m,"northeast")&&2*i>=e)return!1}else if("south"===d&&l(m,"southwest")&&l(m,"southeast")&&2*i>=e)return!1}}else{if(2*i>=e&&("north"===d||"south"===d))return!1;if(2*i>=f&&("east"===d||"west"===d))return!1}if(T({x:c.x-j,y:c.y-j,width:i,height:i},a)){if(g.$10l!==d){var n=180*g.$7l/C,p="";n>=337.5||22.5>n?p="north":n>=22.5&&67.5>n?p="northeast":n>=67.5&&112.5>n?p="east":n>=112.5&&157.5>n?p="southeast":n>=157.5&&202.5>n?p="south":n>=202.5&&247.5>n?p="southwest":n>=247.5&&292.5>n?p="west":n>=292.5&&337.5>n&&(p="northwest");var q=Na.indexOf(p),p=Na[b-(1-q)+8];switch(p){case"northwest":g.$12l="nwse-resize";break;case"northeast":g.$12l="nesw-resize";break;case"southwest":g.$12l="nesw-resize";break;case"southeast":g.$12l="nwse-resize";break;case"north":g.$12l="ns-resize";break;case"east":g.$12l="ew-resize";break;case"south":g.$12l="ns-resize";break;case"west":g.$12l="ew-resize"}g.$10l=d}return!0}return!1},$42l:function(a,b,c,d,e){var f,g=this,h=g.gv,i=h.getEditPointSize(),j=i/h.getZoom(),k=-1,l={x:b.x,y:b.y,width:0,height:0},m=function(b){"shape"===e?g._shape=a:g._edge=a,g._removePointIndex=b},n=function(b){"shape"===e?g._shape=a:g._edge=a,g.$13l=b,g.$12l="crosshair"};for(v(l,j/2),k=c.length-1,f=d.size()-1;f>=0;f--){var o=d.get(f);if(1===o||2===o)k-=1;else if(3===o){var p=c[k-1];if(T(l,p))return n(k-1),!0;k-=2}else if(4===o){var q=c[k-1],r=c[k-2];if(T(l,q))return n(k-1),!0;if(T(l,r))return n(k-2),!0;k-=3}}for(k=c.length-1,f=d.size()-1;f>=0;f--){var o=d.get(f),s=c[k];if(T(l,s))return m(k),n(k),!0;1===o||2===o?k-=1:3===o?k-=2:4===o&&(k-=3)}return!1},$41l:function(a,b,c,d,e){var f=this,g=f.gv,h=-1,i=0,j={x:b.x,y:b.y,width:0,height:0},k=function(c,d){f._hoverSegmentIndex=d,f._lp=b,"shape"===e?f._shape=a:f._edge=a};for(v(j,g.getSegmentHoverWidth()/2/g.getZoom()),a instanceof p&&a.isClosePath()&&d.indexOf(5)<0&&(d=new z(d._as),d.add(5));i<d.size();i++){var l=d.get(i);if(1===l){var m=c[h],n=c[h+1];if(m){var o=mb(new bb(m.x,m.y),new bb(n.x,n.y),new bb(j.x,j.y),new bb(j.x+j.width,j.y+j.height));if(o.$62l===D&&o.points.length>0)return k(o,i),!0}h+=1}else if(2===l){var m=c[h],n=c[h+1],o=mb(new bb(m.x,m.y),new bb(n.x,n.y),new bb(j.x,j.y),new bb(j.x+j.width,j.y+j.height));if(o.$62l===D&&o.points.length>0)return k(o,i),!0;h+=1}else if(3===l){var m=c[h],q=c[h+1],r=c[h+2],o=jb(new bb(m.x,m.y),new bb(q.x,q.y),new bb(r.x,r.y),new bb(j.x,j.y),new bb(j.x+j.width,j.y+j.height));if(o.$62l===D)return k(o,i),!0;h+=2}else if(4===l){var m=c[h],s=c[h+1],t=c[h+2],r=c[h+3],o=lb(new bb(m.x,m.y),new bb(s.x,s.y),new bb(t.x,t.y),new bb(r.x,r.y),new bb(j.x,j.y),new bb(j.x+j.width,j.y+j.height));if(o.$62l===D)return k(o,i),!0;h+=3}else if(5===l){var m=c[h],n=c[0];if(m){var o=mb(new bb(m.x,m.y),new bb(n.x,n.y),new bb(j.x,j.y),new bb(j.x+j.width,j.y+j.height));if(o.$62l===D&&o.points.length>0)return k(o,i),!0}}}return!1},addShapePoint:function(a,b,c){var d=this,e=d.gv,f=e.dm();if(f.beginTransaction(),0===arguments.length&&(a=d._shape||d._edge,b=d._hoverSegmentIndex,c=d._lp),a instanceof p||a instanceof q){var g=Ra(a,e.getDataUI(a),b);if(!isNaN(b)&&c&&!isNaN(g)){var h=c;if(a instanceof p){var i=a.p(),j=a.getRotation(),k=a.toSegments();k&&k.size()||(k=ta(a.getPoints())),a.isClosePath()&&k.indexOf(5)<0&&(k=new z(k._as),k.add(5));var l=k.get(b),m="addPoint",n="removePointAt";if(2===l||1===l){var o={x:h.x,y:h.y};k.add(l,b),o=na(i,o.x-i.x,o.y-i.y,-j),a[m](o,g+1)}else if(3===l){var r=a.getPoints(),s=r.get(g),t=r.get(g+2),o={x:h.x,y:h.y};o=na(i,o.x-i.x,o.y-i.y,-j);var u=ua(s,o),v=ua(o,t);k.removeAt(b),k.add(3,b),k.add(3,b),a.setPoint(g+1,o),a[m](v,g+2),a[m](u,g+1)}else if(4===l){var r=a.getPoints(),s=r.get(g),t=r.get(g+3),o={x:h.x,y:h.y};o=na(i,o.x-i.x,o.y-i.y,-j);var u=va(s,o),v=wa(s,o),w=va(o,t),x=wa(o,t);k.removeAt(b),k.add(4,b),k.add(4,b),a[n](g+1),a[n](g+1),a[m](o,g+1),a[m](x,g+2),a[m](w,g+2),a[m](v,g+1),a[m](u,g+1)}else if(5===l){var o={x:h.x,y:h.y};k.add(2,b),o=na(i,o.x-i.x,o.y-i.y,-j),a[m](o,g+1)}a.isClosePath()&&k.remove(5),a.setSegments(k);var y=a.getWidth(),A=a.getHeight(),B=a.p().x-y/2,C=a.p().y-A/2;B-=i.x,C-=i.y;var D=xa(a,{x:B,y:C,width:y,height:A},j,i);a.p(D.x,D.y)}else if(a instanceof q){if("points"!==a.s("edge.type"))return void f.endTransaction();var r=a.s("edge.points");k=a.s("edge.segments"),r=ra(e.getDataUI(a),r),k&&k.size()||(k=ta(r)),k=new z(k._as.slice(0)),r=new z(r._as.slice(0));var l=k.get(b);if(2===l||1===l){var o={x:h.x,y:h.y};k.add(l,b),r.add(o,g+1)}else if(3===l){var s=r.get(g),t=r.get(g+2),o={x:h.x,y:h.y},u=ua(s,o),v=ua(o,t);k.removeAt(b),k.add(3,b),k.add(3,b),r.set(g+1,o),r.add(v,g+2),r.add(u,g+1)}else if(4===l){var s=r.get(g),t=r.get(g+3),o={x:h.x,y:h.y},u=va(s,o),v=wa(s,o),w=va(o,t),x=wa(o,t);k.removeAt(b),k.add(4,b),k.add(4,b),r.removeAt(g+1),r.removeAt(g+1),r.add(o,g+1),r.add(x,g+2),r.add(w,g+2),r.add(v,g+1),r.add(u,g+1)}a.s("edge.points",sa(r)),a.s("edge.segments",k)}}}f.endTransaction()},removeShapePoint:function(a,b){var c=this,d="removeAt",e=c.gv,f=e.dm();if(f.beginTransaction(),0===arguments.length&&(a=c._shape||c._edge,b=c._removePointIndex),b>=0&&(a instanceof p||a instanceof q)){var g=Sa(a,c.gv.getDataUI(a),b),h=b;if(a instanceof p){var i=a.p(),j=a.toSegments();j&&j.size()||(j=ta(a.getPoints()));var k=j.get(g),l="removePointAt";if(1===k&&0===h)if(a.getPoints().size()>1){var m=j.get(g+1);j[d](g+1),3===m?a[l](h+1):4===m&&(a[l](h+2),a[l](h+1)),a[l](h)}else a.dm().remove(a);else 2===k||1===k?(j[d](g),a[l](h)):3===k?(j[d](g),a[l](h),a[l](h-1)):4===k&&(j[d](g),a[l](h),a[l](h-1),a[l](h-2));a.setSegments(j);var n=a.getWidth(),o=a.getHeight(),r=a.p().x-n/2,s=a.p().y-o/2;r-=i.x,s-=i.y;var t=xa(a,{x:r,y:s,width:n,height:o},a.getRotation(),i);a.p(t.x,t.y)}else if(a instanceof q){if("points"!==a.s("edge.type"))return void f.endTransaction();var u=a.s("edge.points");if(j=a.s("edge.segments"),u&&(u=ra(c.gv.getDataUI(a),u),j&&j.size()||(j=ta(u))),0===b||b===u.size()-1)return void f.endTransaction();j=new z(j._as.slice(0)),u=new z(u._as.slice(0));var k=j.get(g);2===k||1===k?(j[d](g),u[d](h)):3===k?(j[d](g),u[d](h),u[d](h-1)):4===k&&(j[d](g),u[d](h),u[d](h-1),u[d](h-2)),a.s("edge.segments",j),a.s("edge.points",sa(u))}}f.endTransaction()},changeShapeSegment:function(a,b,c){var d=this,e=d.gv,f=e.dm();if(f.beginTransaction(),1!==arguments.length||isNaN(a)||(c=a,a=d._shape||d._edge,b=d._hoverSegmentIndex),a instanceof p||a instanceof q){var g=Ra(a,d.gv.getDataUI(a),b);if(!isNaN(b)&&!isNaN(g))if(a instanceof p){var h=a.p(),i=a.toSegments();i&&i.size()||(i=ta(a.getPoints()));var j=i.get(b),k=a.toPoints();if(1===c||2===c)1===j||2===j?i.set(b,c):3===j?(i.set(b,c),k.removeAt(g+1)):4===j&&(i.set(b,c),k.removeAt(g+1),k.removeAt(g+1));else if(3===c){var l=function(){var a=k.get(g),c=k.get(g+1),d=ua(a,c);i.set(b,3),k.add(d,g+1)};2===j||1===j?l():4===j&&(k.removeAt(g+1),k.removeAt(g+1),l())}else if(4===c){var m=function(){var a=k.get(g),c=k.get(g+1),d=va(a,c),e=wa(a,c);i.set(b,4),k.add(d,g+1),k.add(e,g+2)};2===j||1===j?m():3===j&&(k.removeAt(g+1),m())}a.setSegments(i),a.setPoints(k);var n=a.getWidth(),o=a.getHeight(),r=a.p().x-n/2,s=a.p().y-o/2;r-=h.x,s-=h.y;var t=new xa(a,{x:r,y:s,width:n,height:o},a.getRotation(),h);a.p(t.x,t.y)}else if(a instanceof q){if("points"!==a.s("edge.type"))return void f.endTransaction();var k=a.s("edge.points");i=a.s("edge.segments"),k&&(k=ra(d.gv.getDataUI(a),k),i&&i.size()||(i=ta(k))),i=new z(i._as.slice(0)),k=new z(k._as.slice(0));var j=i.get(b);if(1===c||2===c)1===j||2===j?i.set(b,c):3===j?(i.set(b,c),k.removeAt(g+1)):4===j&&(i.set(b,c),k.removeAt(g+1),k.removeAt(g+1));else if(3===c){var l=function(){var a=k.get(g),c=k.get(g+1),d=ua(a,c);i.set(b,3),k.add(d,g+1)};2===j||1===j?l():4===j&&(k.removeAt(g+1),k.removeAt(g+1),l())}else if(4===c){var m=function(){var a=k.get(g),c=k.get(g+1),d=va(a,c),e=wa(a,c);i.set(b,4),k.add(d,g+1),k.add(e,g+2)};2===j||1===j?m():3===j&&(k.removeAt(g+1),m())}a.s("edge.points",sa(k)),a.s("edge.segments",i)}}f.endTransaction()},getDefaultSegments:function(a){var b=this.gv,c=b.getDataUI(a);if(a instanceof q){var d=a.s("edge.points");return d=ra(c,d),ta(d)}if(a instanceof p){var d=a.getPoints(),e=a.getSegments();return e&&e.size()>0?e:ta(d)}},$43l:function(a){var b=this;a&&(b.$5l=1),b._68I=1,b._42()},_42:function(){var a=this;if(a._68I){delete a._68I;var b=a.gv,c=a.$5l,d=b.getZoom(),g=b.getEditPointSize(),i=g/2,j=new z,k=a._view,l=a._edge,m=a._shape,n=k.getContext("2d"),s=b.tx(),t=b.ty(),u=y,w=b.getEditPointBackground(),x=b.getControlPointBackground(),A=b.getControlPointBorderColor(),B=b.getEditPointBorderColor(),C=b.getEditRectBorderColor(),D=b.getDirectionLineColor(),E=b.getSegmentHoverColor(),F=b.getSnapPointBorderColor(),H=b.getJoinPointBackground(),J=b.getJoinPointBorderColor(),K=b.getSegmentHoverWidth(),L=[5,5],M=b.getEditRectBorderStyle();ia(b,function(a){b.isSelected(a)&&b.isVisible(a)&&j.add(a)}),n.clearRect(0,0,P(k.width),P(k.height)),n.save(),h.translateAndScale(n,s,t,1);var N=y,O={x:0,y:0,width:0,height:0},Q=0,T=0,X=0,Z=0,$=0,_=0,aa=0,ba=0,ca=0,da=0,ea=[];if(c?(delete a.$6l,delete a.$8l,delete a.$7l,delete a.$16l,delete a.$23l):(N=a.$6l,u=a.$7l),delete a.$68l,delete a.$69l,delete a.$71l,delete a.$70l,delete a.$82l,delete a.$83l,delete a._pointElevationHelperPoint,delete a.$90l,delete a.$91l,delete a.$75l,delete a.$74l,j.each(function(a){var c=b.getDataUI(a);if(c){var d=c._55O;if(b.isEditable(a))d._56O&&a instanceof o&&T++,ea.push(a),d._42O&&a instanceof o&&Q++,b.isHelperEditable(a,"host")&&Z++,b.isHelperEditable(a,"parent")&&X++,b.isHelperEditable(a,"remove")&&$++,b.isHelperEditable(a,"edge")&&_++,b.isHelperEditable(a,"source")&&aa++,b.isHelperEditable(a,"target")&&ba++,b.isHelperEditable(a,"elevation")&&ca++,b.isHelperEditable(a,"tall")&&da++;else if(a instanceof r&&a.isExpanded()){var e=!0,f=b.getEditableFunc();f&&(e=f(a)),e&&(b.isHelperEditable(a,"host")&&Z++,b.isHelperEditable(a,"parent")&&X++,b.isHelperEditable(a,"remove")&&$++,b.isHelperEditable(a,"edge")&&_++,b.isHelperEditable(a,"source")&&aa++,b.isHelperEditable(a,"target")&&ba++,b.isHelperEditable(a,"elevation")&&ca++,b.isHelperEditable(a,"tall")&&da++,ea.push(a))}}}),n.beginPath(),n.lineWidth=1,n.strokeStyle=b.getNodeBorderColor(),ea.forEach(function(e){var f=b.getDataUI(e),g=f._55O;if(c)if(u==y&&(u=e instanceof q?0:e instanceof r&&e.isExpanded()?0:e.getRotation(),a.$7l=u),N==y){var h,i,j;if(e instanceof r&&e.isExpanded()||e instanceof q){var k=b.getDataUIBounds(e);i=k.width,j=k.height,h={x:k.x+i/2,y:k.y+j/2}}else h=e.p(),i=e.getWidth(),j=e.getHeight();N={x:h.x,y:h.y,width:0,height:0},O.x=h.x-i/2,O.y=h.y-j/2,O.width=i,O.height=j,N=S(N,O)}else{var h,i,j,l,m=N.x+N.width/2,p=N.y+N.height/2,s={x:m,y:p};if(e instanceof r&&e.isExpanded()||e instanceof q){l=0;var k=b.getDataUIBounds(e);i=k.width,j=k.height,h={x:k.x+i/2,y:k.y+j/2}}else h=e.p(),i=e.getWidth(),j=e.getHeight(),l=e.getRotation();var t={x:h.x-i/2,y:h.y-j/2,width:i,height:j},v={x:t.x,y:t.y},w={x:t.x+t.width,y:t.y},x={x:t.x,y:t.y+t.height},z={x:t.x+t.width,y:t.y+t.height},v=na(h,v.x-h.x,v.y-h.y,l),x=na(h,x.x-h.x,x.y-h.y,l),z=na(h,z.x-h.x,z.y-h.y,l),w=na(h,w.x-h.x,w.y-h.y,l),A=-u,B=na(s,v.x-s.x,v.y-s.y,A),C=na(s,w.x-s.x,w.y-s.y,A),D=na(s,x.x-s.x,x.y-s.y,A),E=na(s,z.x-s.x,z.y-s.y,A),F=R([B,C,D,E]);N=S(N,F),N.x-=m,N.y-=p;var G=xa(y,N,u,s);N.x=G.x-N.width/2,N.y=G.y-N.height/2}if(Q>1&&b.isEditable(e)&&b.isRectEditable(e)&&e instanceof o){var H=e.getRect(),I=g.$45l,J=ha(I[0],d),K=ha(I[2],d),L=ha(I[4],d),M=ha(I[6],d);e.getRotation()?(n.moveTo(J.x,J.y),n.lineTo(K.x,K.y),n.lineTo(L.x,L.y),n.lineTo(M.x,M.y),n.lineTo(J.x,J.y)):n.rect(H.x*d,H.y*d,H.width*d,H.height*d)}}),n.stroke(),N){a.$6l=U(N),v(N,b.getEditRectPadding()/d);var fa={x:N.x+N.width/2,y:N.y+N.height/2},ja=la(fa,N.width,N.height,u),ka=ja[0],ma=ja[1],oa=ja[2],pa=ja[3],sa=ja[4],ua=ja[5],va=ja[6],wa=ja[7];if(ka=ha(ja[0],d),ma=ha(ja[1],d),oa=ha(ja[2],d),pa=ha(ja[3],d),sa=ha(ja[4],d),ua=ha(ja[5],d),va=ha(ja[6],d),wa=ha(ja[7],d),a.$8l=N,Q>0&&(a.$16l=[ka,sa,ma,ua,pa,va,oa,wa],n.beginPath(),n.lineWidth=1,n.strokeStyle=C,"dashed"===M&&n.setLineDash&&n.setLineDash(L),n.moveTo(ka.x,ka.y),n.lineTo(ma.x,ma.y),n.lineTo(pa.x,pa.y),n.lineTo(oa.x,oa.y),n.lineTo(ka.x,ka.y),n.stroke(),"dashed"===M&&n.setLineDash&&n.setLineDash([])),n.beginPath(),n.lineWidth=1,n.fillStyle=w,n.strokeStyle=B,Q>0){var ya=ua.x-wa.x,za=ua.y-wa.y,Aa=I(ya*ya+za*za),Ba=sa.x-va.x,Ca=sa.y-va.y,Da=I(Ba*Ba+Ca*Ca),Ea=2*g;if(b.isDirectionEditable&&1===ea.length){var Fa=ea[0],Ga=b.getDataUI(Fa),Ha=Ga._55O,Ia=b.isDirectionEditable.bind(b);if(Ha._42O){var Ja,Ka,La,Ma;Ia(Fa,"northwest")&&(Ja=!0,n.rect(ka.x-i,ka.y-i,g,g)),Ia(Fa,"northeast")&&(Ka=!0,n.rect(ma.x-i,ma.y-i,g,g)),Ia(Fa,"southwest")&&(La=!0,n.rect(oa.x-i,oa.y-i,g,g)),Ia(Fa,"southeast")&&(Ma=!0,n.rect(pa.x-i,pa.y-i,g,g)),Ia(Fa,"north")&&(Ja&&Ka?Aa>Ea&&n.rect(sa.x-i,sa.y-i,g,g):n.rect(sa.x-i,sa.y-i,g,g)),Ia(Fa,"south")&&(Ma&&La?Aa>Ea&&n.rect(va.x-i,va.y-i,g,g):n.rect(va.x-i,va.y-i,g,g)),Ia(Fa,"west")&&(La&&Ja?Da>Ea&&n.rect(wa.x-i,wa.y-i,g,g):n.rect(wa.x-i,wa.y-i,g,g)),Ia(Fa,"east")&&(Ma&&Ka?Da>Ea&&n.rect(ua.x-i,ua.y-i,g,g):n.rect(ua.x-i,ua.y-i,g,g))}}else Aa>Ea&&(n.rect(sa.x-i,sa.y-i,g,g),n.rect(va.x-i,va.y-i,g,g)),Da>Ea&&(n.rect(ua.x-i,ua.y-i,g,g),n.rect(wa.x-i,wa.y-i,g,g)),n.rect(ka.x-i,ka.y-i,g,g),n.rect(ma.x-i,ma.y-i,g,g),n.rect(oa.x-i,oa.y-i,g,g),n.rect(pa.x-i,pa.y-i,g,g)}if(T>0){var Na=a.$23l=na(sa,0,2*-g,u);n.moveTo(Na.x+i,Na.y),n.arc(Na.x,Na.y,i,0,G,!1)}n.fill(),n.stroke(),a.$40l&&a.$44l(n,N,u);var Oa,Pa,Qa=b.getLeftTopHelpers(),Sa=b.getRightTopHelpers(),Ta=b.getLeftBottomHelpers(),Ua=b.getRightBottomHelpers(),Va=b.getEdgeHelpers(),Wa=b.getEditHelperSize(),Ya=Wa/2,$a=function(c,e,f,g){"leftTop"===e?(Oa=N.x*d-Wa-i-("h"===g?f*(Wa+i):0)-1,Pa=N.y*d-Wa-i-("v"===g?f*(Wa+i):0)-1):"rightTop"===e?(Oa=(N.x+N.width)*d+i+("h"===g?f*(Wa+i):0)+1,Pa=N.y*d-Wa-i-("v"===g?f*(Wa+i):0)-1):"leftBottom"===e?(Oa=N.x*d-Wa-i-("h"===g?f*(Wa+i):0)-1,Pa=(N.y+N.height)*d+i+("v"===g?f*(Wa+i):0)+1):"rightBottom"===e&&(Oa=(N.x+N.width)*d+i+("h"===g?f*(Wa+i):0)+1,Pa=(N.y+N.height)*d+i+("v"===g?f*(Wa+i):0)+1);var h=Oa+Ya,j=Pa+Ya,k=(N.x+N.width/2)*d,l=(N.y+N.height/2)*d,m=na({x:k,y:l},h-k,j-l,u);if("host"===c){if(Z>0)return a.$77l(n,u,m),!0}else if("edge"===c){if(_>0)return a.$80l(n,u,m),!0}else if("remove"===c){if($>0)return ea&&1===ea.length&&ea[0]instanceof q?a.$81l(n,u,{x:k+Wa/2+5,y:l}):a.$81l(n,u,m),!0}else if("parent"===c){if(X>0)return ea&&1===ea.length&&ea[0]instanceof q?a.$76l(n,u,{x:k-Wa/2-5,y:l}):a.$76l(n,u,m),!0}else if("elevation"===c){if(ca>0)return a.$85l(n,u,m),!0}else if("tall"===c){if(da>0)return a.$86l(n,u,m),!0}else if("source"===c||"target"===c){var o=ea[0],p=b.getDataUI(o),r=qa(p,!0),s=r[0],t=r[1];if(aa&&"source"===c)return a.$84l(n,N,s,!0,o.isLooped(),e,f,g),!0;if(ba&&"target"===c)return a.$84l(n,N,t,!1,o.isLooped(),e,f,g),!0}};if(Qa&&Qa.length>0){var _a=0;Qa.forEach(function(a){$a(a,"leftTop",_a,b.getLeftTopHelpersAlign()||"h")&&_a++})}if(Sa&&Sa.length>0){var _a=0;Sa.forEach(function(a){$a(a,"rightTop",_a,b.getRightTopHelpersAlign()||"h")&&_a++})}if(Ta&&Ta.length>0){var _a=0;Ta.forEach(function(a){$a(a,"leftBottom",_a,b.getLeftBottomHelpersAlign()||"h")&&_a++})}if(Ua&&Ua.length>0){var _a=0;Ua.forEach(function(a){$a(a,"rightBottom",_a,b.getRightBottomHelpersAlign()||"h")&&_a++})}if(Va&&Va.length>0&&((aa||ba)&&ea&&1===ea.length&&ea[0]instanceof q?!0:!1)){var _a=0;Va.forEach(function(a){$a(a,"edge",_a,"h")&&_a++})}if(a.$72l){var ab,bb=a.$67l,cb=a.$68l,db=a.$69l,eb=(a.$71l,a.$70l),fb=a.$82l,gb=a.$83l;if(1===bb?ab=cb:2===bb?ab=db:3===bb?ab=eb:5===bb?ab=fb:6===bb&&(ab=gb),ab){var hb=b.lp(a.$72l),ib=b.getDataAt(a.$72l);if(ib&&ib instanceof o){var jb,kb,lb;if(a.$73l=ib,1===bb)if(ib instanceof e.Grid)jb=a.$75l=Xa(ib,hb);else if(ib instanceof e.Shape){lb=a.$74l=Za(ib,hb);var mb=ib.getPoints();if(lb){var nb=lb.attachIndex,ob=Ra(ib,b.getDataUI(ib),nb)+1,pb=ob+1>=mb.size()?0:ob+1,qb=mb.get(ob),rb=mb.get(pb),sb=ib.p(),tb=ib.getRotation();qb=na(sb,qb.x-sb.x,qb.y-sb.y,tb),rb=na(sb,rb.x-sb.x,rb.y-sb.y,tb),n.beginPath(),n.strokeStyle=E,n.lineWidth=K,n.moveTo(qb.x*d,qb.y*d),n.lineTo(rb.x*d,rb.y*d),n.stroke()}}jb?kb=jb.rect:(kb=f.clone(b.getDataUIBounds(ib)),f.grow(kb,2)),n.beginPath(),n.rect(kb.x*d,kb.y*d,kb.width*d,kb.height*d),1===bb||4===bb||6===bb?n.strokeStyle=W:n.strokeStyle=V,n.lineWidth=2,n.setLineDash&&n.setLineDash([8,8]),n.stroke()}else delete a.$73l;hb.x=hb.x*d,hb.y=hb.y*d;var ub=ga(ab.x,ab.y,hb.x,hb.y),vb=na(ab,hb.x-ab.x,hb.y-ab.y,-ub),wb=vb.x-ab.x;n.save(),n.translate(ab.x,ab.y),n.rotate(ub),Y.width=wb,Y.height=40;var xb=V;(1===bb||4===bb||6===bb)&&(xb=W),Y.comps[0].gradientColor=xb,f.drawImage(n,Y,0,-20,wb,40),n.restore()}}}if(j.each(function(c){var e=b.getDataUI(c);if(e){var f,g,h=e._55O,j=e._78o;if(h&&h._43O&&c instanceof p?(f=h.$15l,g=c.getSegments(),g&&g.size()||(g=ta(f)),c.isClosePath()&&g.indexOf(5)<0&&(g=new z(g._as),g.add(5))):h&&j&&h._43O&&(f=c.s("edge.points"),g=c.s("edge.segments"),f=ra(e,f),g&&g.size()||(g=ta(f)),f&&(f=f._as)),f&&g){var k=0,o=g.size(),q=a._hoverSegmentIndex;f=f.slice(0);for(var r=0;r<f.length;r++)f[r]=ha(f[r],d);n.beginPath(),n.strokeStyle=D,n.lineWidth=1,k=0;for(var r=0;o>r;r++){var s=g.get(r);if(1===s||2===s)k++;else if(3===s){var t=f[k-1],u=f[k],v=f[k+1];n.moveTo(t.x,t.y),n.lineTo(u.x,u.y),n.lineTo(v.x,v.y),k+=2}else if(4===s){var t=f[k-1],w=f[k],B=f[k+1],v=f[k+2];n.moveTo(t.x,t.y),n.lineTo(w.x,w.y),n.moveTo(B.x,B.y),n.lineTo(v.x,v.y),k+=3}}if(n.stroke(),m===c||l===c&&"points"===l.s("edge.type")){n.beginPath(),k=0,n.strokeStyle=E,n.lineWidth=K;for(var r=0;o>r;r++){var s=g.get(r);if(1===s||2===s){if(q===r){var t=f[k-1],v=f[k];n.moveTo(t.x,t.y),n.lineTo(v.x,v.y);break}k++}else if(3===s){if(q===r){var t=f[k-1],u=f[k],v=f[k+1];n.moveTo(t.x,t.y),n.quadraticCurveTo(u.x,u.y,v.x,v.y);break}k+=2}else if(4===s){if(q===r){var t=f[k-1],w=f[k],B=f[k+1],v=f[k+2];n.moveTo(t.x,t.y),n.bezierCurveTo(w.x,w.y,B.x,B.y,v.x,v.y);break}k+=3}else if(5===s&&q===r){var t=f[k-1],v=f[0];n.moveTo(t.x,t.y),n.lineTo(v.x,v.y);break}}n.stroke()}n.beginPath(),k=0,n.strokeStyle=J,n.lineWidth=1,n.fillStyle=H;for(var r=0;o>r;r++){var s=g.get(r);if(1===s||2===s){var v=f[k];n.moveTo(v.x+i,v.y),n.arc(v.x,v.y,i,0,G,!0),k++}else if(3===s){var v=f[k+1];n.moveTo(v.x+i,v.y),n.arc(v.x,v.y,i,0,G,!0),k+=2}else if(4===s){var v=f[k+2];n.moveTo(v.x+i,v.y),n.arc(v.x,v.y,i,0,G,!0),k+=3}}n.fill(),n.stroke(),n.beginPath(),k=0,n.strokeStyle=A,n.lineWidth=1,n.fillStyle=x;for(var r=0;o>r;r++){var s=g.get(r);if(1===s||2===s)k++;else if(3===s){var u=f[k];n.moveTo(u.x+i,u.y),n.arc(u.x,u.y,i,0,G,!0),k+=2}else if(4===s){var w=f[k],B=f[k+1];n.moveTo(w.x+i,w.y),n.arc(w.x,w.y,i,0,G,!0),n.moveTo(B.x+i,B.y),n.arc(B.x,B.y,i,0,G,!0),k+=3}}if(n.fill(),n.stroke(),n.beginPath(),k=0,n.strokeStyle=F,n.lineWidth=2,(m===c||l===c)&&a.$9l!=y){var v=f[a.$9l];n.moveTo(v.x+i,v.y),n.arc(v.x,v.y,i,0,G,!0),n.stroke()}}}}),a.$87l&&b.sm().contains(a.$87l)){var yb,zb=a.$87l,Ab=a.$88l,Wa=b.getEditHelperSize(),Ya=Wa/2;if(b.isHelperEditable(zb,"pointElevation"))if(zb instanceof p){var Bb=zb.getPosition();yb=f.clone(zb.getPoints().get(Ab)),yb=na({x:Bb.x,y:Bb.y},yb.x-Bb.x,yb.y-Bb.y,zb.getRotation()),yb.x*=d,yb.y*=d,n.translate(yb.x,yb.y),f.drawImage(n,f.getImage("xeditinteractor_elevationIcon"),Ya,-Ya,Wa,Wa),n.translate(-yb.x,-yb.y),a._pointElevationHelperPoint={x:yb.x+Wa,y:yb.y}}else if(zb instanceof q){var Cb=ra(b.getDataUI(zb),zb.s("edge.points")),yb=f.clone(Cb.get(Ab));yb.x*=d,yb.y*=d,n.translate(yb.x,yb.y),f.drawImage(n,f.getImage("xeditinteractor_elevationIcon"),Ya,-Ya,Wa,Wa),n.translate(-yb.x,-yb.y),a._pointElevationHelperPoint={x:yb.x+Wa,y:yb.y}}}n.restore(),a.$5l=0}},$89l:function(a,b,c,d){a.save();var e=this,g=e.gv,h=g.getEditHelperSize(),i=h/2;a.beginPath(),a.translate(c.x,c.y),a.rotate(b),f.drawImage(a,d,-i,-i,h,h),a.restore()},$85l:function(a,b,c){var d=this;d.$90l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_elevationIcon"))},$86l:function(a,b,c){var d=this;d.$91l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_tallIcon"))},$77l:function(a,b,c){var d=this;d.$68l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_hostIcon"))},$80l:function(a,b,c){var d=this;d.$70l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_edgeIcon"))},$81l:function(a,b,c){var d=this;d.$71l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_removeIcon"))},$76l:function(a,b,c){var d=this;d.$69l=c,d.$89l(a,b,c,f.getImage("xeditinteractor_parentIcon"))},$84l:function(a,b,c,d,e){var g,h=this,i=h.gv,j=i.getZoom(),k=i.getEditHelperSize(),l=k/2;c.x*=j,c.y*=j,e&&(d?c.x-=l+5:c.x+=l+5),c.y-=k-2,d?(h.$82l=c,g=f.getImage("xeditinteractor_sourceIcon")):(h.$83l=c,g=f.getImage("xeditinteractor_targetIcon")),a.beginPath(),a.translate(c.x,c.y),f.drawImage(a,g,-l,-l,k,k),a.translate(-c.x,-c.y)},$44l:function(a,b,c){a.save();var d=this.gv.getZoom(),e=I(J(b.width,2)+J(b.height,2))/2*d+10,f=e,g=f+8,h=f+18,i=c,j=b.x+b.width/2,k=b.y+b.height/2;a.translate(j*d,k*d),a.beginPath(),a.strokeStyle="rgb(150, 150, 150)";for(var l=0,m=0,n=0,o=0,p=0,q=0;360>q;q++)l=q*C/180,q%5===0&&(m=L(l)*f,n=K(l)*f,o=L(l)*g,p=K(l)*g,a.moveTo(m,n),a.lineTo(o,p)),q%45===0&&(m=L(l)*f,n=K(l)*f,o=L(l)*h,p=K(l)*h,a.moveTo(m,n),a.lineTo(o,p));a.stroke(),a.beginPath(),a.rotate(-F),a.beginPath(),a.fillStyle="rgba(255, 0, 0, 0.1)",a.strokeStyle="rgb(157, 157, 157)",a.moveTo(0,0),a.arc(0,0,h,0,c,!1),a.fill(),a.beginPath(),a.moveTo(0+h,0),a.arc(0,0,h,0,c,!1),a.stroke(),a.rotate(F),a.font="bold 12px Verdana, Arial";var r=20*K(i),s=20*L(i),t=Q(180*i/C)+"°";a.textAlign="center",a.textBaseline="middle",a.beginPath();var u=a.measureText("365.°").width;a.fillStyle="white",a.rect(r-u/2,-s-10,u,20),a.fill(),a.beginPath(),a.fillStyle="rgb(79,79,79)",a.fillText(t,r,-s),a.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);