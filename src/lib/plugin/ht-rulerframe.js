!function(a,b,c){"use strict";var d="position",e="absolute",f="relative",g="px",h="left",i="right",j="top",k="bottom",l="display",m="none",n="block",o=ht.Default,p=o.getInternal(),q=Math.floor,r=Math.ceil,s=Math.PI,t=null,u=a.parseInt,v=function(a){return a.getContext("2d")},w=function(){return document},x=function(a){return w().createElement(a)},y=function(){return x("canvas")},z=function(a,b,c){a.style.setProperty(b,c,t)},A=function(a,b,c){o.def(ht.widget[a],b,c)},B=function(a,b){a.appendChild(b)},C=function(a,b){a.removeChild(b)},p=o.getInternal(),D=p.addEventListener,E=p.removeEventListener;ht.widget.RulerFrame=function(a){var b=this,c=b._view=p.createView(null,b),g=b.$1k=y(),h=b.$2k=y(),i=b.$3k=y(),j=b.$4k=y();b._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},b._topRulerConfig={visible:!0},b._rightRulerConfig={visible:!1},b._bottomRulerConfig={visible:!1},b._leftRulerConfig={visible:!0},B(c,g),B(c,i),B(c,h),B(c,j),z(c,d,f),z(c,"box-sizing","border-box"),z(c,"-moz-box-sizing","border-box"),z(g,d,e),z(h,d,e),z(i,d,e),z(j,d,e),b.$14k=function(a){b.$13k=1,b.iv()},b.$15k=function(a){if(b._topRulerConfig.guideVisible||b._rightRulerConfig.guideVisible||b._bottomRulerConfig.guideVisible||b._leftRulerConfig.guideVisible||b._defaultRulerConfig.guideVisible||(b._topRulerConfig.guideTipVisible||b._rightRulerConfig.guideTipVisible||b._bottomRulerConfig.guideTipVisible||b._leftRulerConfig.guideTipVisible||b._defaultRulerConfig.guideTipVisible)&&b._component){var d=c.getBoundingClientRect();b.$16k={x:a.clientX-d.left,y:a.clientY-d.top},b.$5k()}},b.setComponent(a)},A("RulerFrame",b,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(a){var b=this,c=b._component,f=b.getView();if(f){if(b._component=a,b.fp("component",c,a),c){var g=b.getComponentView(c);C(f,g),E(f,"mousemove",b.$15k),b.removeComponentPropertyChangeListener(c,b.$14k)}if(a){var h=b.getComponentView(a);B(f,h),z(h,d,e),D(f,"mousemove",b.$15k),b.addComponentPropertyChangeListener(a,b.$14k)}}},addComponentPropertyChangeListener:function(a,b){a&&a.mp&&a.mp(b)},removeComponentPropertyChangeListener:function(a,b){a&&a.ump&&a.ump(b)},getComponentHZoom:function(a){return a&&a.getZoom?a.getZoom():1},getComponentVZoom:function(a){return a&&a.getZoom?a.getZoom():1},getComponentViewRect:function(a){return a&&a.getViewRect?a.getViewRect():void 0},getComponentView:function(a){return a&&a.getView?a.getView():a},invalidateComponent:function(a){a&&a.iv&&a.iv()},validateComponent:function(a){a&&a.validate&&a.validate()},$7k:function(a,b,c,d,e,f,g,h,i,j,k,o){if(b.visible){var q=this._defaultRulerConfig,r="borderStyle",s="borderColor",u="borderWidth",v="background",w=b[r]||q[r],x=b[s]||q[s],y=b[u]||q[u],A=b.size!=t?b.size:q.size,B=b[v]||q[v],C=A+y,D=this.$6k(y,w,x,a,c,e,C,g,h,i,j,k,o);z(a,e,"0px"),f?p.setCanvas(a,d-D,A):p.setCanvas(a,A,d-D),z(a,"background",B),z(a,l,n)}else z(a,l,m),z(this.getComponentView(this._component),e,"0px")},$6k:function(a,b,c,d,e,f,h,i,j,k,l,m,n){var o=0;return z(d,e,a+"px "+b+" "+c),z(this.getComponentView(this._component),f,h+g),i?(z(d,j,k+g),o+=k):z(d,j,"0px"),l?(z(d,m,n+g),o+=n):z(d,m,"0px"),o},validateImpl:function(){var a=this,b=a._component,c=a.$1k,d=a.$2k,e=a.$3k,f=a.$4k,g=a._view,l=a._defaultRulerConfig,m=a._topRulerConfig,n=a._rightRulerConfig,o=a._bottomRulerConfig,p=a._leftRulerConfig,q=l.size;if(g&&b){var r=m.size!=t?m.size:q,s=n.size!=t?n.size:q,u=o.size!=t?o.size:q,v=p.size!=t?p.size:q;a.$7k(c,m,"border-bottom",g.offsetWidth,j,!0,p.visible,h,v,n.visible,i,s),a.$7k(d,n,"border-left",g.offsetHeight,i,!1,m.visible,j,r,o.visible,k,u),a.$7k(e,o,"border-top",g.offsetWidth,k,!0,p.visible,h,v,n.visible,i,s),a.$7k(f,p,"border-right",g.offsetHeight,h,!1,m.visible,j,r,o.visible,k,u),a.$13k?delete a.$13k:a.invalidateComponent(b),a.validateComponent(b),a.$5k()}},$5k:function(){function a(a,c,d,e,f,g){if(c.visible){var h=v(a),i=c[w]||N,j=c[z]!=t?c[z]:Q,k=c[A]||R,l=c[B]||S,m=c.size!=t?c.size:u,ca=c[C]||T,da=c[M]||U,ea=c[D]||V,fa=c[E]!=t?c[E]:W,ga=c[F]!=t?c[F]:X,ha=c[G]!=t?c[G]:Y,ia=c[H]!=t?c[H]:Z,ja=c[I]!=t?c[I]:$,ka=c[J]!=t?c[J]:_,la=c[K]||aa,ma=c[L]||ba;j&&(i=b[g]=b.$8k(b[g]||i,c[x]||O,c[y]||P,e?n:o,da)),d.call(b,h,p,r,q,s,m,e?n:o,i,k,l,f,ca,ea);var na=b.$16k;(fa||ga)&&na&&(e?b.$9k(h,na.x,m,la,ma,fa,ga,ha,ia,ja,ka):b.$10k(h,na.y,m,la,ma,fa,ga,ha,ia,ja,ka,f))}}var b=this,c=b.$1k,d=b.$2k,e=b.$3k,f=b.$4k,g=b._topRulerConfig,h=b._rightRulerConfig,i=b._bottomRulerConfig,j=b._leftRulerConfig,k=b._defaultRulerConfig,l=b._component,m=b.getComponentViewRect(l),n=b.getComponentHZoom(l),o=b.getComponentVZoom(l),p=m.x*n,q=p+m.width*n,r=m.y*o,s=r+m.height*o,u=b._defaultRulerConfig.size,w="defaultMajorTickSpacing",x="maxPhysicalMajorTickSpacing",y="minPhysicalMajorTickSpacing",z="tickSpacingAdaptable",A="majorTickTextFont",B="majorTickTextColor",C="majorTickColor",D="minorTickColor",E="guideVisible",F="guideTipVisible",G="guideTipBorderColor",H="guideTipTextColor",I="guideTipTextFont",J="guideTipBackground",K="guideColor",L="guideWidth",M="minMajorTickSpacing",N=k[w],O=k[x],P=k[y],Q=k[z],R=k[A],S=k[B],T=k[C],U=k[M],V=k[D],W=k[E],X=k[F],Y=k[G],Z=k[H],$=k[I],_=k[J],aa=k[K],ba=k[L];b._view&&l&&(a(c,g,b.$11k,!0,!1,"_currentTopMajorTickSpacing"),a(d,h,b.$12k,!1,!0,"_currentRightMajorTickSpacing"),a(e,i,b.$11k,!0,!0,"_currentBottomMajorTickSpacing"),a(f,j,b.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(a,b,c,d,e){return c>a*d?a=q(b/d/e)*e:a*d>b&&(a=r(c/d/e)*e),a},getHTipText:function(a){var b=this,c=b._component,d=0,e=b._view.getBoundingClientRect();return c.lp?d=u(c.lp({x:a.x+e.left,y:a.y}).x):d-=u(this.getComponentView(c).style.left)||0,d},$9k:function(a,b,c,d,e,f,g,h,i,j,k){var l=this,m=l._component;a.save(),p.translateAndScale(a,0,0,1);var n=b-(u(this.getComponentView(m).style.left)||0),o=0;if(b=l.getHTipText(l.$16k),f&&(a.beginPath(),a.fillStyle=d,a.rect(n,o,e,c),a.fill()),g){a.beginPath(),a.textAlign="center",a.textBaseline="middle",a.font=j;var q=a.measureText(b).width+6;a.fillStyle=k,a.rect(n-q/2,o,q,c),a.fill(),a.strokeStyle=h,a.stroke(),a.beginPath(),a.fillStyle=i,a.fillText(b,n,o+c/2)}a.restore()},getVTipText:function(a){var b=this,c=b._component,d=0,e=b._view.getBoundingClientRect();return c.lp?d=u(c.lp({x:a.x,y:a.y+e.top}).y):d-=u(this.getComponentView(c).style.top)||0,d},formatScaleText:function(a){return Math.round(a)},$10k:function(a,b,c,d,e,f,g,h,i,j,k,l){var m=this,n=m._component;a.save(),p.translateAndScale(a,0,0,1);var o=c/2,q=b-(u(this.getComponentView(n).style.top)||0);if(b=m.getVTipText(m.$16k),f&&(a.beginPath(),a.fillStyle=d,a.rect(o-c/2,q,c,e),a.fill()),g){a.translate(o,q),a.rotate((l?90:-90)*s/180),a.translate(-o,-q),a.beginPath(),a.textAlign="center",a.textBaseline="middle",a.font=j;var r=a.measureText(b).width+6;a.fillStyle=k,a.rect(o-r/2,q-c/2,r,c),a.fill(),a.strokeStyle=h,a.stroke(),a.fillStyle=i,a.fillText(b,o,q)}a.restore()},$11k:function(a,b,c,d,e,f,g,h,i,j,k,l,m){a.save(),c=0;var n=b,o=d,r=(n+o)/2;b=0,d=o-n,p.translateAndScale(a,0,0,1);var s=0,t=0,v=u(f/2),w=f-v,x=k?0:v,y=h*g,z=y/10;b-=y,d+=y,a.clearRect(b,0,d-b,f),a.beginPath(),a.fillStyle=m;var A=q(r/z)*z-n;for(s=A;d>s;s+=z)a.rect(s,c+x,1,w);for(s=A;s>b;s-=z)a.rect(s,c+x,1,w);for(a.fill(),x=k?0:1,a.beginPath(),a.fillStyle=l,A=q(r/y)*y-n,s=A;d>s;s+=y)a.rect(s,c+x,1,f-1);for(s=A;s>b;s-=y)a.rect(s,c+x,1,f-1);a.fill();var B=u(/\d+px/.exec(i)[0]),C=(B||10)/2;a.textBaseline="middle",x=k?f-C-2:C+2,a.beginPath(),a.fillStyle=j,a.font=i;var D=q(r/y)*y/g;for(s=A,t=D;d>s;s+=y,t+=h){var E=this.getHScaleText?this.getHScaleText(s):t;a.fillText(this.formatScaleText(E),s+2,c+x)}for(s=A,t=D;s>b;s-=y,t-=h){var E=this.getHScaleText?this.getHScaleText(s):t;a.fillText(this.formatScaleText(E),s+2,c+x)}a.restore()},$12k:function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(b,c,d,e,f,g){f=w.getVScaleText?w.getVScaleText(d):f,f=w.formatScaleText(f),a.translate(b+c,d),a.rotate(-e),a.translate(-b-c,-d),a.fillText(f,b+c+(g?2:1),d),a.translate(b+c,d),a.rotate(e),a.translate(-b-c,-d)}a.save(),b=0;var o=c,r=e,t=(o+r)/2;c=0,e=r-o,p.translateAndScale(a,0,0,1);var v=0,w=this,x=0,y=u(f/2),z=f-y,A=k?0:y,B=h*g,C=B/10;c-=B,e+=B,a.clearRect(b,0,f,e-c),a.beginPath(),a.fillStyle=m;var D=q(t/C)*C-o;for(v=D;e>v;v+=C)a.rect(b+A,v,z,1);for(v=D;v>c;v-=C)a.rect(b+A,v,z,1);for(a.fill(),A=k?0:1,a.beginPath(),a.fillStyle=l,D=q(t/B)*B-o,v=D;e>v;v+=B)a.rect(b+A,v,f-1,1);for(v=D;v>c;v-=B)a.rect(b+A,v,f-1,1);a.fill();var E=u(/\d+px/.exec(i)[0]),F=(E||10)/2,G=90*s/180;a.textBaseline="middle",A=k?f-F:F+2,G=k?-G:G,a.beginPath(),a.fillStyle=j,a.font=i;var H=q(t/B)*B/g;for(v=D,x=H;e>v;v+=B,x+=h)n(b,A,v,G,x,k);for(v=D,x=H;v>c;v-=B,x-=h)n(b,A,v,G,x,k);a.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var a=this,b=a._component,c=a._view;b&&a.removeComponentPropertyChangeListener(b,a.$14k),c&&(E(c,"mousemove",a.$15k),C(c.parentNode,c),a._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);