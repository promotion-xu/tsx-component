!function(a,b,c){"use strict";function d(){this.el=[1,0,0,0,1,0,0,0,1]}function e(a){var b={};return{get:function(d){if(b[d]!==c)return b[d];var e;switch(d){case"WEBGL_depth_texture":e=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":e=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":e=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":e=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":e=a.getExtension("WEBGL_compressed_texture_etc1");break;default:e=a.getExtension(d)}return b[d]=e,e}}}function f(a,b,d){function e(){if(g!==c)return g;var d=b.get("EXT_texture_filter_anisotropic");return g=null!==d?a.getParameter(d.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function f(b){if("highp"===b){if(a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.HIGH_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.HIGH_FLOAT).precision>0)return"highp";b="mediump"}return"mediump"===b&&a.getShaderPrecisionFormat(a.VERTEX_SHADER,a.MEDIUM_FLOAT).precision>0&&a.getShaderPrecisionFormat(a.FRAGMENT_SHADER,a.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var g;d=d||{};var h="undefined"!=typeof WebGL2RenderingContext&&a instanceof WebGL2RenderingContext,i=d.precision!==c?d.precision:"highp",j=f(i);j!==i&&(console.warn("WebGL:",i,"not supported, using",j,"instead."),i=j);var k=d.logarithmicDepthBuffer===!0,l=a.getParameter(a.MAX_TEXTURE_IMAGE_UNITS),m=a.getParameter(a.MAX_VERTEX_TEXTURE_IMAGE_UNITS),n=a.getParameter(a.MAX_TEXTURE_SIZE),o=a.getParameter(a.MAX_CUBE_MAP_TEXTURE_SIZE),p=a.getParameter(a.MAX_VERTEX_ATTRIBS),q=a.getParameter(a.MAX_VERTEX_UNIFORM_VECTORS),r=a.getParameter(a.MAX_VARYING_VECTORS),s=a.getParameter(a.MAX_FRAGMENT_UNIFORM_VECTORS),t=m>0,u=h||!!b.get("OES_texture_float"),v=t&&u,w=h?a.getParameter(a.MAX_SAMPLES):0;return{getMaxAnisotropy:e,getMaxPrecision:f,precision:i,logarithmicDepthBuffer:k,maxTextures:l,maxVertexTextures:m,maxTextureSize:n,maxCubemapSize:o,maxAttributes:p,maxVertexUniforms:q,maxVaryings:r,maxFragmentUniforms:s,vertexTextures:t,floatFragmentTextures:u,floatVertexTextures:v,maxSamples:w}}var g="ht";if(!a[g]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),a.performance&&a.performance.now||!function(){var b=Date.now();a.performance||(a.performance={}),a.performance.now=function(){return Date.now()-b}}();for(var d=Date.now(),e=16,f=["ms","moz","webkit","o"],g=0;g<f.length&&!a.requestAnimationFrame;++g)a.requestAnimationFrame=a[f[g]+"RequestAnimationFrame"],a.cancelAnimationFrame=a[f[g]+"CancelAnimationFrame"]||a[f[g]+"CancelRequestAnimationFrame"];a.requestAnimationFrame||(a.requestAnimationFrame=function(b){var c=Date.now(),f=e+d-c;return 0>f&&(f=0),d=c,a.setTimeout(function(){d=Date.now(),b(performance.now())},f)}),a.cancelAnimationFrame||(a.cancelAnimationFrame=function(b){return a.clearTimeout(b)}),b.assign===c&&(b.assign=function(a){if(a===c||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var d=b(a),e=1;e<arguments.length;e++){var f=arguments[e];if(f!==c&&null!==f)for(var g in f)b.prototype.hasOwnProperty.call(f,g)&&(d[g]=f[g])}return d})}();var h=a.document,i=null,j=a[g]={},k=a[g+"config"],l=j.Default=k&&k.Default||{},m=j.Style=k&&k.Style||{},n=j.Attr=k&&k.Attr||{},o=j.Color=k&&k.Color||{},p=j.IsGetter=k&&k.IsGetter||{};!function(){var c=!1;try{var d=b.defineProperty({},"passive",{get:function(){c=!0}});a.addEventListener("test",d,d),a.removeEventListener("test",d,d)}catch(e){c=!1}l.passiveSupported=c}();var q,r,s,t,u=l.passiveSupported,v=l.eventListenerOptionsFalse=u?{passive:!1,capture:!1}:!1,w=l.eventListenerOptionsTrue=u?{passive:!1,capture:!0}:!0,x=function(a,b,c,d){a.addEventListener(b,c,d?w:v)},y=function(a,b,c,d){a.removeEventListener(b,c,d?w:v)},z=Math,A=z.round,B=z.floor,C=z.ceil,D=z.sqrt,E=z.max,F=z.min,G=z.abs,H=z.cos,I=z.acos,J=z.sin,K=z.pow,L=z.asin,M=z.PI,N=2*M,O=M/2,P=z.tan,Q=z.atan2,R=z.random,S=z.log,T=!1,U=!1,V=a.parseInt||global.parseInt,W="2019-12-25",X=a.navigator?a.navigator.platform.indexOf("Win")>-1:!1,Y=function(a){return a*a},Z=a.setTimeout,$=a.clearTimeout,_=a.location,aa=a.navigator?a.navigator.userAgent.toLowerCase():"",ba=function(a){return a.test(aa)},ca=ba(/msie/),da=ba(/msie/)||ba(/trident/),ea=ba(/msie 10/),fa=ba(/edge/),ga=ba(/firefox/),ha=ba(/mac/),ia=l.isTouchable===c?X?!1:h?"ontouchend"in h:!1:l.isTouchable,ja="default",ka="single",la="multiple",ma="front",na="back",oa="left",pa="right",qa="top",ra="bottom",sa="center",ta="eye",ua="middle",va="east",wa="west",xa="north",ya="none",za="px",Aa="absolute",Ba="border",Ca="triangle",Da="rect",Ea="circle",Fa="cylinder",Ga="shape",Ha="items",Ia="normal",Ja="remove",Ka="clear",La="width",Ma="height",Na="ingroup",Oa="check",Pa="uncheck",Qa="radio",Ra="radioOn",Sa="radioOff",Ta="points",Ua="values",Va="series",Wa="body",Xa="label",Ya="label2",Za="note",$a="note2",_a="icons",ab="labelFont",bb="labelColor",cb="labelSelectColor",db="note.expanded",eb="note2.expanded",fb="edge.expanded",gb="edge.points",hb="edge.type",ib="rotation",jb="hidden",kb="visible",lb="tuv",mb="no",nb="draw",ob="select",pb="currentSubGraph",qb="selectBackground",rb="autoMakeVisible",sb="autoHideScrollBar",tb="scrollBarColor",ub="scrollBarSize",vb="indent",wb="rowHeight",xb="columnLineColor",yb="rowLineColor",zb="columnLineVisible",Ab="rowLineVisible",Bb="visibleFunc",Cb="expandIcon",Db="collapseIcon",Eb="checkMode",Fb="sortFunc",Gb="editable",Hb="batchEditable",Ib="tristate",Jb="asc",Kb="desc",Lb="position",Mb="elevation",Nb="children",Ob="translateX",Pb="translateY",Qb="dataModel",Rb="maxSize",Sb="state",Tb="shape3d",Ub="shape3d.resolution",Vb="shape3d.visible",Wb="shape3d.from.visible",Xb="shape3d.to.visible",Yb="shape3d.top.visible",Zb="shape3d.bottom.visible",$b="repeat.uv.length",_b="serializeValue",ac="deserializeValue",bc="centerUniform",cc="uniform",dc="rgba(255,255,255,0)",ec="style",fc="attr",gc="field",hc="string",ic="boolean",jc="color",kc="int",lc="number",mc="ew-resize",nc="ns-resize",oc="pointer",pc="auto",qc="mousedown",rc="mousemove",sc="mouseup",tc="mouseout",uc="touchstart",vc="touchmove",wc="touchend",xc="keydown",yc="keyup",zc=["DOMMouseScroll","mousewheel"],Ac=ga?zc[0]:zc[1],Bc=ia?[uc,vc,wc,xc,yc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[xc,yc,"keypress","input",qc,rc,sc,tc,Ac,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],Cc=i,Dc=i,Ec=i,Fc=sc.length,Gc=function(){Ec&&($(Ec.timeout),Ec=i)},Hc=function(){Ec&&_g(Ec.e,Ec.info)};a.addEventListener&&(ia||(x(a,tc,function(){Gc()}),x(a,Ac,function(){ah()})),x(a,yc,function(a){91===a.keyCode?Vc={}:delete Vc[a.keyCode]},!0),x(a,xc,function(a){Vc[a.keyCode]=!0},!0),x(a,"blur",function(a){Vc={}}));var Ic,Jc,Kc,Lc=0,Mc=i,Nc=function(a,b){var c=Z(function(){delete Mc[c],Xd(Mc)&&(Mc=i),a()},b);return c},Oc=i,Pc=i,Qc={},Rc={},Sc={},Tc={},Uc={},Vc={},Wc={},Xc={},Yc={},Zc={},$c=/.json$/,_c=/^data:image\/svg\+xml/,ad={},bd=[],cd={},dd=i,ed=i,fd=function(){},gd=function(){throw"Oops!"},hd=[0,0,0],id={x:0,y:0,width:0,height:0},jd=i,kd=i,ld=i,md=function(a,b){Rc[a]=b,b&&b.comps&&!b.uuid&&(b.uuid=j.Math.generateUUID()),Nj[a]&&(b.cacheRule=Nj[a],delete Nj[a])},nd=function(a){kd&&!a._72O&&(ld||(ld={}),ld[a._72O=Ch()]=a),Ic!=i?ae()<.05&&t&&!Jc&&(Ee=Gc):Ee=Ed},od=function(a,b,c,d){kd||(kd={});var e=kd[a];if(e){if(e.url===b)return;e.image?(e.image.onload=fd,e.image.onerror=fd):e.request&&(e.request.onload=fd,e.request.onerror=fd)}if($c.test(b)){var f=new il;if(kd[a]={request:f,url:b},b=l.beforeLoadURL(b),b.data){var g=l.parse(b.data);pd(a,g),l.handleImageLoaded(a,g)}else{f.onload=function(c){if(200===this.status||0===this.status){var d=l.parse(f.getResponseText());pd(a,d),l.handleImageLoaded(a,d)}else pd(a,l.handleUnfoundImage(a,b)||i)},f.onerror=function(c){pd(a,l.handleUnfoundImage(a,b)||i)};var j={};j.url=encodeURI(b),j.sync=!1,f.send(j)}}else{var g=new Image;kd[a]={image:g,url:b},/^data:image/.test(b)||(b=l.beforeLoadURL(b),b=l.appendTimeStamp(b),b=encodeURI(b),g.crossOrigin=l.crossOrigin),l.convertImageSrc(b,function(e){da&&(b.toLowerCase().indexOf(".svg")>0||_c.test(b))?(h.body.appendChild(g),g.style.visibility="hidden",g.onload=function(){Z(function(){if(c&&(g.width=c),d&&(g.height=d),!g.width||!g.height){var b=g.width||g.clientWidth,e=g.height||g.clientHeight;g.width=b,g.height=e}l.handleImageLoaded(a,g),pd(a,g),h.body.removeChild(g),g.style.visibility=""},180)},g.onerror=function(){pd(a,l.handleUnfoundImage(a,b)||i),h.body.removeChild(g),g.style.visibility=""}):(g.onload=function(){c&&(g.width=c),d&&(g.height=d),l.handleImageLoaded(a,g),pd(a,g)},g.onerror=function(){pd(a,l.handleUnfoundImage(a,b)||i)}),g.src=e})}},pd=function(a,b){if(md(a,b),delete kd[a],Xd(kd)&&(kd=i,ld)){for(var d in ld){var e=ld[d];e._2O&&e._2O[a]&&(e.deleteTexture(a),delete e._2O[a]),e.invalidateAll&&e.invalidateAll(c,"imageLoaded",a),e.redraw&&e.redraw(),e.iv(),delete e._72O}ld=i}if(b&&ld)for(var d in ld){var e=ld[d];e.invalidateAll&&e.invalidateAll(c,"imageLoading",a),e.redraw&&e.redraw(),e.iv()}},qd=function(){return S=z&&Date,function(){return a.performance&&a.performance.now?a.performance.now():Date.now()}}(),rd=function(a,b,c){return{width:a,height:b,comps:Hd(c)?c:[c]}},sd=function(a,b){return{type:Ea,rect:[a,b,1.6,1.6],borderWidth:1,borderColor:pg,gradient:$g,gradientColor:qg,background:pg}},td=function(a,b){return rd(16,16,{type:Ca,rect:[4,4,10,8],background:a,rotation:b?1.57:3.14})},ud=function(a,b){return rd(16,16,{type:Ca,rect:[4,4,8,7],background:a,rotation:b?3.14:0})},vd=function(a){var b=a._orientation;return"horizontal"===b||"h"===b},wd=function(a,b){var c=i||4,d=i||1,e=i||1;0>c?c=0:c>.25&&(c=.25);var f,g,h,j,k,l,m,n=.5,o=[],p=[],q=[],s=N/e,t=N/d,u=n-c;for(g=0;d>=g;g++)for(j=-M+g*t,l=H(j),k=J(j),f=0;e>=f;f++)h=f*s,m=u+c*l,o.push(H(h)*m,k*c,-J(h)*m),(r=[a,b])&&p.push(f/e,1-g/d);for(g=0;d>g;g++){var v=g*(e+1),w=(g+1)*(e+1);for(f=0;e>f;f++)q.push(v+f,w+f+1,w+f,v+f,v+f+1,w+f+1),ie.z=yf.z=[a,b]}},xd=function(a){var b=2,c=0;for(var d in a)d.length===b&&V(d,32)===Ze&&(dd=ed=a[d]),c++;return c},yd=function(a,b,c,d){return c||(c=ia?5:3,c/=d||1),{x:a-c,y:b-c,width:2*c,height:2*c}},zd=function(b,c,d,e){var f=this;c||(c=ia?5:3,d=20,e=20);var g={x:b,y:c,width:d,height:e};if(d)for(var h=0;d>h;h++)if(3===d)e=20;else for(var i=0;e>i;i++)f=a?a:d;var j={x:M,y:2*M};if(Yh(g,j)){var k=Ma[0]+qa[0]+Ka[1]+Jb.length,l=jb[0]+Ib[0]+Ka[1]+Wa.length;tf[ta]=[f[k],f[l]],f[k]=Bd[ta],f[l]=Bd[Tb]}},Ad=function(a){return(/ble$/.test(a)||/ed$/.test(a)||p[a]?"is":"get")+a.charAt(0).toUpperCase()+a.slice(1)},Bd=function(a){return"set"+a.charAt(0).toUpperCase()+a.slice(1)},Cd=function(a){return typeof a===hc||a instanceof String},Dd=function(a){return typeof a===lc},Ed=function(a){return typeof a===ic},Fd=function(a){return a&&"object"==typeof a},Gd=function(a){return"function"==typeof a},Hd=function(a){return a instanceof Array},Id=function(a){return a instanceof bj},Jd=function(a){return Hd(a)?new bj(a):a},Kd=function(a){return a instanceof Sk},Ld=function(a){return a instanceof Yk},Md=function(a){return a instanceof Zk},Nd=function(a,b){if(!(a instanceof j.Group))return!1;if(!b)return a.isExpanded();var c=b.getDataUI(a);return c&&c._88I?!0:!1},Od=function(a){return a instanceof $k},Pd=function(a){return a&&"IFRAME"===a.tagName},Qd=function(a){return a==i||l.numberDigits==i?a:parseFloat(a.toFixed(l.numberDigits))},Rd=function(a,b,c){var d,e=b.length;if(c)for(var f=0;c>f;f++)if(3===e)a.push(b[0]),a.push(b[1]),a.push(b[2]);else for(d=0;e>d;d++)a.push(b[d]);else if(3===e)a.push(b[0]),a.push(b[1]),a.push(b[2]);else for(d=0;e>d;d++)a.push(b[d])},Sd=function(a){return a?Fd(a)?a:{}:!1},Td=function(a,b,d){var e,f=Fd(a)?a:a.prototype;for(e in b)d&&e in f?f[e]===c&&console.warn("class",f,"has own undefined property",e,", keep exist!"):f[e]=b[e];return a},Ud=function(a){return String.fromCharCode(a)},Vd=function(a){for(var b,c=0,d="";c<a.length;c++)b=a[a.length-1-c],"%"===b?b="'":"a"===b?b='"':"]"===b&&(b="\\"),d+=Ud(b.charCodeAt(0)-1);return d},Wd=function(a,b,c){a.superClass.constructor.apply(b,c)},Xd=function(a){for(var b in a)return!1;return!0},Yd=function(a){return a?0===a.length:!0},Zd=function(){var a="";return[Pa[0],yb[0],Xa[0]].forEach(function(b){a+=Bd(b).slice(3)}),cc=h&&h[a]||bc,function(a,b){return a===b?!0:a.x===b.x&&a.y===b.y&&a.width===b.width&&a.height===b.height}}(),$d=function(a,b,c){return b>a?b:a>c?c:a},_d=function(a){return 0>a?-1:a>0?1:0},ae=function(){var a=1e4*J(Fc++);return a-B(a)},be=function(a,b,c){return ce(a.x,a.y,b.x,b.y,c.x,c.y,c.x+c.width,c.y,!0)||ce(a.x,a.y,b.x,b.y,c.x+c.width,c.y,c.x+c.width,c.y+c.height,!0)||ce(a.x,a.y,b.x,b.y,c.x+c.width,c.y+c.height,c.x,c.y+c.height,!0)||ce(a.x,a.y,b.x,b.y,c.x,c.y+c.height,c.x,c.y,!0)},ce=function(a,b,c,d,e,f,g,h,j){var k=(g-e)*(b-f)-(h-f)*(a-e),l=(h-f)*(c-a)-(g-e)*(d-b);if(0!==l){var m=k/l,n=a+m*(c-a),o=b+m*(d-b);return j&&(n+ni<F(a,c)||n-ni>E(a,c)||n+ni<F(e,g)||n-ni>E(e,g)||o+ni<F(b,d)||o-ni>E(b,d)||o+ni<F(f,h)||o-ni>E(f,h))?i:[n,o]}return i},de=function(a,b,d){if(a&&d)if(b){if(b===ec)return a.getStyle(d);if(b===fc)return a.getAttr(d);if(b===gc)return a[d]}else if(d=Ad(d),a[d])return a[d]();return c},ee=function(a,b,c,d){if(a&&c)if(b){if(b===ec)a.s(c,d);else if(b===fc)a.a(c,d);else if(b===gc){var e=a[c];a[c]=d,a.fp("f:"+c,e,d)}}else c=Bd(c),a[c]&&a[c](d)},fe=function(a,b,c){return b&&"top"!==b?"bottom"===b?{x:a.x,y:a.y,width:a.width,height:a.height*c}:"right"===b?{x:a.x,y:a.y,width:a.width*c,height:a.height}:"left"===b?{x:a.x+a.width*(1-c),y:a.y,width:a.width*c,height:a.height}:void 0:{x:a.x,y:a.y+a.height*(1-c),width:a.width,height:a.height*c}},ge=function(a,b,c,d,e){b&&Df(a,c,d,1,e,b)},he=function(a,b,c,d){var e=1-a;return e*e*b+2*a*e*c+a*a*d},ie=function(a,b,c,d,e){var f=1-a;return f*f*f*b+3*f*f*a*c+3*f*a*a*d+a*a*a*e},je=function(a){var b,c,d,e,f=0;return a.forEach(function(a){if(b=a.length,b>0)for(c=a[0],e=1;b>e;e++)d=a[e],f+=Vh(c,d),c=d}),f},ke=function(a,b,c){var d="__"+a,e=function(b){c.disabled||c["handle_"+a](b)};c[d]||(c[d]=e,x(b,a,e))},le=function(a,b,c){var d="__"+a,e=c[d];e&&(y(b,a,e),delete c[d])},me=function(a,b){var c="_"+b;a[Ad(b)]=function(){return this[c]},a[Bd(b)]=function(a){var d=this[c];this[c]=a,this.fp(b,d,a)}},ne=function(a){return b.create(a)},oe=function(a){if(!a.element){var b,c;(b=a.textField)?c=vh(yq.TextField,b):(b=a.textArea)?c=vh(yq.TextArea,b):(b=a.button)?c=vh(yq.Button,b):(b=a.comboBox)?c=vh(yq.ComboBox,b):(b=a.checkBox)?c=vh(yq.CheckBox,b):(b=a.radioButton)?c=vh(yq.RadioButton,b):(b=a.slider)?c=vh(yq.Slider,b):(b=a.colorPicker)?c=vh(yq.ColorPicker,b):(b=a.image)&&(c=vh(yq.Image,b)),c&&(a.element=c)}},pe=function(a,b){var c=qe(a);return c._ht=b,c},qe=function(a,b){var c=h.createElement("div"),d=c.style;return c.tabIndex=-1,c.onkeydown=wh,d.msTouchAction=ya,se(c,i,0),ia&&d.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",i),a&&(d.overflow=jb),b&&ve(b,c),c},re=function(a,b){var c=h.createElement("canvas"),d=c.style;return d.msTouchAction=ya,b||(d.pointerEvents=ya),se(c,i,0),a&&ve(a,c),c},se=function(a,b,c){var d=a.style;d.border=b?b+" solid 1px":0,d.outline=0,d.padding=c?"0 "+c+za:0,te(a)},te=function(a){var b=a.style;b.position=Aa,b.margin=0,b.setProperty("box-sizing","border-box",i),b.setProperty("-moz-box-sizing","border-box",i)},ue=function(a,b,c,d){d||(d=Xg),b!=i&&(a.width=b*d,a.style.width=b+za),c!=i&&(a.height=c*d,a.style.height=c+za)},ve=function(a,b,c){a.appendChild(b),c&&(b.style.position=Aa)},we=function(a,b){b.split||(b+="");for(var c,d=b.split("\n"),e=0,f=d.length,g=0;f>g;g++){var h=Mh(a.font,d[g]);h.width>e&&(e=h.width),c||(c=h.height)}return a.ss=d,{width:e,height:c*f}},xe=function(a,b,c,d,e,f){var g=b.length;if(1===g)ye(a,b[0],c,d,e);else for(var h=c.height/g,i={x:c.x,y:c.y,width:c.width,height:h},j=0;j<b.length;j++)f?Lh(a,b[j],d,e,i.x,i.y,i.width,i.height,f):ye(a,b[j],i,d,e),i.y+=h},ye=function(a,b,d,e,f){a.font=e?e:gh,a.fillStyle=f?f:eh,a.textAlign=sa,a.textBaseline=ua;var g,h;d?d.width===c?(g=d.x,h=d.y):(g=d.x+d.width/2,h=d.y+d.height/2):(g=0,h=0),a.fillText(b,A(g),A(h))},ze=function(a){a.getView&&(a=a.getView());var b=a.offsetWidth||a.scrollWidth;return!b&&a.style.width&&(b=V(a.style.width)),b},Ae=function(a){a.getView&&(a=a.getView());var b=a.offsetHeight||a.scrollHeight;return!b&&a.style.height&&(b=V(a.style.height)),b},Be=function(a,b,c){var d=b[0].toUpperCase()+b.substring(1,b.length);a["webkit"+d]=c,a["moz"+d]=c,a["ms"+d]=c,a["o"+d]=c,a[b]=c},Ce=function(){var a=function(a){wh(a),a.stopPropagation()},b=function(a){wh(a)},c=ia?[uc]:[xc,qc];return function(d,e){var f=qe(),g=f.style;return g.backgroundColor=l.disabledBackground,d&&(g.backgroundImage="url("+d+")",g.backgroundPosition="50% 50%",g.backgroundRepeat="no-repeat no-repeat"),e===!1?c.forEach(function(a){x(f,a,b)}):c.forEach(function(b){x(f,b,a)}),f}}(),De=function(a){var b=a.getContext("2d");return b.save(),b.lineCap=ch,b.lineJoin=dh,b},Ee=function(a,b,c,d){Fe(a,b*Xg,c*Xg),d*=Xg,1!==d&&a.scale(d,d)},Fe=function(a,b,c){a.translate(b,c)},Ge=function(a,b){b&&a.rotate(b)},He=function(a,b,d){b===c&&(b=1),d===c&&(d=1),(1!==b||1!==d)&&a.scale(b,d)},Ie=!1,Je=function(b){var c=h.activeElement;if(h.activeElement!==b){c&&c.forceOnblur&&c.forceOnblur();for(var d=[],e=b.parentNode;e;)d.push([e,e.scrollLeft,e.scrollTop]),e=e.parentNode;if(!Ie){var f=[],g=[];try{for(var i=a.parent,j=a;i!==j;)f.push([i,i.scrollX,i.scrollY]),j=i,i=a.parent;var k=a.frameElement;if(k)for(var l=k.parentNode;l;)g.push([l,l.scrollLeft,l.scrollTop]),l=l.parentNode}catch(m){Ie=!0}}if(ia)b.focus();else{var n=ai(),o=n.target;b.focus(),o.scrollLeft=n.left,o.scrollTop=n.top}d.forEach(function(a){a[0].scrollLeft=a[1],a[0].scrollTop=a[2]}),Ie||(f.forEach(function(a){a[0].scrollTo(a[1],a[2])}),g.forEach(function(a){a[0].scrollLeft=a[1],a[0].scrollTop=a[2]}))}},Ke=function(a){return a&&a.getView?a.getView():a},Le=function(a,b,d,e,f){if(2===arguments.length&&(d=b.y,e=b.width,f=b.height,b=b.x),a.isSelfViewEvent)a.setX(b),a.setY(d),a.setWidth(e),a.setHeight(f);else{var g=Ke(a),i=g.style;if((h.fullscreenElement||h.mozFullScreenElement||h.webkitFullscreenElement||h.msFullscreenElement)!==g)b!==c&&(i.left=b+za),d!==c&&(i.top=d+za),e!==c&&(i.width=e+za),f!==c&&(i.height=f+za);else{var j=l.getWindowInfo();i.left=(b=j.left)+za,i.top=(d=j.top)+za,i.width=(e=j.width)+za,i.height=(f=j.height)+za}a.endEditing&&!ia&&a.endEditing(),a.redraw&&a.redraw(),a.invalidate&&a.invalidate(),a.onLayouted&&a.onLayouted(b,d,e,f),a.fireViewEvent&&a.fireViewEvent("layout")}},Me=function(a){if(!a.touches)return a;var b=a.touches[0];return b?b:a.changedTouches[0]},Ne=function(a){return ia?Me(a).target:a.target},Oe=function(a){l.popup&&l.popup.close(),l.popup=a},Pe=i,Qe=function(a){Pe.handleWindowTouchMove(a)},Re=function(b){Pe.handleWindowTouchEnd(b),y(a,vc,Qe),y(a,wc,Re),Pe=i},Se=function(a){Pe.handleWindowMouseMove(a)},Te=function(b){Pe.handleWindowMouseUp(b),y(a,rc,Se),y(a,sc,Te),Pe=i},Ue=function(a){return 1===Ph(a)},Ve=function(a,b){return b?b.keyCode===a:Vc[a]},We=function(a){return Sh(a)&&Ve(65,a)},Xe=function(a){return Ve(46,a)||Ve(8,a)},Ye=function(a){return function(b){return b?b.keyCode===a:Vc[a]}},Ze=573,$e=[65,83,68,87,37,38,39,40,32,13,27],_e=Ye($e[0]),af=Ye($e[1]),bf=Ye($e[2]),cf=Ye($e[3]),df=Ye($e[4]),ef=Ye($e[5]),ff=Ye($e[6]),gf=Ye($e[7]),hf=Ye($e[8]),jf=Ye($e[9]),kf=Ye($e[10]),lf={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},mf=[2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,5,1217],nf=i,of=i,pf=function(a,b){nf||(nf=re()),ue(nf,a,b,1);var c=De(nf);return c.clearRect(0,0,a,b),c},qf=function(){var b,c={};for(var d in a){var e=la.length;if(d.length==e&&d[0]===la[2]&&d[1]===ya[1]&&d[4]===la[3]&&d[5]===la[4]&&d.substr(e-2)===ya[1]+ya[2]){var f=a[d];for(var g in f)g.length===e&&g.substr(0,3)===pa[3]+Ja[3]+ob[0]&&g.substr(e-2)===la[0]+Za[3]&&(zc=f[g])}}return function(a){var d,e=c[a];return e||(b||(b=re(),ue(b,1,1,1)),d=b.getContext("2d"),d.clearRect(0,0,1,1),Df(d,0,0,1,1,a),e=d.getImageData(0,0,1,1).data,e=c[a]=[e[0],e[1],e[2],e[3]]),e}}(),rf=function(a){if(!Cd(a))return a;var b=qf(a);return b.CA||(b.CA=[b[0]/255,b[1]/255,b[2]/255,b[3]/255]),b.CA},sf=function(a,b,c,d,e){var f=re();f.width=c,f.height=d;var g=f.getContext("2d");g.drawImage(a,0,0,c,d);try{for(var h=g.getImageData(0,0,c,d),i=h.data,j=0,k=i.length;k>j;j+=4){var l=i[j+0],m=i[j+1],n=i[j+2],o=i[j+3];"override_a"===e?i[j+3]=255*b[3]:"override_rgb"===e?(i[j+0]=255*b[0],i[j+1]=255*b[1],i[j+2]=255*b[2]):"override"===e?(i[j+0]=255*b[0],i[j+1]=255*b[1],i[j+2]=255*b[2],i[j+3]=255*b[3]):(i[j+0]=b[0]*l,i[j+1]=b[1]*m,i[j+2]=b[2]*n,i[j+3]=b[3]*o)}g.putImageData(h,0,0)}catch(p){return a}return f},tf=function(a,b,c){return b&&(b="miter"===c?8*b+20:b+1,a&&bi(a,b)),b},uf=function(a,b){if(b){var c=new Hg(b),d=a.width/2,e=a.height/2,f=Wh([c.tf(-d,-e),c.tf(d,-e),c.tf(d,e),c.tf(-d,e)]);return f.x+=a.x+d,f.y+=a.y+e,f}return a},vf=function(a,b,c,d,e,f,g,h){d*=Math.PI/180;var i={x:Math.cos(d)*(a.x-g.x)/2+Math.sin(d)*(a.y-g.y)/2,y:-Math.sin(d)*(a.x-g.x)/2+Math.cos(d)*(a.y-g.y)/2},j=Math.pow(i.x,2)/Math.pow(b,2)+Math.pow(i.y,2)/Math.pow(c,2);j>1&&(b*=Math.sqrt(j),c*=Math.sqrt(j));var k=(e==f?-1:1)*Math.sqrt((Math.pow(b,2)*Math.pow(c,2)-Math.pow(b,2)*Math.pow(i.y,2)-Math.pow(c,2)*Math.pow(i.x,2))/(Math.pow(b,2)*Math.pow(i.y,2)+Math.pow(c,2)*Math.pow(i.x,2)));isNaN(k)&&(k=0);var l={x:k*b*i.y/c,y:k*-c*i.x/b},m={x:(a.x+g.x)/2+Math.cos(d)*l.x-Math.sin(d)*l.y,y:(a.y+g.y)/2+Math.sin(d)*l.x+Math.cos(d)*l.y},n=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},o=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(n(a)*n(b))},p=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(o(a,b))},q=p([1,0],[(i.x-l.x)/b,(i.y-l.y)/c]),r=[(i.x-l.x)/b,(i.y-l.y)/c],s=[(-i.x-l.x)/b,(-i.y-l.y)/c],t=p(r,s);o(r,s)<=-1&&(t=Math.PI),o(r,s)>=1&&(t=0);var o=b>c?b:c,u=b>c?1:b/c,v=b>c?c/b:1;if(null==h){var w={x:0,y:0,width:0,height:0};bi(w,o),w.x*=u,w.width*=u,w.y*=v,w.height*=v;var x=new Hg(d);return w=Wh([x.tf(w.x,w.y),x.tf(w.x+w.width,w.y),x.tf(w.x+w.width,w.y+w.height),x.tf(w.x,w.y+w.height)]),w.x+=m.x,w.y+=m.y,[{x:w.x,y:w.y},{x:w.x+w.width,y:w.y},{x:w.x+w.width,y:w.y+w.height},{x:w.x,y:w.y+w.height}]}h.translate(m.x,m.y),h.rotate(d),h.scale(u,v),h.arc(0,0,o,q,q+t,1-f),h.scale(1/u,1/v),h.rotate(-d),h.translate(-m.x,-m.y)},wf=function(a,b){a&&a.beginPath();for(var c,d,e,f=[],g=function(a){for(var b,c=/(\-{0,1}[\d\.]+)/gi,d=[];b=c.exec(a);)d.push(parseFloat(b[0]));return d},h=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,i={x:0,y:0};c=h.exec(b);){var j=c[0],k=j.substr(0,1);if("M"===k||"m"===k){for(var l=g(j),m=0;m<l.length;m+=2){var n=l[m],o=l[m+1];"m"===k&&(n+=i.x,o+=i.y),a&&a.moveTo(n,o),f.push({x:n,y:o}),i.x=n,i.y=o}d=e=null}else if("H"===k||"h"===k){for(var l=g(j),m=0;m<l.length;m+=1){var n=l[m];"h"===k&&(n+=i.x),a&&a.lineTo(n,i.y),f.push({x:n,y:i.y}),i.x=n}d=e=null}else if("C"===k||"c"===k){for(var l=g(j),m=0;m<l.length;m+=6){var p=l[m],q=l[m+1],r=l[m+2],s=l[m+3],n=l[m+4],o=l[m+5];"c"===k&&(p+=i.x,q+=i.y,r+=i.x,s+=i.y,n+=i.x,o+=i.y),a&&a.bezierCurveTo(p,q,r,s,n,o),f.push({x:p,y:q}),f.push({x:r,y:s}),f.push({x:n,y:o}),i.x=n,i.y=o}d=[p,q,r,s,n,o],e=null}else if("S"===k||"s"===k){for(var l=g(j),m=0;m<l.length;m+=4){var p,q;d?(p=2*d[4]-d[2],q=2*d[5]-d[3]):(p=i.x,q=i.y);var r=l[m],s=l[m+1],n=l[m+2],o=l[m+3];"s"===k&&(r+=i.x,s+=i.y,n+=i.x,o+=i.y),a&&a.bezierCurveTo(p,q,r,s,n,o),f.push({x:p,y:q}),f.push({x:r,y:s}),f.push({x:n,y:o}),i.x=n,i.y=o}d=[p,q,r,s,n,o],e=null}else if("Q"===k||"q"===k){for(var l=g(j),m=0;m<l.length;m+=4){var p=l[m],q=l[m+1],n=l[m+2],o=l[m+3];"q"===k&&(p+=i.x,q+=i.y,n+=i.x,o+=i.y),a&&a.quadraticCurveTo(p,q,n,o),f.push({x:p,y:q}),f.push({x:n,y:o}),i.x=n,i.y=o}d=null,e=[p,q,n,o]}else if("T"===k||"t"===k){for(var l=g(j),m=0;m<l.length;m+=2){var p,q;e?(p=2*e[2]-e[0],q=2*e[3]-e[1]):(p=i.x,q=i.y);var n=l[m],o=l[m+1];"t"===k&&(n+=i.x,o+=i.y),a&&a.quadraticCurveTo(p,q,n,o),f.push({x:p,y:q}),f.push({x:n,y:o}),i.x=n,i.y=o}d=null,e=[p,q,n,o]}else if("V"===k||"v"===k){for(var l=g(j),m=0;m<l.length;m+=1){var o=l[m];"v"===k&&(o+=i.y),a&&a.lineTo(i.x,o),f.push({x:i.x,y:o}),i.y=o}d=e=null}else if("L"===k||"l"===k){for(var l=g(j),m=0;m<l.length;m+=2){var n=l[m],o=l[m+1];"l"===k&&(n+=i.x,o+=i.y),a&&a.lineTo(n,o),f.push({x:n,y:o}),i.x=n,i.y=o}d=e=null}else if("A"===k||"a"===k){for(var l=g(j),m=0;m<l.length;m+=7){var t=l[m],u=l[m+1],v=l[m+2],w=l[m+3],x=l[m+4],n=l[m+5],o=l[m+6];"a"===k&&(n+=i.x,o+=i.y);var y=vf(i,t,u,v,w,x,{x:n,y:o},a);y&&(f=f.concat(y)),i.x=n,i.y=o}d=e=null}var z=j.substr(j.length-1);("z"===z||"Z"===z)&&a&&a.closePath()}return f},xf=function(a,b){var c,d,e="L"===b[0],f=b.length;a.save(),e?(a.transform(b[5],b[6],b[7],b[8],b[9],b[10]),c=a.createLinearGradient(b[1],b[2],b[3],b[4]),d=11):(a.transform(b[7],b[8],b[9],b[10],b[11],b[12]),c=a.createRadialGradient(b[1],b[2],b[3],b[4],b[5],b[6]),d=13);for(var g=a.compGray;f>d;)c.addColorStop(b[d],g?l.toGrayColor(b[d+1]):b[d+1]),d+=2;a.fillStyle=c},yf=function(a,b){var c=a.s("shape.gradient.pack");if(c){for(var d=c.length,e=new Array(d),f=0;d>f;f++)e[f]=c[f];var g,h,i,j,k,l,m,n,o,p,q,r,s,t="L"===e[0];g=t?5:7,h=e[g],i=e[g+1],j=e[g+2],k=e[g+3],l=e[g+4],m=e[g+5],n=b[0],o=b[1],p=b[2],q=b[3],r=b[4],s=b[5],e[g]=n*h+p*i,e[g+1]=o*h+q*i,e[g+2]=n*j+p*k,e[g+3]=o*j+q*k,e[g+4]=n*l+p*m+r,e[g+5]=o*l+q*m+s,a.s("shape.gradient.pack",e)}},zf=function(a,b,c,d){var e=!1;if(a.beginPath?a.beginPath():e=!0,Id(b)&&(b=b._as),Id(c)&&(c=c._as),c&&c.length){for(var f,g,h,i,j=0,k=0,l=c.length;l>k;k++)f=c[k],1===f?(g=b[j++],a.moveTo(g.x,e?-g.y:g.y)):2===f?(g=b[j++],a.lineTo(g.x,e?-g.y:g.y)):3===f?(g=b[j++],h=b[j++],a.quadraticCurveTo(g.x,e?-g.y:g.y,h.x,e?-h.y:h.y)):4===f?(g=b[j++],h=b[j++],i=b[j++],a.bezierCurveTo(g.x,e?-g.y:g.y,h.x,e?-h.y:h.y,i.x,e?-i.y:i.y)):5===f&&a.closePath();d&&5!==f&&a.closePath()}else{var m,n,o,p=b.length;if(p>0){for(m=b[0],a.moveTo(m.x,e?-m.y:m.y),n=1;p>n;n++)o=b[n],a.lineTo(o.x,e?-o.y:o.y);d&&a.closePath()}}},Af=function(a,b,c,d){if(Id(a)&&(a=a._as),Id(b)&&(b=b._as),b&&b.length){c=c||hi;for(var e,f,g,h,j,k,l,m,n=[],o=i,p=0,q=0,r=b.length;r>q;q++)if(e=b[q],1===e)n.push(o=[]),o.push(a[p++]);else if(2===e)o.push(a[p++]);else if(3===e){for(f=o[o.length-1],g=a[p++],h=a[p++],k=1;c>k;k++)l=he(k/c,f.x,g.x,h.x),m=he(k/c,f.y,g.y,h.y),o.push({x:l,y:m,b:!0});o.push(h)}else if(4===e){for(f=o[o.length-1],g=a[p++],h=a[p++],j=a[p++],k=1;c>k;k++)l=ie(k/c,f.x,g.x,h.x,j.x),m=ie(k/c,f.y,g.y,h.y,j.y),o.push({x:l,y:m,b:!0});o.push(j)}else 5===e&&o.push(o[0]);return d&&5!==e&&o&&o.length>2&&o.push(o[0]),n}return d&&a.length>2&&(a=a.slice(),a.push(a[0])),a?[a]:[]},Bf=function(a,b,c,d,e,f){var g,h,i,j=qf(b),k=d,l=j[0],m=j[1],n=j[2];if(c){var o=qf(c);g=o[0]-l,h=o[1]-m,i=o[2]-n}else g=255-l,h=255-m,i=255-n;for(f||(f=d>10?1:.5,f=1>e?F(f/e,2):f),a.save(),a.shadowOffsetX=0,a.shadowOffsetY=0,a.shadowBlur=0,a.shadowColor=0;(d-=f)>0;){var p=1-d/k,q=l+g*p,r=m+h*p,s=n+i*p;q=F(C(q),255),r=F(C(r),255),s=F(C(s),255),a.strokeStyle="rgb("+q+","+r+","+s+")",a.lineWidth=d,a.stroke()}a.restore()},Cf=function(){var a={};return function(b,c){var d=b+"-"+c,e=a[d];if(e)return e;var f,g,h,i=qf(b);return 0>c?(c=(100+c)/100,f=C(i[0]*c),g=C(i[1]*c),h=C(i[2]*c)):(c/=100,f=i[0],g=i[1],h=i[2],f+=(255-f)*c,g+=(255-g)*c,h+=(255-h)*c,f=F(C(f),255),g=F(C(g),255),h=F(C(h),255)),a[d]="rgb("+f+","+g+","+h+")"}}(),Df=function(a,b,c,d,e,f){f&&(a.fillStyle=f),a.beginPath(),a.rect(b,c,d,e),a.fill()},Ef=function(a,b,c,d,e,f,g){a.beginPath(),Rf[b](a,c.x,c.y,c.width,c.height,d,e,f,g)},Ff=function(a,b,c,d,e){var f=Rf[c];f?a.fillStyle=f(a,b,d?d:qg,e.x,e.y,e.width,e.height):a.fillStyle=b},Gf=function(a,b,c,d,e,f){try{if(!b.tagName&&b.comps){b._cacheImage_||(b._cacheImage_={});var g;g="override"===d?"colors_override":"override_rgb"===d?"colors_override_rgb":"override_a"===d?"colors_override_a":"colors",b._cacheImage_[g]||(b._cacheImage_[g]={__count__:0});var h=b._cacheImage_[g][c];h||(b._cacheImage_[g].__count__>l.imageCacheThreshold&&(b._cacheImage_[g]={__count__:0}),h=j.Default.toCanvas(b,Zi(b),$i(b),null,e,f,c,null,d),b._cacheImage_[g][c]=h,b._cacheImage_[g].__count__++),b=h}a.fillStyle=a.createPattern(b,"repeat")}catch(i){a.fillStyle="black"}},Hf=function(a,b,c,d,e,f,g){a.save(),a.translate(b,c),a.scale(1,g/f),a.arc(0,0,f,d,e),a.restore()},If=function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s;if(G(e)>2*M&&(e=2*M),m=C(G(e)/(M/4)),i=e/m,j=-i,k=-d,m>0){n=b+H(d)*f,o=c+J(-d)*g,h?a.lineTo(n,o):a.moveTo(n,o);for(var t=0;m>t;t++)k+=j,l=k-j/2,p=b+H(k)*f,q=c+J(k)*g,r=b+H(l)*(f/H(j/2)),s=c+J(l)*(g/H(j/2)),a.quadraticCurveTo(r,s,p,q)}},Jf=function(a,b,c,d,e,f,g,h,i){6===arguments.length&&(g=f,h=f,i=f);var j=b+d,k=c+e,l=e>d?2*d:2*e;f=l>f?f:l,g=l>g?g:l,h=l>h?h:l,i=l>i?i:l;var m=.29*i,n=.58*i;a.moveTo(j,k-i),a.quadraticCurveTo(j,k-n,j-m,k-m),a.quadraticCurveTo(j-n,k,j-i,k),m=.29*h,n=.58*h,a.lineTo(b+h,k),a.quadraticCurveTo(b+n,k,b+m,k-m),a.quadraticCurveTo(b,k-n,b,k-h),m=.29*f,n=.58*f,a.lineTo(b,c+f),a.quadraticCurveTo(b,c+n,b+m,c+m),a.quadraticCurveTo(b+n,c,b+f,c),m=.29*g,n=.58*g,a.lineTo(j-g,c),a.quadraticCurveTo(j-n,c,j-m,c+m),a.quadraticCurveTo(j,c+n,j,c+g),a.lineTo(j,k-i)},Kf=function(a,b,c,d,e,f,g){b&&(c=A(c),d=A(d),g||(g=1),a.fillStyle=b,a.beginPath(),a.rect(c,d,g,f),a.rect(c,d,e,g),f-g>0&&a.rect(c,d+f-g,e,g),e-g>0&&a.rect(c+e-g,d,g,f),a.fill())},Lf=function(a,b,c,d){var e=d.x,f=d.y,g=d.width,h=d.height;if(!(!b||!c||0>=g||0>=h)){var i,j=Jh(b),k=Kh(b),l=c>0;1===c||-1===c?(a.fillStyle=l?j:k,a.beginPath(),a.rect(e,f,1,h),a.rect(e,f,g,1),a.fill(),a.fillStyle=l?k:j,a.beginPath(),a.rect(e,f+h-1,g,1),a.rect(e+g-1,f,1,h),a.fill()):(c=F(G(c),F(g/2,h/2)),i=a.createLinearGradient(e,f,e+c,f),i.addColorStop(0,l?j:k),i.addColorStop(1,b),a.fillStyle=i,a.beginPath(),a.moveTo(e,f),a.lineTo(e+c,f+c),a.lineTo(e+c,f+h-c),a.lineTo(e,f+h),a.lineTo(e,f),a.fill(),i=a.createLinearGradient(e,f,e,f+c),i.addColorStop(0,l?j:k),i.addColorStop(1,b),a.fillStyle=i,a.beginPath(),a.moveTo(e,f),a.lineTo(e+c,f+c),a.lineTo(e+g-c,f+c),a.lineTo(e+g,f),a.lineTo(e,f),a.fill(),i=a.createLinearGradient(e,f+h,e,f+h-c),i.addColorStop(0,l?k:j),i.addColorStop(1,b),a.fillStyle=i,a.beginPath(),a.moveTo(e,f+h),a.lineTo(e+c,f+h-c),a.lineTo(e+g-c,f+h-c),a.lineTo(e+g,f+h),a.lineTo(e,f+h),a.fill(),i=a.createLinearGradient(e+g,f,e+g-c,f),i.addColorStop(0,l?k:j),i.addColorStop(1,b),a.fillStyle=i,a.beginPath(),a.moveTo(e+g,f),a.lineTo(e+g-c,f+c),a.lineTo(e+g-c,f+h-c),a.lineTo(e+g,f+h),a.lineTo(e+g,f),a.fill())}},Mf=function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,f,g);return h.addColorStop(0,c),h.addColorStop(1,b),h},Nf=function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,f,g);return h.addColorStop(0,b),h.addColorStop(.5,c),h.addColorStop(1,b),h},Of=function(a,b,c,d,e,f,g){var h=a.createLinearGradient(d,e,f,g);return h.addColorStop(0,b),h.addColorStop(1/3,c),h.addColorStop(2/3,b),h.addColorStop(1,c),h},Pf=function(a,b,c,d,e,f,g,h,i){var j=a.createRadialGradient(d+f*h,e+g*i,F(f,g)/24,d+f/2,e+g/2,E(f,g)/2);return j.addColorStop(0,c),j.addColorStop(1,b),j},Qf=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],Rf={polygon:function(a,b,c,d,e,f){(f==i||3>f)&&(f=6);for(var g,h,j=F(d,e)/2,k=b+d/2,l=c+e/2,m=0,n=2*M/f,o=0;f>o;o++)g=k+H(m)*j,h=l+J(m)*j,0===o?a.moveTo(g,h):a.lineTo(g,h),m+=n;a.closePath()},arc:function(a,b,c,d,e,f,g,h,j){f==i&&(f=M),g==i&&(g=N),h==i&&(h=!0);var k=b+d/2,l=c+e/2;
h&&a.moveTo(k,l),j?Hf(a,k,l,f,g,d/2,e/2):a.arc(k,l,F(d,e)/2,f,g),h&&a.closePath()},rect:function(a,b,c,d,e){a.rect(b,c,d,e)},circle:function(a,b,c,d,e){a.arc(b+d/2,c+e/2,F(d,e)/2,0,N,!0)},oval:function(a,b,c,d,e){Hf(a,b+d/2,c+e/2,0,N,d/2,e/2)},roundRect:function(a,b,c,d,e,f){f==i&&(f=F(F(d,e)/4,8)),Jf(a,b,c,d,e,f)},star:function(a,b,c,d,e){var f=2*d,g=2*e,h=b+d/2,i=c+e/2;a.moveTo(h-f/4,i-g/12),a.lineTo(b+.306*d,c+.579*e),a.lineTo(h-f/6,i+g/4),a.lineTo(b+d/2,c+.733*e),a.lineTo(h+f/6,i+g/4),a.lineTo(b+.693*d,c+.579*e),a.lineTo(h+f/4,i-g/12),a.lineTo(b+.611*d,c+.332*e),a.lineTo(h+0,i-g/4),a.lineTo(b+.388*d,c+.332*e),a.closePath()},pentagram:function(a,b,c,d,e){var f=.5*e,g=b+.5*d,h=c+f,i=.5257311121191336*d;i>f&&(i=f);var j=Qf,k=0;for(a.moveTo(g+i*j[k++],h+i*j[k++]);20>k;)a.lineTo(g+i*j[k++],h+i*j[k++]);a.closePath()},triangle:function(a,b,c,d,e){a.moveTo(b+d/2,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.closePath()},hexagon:function(a,b,c,d,e){a.moveTo(b,c+e/2),a.lineTo(b+d/4,c+e),a.lineTo(b+3*d/4,+c+e),a.lineTo(b+d,c+e/2),a.lineTo(b+3*d/4,c),a.lineTo(b+d/4,c),a.closePath()},pentagon:function(a,b,c,d,e){var f=2*d,g=2*e,h=b+d/2,i=c+e/2;a.moveTo(h-f/4,i-g/12),a.lineTo(h-f/6,i+g/4),a.lineTo(h+f/6,i+g/4),a.lineTo(h+f/4,i-g/12),a.lineTo(h+0,i-g/4),a.closePath()},diamond:function(a,b,c,d,e){a.moveTo(b+d/2,c),a.lineTo(b,c+e/2),a.lineTo(b+d/2,c+e),a.lineTo(b+d,c+e/2),a.closePath()},rightTriangle:function(a,b,c,d,e){a.moveTo(b,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.closePath()},parallelogram:function(a,b,c,d,e){var f=d/4;a.moveTo(b+f,c),a.lineTo(b+d,c),a.lineTo(b+d-f,c+e),a.lineTo(b,c+e),a.closePath()},trapezoid:function(a,b,c,d,e){var f=d/4;a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.lineTo(b+d,c+e),a.lineTo(b,c+e),a.closePath()},"linear.southwest":function(a,b,c,d,e,f,g){return Mf(a,b,c,d,e+g,d+f,e)},"linear.southeast":function(a,b,c,d,e,f,g){return Mf(a,b,c,d+f,e+g,d,e)},"linear.northwest":function(a,b,c,d,e,f,g){return Mf(a,b,c,d,e,d+f,e+g)},"linear.northeast":function(a,b,c,d,e,f,g){return Mf(a,b,c,d+f,e,d,e+g)},"linear.north":function(a,b,c,d,e,f,g){return Mf(a,b,c,d,e,d,e+g)},"linear.south":function(a,b,c,d,e,f,g){return Mf(a,b,c,d,e+g,d,e)},"linear.west":function(a,b,c,d,e,f,g){return Mf(a,b,c,d,e,d+f,e)},"linear.east":function(a,b,c,d,e,f,g){return Mf(a,b,c,d+f,e,d,e)},"radial.center":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.5,.5)},"radial.southwest":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.25,.75)},"radial.southeast":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.75,.75)},"radial.northwest":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.25,.25)},"radial.northeast":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.75,.25)},"radial.north":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.5,.25)},"radial.south":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.5,.75)},"radial.west":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.25,.5)},"radial.east":function(a,b,c,d,e,f,g){return Pf(a,b,c,d,e,f,g,.75,.5)},"spread.horizontal":function(a,b,c,d,e,f,g){return Nf(a,b,c,d,e,d+f,e)},"spread.vertical":function(a,b,c,d,e,f,g){return Nf(a,b,c,d,e,d,e+g)},"spread.diagonal":function(a,b,c,d,e,f,g){return Nf(a,b,c,d+f,e,d,e+g)},"spread.antidiagonal":function(a,b,c,d,e,f,g){return Nf(a,b,c,d,e,d+f,e+g)},"spread.north":function(a,b,c,d,e,f,g){return Of(a,b,c,d,e-g/4,d,e+g+g/4)},"spread.south":function(a,b,c,d,e,f,g){return Of(a,c,b,d,e-g/4,d,e+g+g/4)},"spread.west":function(a,b,c,d,e,f,g){return Of(a,b,c,d-f/4,e,d+f+f/4,e)},"spread.east":function(a,b,c,d,e,f,g){return Of(a,c,b,d-f/4,e,d+f+f/4,e)}},Sf=function(a,b,c){return new Hg(a).tf(b,c)},Tf=function(a){var b=a.touches[0],c=a.touches[1],d=b.clientX,e=b.clientY,f=c.clientX,g=c.clientY;return D((d-f)*(d-f)+(e-g)*(e-g))},Uf=(function(){for(var b=0,c=Kb.split(""),d=0;d<c.length;d++)b=10*V(c[d])+b;return wd(a[Ze.toString(8*d)+Xa.substr(d)+3],a[Ze.toString(8*d)+Xa.substr(d)+4]),b}(),function(a,b,c){for(var d=0;d<c.size();d++){var e=c.get(d);a.co(e)&&b.add(e)}for(d=0;d<c.size();d++)e=c.get(d),Uf(a,b,e._children)}),Vf=function(a,b,c){for(var d=0;d<c.size();d++){var e=c.get(c.size()-1-d);a.co(e)&&b.add(e)}for(d=0;d<c.size();d++)e=c.get(d),Vf(a,b,e._children)},Wf=function(a,b,c){for(var d=!1,e=0;e<c.size();e++){var f=c.get(e);a.co(f)?d&&b.add(f):d=1}for(e=0;e<c.size();e++)f=c.get(e),Wf(a,b,f._children)},Xf=function(a,b,c){for(var d=!1,e=0;e<c.size();e++){var f=c.get(c.size()-1-e);a.co(f)?d&&b.add(f):d=!0}for(e=0;e<c.size();e++)f=c.get(e),Xf(a,b,f._children)},Yf=l.moveDatas=function(a,b,d,e){var f=e==i;if(0!==b||0!==d||!f&&0!==e){var g=!0,h=[];if(a.forEach(function(a){g&&(a._69O||Md(a)||Od(a))&&(g=!1)}),g)h=a;else{var j={},k={};a.forEach(function(a){j[a._id]=!0});var l={},m=function(a){var b=a._id;return j[b]?(h.push(a),l[b]=!0):l[b]=!1},n=function(a){var b=a._id;if(k[b])return m(a);var d=l[b];if(d!==c)return d;var e=a._parent;if(e&&(Od(e)||Md(e))&&n(e))return l[b]=!0;var f=a._host;return f&&(k[b]=b,d=n(f),k[b]=c,d)?l[b]=!0:m(a)};a.forEach(function(a){n(a)})}h.forEach(function(a){if(Kd(a))f?a.translate(b,d):a.translate3d(b,d,e);else{var c=a.s(gb);if(!c||c.isEmpty())return;var g=new bj;c.each(function(a){a=Gh(a),f?(a.x+=b,a.y+=d):(a.x+=b,a.y+=e,a.e==i?a.e=d:a.e+=d),g.add(a)}),a.s(gb,g)}})}},Zf=function(a,b){function d(a,b){return b===a.substring(0,b.length)?!0:!1}function e(a){return parseFloat(a)||0}function f(a,b){if(b==c&&(b=new Rg),d(a,"matrix3d")){var f=a.substring(9,a.length-1).split(",");f=f.map(e),b.fromArray(f)}else if(d(a,"matrix")){var f=a.substring(7,a.length-1).split(",");f=f.map(e),b.el[0]=f[0],b.el[1]=f[1],b.el[2]=0,b.el[3]=0,b.el[4]=f[2],b.el[5]=f[3],b.el[6]=0,b.el[7]=0,b.el[8]=0,b.el[9]=0,b.el[10]=1,b.el[11]=0,b.el[12]=f[4],b.el[13]=f[5],b.el[14]=0,b.el[15]=1}return b}function g(a,b){b==c&&(b=new Kg);var d=a.split(/\s+/);return d=d.map(e),b.set(d[0]||0,d[1]||0,d[2]||0),b}var h,i,j,k,l,m=function(a,b){h||(h=new Rg,i=new Kg,j=new Rg,k=new Rg,l=new Rg),b==c&&(b=new Rg);var d=getComputedStyle(a);d.transform&&"none"!==d.transform&&(f(d.transform,h),g(d.transformOrigin,i),k.setPosition(i),i.negate(),l.setPosition(i),(da||"preserve-3d"!==d.transformStyle)&&(h.el[8]=0,h.el[9]=0,h.el[10]=1,h.el[11]=0),b.multiplyMatrices(l,b),b.multiplyMatrices(h,b),b.multiplyMatrices(k,b)),!da&&d.perspective&&"none"!==d.perspective&&(j.el[11]=-1/e(d.perspective),g(d.perspectiveOrigin,i),k.setPosition(i),i.negate(),l.setPosition(i),b.multiplyMatrices(l,b),b.multiplyMatrices(j,b),b.multiplyMatrices(k,b));for(var n=a.offsetParent,o=a.offsetLeft,p=a.offsetTop,q=a.parentElement;q&&q!==n;){var r=getComputedStyle(q);if("none"!==r.transform||"none"!==r.perspective)break;q=q.parentElement}return q==c&&a!==a.ownerDocument.documentElement&&"fixed"!==d.position&&(q=a.ownerDocument.documentElement),n!=c&&n!==q&&(o-=q.offsetLeft,p-=q.offsetTop),i.set(o,p,0),k.setPosition(i),b.multiplyMatrices(k,b),q&&m(q,b),b};return function(a,b){var c=a.parentElement;if(c){var d=c.updateAppendMatrix;if(d){delete c.updateAppendMatrix;var e=new Rg;m(c,e);var f=new Rg;f.getInverse(e),c._matrixAppend=f,c._maxrixPreAppend=e}return b?c._matrixAppend:c._maxrixPreAppend}}}(),$f=function(a,c){for(;a&&!a.hasOwnProperty(c);)a=b.getPrototypeOf(a);return a&&b.getOwnPropertyDescriptor(a,c)},_f=b.getPrototypeOf?function(a,c,d){var e=$f(c,d);e&&b.defineProperty(a,d,e)}:function(a,b,c){a[c]=b[c]},ag={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},bg=function(){var b={1:function(a,b){return{x:a.x-b.width/2,y:a.y-b.height/2}},2:function(a,b){return{x:a.x+b.width/2,y:a.y-b.height/2}},3:function(a,b){return{x:a.x+a.width/2,y:a.y-b.height/2}},4:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y-b.height/2}},5:function(a,b){return{x:a.x+a.width+b.width/2,y:a.y-b.height/2}},6:function(a,b){return{x:a.x,y:a.y}},7:function(a,b){return{x:a.x+a.width/2,y:a.y}},8:function(a,b){return{x:a.x+a.width,y:a.y}},9:function(a,b){return{x:a.x-b.width/2,y:a.y+b.height/2}},10:function(a,b){return{x:a.x+b.width/2,y:a.y+b.height/2}},11:function(a,b){return{x:a.x+a.width/2,y:a.y+b.height/2}},12:function(a,b){return{x:a.x-b.width/2+a.width,y:a.y+b.height/2}},13:function(a,b){return{x:a.x+a.width+b.width/2,y:a.y+b.height/2}},14:function(a,b){return{x:a.x-b.width/2,y:a.y+a.height/2}},15:function(a,b){return{x:a.x,y:a.y+a.height/2}},16:function(a,b){return{x:a.x+b.width/2,y:a.y+a.height/2}},17:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height/2}},18:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y+a.height/2}},19:function(a,b){return{x:a.x+a.width,y:a.y+a.height/2}},20:function(a,b){return{x:a.x+a.width+b.width/2,y:a.y+a.height/2}},21:function(a,b){return{x:a.x-b.width/2,y:a.y+a.height-b.height/2}},22:function(a,b){return{x:a.x+b.width/2,y:a.y+a.height-b.height/2}},23:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height-b.height/2}},24:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y+a.height-b.height/2}},25:function(a,b){return{x:a.x+a.width+b.width/2,y:a.y+a.height-b.height/2}},26:function(a,b){return{x:a.x,y:a.y+a.height}},27:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height}},28:function(a,b){return{x:a.x+a.width,y:a.y+a.height}},29:function(a,b){return{x:a.x-b.width/2,y:a.y+a.height+b.height/2}},30:function(a,b){return{x:a.x+b.width/2,y:a.y+a.height+b.height/2}},31:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height+b.height/2}},32:function(a,b){return{x:a.x+a.width-b.width/2,y:a.y+a.height+b.height/2}},33:function(a,b){return{x:a.x+a.width+b.width/2,y:a.y+a.height+b.height/2}},34:function(a,b){return{x:a.x,y:a.y-b.height/2}},35:function(a,b){return{x:a.x+a.width,y:a.y-b.height/2}},36:function(a,b){return{x:a.x,y:a.y+a.height+b.height/2}},37:function(a,b){return{x:a.x+a.width,y:a.y+a.height+b.height/2}},38:function(a,b){return{x:a.x+a.width/4,y:a.y-b.height/2}},39:function(a,b){return{x:a.x+3*a.width/4,y:a.y-b.height/2}},40:function(a,b){return{x:a.x+a.width/4,y:a.y}},41:function(a,b){return{x:a.x+3*a.width/4,y:a.y}},42:function(a,b){return{x:a.x+a.width/4,y:a.y+b.height/2}},43:function(a,b){return{x:a.x+3*a.width/4,y:a.y+b.height/2}},44:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height/2-b.height/2}},45:function(a,b){return{x:a.x+a.width/4,y:a.y+a.height/2}},46:function(a,b){return{x:a.x+a.width/2-b.width/2,y:a.y+a.height/2}},47:function(a,b){return{x:a.x+a.width/2+b.width/2,y:a.y+a.height/2}},48:function(a,b){return{x:a.x+3*a.width/4,y:a.y+a.height/2}},49:function(a,b){return{x:a.x+a.width/2,y:a.y+a.height/2+b.height/2}},50:function(a,b){return{x:a.x+a.width/4,y:a.y+a.height-b.height/2}},51:function(a,b){return{x:a.x+3*a.width/4,y:a.y+a.height-b.height/2}},52:function(a,b){return{x:a.x+a.width/4,y:a.y+a.height}},53:function(a,b){return{x:a.x+3*a.width/4,y:a.y+a.height}},54:function(a,b){return{x:a.x+a.width/4,y:a.y+a.height+b.height/2}},55:function(a,b){return{x:a.x+3*a.width/4,y:a.y+a.height+b.height/2}}};return xd(a)?function(a,c,d){return b[a](c,d?d:id)}:void 0}();Td(o,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#45C4F9",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var cg=o.reverse,dg=o.transparent,eg=o.rectSelectBackground,fg=o.dash,gg=o.titleBackground,hg=o.titleIconBackground,ig=o.headerBackground,jg=o.headerIconBackground,kg=o.headerSeparator,lg=o.headerLine,mg=o.contentIconBackground,ng=o.contentLine,og=(o.widgetIconHighlight,o.widgetIconBorder),pg=(o.widgetIconGradient,o.imageBackground),qg=o.imageGradient,rg=o.highlight,sg=o.label,tg=o.labelSelect;if(W&&!a.shutAlert1){var ug=new Date,vg=W.split("-"),wg=new Date(ug.getFullYear(),ug.getMonth(),ug.getDate()),W=new Date(V(vg[0],10),V(vg[1],10)-1,V(vg[2],10)),xg=wg.getTime(),yg=W.getTime(),zg=g+"_try",Ag=a.alert;try{var Bg=a.localStorage;if(Bg&&Ag)if(yg>xg&&1728e6>yg-xg){var Cg=(yg-xg)/864e5;Bg&&Bg[zg]!=Cg&&(Bg[zg]=Cg,Ag(a.htWillExpire?a.htWillExpire.replace("{{day}}",Cg):"HT for Web free trial license will expire in "+Cg+" days, please apply for a new license!"))}else xg>=yg&&Ag(a.htExpired?a.htExpired:"Your free trial of HT for Web has expired!"),Bg&&delete Bg[zg]}catch(Dg){}}Math.sign===c&&(Math.sign=function(a){return 0>a?-1:a>0?1:+a});var Eg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Fg={encode:function(a,b){var c,d,e,f,g,h,i,j="",k=0;for(a=Fg._utf8_encode(a);k<a.length;)c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+b.charAt(f)+b.charAt(g)+b.charAt(h)+b.charAt(i);return j},decode:function(a,b){var c,d,e,f,g,h,i,j="",k=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<a.length;)f=b.indexOf(a.charAt(k++)),g=b.indexOf(a.charAt(k++)),h=b.indexOf(a.charAt(k++)),i=b.indexOf(a.charAt(k++)),c=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(c),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));return j=Fg._utf8_decode(j)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3);return b}};j.Math={generateUUID:function(){for(var a=[],b=0;256>b;b++)a[b]=(16>b?"0":"")+b.toString(16).toUpperCase();return function(){var b=4294967295*Math.random()|0,c=4294967295*Math.random()|0,d=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]+"-"+a[255&c]+a[c>>8&255]+"-"+a[c>>16&15|64]+a[c>>24&255]+"-"+a[63&d|128]+a[d>>8&255]+"-"+a[d>>16&255]+a[d>>24&255]+a[255&e]+a[e>>8&255]+a[e>>16&255]+a[e>>24&255]}}(),clamp:function(a,b,c){return Math.max(b,Math.min(c,a))},generateIncreasingID:function(){var a=0;return function(){return++a}}(),encodeBase64:function(a,b){return Fg.encode(a,b||Eg)},decodeBase64:function(a,b){return Fg.decode(a,b||Eg)},randomArray:function(a,b){b=b||a.length;for(var c=b-1;c>0;c--){var d=Math.floor(Math.random()*(c+1)),e=a[c];a[c]=a[d],a[d]=e}return a}};var Gg=j.Matrix=j.Math.Matrix2d=function(a,b,c,d,e){this.setFromTransform(a,b,c,d,e)},Hg=Gg;Gg.prototype={},Gg.prototype.constructor=Gg,Gg.prototype.set=function(a,b,c,d,e,f){return this.a=a,this.b=b,this.c=c,this.d=d,this.tx=e,this.ty=f,this},Gg.prototype.setFromTransform=function(a,b,d,e,f){var g=this;if(a===c)return g.a=1,g.b=0,g.c=0,g.d=1,g.tx=0,void(g.ty=0);a=a||0;var h=J(a),i=H(a);return e=e||1,f=f||1,g.a=i*e,g.b=h*e,g.c=-h*f,g.d=i*f,g.tx=b||0,g.ty=d||0,g},Gg.prototype.apply=function(a,b){b=b||new Lg;var c=a.x,d=a.y;return b.x=this.a*c+this.c*d+this.tx,b.y=this.b*c+this.d*d+this.ty,b},Gg.prototype.applyInverse=function(a,b){b=b||new Lg;var c=1/(this.a*this.d+this.c*-this.b),d=a.x,e=a.y;return b.x=this.d*c*d+-this.c*c*e+(this.ty*this.c-this.tx*this.d)*c,b.y=this.a*c*e+-this.b*c*d+(-this.ty*this.a+this.tx*this.b)*c,b},Gg.prototype.translate=function(a,b){return this.tx+=a,this.ty+=b,this},Gg.prototype.scale=function(a,b){return this.a*=a,this.d*=b,this.c*=a,this.b*=b,this.tx*=a,this.ty*=b,this},Gg.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;return this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b,this},Gg.prototype.appendTranslate=function(a,b){return this.tx+=this.a*a+this.c*b,this.ty+=this.b*a+this.d*b,this},Gg.prototype.appendScale=function(a,b){return this.a*=a,this.d*=b,this.c*=b,this.b*=a,this},Gg.prototype.appendRotate=function(a){if(!a)return this;var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.b;return this.a=d*b+this.c*c,this.b=e*b+this.d*c,this.c=-d*c+this.c*b,this.d=-e*c+this.d*b,this},Gg.prototype.append=function(a){var b=this.a,c=this.b,d=this.c,e=this.d;return this.a=a.a*b+a.b*d,this.b=a.a*c+a.b*e,this.c=a.c*b+a.d*d,this.d=a.c*c+a.d*e,this.tx=a.tx*b+a.ty*d+this.tx,this.ty=a.tx*c+a.ty*e+this.ty,this},Gg.prototype.setTransform=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q,r,s;return n=Math.sin(g),o=Math.cos(g),p=Math.cos(i),q=Math.sin(i),r=-Math.sin(h),s=Math.cos(h),j=o*e,k=n*e,l=-n*f,m=o*f,this.a=p*j+q*l,this.b=p*k+q*m,this.c=r*j+s*l,this.d=r*k+s*m,this.tx=a+(c*j+d*l),this.ty=b+(c*k+d*m),this},Gg.prototype.prepend=function(a){var b=this.tx;if(1!==a.a||0!==a.b||0!==a.c||1!==a.d){var c=this.a,d=this.c;this.a=c*a.a+this.b*a.c,this.b=c*a.b+this.b*a.d,this.c=d*a.a+this.d*a.c,this.d=d*a.b+this.d*a.d}return this.tx=b*a.a+this.ty*a.c+a.tx,this.ty=b*a.b+this.ty*a.d+a.ty,this},Gg.prototype.transform=Gg.prototype.prepend,Gg.prototype.invert=function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},Gg.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Gg.prototype.clone=function(){var a=new Gg;return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},Gg.prototype.copy=function(a){return a.a=this.a,a.b=this.b,a.c=this.c,a.d=this.d,a.tx=this.tx,a.ty=this.ty,a},Gg.prototype.tf=function(a,b){1===arguments.length&&(b=a.y,a=a.x);var c=this;return{x:c.a*a+c.c*b+c.tx,y:c.b*a+c.d*b+c.ty}},Gg.prototype.tfi=function(a,b){1===arguments.length&&(b=a.y,a=a.x);var c=this,d=1/(c.a*c.d+c.c*-c.b);return{x:c.d*d*a+-c.c*d*b+(c.ty*c.c-c.tx*c.d)*d,y:c.a*d*b+-c.b*d*a+(-c.ty*c.a+c.tx*c.b)*d}},Gg.IDENTITY=new Gg,Gg.TEMP_MATRIX=new Gg;var Ig=j.Math.Quaternion=function(a,b,c,d){this.set(a,b,c,d)};b.assign(Ig.prototype,{set:function(a,b,d,e){var f=this;return f._x=a||0,f._y=b||0,f._z=d||0,f._w=e!==c?e:1,f},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(a){var b=this;return b._x=a._x,b._y=a._y,b._z=a._z,b._w=a._w,b},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this},dot:function(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this},fromArray:function(a,b){b===c&&(b=0);var d=this;return d._x=a[b],d._y=a[b+1],d._z=a[b+2],d._w=a[b+3],this},slerp:function(a,b){if(0===b)return this;if(1===b)return this.copy(a);var c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(0>g?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;var h=Math.sqrt(1-g*g);if(Math.abs(h)<.001)return this._w=.5*(f+this._w),this._x=.5*(c+this._x),this._y=.5*(d+this._y),this._z=.5*(e+this._z),this;var i=Math.atan2(h,g),j=Math.sin((1-b)*i)/h,k=Math.sin(b*i)/h;return this._w=f*j+this._w*k,this._x=c*j+this._x*k,this._y=d*j+this._y*k,this._z=e*j+this._z*k,this},setFromAxisAngle:function(a,b){var c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this},setFromEuler:function(a){var b=a._x,c=a._y,d=a._z,e=a._order,f=Math.cos,g=Math.sin,h=f(b/2),i=f(c/2),j=f(d/2),k=g(b/2),l=g(c/2),m=g(d/2);return"XYZ"===e?(this._x=k*i*j+h*l*m,this._y=h*l*j-k*i*m,this._z=h*i*m+k*l*j,this._w=h*i*j-k*l*m):"YXZ"===e?(this._x=k*i*j+h*l*m,this._y=h*l*j-k*i*m,this._z=h*i*m-k*l*j,this._w=h*i*j+k*l*m):"ZXY"===e?(this._x=k*i*j-h*l*m,this._y=h*l*j+k*i*m,this._z=h*i*m+k*l*j,this._w=h*i*j-k*l*m):"ZYX"===e?(this._x=k*i*j-h*l*m,this._y=h*l*j+k*i*m,this._z=h*i*m-k*l*j,this._w=h*i*j+k*l*m):"YZX"===e?(this._x=k*i*j+h*l*m,this._y=h*l*j+k*i*m,this._z=h*i*m-k*l*j,this._w=h*i*j-k*l*m):"XZY"===e&&(this._x=k*i*j-h*l*m,this._y=h*l*j-k*i*m,this._z=h*i*m+k*l*j,this._w=h*i*j+k*l*m),this},setFromRotationMatrix:function(a){var b,c=a.el,d=c[0],e=c[4],f=c[8],g=c[1],h=c[5],i=c[9],j=c[2],k=c[6],l=c[10],m=d+h+l;return m>0?(b=.5/Math.sqrt(m+1),this._w=.25/b,this._x=(k-i)*b,this._y=(f-j)*b,this._z=(g-e)*b):d>h&&d>l?(b=2*Math.sqrt(1+d-h-l),this._w=(k-i)/b,this._x=.25*b,this._y=(e+g)/b,this._z=(f+j)/b):h>l?(b=2*Math.sqrt(1+h-d-l),this._w=(f-j)/b,this._x=(e+g)/b,this._y=.25*b,this._z=(i+k)/b):(b=2*Math.sqrt(1+l-d-h),this._w=(g-e)/b,this._x=(f+j)/b,this._y=(i+k)/b,this._z=.25*b),this},setFromToVectors:function(){var a,b;return function(d,e){return a===c&&(a=new Kg),b=d.dot(e)+1,1e-7>b?(b=0,Math.abs(d.x)>Math.abs(d.z)?a.set(-d.y,d.x,0):a.set(0,-d.z,d.y)):a.crossVectors(d,e),this._x=a.x,this._y=a.y,this._z=a.z,this._w=b,this.normalize()}}(),setFromUnitVectors:function(){var a,b,d=1e-6;return function(e,f){return a===c&&(a=new Kg),b=e.dot(f)+1,d>b?(b=0,Math.abs(e.x)>Math.abs(e.z)?a.set(-e.y,e.x,0):a.set(0,-e.z,e.y)):a.crossVectors(e,f),this._x=a.x,this._y=a.y,this._z=a.z,this._w=b,this.normalize()}}(),multiply:function(a){return this.multiplyQuaternions(this,a)},premultiply:function(a){return this.multiplyQuaternions(a,this)},multiplyQuaternions:function(a,b){var c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this}});var Jg=j.Math.Vector4=function(a,b,d,e){this.x=a||0,this.y=b||0,this.z=d||0,this.w=e!==c?e:1};b.assign(Jg.prototype,{isVector4:!0,set:function(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this.w=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setW:function(a){return this.w=a,this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+a)}return this},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=a.w!==c?a.w:1,this},add:function(a,b){return b!==c?this.addVectors(a,b):(this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this)},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this},sub:function(a,b){return b!==c?this.subVectors(a,b):(this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this)},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=this.w,f=a.el;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this},divideScalar:function(a){return this.multiplyScalar(1/a)},setAxisAngleFromQuaternion:function(a){this.w=2*Math.acos(a.w);var b=Math.sqrt(1-a.w*a.w);return 1e-4>b?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this},setAxisAngleFromRotationMatrix:function(a){var b,c,d,e,f=.01,g=.1,h=a.el,i=h[0],j=h[4],k=h[8],l=h[1],m=h[5],n=h[9],o=h[2],p=h[6],q=h[10];if(Math.abs(j-l)<f&&Math.abs(k-o)<f&&Math.abs(n-p)<f){if(Math.abs(j+l)<g&&Math.abs(k+o)<g&&Math.abs(n+p)<g&&Math.abs(i+m+q-3)<g)return this.set(1,0,0,0),this;b=Math.PI;var r=(i+1)/2,s=(m+1)/2,t=(q+1)/2,u=(j+l)/4,v=(k+o)/4,w=(n+p)/4;return r>s&&r>t?f>r?(c=0,d=.707106781,e=.707106781):(c=Math.sqrt(r),d=u/c,e=v/c):s>t?f>s?(c=.707106781,d=0,e=.707106781):(d=Math.sqrt(s),c=u/d,e=w/d):f>t?(c=.707106781,d=.707106781,e=0):(e=Math.sqrt(t),c=v/e,d=w/e),this.set(c,d,e,b),this}var x=Math.sqrt((p-n)*(p-n)+(k-o)*(k-o)+(l-j)*(l-j));return Math.abs(x)<.001&&(x=1),this.x=(p-n)/x,this.y=(k-o)/x,this.z=(l-j)/x,this.w=Math.acos((i+m+q-1)/2),this},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this},clamp:function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this.z=Math.max(a.z,Math.min(b.z,this.z)),this.w=Math.max(a.w,Math.min(b.w,this.w)),this},clampScalar:function(){var a,b;return function(d,e){return a===c&&(a=new Jg,b=new Jg),a.set(d,d,d,d),b.set(e,e,e,e),this.clamp(a,b)}}(),clampLength:function(a,b){var c=this.length();return this.divideScalar(c||1).multiplyScalar(Math.max(a,Math.min(b,c)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(a){return this.normalize().multiplyScalar(a)},lerp:function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},equals:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w},fromArray:function(a,b){return b===c&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this},toArray:function(a,b){return a===c&&(a=[]),b===c&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a},fromBufferAttribute:function(a,b,c){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}});var Kg=j.Math.Vector3=function(a,b,d){a===c?(this.x=0,this.y=0,this.z=0):"object"==typeof a?this.copy(a):this.set(a,b==c?a:b,d==c?a:d)};b.assign(Kg.prototype,{set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},equals:function(a){return a&&this.x===a.x&&this.y===a.y&&this.z===a.z},setScalar:function(a){return this.x=a,this.y=a,this.z=a,this},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(a){return a.x===c?(this.x=a[0],this.y=a[1],this.z=a[2]):(this.x=a.x,this.y=a.y,this.z=a.z),this},add:function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this},addScalar:function(a){return this.x+=a,this.y+=a,this.z+=a,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},addScaledVector:function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this},sub:function(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this},subScalar:function(a){return this.x-=a,this.y-=a,this.z-=a,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiply:function(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},distanceToSquared2:function(a){var b=this.x-a[0],c=this.y-a[1],d=this.z-a[2];return b*b+c*c+d*d},multiplyVectors:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this},transformDirection:function(a){var b=this.x,c=this.y,d=this.z,e=a.el;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize()},applyEuler:function(){var a=new Ig;return function(b){return this.applyQuaternion(a.setFromEuler(b))}}(),applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,e=a._x,f=a._y,g=a._z,h=a._w,i=h*b+f*d-g*c,j=h*c+g*b-e*d,k=h*d+e*c-f*b,l=-e*b-f*c-g*d;return this.x=i*h+l*-e+j*-g-k*-f,this.y=j*h+l*-f+k*-e-i*-g,this.z=k*h+l*-g+i*-f-j*-e,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.el,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this},applyMatrix3:function(a){var b=this.x,c=this.y,d=this.z,e=a.el;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},reflect:function(){var a=new Kg;return function(b){return this.sub(a.copy(b).multiplyScalar(2*this.dot(b)))}}(),dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var a=this.length();return a?this.multiplyScalar(1/a):this},setLength:function(a){return this.normalize().multiplyScalar(a)},fromArray:function(a,b){return b===c&&(b=0),this.x=a[b],this.y=a[b+1],this.z=a[b+2],this},toArray:function(a,b){return a===c&&(a=[0,0,0]),b===c&&(b=0),a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a},cross:function(a){return this.crossVectors(this,a)},angleTo:function(a){var b=this.dot(a)/Math.sqrt(this.lengthSq()*a.lengthSq());return b>1||-1>b?0:Math.acos(b)},lerpVectors:function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},min:function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this},max:function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this},
setFromMatrixPosition:function(a){return this.setFromMatrixColumn(a,3)},setFromMatrixScale:function(a){var b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this},setFromMatrixColumn:function(a,b){return this.fromArray(a.el,4*b)}});var Lg=j.Math.Vector2=function(a,b,d){"object"==typeof a&&(a.x!=c?(b=a.y,a=a.x,d=a.e):(d=a[2],b=a[1],a=a[0])),this.set(a||0,b||0,d)};Lg.prototype={},Lg.prototype.constructor=Lg,b.defineProperties(Lg.prototype,{width:{get:function(){return this.x},set:function(a){this.x=a}},height:{get:function(){return this.y},set:function(a){this.y=a}}}),Lg.prototype.clone=function(){return new Lg(this.x,this.y,this.e)},Lg.prototype.copy=function(a){return this.set(a.x,a.y,a.e),this},Lg.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},Lg.prototype.set=function(a,b,d){return this.x=a||0,this.y=b||(0!==b?this.x:0),d!=c&&(this.e=d),this},Lg.prototype.setScalar=function(a){return this.x=a,this.y=a,this},Lg.prototype.setX=function(a){return this.x=a||0,this},Lg.prototype.setY=function(a){return this.y=a||0,this},Lg.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},Lg.prototype.addVectors=function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this},Lg.prototype.addScalar=function(a){return this.x+=a,this.y+=a,this},Lg.prototype.addScaledVector=function(a,b){return this.x+=a.x*b,this.y+=a.y*b,this},Lg.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},Lg.prototype.subScalar=function(a){return this.x-=a,this.y-=a,this},Lg.prototype.subVectors=function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this},Lg.prototype.multiply=function(a){return this.x*=a.x,this.y*=a.y,this},Lg.prototype.multiplyScalar=function(a){return this.x*=a,this.y*=a,this},Lg.prototype.divide=function(a){return this.x/=a.x,this.y/=a.y,this},Lg.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},Lg.prototype.min=function(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this},Lg.prototype.max=function(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this},Lg.prototype.fromArray=function(a,b){return b===c&&(b=0),this.x=a[b],this.y=a[b+1],this},Lg.prototype.clamp=function(a,b){return this.x=Math.max(a.x,Math.min(b.x,this.x)),this.y=Math.max(a.y,Math.min(b.y,this.y)),this},Lg.prototype.clampScalar=function(){var a,b;return function(d,e){return a===c&&(a=new Lg,b=new Lg),a.set(d,d),b.set(e,e),this.clamp(a,b)}}(),Lg.prototype.clampLength=function(a,b){var c=this.length();return this.multiplyScalar(Math.max(a,Math.min(b,c))/c)},Lg.prototype.dot=function(a){return this.x*a.x+this.y*a.y},Lg.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},Lg.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Lg.prototype.normalize=function(){return this.divideScalar(this.length())},Lg.prototype.angle=function(){var a=Math.atan2(this.y,this.x);return 0>a&&(a+=2*Math.PI),a},Lg.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},Lg.prototype.distanceToSquared=function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},Lg.prototype.isNearEnough=function(a){return this.distanceToSquared(a)<1e-8},Lg.prototype.setLength=function(a){var b=this.length();return b?this.multiplyScalar(a/b):this},Lg.prototype.lerp=function(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this},Lg.prototype.lerpVectors=function(a,b,c){return this.subVectors(b,a).multiplyScalar(c).add(a)},Lg.prototype.rotateAround=function(a,b){var c=a?a.x:0,d=a?a.y:0,e=Math.cos(b),f=Math.sin(b),g=this.x-c,h=this.y-d;return this.x=g*e-h*f+c,this.y=g*f+h*e+d,this},b.assign(d.prototype,{isMatrix3:!0,set:function(a,b,c,d,e,f,g,h,i){var j=this.el;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.el)},copy:function(a){var b=this.el,c=a.el;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],this},setFromMatrix4:function(a){var b=a.el;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this},applyToBufferAttribute:function(){var a=new Kg;return function(b){for(var c=0,d=b.count;d>c;c++)a.x=b.getX(c),a.y=b.getY(c),a.z=b.getZ(c),a.applyMatrix3(this),b.setXYZ(c,a.x,a.y,a.z);return b}}(),multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.el,d=b.el,e=this.el,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=d[0],p=d[3],q=d[6],r=d[1],s=d[4],t=d[7],u=d[2],v=d[5],w=d[8];return e[0]=f*o+g*r+h*u,e[3]=f*p+g*s+h*v,e[6]=f*q+g*t+h*w,e[1]=i*o+j*r+k*u,e[4]=i*p+j*s+k*v,e[7]=i*q+j*t+k*w,e[2]=l*o+m*r+n*u,e[5]=l*p+m*s+n*v,e[8]=l*q+m*t+n*w,this},multiplyScalar:function(a){var b=this.el;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this},determinant:function(){var a=this.el,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h},getInverse:function(a,b){var c=a.el,d=this.el,e=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=c[8],n=m*i-j*l,o=j*k-m*h,p=l*h-i*k,q=e*n+f*o+g*p;if(0===q)return this.identity();var r=1/q;return d[0]=n*r,d[1]=(g*l-m*f)*r,d[2]=(j*f-g*i)*r,d[3]=o*r,d[4]=(m*e-g*k)*r,d[5]=(g*h-j*e)*r,d[6]=p*r,d[7]=(f*k-l*e)*r,d[8]=(i*e-f*h)*r,this},transpose:function(){var a,b=this.el;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this},getNormalMatrix:function(a){return this.setFromMatrix4(a).getInverse(this).transpose()},transposeIntoArray:function(a){var b=this.el;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this},setUvTransform:function(a,b,c,d,e,f,g){var h=Math.cos(e),i=Math.sin(e);this.set(c*h,c*i,-c*(h*f+i*g)+f+a,-d*i,d*h,-d*(-i*f+h*g)+g+b,0,0,1)},scale:function(a,b){var c=this.el;return c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=b,c[4]*=b,c[7]*=b,this},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.el,e=d[0],f=d[3],g=d[6],h=d[1],i=d[4],j=d[7];return d[0]=b*e+c*h,d[3]=b*f+c*i,d[6]=b*g+c*j,d[1]=-c*e+b*h,d[4]=-c*f+b*i,d[7]=-c*g+b*j,this},translate:function(a,b){var c=this.el;return c[0]+=a*c[2],c[3]+=a*c[5],c[6]+=a*c[8],c[1]+=b*c[2],c[4]+=b*c[5],c[7]+=b*c[8],this},equals:function(a){for(var b=this.el,c=a.el,d=0;9>d;d++)if(b[d]!==c[d])return!1;return!0},fromArray:function(a,b){b===c&&(b=0);for(var d=0;9>d;d++)this.el[d]=a[d+b];return this},toArray:function(a,b){a===c&&(a=[]),b===c&&(b=0);var d=this.el;return a[b]=d[0],a[b+1]=d[1],a[b+2]=d[2],a[b+3]=d[3],a[b+4]=d[4],a[b+5]=d[5],a[b+6]=d[6],a[b+7]=d[7],a[b+8]=d[8],a}});var Mg=j.Math.Plane=function(a,b){this.normal=a!==c?a:new Kg(1,0,0),this.constant=b!==c?b:0};b.assign(Mg.prototype,{set:function(a,b){return this.normal.copy(a),this.constant=b,this},setComponents:function(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this},setFromNormalAndCoplanarPoint:function(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this},setFromCoplanarPoints:function(){var a=new Kg,b=new Kg;return function(c,d,e){var f=a.subVectors(e,d).cross(b.subVectors(c,d)).normalize();return this.setFromNormalAndCoplanarPoint(f,c),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.normal.copy(a.normal),this.constant=a.constant,this},normalize:function(){var a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return b===c&&(b=new Kg),b.copy(this.normal).multiplyScalar(-this.distanceToPoint(a)).add(a)},intersectLine:function(){var a=new Kg;return function(b,d){d===c&&(d=new Kg);var e=b.delta(a),f=this.normal.dot(e);if(0===f)return 0===this.distanceToPoint(b.start)?d.copy(b.start):c;var g=-(b.start.dot(this.normal)+this.constant)/f;return 0>g||g>1?c:d.copy(e).multiplyScalar(g).add(b.start)}}(),intersectsLine:function(a){var b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return 0>b&&c>0||0>c&&b>0},intersectsBox:function(a){return a.intersectsPlane(this)},intersectsSphere:function(a){return a.intersectsPlane(this)},coplanarPoint:function(a){return a===c&&(a=new Kg),a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var a=new Kg,b=new d;return function(c,d){var e=d||b.getNormalMatrix(c),f=this.coplanarPoint(a).applyMatrix4(c),g=this.normal.applyMatrix3(e).normalize();return this.constant=-f.dot(g),this}}(),translate:function(a){return this.constant-=a.dot(this.normal),this},equals:function(a){return a.normal.equals(this.normal)&&a.constant===this.constant}});var Ng=j.Math.Ray=function(a,b){this.origin=a!==c?a.clone():new Kg,this.direction=b!==c?b.clone():new Kg};b.assign(Ng.prototype,{set:function(a,b){return this.origin.copy(a),this.direction.copy(b),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this.maxHitLen=a.maxHitLen,this},at:function(a,b){var c=b||new Kg;return c.copy(this.direction).multiplyScalar(a).add(this.origin)},setMaxHitLength:function(a){this.maxHitLen=a},lookAt:function(a){return this.direction.copy(a).sub(this.origin).normalize(),this},applyMatrix4:function(a){var b=this.maxHitLen;if(b){var c=this.direction.clone().multiplyScalar(b).add(this.origin);c.applyMatrix4(a)}return this.origin.applyMatrix4(a),this.direction.transformDirection(a),b&&(this.maxHitLen=this.origin.distanceTo(c)),this},intersectBox:function(a,b){var c,d,e,f,g,h,i=1/this.direction.x,j=1/this.direction.y,k=1/this.direction.z,l=this.origin;if(i>=0?(c=(a.min.x-l.x)*i,d=(a.max.x-l.x)*i):(c=(a.max.x-l.x)*i,d=(a.min.x-l.x)*i),j>=0?(e=(a.min.y-l.y)*j,f=(a.max.y-l.y)*j):(e=(a.max.y-l.y)*j,f=(a.min.y-l.y)*j),c>f||e>d)return null;if((e>c||c!==c)&&(c=e),(d>f||d!==d)&&(d=f),k>=0?(g=(a.min.z-l.z)*k,h=(a.max.z-l.z)*k):(g=(a.max.z-l.z)*k,h=(a.min.z-l.z)*k),c>h||g>d)return null;if((g>c||c!==c)&&(c=g),(d>h||d!==d)&&(d=h),0>d)return null;var m=c>=0?c:d,n=this.maxHitLen;return n&&m>n?null:this.at(m,b)},intersectTriangle:function(){var a=new Kg,b=new Kg,c=new Kg,d=new Kg;return function(e,f,g,h,i){b.subVectors(f,e),c.subVectors(g,e),d.crossVectors(b,c);var j,k=this.direction.dot(d);if(k>0){if(h)return null;j=1}else{if(!(0>k))return null;j=-1,k=-k}a.subVectors(this.origin,e);var l=j*this.direction.dot(c.crossVectors(a,c));if(0>l)return null;var m=j*this.direction.dot(b.cross(a));if(0>m||l+m>k)return null;var n=-j*a.dot(d);if(0>n)return null;var o=n/k,p=this.maxHitLen;return p&&o>p?null:this.at(o,i)}}()});var Og=j.Math.Box3=function(a,b){this.min=a!==c?a:new Kg(+(1/0),+(1/0),+(1/0)),this.max=b!==c?b:new Kg(-(1/0),-(1/0),-(1/0))};b.assign(Og.prototype,{set:function(a,b){return this.min.copy(a),this.max.copy(b),this},setFromArray:function(a){for(var b=+(1/0),c=+(1/0),d=+(1/0),e=-(1/0),f=-(1/0),g=-(1/0),h=0,i=a.length;i>h;h+=3){var j=a[h],k=a[h+1],l=a[h+2];b>j&&(b=j),c>k&&(c=k),d>l&&(d=l),j>e&&(e=j),k>f&&(f=k),l>g&&(g=l)}return this.min.set(b,c,d),this.max.set(e,f,g),this},setFromPoints:function(a){this.makeEmpty();for(var b=0,c=a.length;c>b;b++)this.expandByPoint(a[b]);return this},clone:function(){return(new this.constructor).copy(this)},intersectsBox:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},copy:function(a){return this.min.copy(a.min),this.max.copy(a.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=+(1/0),this.max.x=this.max.y=this.max.z=-(1/0),this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(a){return this.min.min(a),this.max.max(a),this}});var Pg=j.Math.Sphere=function(a,b){this.center=a!==c?a:new Kg,this.radius=b!==c?b:0};b.assign(Pg.prototype,{set:function(a,b){return this.center.copy(a),this.radius=b,this},setFromPoints:function(){var a=new Og;return function(b,d){var e=this.center;d!==c?e.copy(d):a.setFromPoints(b).getCenter(e);for(var f=0,g=0,h=b.length;h>g;g++)f=Math.max(f,e.distanceToSquared(b[g]));return this.radius=Math.sqrt(f),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(a){return this.center.copy(a.center),this.radius=a.radius,this},empty:function(){return this.radius<=0},containsPoint:function(a){return a.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(a){return a.distanceTo(this.center)-this.radius},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b},intersectsBox:function(a){return a.intersectsSphere(this)},intersectsPlane:function(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius},clampPoint:function(a,b){var d=this.center.distanceToSquared(a);return b===c&&(b=new Kg),b.copy(a),d>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b},getBoundingBox:function(a){return a===c&&(a=new Og),a.set(this.center,this.center),a.expandByScalar(this.radius),a},applyMatrix4:function(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this},translate:function(a){return this.center.add(a),this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius}});var Qg=j.Math.Frustum=function(a,b,d,e,f,g){this.planes=[a!==c?a:new Mg,b!==c?b:new Mg,d!==c?d:new Mg,e!==c?e:new Mg,f!==c?f:new Mg,g!==c?g:new Mg]};b.assign(Qg.prototype,{set:function(a,b,c,d,e,f){var g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this},clone:function(){return(new this.constructor).copy(this)},copy:function(a){for(var b=this.planes,c=0;6>c;c++)b[c].copy(a.planes[c]);return this},setFromMatrix:function(a){var b=this.planes,c=a.el,d=c[0],e=c[1],f=c[2],g=c[3],h=c[4],i=c[5],j=c[6],k=c[7],l=c[8],m=c[9],n=c[10],o=c[11],p=c[12],q=c[13],r=c[14],s=c[15];return b[0].setComponents(g-d,k-h,o-l,s-p).normalize(),b[1].setComponents(g+d,k+h,o+l,s+p).normalize(),b[2].setComponents(g+e,k+i,o+m,s+q).normalize(),b[3].setComponents(g-e,k-i,o-m,s-q).normalize(),b[4].setComponents(g-f,k-j,o-n,s-r).normalize(),b[5].setComponents(g+f,k+j,o+n,s+r).normalize(),this},intersectsObject:function(){var a=new Pg;return function(b){var c=b.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),a.copy(c.boundingSphere).applyMatrix4(b.matrixWorld),this.intersectsSphere(a)}}(),intersectsSprite:function(){var a=new Pg;return function(b){return a.center.set(0,0,0),a.radius=.7071067811865476,a.applyMatrix4(b.matrixWorld),this.intersectsSphere(a)}}(),intersectsSphere:function(a){for(var b=this.planes,c=a.center,d=-a.radius,e=0;6>e;e++){var f=b[e].distanceToPoint(c);if(d>f)return!1}return!0},intersectsBox:function(){var a=new Kg;return function(b){for(var c=this.planes,d=0;6>d;d++){var e=c[d];if(a.x=e.normal.x>0?b.max.x:b.min.x,a.y=e.normal.y>0?b.max.y:b.min.y,a.z=e.normal.z>0?b.max.z:b.min.z,e.distanceToPoint(a)<0)return!1}return!0}}(),containsPoint:function(a){for(var b=this.planes,c=0;6>c;c++)if(b[c].distanceToPoint(a)<0)return!1;return!0}});var Rg=j.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};b.assign(Rg.prototype,{set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.el;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},clone:function(){return(new Rg).fromArray(this.el)},fromArray:function(a,b){b===c&&(b=0);for(var d=this.el,e=0;16>e;e++)d[e]=a[e+b];return this},scale:function(a){var b=this.el,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this},makeRotationFromEuler:function(a){var b=this.el,c=a._x,d=a._y,e=a._z,f=a._order,g=Math.cos(c),h=Math.sin(c),i=Math.cos(d),j=Math.sin(d),k=Math.cos(e),l=Math.sin(e);if("XYZ"===f){var m=g*k,n=g*l,o=h*k,p=h*l;b[0]=i*k,b[4]=-i*l,b[8]=j,b[1]=n+o*j,b[5]=m-p*j,b[9]=-h*i,b[2]=p-m*j,b[6]=o+n*j,b[10]=g*i}else if("YXZ"===f){var q=i*k,r=i*l,s=j*k,t=j*l;b[0]=q+t*h,b[4]=s*h-r,b[8]=g*j,b[1]=g*l,b[5]=g*k,b[9]=-h,b[2]=r*h-s,b[6]=t+q*h,b[10]=g*i}else if("ZXY"===f){var q=i*k,r=i*l,s=j*k,t=j*l;b[0]=q-t*h,b[4]=-g*l,b[8]=s+r*h,b[1]=r+s*h,b[5]=g*k,b[9]=t-q*h,b[2]=-g*j,b[6]=h,b[10]=g*i}else if("ZYX"===f){var m=g*k,n=g*l,o=h*k,p=h*l;b[0]=i*k,b[4]=o*j-n,b[8]=m*j+p,b[1]=i*l,b[5]=p*j+m,b[9]=n*j-o,b[2]=-j,b[6]=h*i,b[10]=g*i}else if("YZX"===f){var u=g*i,v=g*j,w=h*i,x=h*j;b[0]=i*k,b[4]=x-u*l,b[8]=w*l+v,b[1]=l,b[5]=g*k,b[9]=-h*k,b[2]=-j*k,b[6]=v*l+w,b[10]=u-x*l}else if("XZY"===f){var u=g*i,v=g*j,w=h*i,x=h*j;b[0]=i*k,b[4]=-l,b[8]=j*k,b[1]=u*l+x,b[5]=g*k,b[9]=v*l-w,b[2]=w*l-v,b[6]=h*k,b[10]=x*l+u}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},makeRotationFromQuaternion:function(a){var b=this.el,c=a._x,d=a._y,e=a._z,f=a._w,g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return b[0]=1-(m+o),b[4]=k-r,b[8]=l+q,b[1]=k+r,b[5]=1-(j+o),b[9]=n-p,b[2]=l-q,b[6]=n+p,b[10]=1-(j+m),b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(a,b){var c=this.el,d=a.el,e=d[0],f=d[1],g=d[2],h=d[3],i=d[4],j=d[5],k=d[6],l=d[7],m=d[8],n=d[9],o=d[10],p=d[11],q=d[12],r=d[13],s=d[14],t=d[15],u=n*s*l-r*o*l+r*k*p-j*s*p-n*k*t+j*o*t,v=q*o*l-m*s*l-q*k*p+i*s*p+m*k*t-i*o*t,w=m*r*l-q*n*l+q*j*p-i*r*p-m*j*t+i*n*t,x=q*n*k-m*r*k-q*j*o+i*r*o+m*j*s-i*n*s,y=e*u+f*v+g*w+h*x;if(0===y)return this.identity();var z=1/y;return c[0]=u*z,c[1]=(r*o*h-n*s*h-r*g*p+f*s*p+n*g*t-f*o*t)*z,c[2]=(j*s*h-r*k*h+r*g*l-f*s*l-j*g*t+f*k*t)*z,c[3]=(n*k*h-j*o*h-n*g*l+f*o*l+j*g*p-f*k*p)*z,c[4]=v*z,c[5]=(m*s*h-q*o*h+q*g*p-e*s*p-m*g*t+e*o*t)*z,c[6]=(q*k*h-i*s*h-q*g*l+e*s*l+i*g*t-e*k*t)*z,c[7]=(i*o*h-m*k*h+m*g*l-e*o*l-i*g*p+e*k*p)*z,c[8]=w*z,c[9]=(q*n*h-m*r*h-q*f*p+e*r*p+m*f*t-e*n*t)*z,c[10]=(i*r*h-q*j*h+q*f*l-e*r*l-i*f*t+e*j*t)*z,c[11]=(m*j*h-i*n*h-m*f*l+e*n*l+i*f*p-e*j*p)*z,c[12]=x*z,c[13]=(m*r*g-q*n*g+q*f*o-e*r*o-m*f*s+e*n*s)*z,c[14]=(q*j*g-i*r*g-q*f*k+e*r*k+i*f*s-e*j*s)*z,c[15]=(i*n*g-m*j*g+m*f*k-e*n*k-i*f*o+e*j*o)*z,this},makeRotationAxis:function(a,b){var c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this},multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(a){return this.multiplyMatrices(a,this)},multiplyMatrices:function(a,b){var c=a.el,d=b.el,e=this.el,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this},lookAt:function(){var a=new Kg,b=new Kg,c=new Kg;return function(d,e,f){var g=this.el;return c.subVectors(d,e),0===c.lengthSq()&&(c.z=1),c.normalize(),a.crossVectors(f,c),0===a.lengthSq()&&(1===Math.abs(f.z)?c.x+=1e-4:c.z+=1e-4,c.normalize(),a.crossVectors(f,c)),a.normalize(),b.crossVectors(c,a),g[0]=a.x,g[4]=b.x,g[8]=c.x,g[1]=a.y,g[5]=b.y,g[9]=c.y,g[2]=a.z,g[6]=b.z,g[10]=c.z,this}}(),extractScale:function(){var a;return function(b){a===c&&(a=new Kg),b===c&&(b=new Kg);var d=a.setFromMatrixColumn(this,0).length(),e=a.setFromMatrixColumn(this,1).length(),f=a.setFromMatrixColumn(this,2).length();return b.set(d,e,f),b}}(),extractRotation:function(){var a;return function(b){a===c&&(a=new Kg),b===c&&(b=new Rg);var d=this.el,e=b.el,f=1/a.setFromMatrixColumn(b,0).length(),g=1/a.setFromMatrixColumn(b,1).length(),h=1/a.setFromMatrixColumn(b,2).length();return d[0]=e[0]*f,d[1]=e[1]*f,d[2]=e[2]*f,d[4]=e[4]*g,d[5]=e[5]*g,d[6]=e[6]*g,d[8]=e[8]*h,d[9]=e[9]*h,d[10]=e[10]*h,this}}(),multiplyScalar:function(a){var b=this.el;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this},getPosition:function(a){return a===c&&(a=new Kg),a.setFromMatrixColumn(this,3)},setPosition:function(a){var b=this.el;return b[12]=a.x,b[13]=a.y,b[14]=a.z,this},toArray:function(a,b){a===c&&(a=[]),b===c&&(b=0);var d=this.el;return a[b]=d[0],a[b+1]=d[1],a[b+2]=d[2],a[b+3]=d[3],a[b+4]=d[4],a[b+5]=d[5],a[b+6]=d[6],a[b+7]=d[7],a[b+8]=d[8],a[b+9]=d[9],a[b+10]=d[10],a[b+11]=d[11],a[b+12]=d[12],a[b+13]=d[13],a[b+14]=d[14],a[b+15]=d[15],a},determinant:function(){var a=this.el,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7],p=a[11],q=a[15];return n*(+e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(+b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+p*(+b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+q*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)},copy:function(a){var b=this.el,c=a.el;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],b[9]=c[9],b[10]=c[10],b[11]=c[11],b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15],this},compose:function(a,b,c){var d=this.el,e=b._x,f=b._y,g=b._z,h=b._w,i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=c.x,v=c.y,w=c.z;return d[0]=(1-(o+q))*u,d[1]=(m+t)*u,d[2]=(n-s)*u,d[3]=0,d[4]=(m-t)*v,d[5]=(1-(l+q))*v,d[6]=(p+r)*v,d[7]=0,d[8]=(n+s)*w,d[9]=(p-r)*w,d[10]=(1-(l+o))*w,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this},decompose:function(){var a=new Kg,b=new Rg;return function(c,d,e){var f=this.el,g=a.set(f[0],f[1],f[2]).length(),h=a.set(f[4],f[5],f[6]).length(),i=a.set(f[8],f[9],f[10]).length(),j=this.determinant();0>j&&(g=-g),c.x=f[12],c.y=f[13],c.z=f[14],b.copy(this);var k=1/g,l=1/h,m=1/i;return b.el[0]*=k,b.el[1]*=k,b.el[2]*=k,b.el[4]*=l,b.el[5]*=l,b.el[6]*=l,b.el[8]*=m,b.el[9]*=m,b.el[10]*=m,d.setFromRotationMatrix(b),e.x=g,e.y=h,e.z=i,this}}()});var Sg=j.Math.Triangle=function(a,b,d){this.a=a!==c?a:new Kg,this.b=b!==c?b:new Kg,this.c=d!==c?d:new Kg};b.assign(Sg,{barycoordFromPoint:function(){var a=new Kg,b=new Kg,c=new Kg;return function(d,e,f,g,h){a.subVectors(g,e),b.subVectors(f,e),c.subVectors(d,e);var i=a.dot(a),j=a.dot(b),k=a.dot(c),l=b.dot(b),m=b.dot(c),n=i*l-j*j,o=h||new Kg;if(0===n)return o.set(-2,-1,-1);var p=1/n,q=(l*k-j*m)*p,r=(i*m-j*k)*p;return o.set(1-q-r,r,q)}}()});var Tg=j.Math.Euler=function(a,b,c,d,e){this.set(a,b,c,d,e)};Tg.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Tg.DefaultOrder="XYZ",Tg.ReverseOrder=function(a){return a=a[2]+a[1]+a[0],a.toUpperCase()},b.defineProperties(Tg.prototype,{x:{get:function(){return this._x},set:function(a){this._x=a,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(a){this._y=a,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(a){this._z=a,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(a){this._order=a,this.onChangeCallback()}}}),b.assign(Tg.prototype,{set:function(a,b,c,d,e){return Hd(a)&&(e=c,d=b,c=a[2],b=a[1],a=a[0]),d?e&&(d=Tg.ReverseOrder(d)):d="ZYX",this._x=a||0,this._y=b||0,this._z=c||0,this._order=d||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this.onChangeCallback(),this},setFromRotationMatrix:function(a,b,c){var d=j.Math.clamp,e=a.el||a,f=e[0],g=e[4],h=e[8],i=e[1],k=e[5],l=e[9],m=e[2],n=e[6],o=e[10];return b=b||this._order,"XYZ"===b?(this._y=Math.asin(d(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(-l,o),this._z=Math.atan2(-g,f)):(this._x=Math.atan2(n,k),this._z=0)):"YXZ"===b?(this._x=Math.asin(-d(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(h,o),this._z=Math.atan2(i,k)):(this._y=Math.atan2(-m,f),this._z=0)):"ZXY"===b?(this._x=Math.asin(d(n,-1,1)),Math.abs(n)<.99999?(this._y=Math.atan2(-m,o),this._z=Math.atan2(-g,k)):(this._y=0,this._z=Math.atan2(i,f))):"ZYX"===b?(this._y=Math.asin(-d(m,-1,1)),Math.abs(m)<.99999?(this._x=Math.atan2(n,o),this._z=Math.atan2(i,f)):(this._x=0,this._z=Math.atan2(-g,k))):"YZX"===b?(this._z=Math.asin(d(i,-1,1)),Math.abs(i)<.99999?(this._x=Math.atan2(-l,k),this._y=Math.atan2(-m,f)):(this._x=0,this._y=Math.atan2(h,o))):"XZY"===b?(this._z=Math.asin(-d(g,-1,1)),Math.abs(g)<.99999?(this._x=Math.atan2(n,k),this._y=Math.atan2(h,f)):(this._x=Math.atan2(-l,o),this._y=0)):console.warn("unsupported order: "+b),this._order=b,c!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var a=new Rg;return function(b,c,d){return a.makeRotationFromQuaternion(b),this.setFromRotationMatrix(a,c,d)}}(),setFromVector3:function(a,b){return this.set(a.x,a.y,a.z,b||this._order)},reorder:function(){var a=new Ig;return function(b){return a.setFromEuler(this),this.setFromQuaternion(a,b)}}(),equals:function(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order},fromArray:function(a){return this._x=a[0],this._y=a[1],this._z=a[2],a[3]!==c&&(this._order=a[3]),this.onChangeCallback(),this},toArray:function(a,b){return a===c&&(a=[]),b===c&&(b=0),a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a},toVector3:function(a){return a?a.set(this._x,this._y,this._z):new Kg(this._x,this._y,this._z)},onChange:function(a){return this.onChangeCallback=a,this},onChangeCallback:function(){}});var Ug={ms_ac:function(a,b){for(var c=b.ms_ac,d=0;d<c.length;d++)me(a,c[d])},ms_listener:function(a,b){a.addListeners=function(){for(var a=this,b=0;b<Bc.length;b++)a["handle_"+Bc[b]]&&ke(Bc[b],a.getView(),a)},a.removeListeners=function(){for(var a=this,b=0;b<Bc.length;b++)a["handle_"+Bc[b]]&&le(Bc[b],a.getView(),a)}},ms_fire:function(a,b){a.mp=function(a,b,c){this.addPropertyChangeListener(a,b,c)},a.ump=function(a,b){this.removePropertyChangeListener(a,b)},a.fp=function(a,b,c,d,e){return this.firePropertyChange(a,b,c,d,e)},a.addPropertyChangeListener=function(a,b,c){var d=this;d._62I||(d._62I=new dj),d._62I.add(a,b,c)},a.removePropertyChangeListener=function(a,b){this._62I&&this._62I.remove(a,b)},a.firePropertyChange=function(a,b,c,d,e){if(d){if(d(b,c))return!1}else if(b===c)return!1;var f=this,g=e||{};return g.property=a,g.oldValue=b,g.newValue=c,g.source=f,g.data=f,f._62I&&f._62I.fire(g),f.onPropertyChanged&&f.onPropertyChanged(g),!0}},ms_attr:function(a,b){a.a=function(a,b){var c=this;if(2===arguments.length)c.setAttr(a,b);else{if(!Fd(a))return c.getAttr(a);for(var d in a)c.setAttr(d,a[d])}return c},a.getAttr=function(a,b){if(b===c&&(b=1),this._attrObject&&a in this._attrObject)return this._attrObject[a];if(this.getImage){var d=this.getImage();if(Cd(d)&&(d=Rc[d]),Fd(d)&&"dataBindings"in d)for(var e=d.dataBindings,f=e.length-1;f>=0;f--){var g=e[f];if(g.attr===a){if("defaultValue"in g)return g.defaultValue;break}}}return b?n[a]:c},a.setAttr=function(a,b){var d=this;d._attrObject||(d._attrObject={});var e=d._attrObject[a];b===c?delete d._attrObject[a]:d._attrObject[a]=b,d.fp&&d.fp("a:"+a,e,b)&&d.onAttrChanged&&d.onAttrChanged(a,e,b)},a.getSerializableAttrs=function(){var a,b={};for(a in this._attrObject)b[a]=1;return b}},ms_bnb:function(a,b){a.getBodyColor=function(a){return a.s("body.color")},a.getBorderColor=function(a){return a.s("border.color")}},_51o:function(a,b){a.mi=function(a,b,c){this.addInteractorListener(a,b,c)},a.umi=function(a,b){this.removeInteractorListener(a,b)},a.fi=function(a){this.fireInteractorEvent(a)},a.addInteractorListener=function(a,b,c){var d=this;d._63I||(d._63I=new dj),d._63I.add(a,b,c)},a.removeInteractorListener=function(a,b){this._63I&&this._63I.remove(a,b)},a.fireInteractorEvent=function(a){this._63I&&this._63I.fire(a)},a.setInteractors=function(a){var b=this,c=b._interactors;c&&c.each(function(a){a.tearDown()}),Hd(a)&&(a=new bj(a)),b._interactors=a,a&&a.each(function(a){a.setUp()}),b.fp("interactors",c,a),b.invalidateSelection()},a.getInteractors=function(){return this._interactors}},_49o:function(a,b){a._44O=i,a._45O=i,a.getTopPainters=function(){return this._44O},a.getBottomPainters=function(){return this._45O},a.addTopPainter=function(a){var b=this;b._44O||(b._44O=new bj),b._44O.contains(a)||(b._44O.add(a),b.redraw&&b.redraw())},a.removeTopPainter=function(a){var b=this;b._44O&&(b._44O.remove(a),b.redraw&&b.redraw())},a.addBottomPainter=function(a){var b=this;b._45O||(b._45O=new bj),b._45O.contains(a)||(b._45O.add(a),b.redraw&&b.redraw())},a.removeBottomPainter=function(a){var b=this;b._45O&&(b._45O.remove(a),b.redraw&&b.redraw())},a._93db=function(a,b){var c=this;c._45O&&c._45O.each(function(d){d.draw?d.draw(a,b):d.call(c,a,b)})},a._92db=function(a,b){var c=this;c._44O&&c._44O.each(function(d){d.draw?d.draw(a,b):d.call(c,a,b)})}},ms_sm:function(a,b){a.sm=function(){return this.getSelectionModel()},a.setSelectableFunc=function(a){this.sm().setFilterFunc(a)},a.getSelectableFunc=function(){return this.sm().getFilterFunc()},a.getSelectionModel=function(){var a=this;return a._selectionModel?a._selectionModel:a.dm().sm()},a.isSelectionModelShared=function(){return!this._selectionModel},a.setSelectionModelShared=function(a){var b=this,c=!b._selectionModel,d=b.handleSelectionChange,e=b.dm();c!==a&&(b.invalidateSelection&&b.invalidateSelection(),a?(e.sm().ms(d,b),b._selectionModel.ums(d,b),b._selectionModel.dispose(),b._selectionModel=i):(e.sm().ums(d,b),b._selectionModel=new gj(e),b._selectionModel.ms(d,b)),b.onSelectionModelSharedChanged(),b.fp("selectionModelShared",c,a))},a.onSelectionModelSharedChanged=function(){var a=this;a.redraw(),a.invalidateSelection&&a.invalidateSelection()},a.removeSelection=function(){var a=this.dm();a.beginTransaction(),this.sm().toSelection().each(a.remove,a),a.endTransaction()},a.selectAll=function(){var a=this;a.sm().ss(a.dm().toDatas(function(b){return a.isVisible(b)&&a.isSelectable(b)}))},a.isSelected=function(a){return this.sm().co(a)},a.isSelectedById=function(a){var b=this.dm().getDataById(a);return b?this.isSelected(b):!1},a.isSelectable=function(a){return this.sm().isSelectable(a)}},ms_tx:function(a,b){a._64I=0,a._65O=0,a.isScrollable=function(){return this.getWidth()<this._64I},a._40o=function(){return this.isScrollable()},a.getLogicalPoint=function(a){return ci(a,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},a.tx=function(a){return a===c?this.getTranslateX():void this.setTranslateX(a)},a.getTranslateX=function(){return this._65O},a.setTranslateX=function(a){var b=this,c=b.getWidth()-b._64I;c>a&&(a=c),a>0&&(a=0),a=A(a);var d=b._65O;b._65O=a,b.fp(Ob,d,a)}},ms_ty:function(a,b){a._23Q=0,a._66O=0,a._41o=function(){return this.getHeight()<this._23Q},a.getLogicalPoint=function(a){return ci(a,this._canvas||this._view,this.tx?this.tx():0,this.ty())},a.ty=function(a){return a===c?this.getTranslateY():void this.setTranslateY(a)},a.getTranslateY=function(){return this._66O},a.setTranslateY=function(a){var b=this,c=b.getHeight()-b._23Q;c>a&&(a=c),a>0&&(a=0),a=A(a);var d=b._66O;b._66O=a,b.fp(Pb,d,a)}},ms_txy:function(a,b){a._65O=0,a._66O=0,a.tx=function(a){return a===c?this.getTranslateX():void this.setTranslateX(a)},a.ty=function(a){return a===c?this.getTranslateY():void this.setTranslateY(a)},a.onTranslateEnded=function(){},a.setTranslate=function(a,b,c){var d=this;if(c=Sd(c)){d._65I&&d._65I.stop(!0);var e=d.tx(),f=d.ty();c.action=function(c){d.setTranslate(e+(a-e)*c,f+(b-f)*c)},c._37o=function(){delete d._66I,delete d._65I,d.onTranslateEnded()},d._66I=1,d._65I=Ih(c)}else d.tx(a),d.ty(b)},a.getTranslateX=function(){return this._65O},a.setTranslateX=function(a){var b=this;a=b.adjustTranslateX(a);
var c=b._65O;b._65O=a,b.fp(Ob,c,a)},a.getTranslateY=function(){return this._66O},a.setTranslateY=function(a){var b=this;a=b.adjustTranslateY(a);var c=b._66O;b._66O=a,b.fp(Pb,c,a)},a.adjustTranslateX=function(a){return A(a)},a.adjustTranslateY=function(a){return A(a)},a.translate=function(a,b,c){this.setTranslate(this.tx()+a,this.ty()+b,c)},a.getLogicalPoint=function(a){var b=this;return ci(a,this._canvas||b._view,b.tx(),b.ty())}},ms_dm:function(a,b){a.dm=function(a){return a?void this.setDataModel(a):this.getDataModel()},a.getDataModel=function(){return this._dataModel}},ms_lp:function(a,b){a.lp=function(a){return this.getLogicalPoint(a)}},ms_v:function(b,d){b._disabled=!1,b.setDisabled=function(a,b){var c=this,d=c._disabled;d!==a&&(d&&(fi(c._63O),delete c._63O),a&&(ve(c._view,c._63O=Ce(b)),c.iv()),c._disabled=a,c.fp("disabled",d,a))},b.isDisabled=function(){return this._disabled},b.getDisabledDiv=function(){return this._63O},b.getView=function(){return this._view},b.addToDOM=function(b){var c=this,d=c.getView(),e=d.style;b=b||h.body,b.appendChild(d),e.left="0",e.right="0",e.top="0",e.bottom="0",x(a,"resize",function(){c.iv()}),c.iv()},b.getWidth=function(){return this._view.clientWidth},b.getHeight=function(){return this._view.clientHeight},b.setWidth=function(a){var b=this;b._view.style.width=a+za,b.iv(),b.fp&&b.fp(La,i,a)},b.setHeight=function(a){var b=this;b._view.style.height=a+za,b.iv(),b.fp&&b.fp(Ma,i,a)},b.setFocus=function(a){var b=this,c=b._currentEditor;return a&&c&&(c.getView&&(c=c.getView()),c.contains(a.target))?!1:(Je(b._view),b.endEditing&&b.endEditing(),b.fireViewEvent("focus"),!0)},b.iv=function(a){this.invalidate(a)},b.invalidate=function(a){var b=this;b._68I||(b._68I=1,Dh(b.validate,b,i,a),b.onInvalidated&&b.onInvalidated(),b.fireViewEvent("invalidate"))},b.validate=function(){var a=this,b=a._view;if(a._68I&&(delete a._68I,b.parentNode))if(0===b.offsetWidth&&0===b.offsetHeight&&a._67I!==i)a._67I===c&&(a._67I=l.reinvalidateCount),a._67I>0?a._67I--:a._67I=i,a.iv();else{a.fireViewEvent("beginValidate"),a.validateImpl(),a.onValidated&&a.onValidated(),a.fireViewEvent("validate");var d=a._63O;d&&(b.lastChild!==d&&(fi(d),ve(b,d)),Le(d,0,0,a.getWidth(),a.getHeight())),nd(a),Pi(a),yo(a)}},b.layout=function(a,b,c,d){1===arguments.length?Le(this,a):Le(this,a,b,c,d)},b.addViewListener=function(a,b,c){var d=this;d._67O||(d._67O=new dj),d._67O.add(a,b,c)},b.removeViewListener=function(a,b){this._67O.remove(a,b)},b.fireViewEvent=function(a){var b=this;b._67O&&(Cd(a)&&(a={kind:a}),b._67O.fire(a)),l.viewListener&&l.viewListener(b,a)}},ms_tip:function(a,b){a.setToolTipEnabled=function(a){var b=this;a?ia||b._13o||(b.enableToolTip(),b.fp("toolTipEnabled",!1,!0)):b._13o&&(b.disableToolTip(),b.fp("toolTipEnabled",!0,!1))},a.isToolTipEnabled=function(){return!!this._13o},a.enableToolTip=function(){var a=this;if(!ia&&!a._13o){a._13o=function(b){var c=a.getToolTip(b);c!=i?l.toolTipContinual&&l.isToolTipShowing()?_g(b,c):(ah(),Ec={timeout:Z(Hc,Wg),e:b,info:c}):ah()};var b=a.getView();x(b,rc,a._13o),x(b,"mouseleave",l.hideToolTip)}},a.disableToolTip=function(){var a=this;if(a._13o){var b=a.getView();y(b,rc,a._13o),y(b,"mouseleave",l.hideToolTip),delete a._13o}},a.getToolTip=function(a){var b=this;if(b.getDataAt){var c=b.getDataAt(a);return c?c.getToolTip():i}return b.getValue?b.getValue():void 0}},_52o:function(a,b){a._zoom=1,a._29I=id,a.zoomIn=function(a,b){this.setZoom(this._zoom*qh,a,b)},a.zoomOut=function(a,b){this.setZoom(this._zoom/qh,a,b)},a.zoomReset=function(a,b){this.setZoom(1,a,b)},a.scrollZoomIn=function(a){this.setZoom(this._zoom*rh,i,a)},a.scrollZoomOut=function(a){this.setZoom(this._zoom/rh,i,a)},a.pinchZoomIn=function(a){this.setZoom(this._zoom*sh,i,a)},a.pinchZoomOut=function(a){this.setZoom(this._zoom/sh,i,a)},a.adjustZoom=function(a){return uh>a?uh:a>th?th:a},a.getZoom=function(){return this._zoom},a.setZoom=function(a,b,c){var d=this;if(b=Sd(b)){d._14o&&d._14o.stop(!0);var e=d._zoom;b.action=function(b){d._96O(e+(a-e)*b,c)},b._37o=function(){delete d._zooming,delete d._14o,d.onZoomEnded()},d._zooming=1,d._14o=Ih(b)}else d._96O(a,c)},a._96O=function(a,b){var c=this;if(a=c.adjustZoom(a),a!==c._zoom){c.validate();var d=c._29I,e=c._zoom;0!==d.width&&0!==d.height&&(b=b?b:{x:d.x+d.width/2,y:d.y+d.height/2},c.tx((b.x-d.x)*e-b.x*a),c.ty((b.y-d.y)*e-b.y*a)),c._zoom=a,c.fp("zoom",e,a)}}},ms_edge:function(a,b){a._2I=function(a){var b=this;b._44I||(b._44I=new bj),b._42I||(b._42I=new bj),b._44I.add(a),b._42I.add(a),b._20I()},a._4I=function(a){var b=this;b._44I||(b._44I=new bj),b._43I||(b._43I=new bj),b._44I.add(a),b._43I.add(a),b._20I()},a._16I=function(a){var b=this;b._44I.remove(a),b._42I.remove(a),b._44I.isEmpty()&&delete b._44I,b._42I.isEmpty()&&delete b._42I,b._20I()},a._18I=function(a){var b=this;b._44I.remove(a),b._43I.remove(a),b._44I.isEmpty()&&delete b._44I,b._43I.isEmpty()&&delete b._43I,b._20I()},a._20I=function(){var a=this;if(delete a._45I,!a._44I||a._44I.isEmpty())return void delete a._70O;var b;a._44I.each(function(c){c.isLooped()&&(b||(b={}),b[c._id]||(a._45I||(a._45I=new bj),a._45I.add(c),b[c._id]=c))}),b?(a._70O=new bj,a._44I.each(function(c){b[c._id]?"A"===b[c._id]||(b[c._id]="A",a._70O.add(c)):a._70O.add(c)})):a._70O=a._44I},a.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},a.getSourceAgentEdges=function(){return this._46I},a.getTargetAgentEdges=function(){return this._47I},a._1I=function(a){var b=this;b._46I||(b._46I=new bj),b._48I||(b._48I=new bj),b._46I.add(a),b._48I.add(a),b._19I()},a._3I=function(a){var b=this;b._47I||(b._47I=new bj),b._48I||(b._48I=new bj),b._47I.add(a),b._48I.add(a),b._19I()},a._15I=function(a){var b=this;b._46I.remove(a),b._48I.remove(a),b._46I.isEmpty()&&delete b._46I,b._48I.isEmpty()&&delete b._48I,b._19I()},a._17I=function(a){var b=this;b._47I.remove(a),b._48I.remove(a),b._47I.isEmpty()&&delete b._47I,b._48I.isEmpty()&&delete b._48I,b._19I()},a._19I=function(){var a=this;delete a._49I;var b=a._48I;if(b&&!b.isEmpty()){var c={};b.each(function(b){c[b._id]?a._49I||(a._49I=new bj):c[b._id]=b}),a._49I?b.each(function(b){c[b._id]&&(a._49I.add(b),delete c[b._id])}):a._49I=b}},a.getLoopedEdges=function(){return this._45I},a.getEdges=function(){return this._70O},a.getAgentEdges=function(){return this._49I},a.getSourceEdges=function(){return this._42I},a.getTargetEdges=function(){return this._43I},a._8I=function(){this._70O&&this._70O.each(function(a){a._7I()})}}};Td(l,{numberDigits:5,crossOrigin:"",baseZIndex:c,isTouchable:ia,devicePixelRatio:a.devicePixelRatio?a.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:o.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,clickDelay:200,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return Pe},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:ia?20:1,animDuration:200,animEasing:function(a){return a*a},labelColor:sg,labelSelectColor:tg,labelFont:(ia?"15":"12")+"px arial, sans-serif",widgetIndent:ia?30:20,widgetRowHeight:ia?30:20,widgetHeaderHeight:ia?32:22,widgetTitleHeight:ia?34:24,scrollBarColor:dg,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:ia?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:be,intersectionLineLine:ce,isEnter:jf,isEsc:kf,isDelete:Xe,isSpace:hf,isLeft:df,isUp:ef,isRight:ff,isDown:gf,getTarget:Ne,isString:Cd,isNumber:Dd,isBoolean:Ed,isArray:Hd,isSelectAll:We,isFunction:Gd,isObject:Fd,getPropertyValue:de,setPropertyValue:ee,addMethod:Td,getVersion:function(){return"7.0.3"},isMobile:function(){var b;return function(){return b!==c?b:(b=!1,function(a){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(b=!0)}(navigator.userAgent||navigator.vendor||a.opera),b)}}(),createGradient:function(a,b,c,d,e,f,g,h){var i=Rf[b];return i(a,c,d,e,f,g,h)},appendToScreen:function(a){a=a.getView?a.getView():a,(h.fullscreenElement||h.mozFullScreenElement||h.webkitFullscreenElement||h.msFullscreenElement||h.body).appendChild(a)},encodeString:function(a){return j.Math.encodeBase64(a,l.encodeStringKey)},decodeString:function(a){return j.Math.decodeBase64(a,l.encodeStringKey)},findView:function(a){var b=function(a,c){var d=c._ht;d&&a.push(d);var e=c.children,f=e.length;if(f)for(var g=0;f>g;g++)b(a,e[g])},c=[];b(c,h.body);var d=function(a,b){for(var d="2d"===b?Lj.GraphView:Tn.Graph3dView,e=0,f=a.length;f>e;e++)if(a[e]instanceof d)return c[e];return null};return"all"===a?c:"2d"===a?d(c,"2d"):"3d"===a?d(c,"3d"):d(c,"3d")||d(c,"2d")},toggleFullscreen:function(a){var b=a.getView();if(h.fullscreenElement||h.mozFullScreenElement||h.webkitFullscreenElement||h.msFullscreenElement)h.exitFullscreen?h.exitFullscreen():h.msExitFullscreen?h.msExitFullscreen():h.mozCancelFullScreen?h.mozCancelFullScreen():h.webkitExitFullscreen&&h.webkitExitFullscreen();else{var c=!0;if(a.isSelfViewEvent){var d=a.getX(),e=a.getY(),f=a.getWidth(),g=a.getHeight(),i=b.style.background,k=b.style.backgroundColor;i||k||(b.style.backgroundColor="white"),b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen();var l=setInterval(function(){if(b!==(h.fullscreenElement||h.mozFullScreenElement||h.webkitFullscreenElement||h.msFullscreenElement))clearInterval(l),a.setX(d),a.setY(e),a.setWidth(f),a.setHeight(g),a._fullscreen=!1,b.style.oldBackgroundColor=k,a.iv();else{var i=j.Default.getWindowInfo();(c||i.width!==a.getWidth()||i.height!==a.getHeight())&&(a.setX(i.left),a.setY(i.top),a.setWidth(i.width),a.setHeight(i.height),a._fullscreen=!0,a.iv(),c=!1)}},500)}else{var m=b.style.left,n=b.style.top,f=b.style.width,g=b.style.height,i=b.style.background,k=b.style.backgroundColor;i||k||(b.style.backgroundColor="white"),b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen();var l=setInterval(function(){if(b!==(h.fullscreenElement||h.mozFullScreenElement||h.webkitFullscreenElement||h.msFullscreenElement))clearInterval(l),b.style.left=m,b.style.top=n,b.style.width=f,b.style.height=g,b.style.oldBackgroundColor=k,a.iv();else{var d=j.Default.getWindowInfo();(c||d.width!==a.getWidth()||d.height!==a.getHeight())&&(Le(a),c=!1)}},500)}}},appendTimeStamp:function(a){return a},setCompType:function(a,b){Gd(b)||Fd(b)?Wc[a]=b:Qi(a)},getCompType:function(a){var b=Wc[a];return b===c&&$c.test(a)&&Qi(a),b},getCompTypeMap:function(){return Wc},drawCompType:function(a,b,c,d,e,f){a(b,c,d,e,f)},numberListener:function(){var a={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(b){var c=b.keyCode;a[c]||65===c&&l.isCtrlDown(b)||86===c&&l.isCtrlDown(b)||67===c&&l.isCtrlDown(b)||88===c&&l.isCtrlDown(b)||c>=35&&40>=c||(b.shiftKey||48>c||c>57)&&(96>c||c>105)&&b.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(a){var b=a.target.tagName;("DIV"===b||"CANVAS"===b)&&!(l.ignoreKeyCodes.indexOf(a.keyCode)>=0)&&("keydown"!==a.type||df(a)||ff(a)||ef(a)||gf(a)||Xe(a)||65===a.keyCode&&(a.metaKey||a.ctrlKey))&&(a.preventDefault(),a.preventManipulation&&a.preventManipulation())},getWindowInfo:function(){var b=h.documentElement,c=b&&(b.scrollLeft||b.scrollTop)?b:h.body;return{target:c,left:c.scrollLeft,top:c.scrollTop,width:a.innerWidth||c.clientWidth,height:a.innerHeight||c.clientHeight}},isDragging:function(){return!!Pe},isLeftButton:function(a){return ia?!0:0===a.button},isMiddleButton:function(a){return ia?!1:a&&(1===a.button||4&(a.buttons||0))},isInput:function(a){if(!a)return!1;var b=a.tagName;return"INPUT"===b||"TEXTAREA"===b||"SELECT"===b},getTouchCount:function(a){return ia?a.touches.length:1},isDoubleClick:function(){function a(a){a.details=0,a.timeout=null,a.lastPoint=null}var b={};return Oc=new S,Pc=Oc.getTime(),function(d){if(d.touches&&d.touches.length>1)return!1;var e=d.button==i?"":d.button,f=d.type+e,g=f+"_isDoubleClick",h=b[f];if(h||(h=b[f]={details:0,timeout:null,lastPoint:null}),d[g]===c){d[g]=!0;var j=Th(d);h.timeout&&($(h.timeout),h.timeout=null),h.lastPoint&&Vh(h.lastPoint,j)>l.doubleClickRange&&a(h),h.lastPoint=j,h.details++,h.timeout=Z(function(){a(this)}.bind(h),500)}return 2===h.details}}(),isShiftDown:function(a){return a?a.shiftKey:Vc[16]},isCtrlDown:function(a){return a?ha?a.metaKey:a.ctrlKey:ha?Vc[91]:Vc[17]},getClientPoint:function(a){return ia&&(a=Me(a)),{x:a.clientX,y:a.clientY}},isMouseEvent:function(a){return a instanceof MouseEvent||0===a.type.indexOf("mouse")},getTargetElement:function(a){if(l.isMouseEvent(a)||!h.elementFromPoint)return a.target;var b=Uh(a);return h.elementFromPoint(b.x,b.y)},getPagePoint:function(a){return ia&&(a=Me(a)),{x:a.pageX,y:a.pageY}},createObject:function(a,b){var c=new a;for(var d in b){var e=b[d];if(Gd(e))c[d]=e;else if(0===d.indexOf("s:"))c.s(d.substr(2),b[d]);else if(0===d.indexOf("a:"))c.a(d.substr(2),b[d]);else{var f=Bd(d),e=b[d];c[f]?(c[f](e),"setToolTip"===f&&c.enableToolTip&&c.enableToolTip()):c[d]=e}}return c},setImage:function(a,b,c,d){var e=arguments.length;4===e?od(a,d,b,c):2===e?Cd(b)?od(a,b):md(a,b):1===e&&od(a,a)},getImage:function(a,b,d){var e;if(a==i)return i;if(Fd(a)?e=a:(e=Rc[a],a&&e===c&&(kd&&kd[a]||od(a,a))),b&&e&&e.tagName){var f;f="override"===d?"colors_override":"override_rgb"===d?"colors_override_rgb":"override_a"===d?"colors_override_a":"colors",e[f]||(e[f]={__count__:0});var g=e[f][b];return g||(e[f].__count__>l.imageCacheThreshold&&(e[f]={__count__:0}),g=sf(e,rf(b),e.width,e.height,d),e[f][b]=g,e[f].__count__++),g}return e},isImageComplete:function(a,b,d){var e=yh(a);if(!e)return!1;if(e.tagName)return e.complete;for(var f,a,g,h=e.comps,i=!0,j=0,k=h.length;k>j;j++)if(f=h[j],g=f.type,"image"===f.type){a=f.name,a&&a.func&&(a=_i(a,b));var m=zh(a,b,d);if(!m){i=!1;break}}else if($c.test(g)&&l.getCompType(g)===c){i=!1,Qi(g);break}return i},getId:function(){var a=1;return function(){return++a}}(),callLater:function(b,c,d,e){var f=function(){b.apply(c,d)};return e?Z(f,e):a.requestAnimationFrame(f)},cancelLater:function(b,c){c?$(b):a.cancelAnimationFrame(b)},clone:function(a){if(null==a||"object"!=typeof a)return a;if(a instanceof Date){var c=new Date;return c.setTime(a.getTime()),c}if(a instanceof Array){for(var c=[],d=0,e=a.length;e>d;d++)c[d]=Gh(a[d]);return c}if(a instanceof bj){for(var c=new bj,d=0,e=a.length;e>d;d++)c.set(d,Gh(a.get(d)));return c}if(a instanceof ej)return a;if(a instanceof b){var c={};for(var f in a)a.hasOwnProperty(f)&&(c[f]=Gh(a[f]));return c}return a},callWhenLoaded:function(a,b){b=b||100;var c=Nc(a,b);Mc||(Mc={}),Mc[c]={tick:c,cb:a,delay:b}},beforeLoadURL:function(a){if(Mc){var b={};for(var c in Mc){var d=Mc[c];$(d.tick);var e=Nc(d.cb,d.delay);b[e]={tick:e,delay:d.delay,cb:d.cb}}Mc=b}return l.convertURL?l.convertURL(a):a},convertURL:function(a){return a},handleRefGraphLoaded:function(a,b,c){},handleCompTypeLoaded:function(a,b){},handleImageLoaded:function(a,b){},handleUnfoundImage:function(a,b){return l.getImage("default_blank")},sortFunc:function(a,b){if(a===b)return 0;if(a==i&&b!=i)return 1;if(a!=i&&b==i)return-1;if(a==i&&b==i)return 0;var d,e=typeof a,f=typeof b;return e===hc&&f===hc?d=a.localeCompare(b):e===lc&&f===lc&&(d=a-b),d===c&&(d=(""+a).localeCompare(""+b)),d>0?1:0>d?-1:0},getClassMap:function(){return Qc},getClass:function(b){if(Cd(b)){var c,d=Qc[b];if(!d){c=b.split("."),d=a;for(var e=0;e<c.length;e++)d=d[c[e]];Qc[b]=d}return d}return b},def:function(a,b,c){var d,e,f,g=function(){};if(g.prototype=b.prototype,d=new g,Cd(a)){if(Qc[a])throw"'"+a+"' already defined";f=Hh(a),d.getClassName=function(){return a}}else f=a;if(d.constructor=f,d.getClass=function(){return f},d.getSuperClass=function(){return b},c)for(e in c)Ug[e]&&Ug.hasOwnProperty(e)?Ug[e](d,c):_f(d,c,e);f.prototype=d,f.superClass=b.prototype},startAnim:function(){var a=function(a){a.duration&&(a.startTime=qd()),a.timeId=Dh(a.tick,i,i,a.interval)};return function(b){return b=Gh(b),b.easing=b.easing||l.animEasing,b.duration||b.frames||(b.duration=l.animDuration),b.t=0,b.duration?b.interval=0:(b.frame=0,b.interval=b.interval||10),b.tick=function(){if(b.duration){var a=(qd()-b.startTime)/b.duration;if(a>1&&(a=1),b.t=a,b.action(b.easing(a),a),!b.isRunning())return;1===a?b.stop():b._isPaused||(b.timeId=Dh(b.tick))}else{if(b.frame++,a=b.t=b.frame/b.frames,b.action(b.easing(a),a),!b.isRunning())return;b.frame<b.frames?b._isPaused||(b.timeId=Dh(b.tick,i,i,b.interval)):b.stop()}},b.resume=function(){b._isPaused&&(delete b._isPaused,b.duration?b.t<1&&(b.startTime=qd()-b.duration*b.t,b.timeId=Dh(b.tick)):b.frame<b.frames&&(b.timeId=Dh(b.tick,i,i,b.interval)))},b.pause=function(){Eh(b.timeId,!b.duration),b._isPaused=!0},b.isPaused=function(){return this._isPaused},b.stop=function(a){b.isRunning()&&(Eh(b.timeId,!b.duration),delete b.timeId,b.duration?b.t<1&&a&&(b.t=1,b.action(b.easing(1),1)):b.frame<b.frames&&a&&(b.frame=b.frames,b.action(b.easing(1),1)),b._37o&&b._37o(),b.finishFunc&&b.finishFunc())},b.isRunning=function(){return b.timeId!=i},b.delay?Dh(a,i,[b],b.delay):a(b),b}}(),getTextSize:function(){var a={},b=h?re().getContext("2d"):i;return function(c,d){b.font=c?c:gh;var e=a[b.font];return e||(e=2*b.measureText("e").width+4,a[b.font]=e),{width:b.measureText(d).width+4,height:e}}}(),drawText:function(a,b,c,d,e,f,g,h,j,k){if(b!=i){var l=Mh(c,b),m={};k&&k!==ua?k===qa?m.y=f+l.height/2:m.y=f+h-l.height/2:m.y=f+h/2,j&&j!==oa?j===pa?m.x=e+g-l.width/2:m.x=e+g/2:m.x=e+l.width/2,ye(a,b,m,c,d)}},getDistance:function(a,b){var d=a.length;return b?D(3===d?Y(a[0]-b[0])+Y(a[1]-b[1])+Y(a[2]-b[2]):2===d?Y(a[0]-b[0])+Y(a[1]-b[1]):a.z===c?Y(b.x-a.x)+Y(b.y-a.y):Y(b.x-a.x)+Y(b.y-a.y)+Y(b.z-a.z)):3===d?D(Y(a[0])+Y(a[1])+Y(a[2])):2===d?D(Y(a[0])+Y(a[1])):void 0},brighter:function(a,b){return 0>b&&(b=-b),Cf(a,b?b:40)},darker:function(a,b){return b>0&&(b=-b),Cf(a,b?b:-40)},unionPoint:function(a,b){if(!a)return i;if(2===arguments.length)return a&&b?{x:F(a.x,b.x),y:F(a.y,b.y),width:G(a.x-b.x),height:G(a.y-b.y)}:i;var d=a;if(d._as&&(d=d._as),d.length===c)return i;var e=d.length;if(0>=e)return i;for(var f=1,g=d[0],h={x:g.x,y:g.y,width:0,height:0};e>f;f++){g=d[f];var j=F(h.x,g.x),k=E(h.x+h.width,g.x),l=F(h.y,g.y),m=E(h.y+h.height,g.y);h.x=j,h.y=l,h.width=k-j,h.height=m-l}return h},unionRect:function(a,b){if(a&&!b)return Gh(a);if(!a&&b)return Gh(b);if(a&&b){var c={x:F(a.x,b.x),y:F(a.y,b.y)};return c.width=E(a.x+a.width,b.x+b.width)-c.x,c.height=E(a.y+a.height,b.y+b.height)-c.y,c}return i},containsPoint:function(a,b,c,d){if(d!=i&&1!==d){var e=a.x+a.width/2,f=a.y+a.height/2;a={x:e-a.width/2*d,y:f-a.height/2*d,width:a.width*d,height:a.height*d}}if(c){var g=a.width/2,h=a.height/2,j=J(-c),k=H(-c),l=b.x-a.x-g,m=b.y-a.y-h;return b={x:k*l-j*m,y:j*l+k*m},Yh({x:-g,y:-h,width:a.width,height:a.height},b)}return!(!a||b.x<a.x||b.y<a.y||b.x>a.x+a.width||b.y>a.y+a.height)},containsRect:function(a,b){if(!a||!b)return!1;var c=b.x,d=b.y,e=b.width,f=b.height,g=a.width,h=a.height;if(0>(g|h|e|f))return!1;var i=a.x,j=a.y;if(i>c||j>d)return!1;if(g+=i,e+=c,c>=e){if(g>=i||e>g)return!1}else if(g>=i&&e>g)return!1;if(h+=j,f+=d,d>=f){if(h>=j||f>h)return!1}else if(h>=j&&f>h)return!1;return!0},intersectsRect:function(a,b){if(!a||!b)return!1;var c=b.width,d=b.height,e=a.width,f=a.height;if(0>=e||0>=f||0>=c||0>=d)return!1;var g=b.x,h=b.y,i=a.x,j=a.y;return e+=i,f+=j,c+=g,d+=h,e>g&&f>h&&c>i&&d>j},intersection:function(a,b){if(!a||!b)return i;var c=b.x,d=b.y,e=a.x,f=a.y,g=c,h=d,j=e,k=f;return g+=b.width,h+=b.height,j+=a.width,k+=a.height,e>c&&(c=e),f>d&&(d=f),g>j&&(g=j),h>k&&(h=k),g-=c,h-=d,0>=g||0>=h?i:{x:c,y:d,width:g,height:h}},grow:function(a,b,d){d===c&&(d=b),a.x-=b,a.y-=d,a.width=a.width+2*b,a.height=a.height+2*d},getScreenPoint:function(a,b,c,d,e,f,g){var h=c.getBoundingClientRect(),i=a*(f||1)-c.scrollLeft+(d||0),j=b*(g||1)-c.scrollTop+(e||0),k=Zf(c,!1);if(k){var l=new Kg(i,j,0);return l.applyMatrix4(k),console.log(l),{x:l.x,y:l.y}}return{x:i+h.left,y:j+h.top}},getLogicalPoint:function(a,b,c,d,e,f){var g,h,i=b.getBoundingClientRect();a.target?(Sh(a)?ha?Vc[91]=!0:Vc[17]=!0:ha?Vc[91]=!1:Vc[17]=!1,Rh(a)?Vc[16]=!0:Vc[16]=!1,a=ia?Me(a):a,g=a.clientX,h=a.clientY):(g=a.x,h=a.y);var j=Zf(b,!0);if(j){var k=new Kg(g,h,0);k.applyMatrix4(j);do{if(Math.abs(k.z)<=1e-6)break;var l=new Kg(g,h,1);if(l.applyMatrix4(matrix),Math.abs(l.z)<=1e-6){k=l;break}if(l.sub(k),Math.abs(l.z)<=1e-6)break;k.addScaledVector(l,-k.z/l.z)}while(!1);return{x:(k.x+b.scrollLeft-(c||0))/(e||1),y:(k.y+b.scrollTop-(d||0))/(f||1)}}return{x:(g-i.left+b.scrollLeft-(c||0))/(e||1),y:(h-i.top+b.scrollTop-(d||0))/(f||1)}},removeHTML:function(){var a;return function(b){return b&&b.getView&&(b=b.getView()),b&&b.parentNode?a===b?!0:(a=b,b.parentNode.removeChild(b),a=i,!0):!1}}(),getToolTipDiv:function(){if(!Cc){Cc=qe(),Dc=qe();var a=Cc.style;l.baseZIndex!=i&&(a.zIndex=V(l.baseZIndex)+3+""),a.whiteSpace="nowrap",a.color=l.toolTipLabelColor,a.background=l.toolTipBackground,a.font=l.toolTipLabelFont,a.padding="5px",a.boxShadow="0px 0px 3px "+l.toolTipShadowColor}return Cc},isToolTipShowing:function(){return Cc&&Cc.parentNode?!0:Dc&&Dc.parentNode?!0:!1},hideToolTip:function(){fi(Cc),fi(Dc),Gc()},showToolTip:function(a,b){if(!a||b==i)return void ah();l.getToolTipDiv();var c,d;if(b.html?(b=b.html,c=Dc,fi(Cc)):(c=Cc,fi(Dc)),d=c.style,c.innerHTML=b,c.parentNode||j.Default.appendToScreen(c),a.target){a=Uh(a);var e=ai(),f=a.x,g=a.y,h=ia?60:12;if(ia){var k=c.getBoundingClientRect();d.left=f-k.width/2+za,g-k.height-h<e.top?d.top=g+h+za:d.top=g-k.height-h+za}else{d.left=f+h+za,d.top=g+h+za;var k=c.getBoundingClientRect();k.left+k.width>e.width&&(d.left=f-h-k.width+za),k.top+k.height>e.height&&(d.top=g-h-k.height+za),k.left<0&&(d.left=f+h+za),k.top<0&&(d.top=g+h+za)}}else d.left=a.x+za,d.top=a.y+za;Gc()},startDragging:function(b,d,e){e==c&&(e=!0),b!==Pe&&(Pe?e&&(ia?Pe.handleWindowTouchEnd(d):Pe.handleWindowMouseUp(d)):ia?(x(a,vc,Qe),x(a,wc,Re)):(x(a,rc,Se),x(a,sc,Te)),Pe=b)},getImageMap:function(){return Rc},toBoundaries:function(a,b,c,d){var e=[];return Af(a,b,c,d).forEach(function(a){var b=[];a.forEach(function(a){b.push(a.x,a.y)}),e.push(b)}),e},getCurrentKeyCodeMap:function(){return Vc},drawCenterImage:function(a,b,c,d,e,f,g,h){!e&&f&&f.isSelfViewEvent&&(e=f);var i=Zi(b,e,f),j=$i(b,e,f);aj(a,b,A(c-i/2),A(d-j/2),i,j,e,f,g,h)},drawStretchImage:function(a,b,c,d,e,f,g,h,i,j,k,l){!h&&i&&i.isSelfViewEvent&&(h=i);var m,n=Zi(b,h,i,f),o=$i(b,h,i,g);"uniform"===c?(m=F(f/n,g/o),n*=m,o*=m,d+=A((f-n)/2),e+=A((g-o)/2),f=n,g=o):"centerUniform"===c&&((n>f||o>g)&&(m=F(f/n,g/o),n*=m,o*=m),d+=A((f-n)/2),e+=A((g-o)/2),f=n,g=o);var p=a.interactiveInfo;if(p){var q;if(q="center"===c?{x:d+f/2-n/2,y:e+g/2-o/2,width:n,height:o}:{x:d,y:e,width:f,height:g},p.rect){var r=p.compInfos,s=r.length;s&&(r[s-1].rect.image=b)}else p.rect=q}if("center"===c){var t=k!==!1&&(n>f||o>g);t&&(a.save(),a.beginPath(),a.rect(d,e,f,g),a.clip()),aj(a,b,d+f/2-n/2,e+g/2-o/2,n,o,h,i,j,l),t&&a.restore()}else aj(a,b,d,e,f,g,h,i,j,l)},toCanvas:function(a,b,c,d,e,f,g,h,i){a=yh(a,g),b=b||Zi(a,e),c=c||$i(a,e);var j=re(),k=De(j);return h?(ue(j,b,c,h),k.scale(h,h)):ue(j,b,c,1),Bh(k,a,d,0,0,b,c,e,f,g,i),a&&a.clampToEdge&&(j.clampToEdge=a.clampToEdge),k.restore(),j},toGrayColor:function(a){if(!a)return a;var b=qf(a),c=.299*b[0]+.587*b[1]+.114*b[2];return"rgba("+c+","+c+","+c+","+b[3]/255+")"},createGradientImage:function(a,b,c,d){for(var e=["L",0,0,a,0,1,0,0,1,0,0],f=0,g=Math.min(b.length,c.length);g>f;f++)e.push(c[f],b[f]);var h=j.Default.toCanvas({width:a,height:a,clampToEdge:!0,comps:[{type:"shape",rotation:d||0,points:[0,0,a,0,a,a,0,a],background:"#ffffff",gradientPack:e}]});return h},createElement:function(a,b,c,d){var e=h.createElement(a);return se(e,b||o.widgetBorder,2),e.style.font=c?c:gh,d!=i&&(e.value=d),l.onElementCreated&&l.onElementCreated(e),e},containedInView:function(a,b){var c=Ke(b).getBoundingClientRect();return Yh({x:c.left,y:c.top,width:c.width,height:c.height},Th(a))},isIsolating:function(){return Lc>0},setIsolating:function(a){a?Lc++:Lc--},getMSMap:function(){return Ug},stringify:function(a,b,c){var d=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var e=JSON.stringify(a,function(a,b){return"function"==typeof b?"__ht__"+(b.__ht__||b.toString()):Dd(b)?Qd(b):b instanceof j.List?"__ht__list"+(b.__ht__list||l.stringify(b._as)):b},b==i?2:b);return Date.prototype.toJSON=d,c&&(e="__ht__encode"+l.encodeString(e)),e},parse:function(a){return Cd(a)&&("__ht__encode"!=a.substr(0,12)||(a=l.decodeString(a.substr(12)),Cd(a)))?JSON.parse(a,function(a,b){if(Cd(b))if("__ht__function"==b.substr(0,14)){var c=b.indexOf("{")+1,d=b.lastIndexOf("}"),e=b.indexOf("(")+1,f=b.indexOf(")");if(c&&d&&e&&f){var g=new Function(b.substring(e,f),b.substring(c,d));return g.__ht__=b.substr(6),g}}else{if("__ht__date"==b.substr(0,10))return new Date(V(b.substr(10)));if("__ht__list"===b.substr(0,10))return new bj(l.parse(b.substr(10)))}return b}):a},loadJS:function(a,b){b&&a.push(b);var c=a.shift();if(Hd(c))a=c.contact(a),l.loadJS(a);else if(Gd(c))c(),l.loadJS(a);else if(Cd(c)){var d=h.createElement("script");d.onload=function(){l.loadJS(a)},d.setAttribute("src",c),h.getElementsByTagName("head")[0].appendChild(d)}else a.length&&l.loadJS(a)},toRoundedCorner:function(a,b){var c=a.size();if(0>=b)return{points:a};var d,e=new bj,f=new bj,g=a.get(0);e.add(g),f.add(1);for(var h=1;c>h;h++)if(c>h+1){var i=a.get(h),j=a.get(h+1),k=g.x,l=g.y,m=i.x,n=i.y,o=n-l,p=m-k,q=Q(o,p);d=F(.99*Vh(g,i),b),e.add({x:m-d*H(q),y:n-d*J(q)}),e.add(i),k=i.x,l=i.y,m=j.x,n=j.y,o=n-l,p=m-k,q=Q(o,p),d=F(.99*Vh(i,j),b),g={x:k+d*H(q),y:l+d*J(q)},e.add(g),f.addAll([2,3])}else e.add(a.get(h)),f.add(2);return{points:e,segments:f}},toColorData:qf,setCanvas:ue,createDiv:qe,createDisabledDiv:Ce,createView:pe,createCanvas:re,appendChild:ve,initContext:De,checkLoadingImage:nd,translateAndScale:Ee,layout:Le,getPosition:bg,drawPoints:zf,drawRoundRect:Jf,drawBorder:Kf,setFocus:Je,getter:Ad,setter:Bd,isEmptyObject:Xd,cameraPriority:function(){var a={skybox:0,main:1e4,top:1e7};return b.seal(b.defineProperties({},{skybox:{configurable:!1,enumerable:!1,get:function(){return a.skybox},set:function(b){if(b>=a.main)throw new RangeError("Skybox camera must have lower priority than the main camera.");a.skybox=Number(b)}},main:{configurable:!1,enumerable:!1,get:function(){return a.main},set:function(b){if(b<=a.skybox)throw new RangeError("Main camera must have higher priority than the skybox camera.");if(b>=a.top)throw new RangeError("Main camera must have lower priority than the top camera.");a.main=Number(b)}},top:{configurable:!1,enumerable:!1,get:function(){return a.top},set:function(b){if(b<=a.main)throw new RangeError("Top camera must have higher priority than the main camera.");a.top=Number(b)}}}))}()},!0),Td(p,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Vg=l.disabledOpacity,Wg=l.toolTipDelay,Xg=l.devicePixelRatio,Yg=l.autoMakeVisible,Zg=l.autoHideScrollBar,$g=l.imageGradient,_g=l.showToolTip,ah=l.hideToolTip,bh=l.dashPattern,ch=l.lineCap,dh=l.lineJoin,eh=l.labelColor,fh=l.labelSelectColor,gh=l.labelFont,hh=l.widgetIndent,ih=l.widgetRowHeight,jh=l.widgetHeaderHeight,kh=l.widgetTitleHeight,lh=l.scrollBarColor,mh=l.scrollBarSize,nh=l.scrollBarTimeout,oh=l.scrollBarMinLength,ph=l.scrollBarInteractiveSize,qh=l.zoomIncrement,rh=l.scrollZoomIncrement,sh=l.pinchZoomIncrement,th=l.zoomMax,uh=l.zoomMin,vh=l.createObject,wh=l.preventDefault,xh=l.setImage,yh=l.getImage,zh=l.isImageComplete,Ah=l.drawCenterImage,Bh=l.drawStretchImage,Ch=l.getId,Dh=l.callLater,Eh=l.cancelLater,Fh=l.sortFunc,Gh=l.clone,Hh=l.getClass,Ih=l.startAnim,Jh=l.brighter,Kh=l.darker,Lh=l.drawText,Mh=l.getTextSize,Nh=l.isLeftButton,Oh=l.isMiddleButton,Ph=l.getTouchCount,Qh=l.isDoubleClick,Rh=l.isShiftDown,Sh=l.isCtrlDown,Th=l.getClientPoint,Uh=l.getPagePoint,Vh=l.getDistance,Wh=l.unionPoint,Xh=l.unionRect,Yh=l.containsPoint,Zh=l.containsRect,$h=l.intersectsRect,_h=l.intersection,ai=l.getWindowInfo,bi=l.grow,ci=l.getLogicalPoint,di=l.getScreenPoint,ei=l.startDragging,fi=l.removeHTML,gi=l.createElement,hi=l.segmentResolution,ii=l.shapeResolution,ji=l.shapeSide,ki=l.def,li=function(a,b,c){ki(g+"."+a,b,c)},mi=function(a,b){a.childNodes.forEach(function(a){b(a),mi(a,b)})};Td(l,{toolTipLabelColor:eh,toolTipLabelFont:gh,toolTipBackground:o.toolTipBackground,toolTipShadowColor:dg,drawBreakableText:xe,setDevicePixelRatio:function(b){Xg=l.devicePixelRatio="number"==typeof b?b:a.devicePixelRatio,mi(h.body,function(a){var b=a._ht;b&&b._canvas&&(ue(b._canvas,b.getWidth(),b.getHeight()),b.redraw?b.redraw():b.iv())})}},!0);var ni=1e-6,oi="undefined"!=typeof Uint16Array?Uint16Array:Array,pi="undefined"!=typeof Float32Array?Float32Array:Array,qi=function(a,b,c){var d=[a[0]-b[0],a[1]-b[1],a[2]-b[2]];if(c){var e=Vh(d);e>0&&(d[0]/=e,d[1]/=e,d[2]/=e)}return d},ri=function(){var b="charCodeAt",c=2*(2*Aa.length+1);for(var d in a)if(d===g+oa[0]+(za.length+2)){var e=a[d];if(!e)break;for(var f=e.length,h=0;f>h;h++)if(e[h][b](0)===c&&e[h+1]!=i&&e[h+1]===za[0]&&e[h+2]!=i&&e[h+2][b](0)===c){for(var j=h+3;f>j;j++)if(e[j][b](0)===c){if(0==e[j+1])for(var k,l=j+2;f>l;l++){if(e[l][b](0)===c){0==e[l-1]&&k&&(ca=k.substr(0,k.length-1));break}k==i?k=e[l]:k+=e[l]}break}break}break}return function(a){return[-a[0],-a[1],-a[2]]}}(),si=function(a,b){return 3===a.length?a[0]*b[0]+a[1]*b[1]+a[2]*b[2]:a[0]*b[0]+a[1]*b[1]},ti=function(){var a=new pi(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},ui=ti(),vi=function(a){var b=new pi(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],
b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},wi=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},xi=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},yi=function(a,b){var c=a[0],d=a[1],e=a[2];return a[0]=b[0]*c+b[4]*d+b[8]*e+b[12],a[1]=b[1]*c+b[5]*d+b[9]*e+b[13],a[2]=b[2]*c+b[6]*d+b[10]*e+b[14],a},zi=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3];return a[0]=b[0]*c+b[4]*d+b[8]*e+b[12]*f,a[1]=b[1]*c+b[5]*d+b[9]*e+b[13]*f,a[2]=b[2]*c+b[6]*d+b[10]*e+b[14]*f,a[3]=b[3]*c+b[7]*d+b[11]*e+b[15]*f,a},Ai=function(){var a,b,c,d,e=Ud($e[1]+$e[7]),f=Ud($e[0]+$e[3]-$e[10]),g=Ud($e[8]+2),h=function(){return b=c.charAt(a),a+=1,b},i=function(){var a="";if(b===g)for(;h();){if(b===g)return h(),a;a+=b}else h()},j=function(){for(;b&&" ">=b;)h()},k=function(){var a,c={};if(b===e){if(h(),j(),b===f)return h(),c;for(;b;){if(a=i(),j(),h(),c[a]=d(),j(),b===f)return h(),c;h(),j()}}};return d=function(){switch(j(),b){case e:return k();default:return i()}},function(e){if(t={},e){var f;if(c=e,a=0,b=" ",f=d(),j(),!b)return f}}}(),Bi=function(a,b){if(b){var c=J(b),d=H(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];a[4]=e*d+i*c,a[5]=f*d+j*c,a[6]=g*d+k*c,a[7]=h*d+l*c,a[8]=i*d-e*c,a[9]=j*d-f*c,a[10]=k*d-g*c,a[11]=l*d-h*c}},Ci=function(a,b){if(b){var c=J(b),d=H(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d}},Di=function(a,b){if(b){var c=J(b),d=H(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];a[0]=e*d+i*c,a[1]=f*d+j*c,a[2]=g*d+k*c,a[3]=h*d+l*c,a[4]=i*d-e*c,a[5]=j*d-f*c,a[6]=k*d-g*c,a[7]=l*d-h*c}},Ei=function(a,b,c){return Fi(i,c===!1?i:a.getFinalScale3d(),a.getFinalRotation3d(),a.getRotationMode(),a.p3(),i,b)},Fi=function(a,b,c,d,e,f,g){return f||(f=ti()),e&&Wm(f,e),Xk(f,c,d),g&&Ym(f,f,g),b&&Xm(f,b),a&&Ym(f,f,a),f},Gi=function(a,b,c){b=V(b),c=V(c);var d=this;d.g=a,d._84O=b,d._85O=c,d._70I=!0,d.F=0,d._83O=b+c,d.pen={x:0,y:0}},Hi="lineDashOffset",Ii="setLineDash",Ji=function(a){for(var b in a)1===b.length&&(Hi=a[b]);return b?1:0},Ki=function(a,b,c){return Yd(b)?a:a[Ii]?(a[Ii](b),c&&(a.lineDashOffset=c),a):new Gi(a,b[0],b.length>1?b[1]:b[0])},Li=function(a,b){!Yd(b)&&a[Ii]&&(a[Ii](bd),a.lineDashOffset=0)};if(ki(Gi,b,{_69I:6,moveTo:function(a,b){var c=this,d=c.pen;d.x=a,d.y=b,c.g.moveTo(a,b),c.start||(c.start={x:a,y:b})},lineTo:function(a,b){var c=this,d=c.pen,e=a-d.x,f=b-d.y,g=Q(f,e),h=H(g),i=J(g),j=c._23O(d.x,d.y,a,b),k=c._85O,l=c._84O,m=c._83O;if(c.F){if(c.F>j)return c._70I?c._72I(a,b):c.moveTo(a,b),void(c.F-=j);if(c._70I?c._72I(d.x+h*c.F,d.y+i*c.F):c.moveTo(d.x+h*c.F,d.y+i*c.F),j-=c.F,c.F=0,c._70I=!c._70I,!j)return}var n=B(j/m);if(n){for(var o=h*l,p=i*l,q=h*k,r=i*k,s=0;n>s;s++)c._70I?(c._72I(d.x+o,d.y+p),c.moveTo(d.x+q,d.y+r)):(c.moveTo(d.x+q,d.y+r),c._72I(d.x+o,d.y+p));j-=m*n}c._70I?j>l?(c._72I(d.x+h*l,d.y+i*l),c.moveTo(a,b),c.F=k-(j-l),c._70I=!1):(c._72I(a,b),j===l?(c.F=0,c._70I=!c._70I):(c.F=l-j,c.moveTo(a,b))):j>k?(c.moveTo(d.x+h*k,d.y+i*k),c._72I(a,b),c.F=l-(j-k),c._70I=!0):(c.moveTo(a,b),j===k?(c.F=0,c._70I=!c._70I):c.F=k-j)},quadraticCurveTo:function(a,b,c,d){var e,f=this,g=f.pen,h=g.x,i=g.y,j=f._22O(h,i,a,b,c,d),k=0,l=0,m=f._85O,n=f._84O;if(f.F){if(f.F>j)return f._70I?f._71I(a,b,c,d):f.moveTo(c,d),void(f.F-=j);if(k=f.F/j,e=f._20O(h,i,a,b,c,d,k),f._70I?f._71I(e[2],e[3],e[4],e[5]):f.moveTo(e[4],e[5]),f.F=0,f._70I=!f._70I,!j)return}var o=j-j*k,p=B(o/f._83O),q=n/j,r=m/j;if(p)for(var s=0;p>s;s++)f._70I?(l=k+q,e=f._21O(h,i,a,b,c,d,k,l),f._71I(e[2],e[3],e[4],e[5]),k=l,l=k+r,e=f._21O(h,i,a,b,c,d,k,l),f.moveTo(e[4],e[5])):(l=k+r,e=f._21O(h,i,a,b,c,d,k,l),f.moveTo(e[4],e[5]),k=l,l=k+q,e=f._21O(h,i,a,b,c,d,k,l),f._71I(e[2],e[3],e[4],e[5])),k=l;o=j-j*k,f._70I?o>n?(l=k+q,e=f._21O(h,i,a,b,c,d,k,l),f._71I(e[2],e[3],e[4],e[5]),f.moveTo(c,d),f.F=m-(o-n),f._70I=!1):(e=f._19O(h,i,a,b,c,d,k),f._71I(e[2],e[3],e[4],e[5]),j===n?(f.F=0,f._70I=!f._70I):(f.F=n-o,f.moveTo(c,d))):o>m?(l=k+r,e=f._21O(h,i,a,b,c,d,k,l),f.moveTo(e[4],e[5]),e=f._19O(h,i,a,b,c,d,l),f._71I(e[2],e[3],e[4],e[5]),f.F=n-(o-m),f._70I=!0):(f.moveTo(c,d),o===m?(f.F=0,f._70I=!f._70I):f.F=m-o)},bezierCurveTo:function(){var a=arguments;this.pen={x:a[4],y:a[5]},this.g.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5])},arc:function(a,b,c,d,e,f){f||(d=-d,e=-e),If(this,a,b,d,e-d,c,c,!1)},rect:function(a,b,c,d){var e=this;e.pen={x:a,y:b},e.moveTo(a,b),e.lineTo(a,b+d),e.lineTo(a+c,b+d),e.lineTo(a+c,b),e.lineTo(a,b)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(a,b,c,d){var e=c-a,f=d-b;return D(e*e+f*f)},_22O:function(a,b,c,d,e,f,g){for(var h,i,j,k,l,m,n,o=0,p=a,q=b,r=g>0?g:this._69I,s=1;r>=s;s++)j=s/r,k=1-j,l=k*k,m=2*j*k,n=j*j,h=l*a+m*c+n*e,i=l*b+m*d+n*f,o+=this._23O(p,q,h,i),p=h,q=i;return o},_21O:function(a,b,c,d,e,f,g,h){var i=this;if(0===g)return i._20O(a,b,c,d,e,f,h);if(1===h)return i._19O(a,b,c,d,e,f,g);var j=i._20O(a,b,c,d,e,f,h);return j.push(g/h),i._19O.apply(i,j)},_20O:function(a,b,c,d,e,f,g){if(1!==g){var h=c+(e-c)*g,i=d+(f-d)*g;c=a+(c-a)*g,d=b+(d-b)*g,e=c+(h-c)*g,f=d+(i-d)*g}return[a,b,c,d,e,f]},_19O:function(a,b,c,d,e,f,g){if(1!==g){var h=a+(c-a)*g,i=b+(d-b)*g;c+=(e-c)*g,d+=(f-d)*g,a=h+(c-h)*g,b=i+(d-i)*g}return[a,b,c,d,e,f]},_72I:function(a,b){var c=this.pen;(a!==c.x||b!==c.y)&&(c.x=a,c.y=b,this.g.lineTo(a,b))},_71I:function(a,b,c,d){var e=this.pen;(a!==c||b!==d||c!==e.x||d!==e.y)&&(e.x=c,e.y=d,this.g.quadraticCurveTo(a,b,c,d))}}),T&&_){var Mi=_.toString();U=Mi.indexOf(jb.substr(0,2))>0&&Mi.indexOf(qa+qa.substr(1,1))>1||Mi.indexOf(gc.substr(0,2)+jb.substr(2,2)+oa[0]+jb[4])>1?!0:!1}var Ni=i,Oi=i,Pi=function(a){Ni&&!a._72O&&(Oi||(Oi={}),Oi[a._72O=Ch()]=a)},Qi=function(a,b){if(b||(b=a),b&&(Ni||(Ni={}),!Ni[a])){var c=new il;if(Ni[b]={request:c,url:b},b=l.beforeLoadURL(b),b.data){var d=l.parse(b.data);Ri(a,d),l.handleCompTypeLoaded(a,d)}else{c.onload=function(b){if(200===this.status||0===this.status){var d=l.parse(c.getResponseText());Ri(a,d),l.handleCompTypeLoaded(a,d)}else Ri(a,i)},c.onerror=function(b){Ri(a,i)};var e={};e.url=encodeURI(b),e.sync=!1,c.send(e)}}},Ri=function(a,b){if(Wc[a]=b,delete Ni[a],Xd(Ni)&&(Ni=i,Oi)){for(var d in Oi){var e=Oi[d];e.invalidateAll&&e.invalidateAll(c,"compTypeLoaded",a),e.redraw&&e.redraw(),e.iv(),delete e._72O}Oi=i}if(b&&Oi)for(var d in Oi){var e=Oi[d];e.invalidateAll&&e.invalidateAll(c,"compTypeLoading",a),e.redraw&&e.redraw(),e.iv()}},Si=o.chart,Ti="",Ui=l.compStack=[],Vi=/^style@/,Wi=/^attr@/,Xi=/^field@/,Yi={x:.5,y:.5},Zi=function(a,b,c,d){if(!a)return 0;if(_i(a.fitSize,b,c)&&d)return d;var e=_i(a.width,b,c);return null==e?20:e},$i=function(a,b,c,d){if(!a)return 0;if(_i(a.fitSize,b,c)&&d)return d;var e=_i(a.height,b,c);return null==e?20:e},_i=function(a,b,d){if(!a||!a.func)return a;var e,f=a.func,g=a.value;return e=Gd(f)?d&&d.vectorDataBindingDisabled&&!a.isSafeFunc?g:f(b,d):b instanceof ej||(j.ui?b instanceof j.ui.View:0)?Wi.test(f)?b.a(Ti+f.slice(5)):Vi.test(f)?b.s(Ti+f.slice(6)):Xi.test(f)?b[f.slice(6)]:b[f]?b[f](d):g:g,g!==c&&e==i?g:e},aj=l.drawImage=function(){var b,d,e,f,g,h,j=function(a,b){a.getValue&&a.getValue.compType===b||(a.getValue=function(d){var e=k(a,d);if(e===c&&b.properties){var f=b.properties[d];f&&(e=f.defaultValue)}return e},a.getColor=function(b){return m(a.getValue(b))},a.getValue.compType=b)},k=function(a,b,f){var g,h=!1;if(a.prefix&&d instanceof ej){var i=d.a(Ti+b);i!==c&&(h=!0,g=i)}return g===c&&(g=a[b]),g&&g.func&&(h=!0,g=_i(g,d,e)),f&&(g=f(g),h||(a[b]=g)),g},m=function(a,c){var d;if(d=c?k(a,c):a,b&&b.compGray&&d)return l.toGrayColor(d);if(g&&d){if("override"===h)return g;if("override_rgb"===h){var e=rf(g);return d=qf(d),"rgba("+B(255*e[0])+","+B(255*e[1])+","+B(255*e[2])+","+d[3]/255+")"}if("override_a"===h){var e=rf(g);return d=qf(d),"rgba("+d[0]+","+d[1]+","+d[2]+","+e[3]+")"}var e=rf(g);return d=qf(d),"rgba("+B(d[0]*e[0])+","+B(d[1]*e[1])+","+B(d[2]*e[2])+","+d[3]/255*e[3]+")"}return d},n=function(a){if(Hd(a)){for(var b=new bj,c=a.length,d=0;c>d;d+=2)b.add({x:a[d],y:a[d+1]});a=b}return a},o=function(a){var b=k(a,"anchorX"),d=k(a,"anchorY");if(b!==c||d!==c)return{x:b===c?Yi.x:b,y:d===c?Yi.y:d};var e=k(a,"type"),f=k(a,"name");if("image"!==e||!f)return Yi;var g=yh(f);return g&&g.anchorX!==c&&g.anchorY!==c?{x:g.anchorX,y:g.anchorY}:Yi},p=function(a,b){var c=k(a,Da),d=o(a);if(Hd(c)){var e=c.length,f=k(a,"relative"),g=b.width,h=b.height;if(4===e)c={x:c[0],y:c[1],width:c[2],height:c[3]},f&&(c.x*=g,c.y*=h,c.width*=g,c.height*=h);else if(3===e){var i=c[0];c={width:c[1],height:c[2]},f&&(c.width*=g,c.height*=h),"object"==typeof i?i.length&&(i={x:i[0],y:i[1]}):i=bg(i,b,c),c.x=i.x-c.width*d.x,c.y=i.y-c.height*d.y}c.x+=k(a,"offsetX")||0,c.y+=k(a,"offsetY")||0,!f&&b.fitSize&&(c=q(a,c,b))}return c},q=function(a,b,c){if(b){var d,e,f,g={x:b.x,y:b.y,width:b.width,height:b.height},h=o(a),j=k(a,"layoutH"),l=k(a,"layoutV"),m=1,n=1,p=0,q=0,r=1,s=1;switch(j){case"left":break;case"right":g.x+=c.width-c.rw;break;case"center":g.x+=.5*(c.width-c.rw);break;case"scale":case"leftright":default:d=k(a,ib)||0,d&&(p=Math.abs(q=Math.sin(d)),r=Math.abs(s=Math.cos(d))),"leftright"!==j?(m+=r*(c.widthScale-1),n+=p*(c.widthScale-1)):(m+=g.width?r*(c.width-c.rw)/g.width:0,n+=g.height?p*(c.width-c.rw)/g.height:0,e=-Math.min(-h.x*s+h.y*q,-h.x*s-(1-h.y)*q,(1-h.x)*s+h.y*q,(1-h.x)*s-(1-h.y)*q))}switch(l){case"top":break;case"bottom":g.y+=c.height-c.rh;break;case"center":g.y+=.5*(c.height-c.rh);break;case"scale":case"topbottom":default:d==i&&(d=k(a,ib),d&&(p=Math.abs(q=Math.sin(d)),r=Math.abs(s=Math.cos(d)))),"topbottom"!==l?(m+=p*(c.heightScale-1),n+=r*(c.heightScale-1)):(m+=g.width?p*(c.height-c.rh)/g.width:0,n+=g.height?r*(c.height-c.rh)/g.height:0,f=-Math.min(-h.x*q-h.y*s,-h.x*q+(1-h.y)*s,(1-h.x)*q-h.y*s,(1-h.x)*q+(1-h.y)*s))}return(1!==m||1!==n)&&("scale"!==j&&j?"leftright"===j&&(g.x+=g.width*(1-m)*h.x+e*(c.width-c.rw)):g.x+=g.x*(c.widthScale-1)+h.x*g.width*(c.widthScale-m),"scale"!==l&&l?"topbottom"===l&&(g.y+=g.height*(1-n)*h.y+f*(c.height-c.rh)):g.y+=g.y*(c.heightScale-1)+h.y*g.height*(c.heightScale-n),g.width*=m,g.height*=n),g.width<0&&(g.width=0),g.height<0&&(g.height=0),g}},r=function(a){return Hd(a)?new bj(a):a},s=function(a,d,e,f,g,h,i){var j=b.interactiveInfo,l=a.transform;if(l)return b.save(),b.setTransform(l.a,l.b,l.c,l.d,l.tx,l.ty),j&&j.compInfos.push({comp:a,rect:d,matrix:l.clone(),prefix:Ti}),!0;g===c&&(g=1),h===c&&(h=1);var m=k(a,"clipPercentage"),n=Zd(e,d);if(n&&!f&&1===g&&1===h&&!(1>m))return j&&j.compInfos.push({comp:a,rect:d,matrix:j.matrix.clone(),prefix:Ti}),!1;i=i||Yi;var o=d.x+d.width*i.x,p=d.y+d.height*i.y,q=e.x+e.width*i.x,r=e.y+e.height*i.y,s=e.width?g*(d.width/e.width):1,t=e.height?h*(d.height/e.height):1;if(b.save(),j&&(j.matrix.appendTranslate(o,p).appendRotate(f).appendScale(s,t).appendTranslate(-q,-r),j.compInfos.push({comp:a,rect:d,matrix:j.matrix.clone()})),Fe(b,o,p),Ge(b,f||0),He(b,s,t),Fe(b,-q,-r),1>m){0>m&&(m=0);var u=fe(e,k(a,"clipDirection"),m);b.beginPath(),b.rect(u.x,u.y,u.width,u.height),b.clip()}return!0},t=function(){b.restore()},u=function(a,c,d){var e=k(a,"path"),g=k(a,ib),h=k(a,"scaleX"),j=k(a,"scaleY"),l=o(a),n=i,p=wf(null,e);if(d||(d=a.unionRect,d||(d=Wh(p),a.path.func||(a.unionRect=d)),n=d),d){n||(n=a.unionRect,n||(n=Wh(p),a.path.func||(a.unionRect=n)));var q=s(a,d,n,g,h,j,l),r=k(a,"borderPattern"),u=Ki(b,r),v=m(a,"background"),w=m(a,"borderColor"),x=k(a,"borderWidth"),y=k(a,"gradient"),z=m(a,"gradientColor"),A=k(a,"border3d"),B=m(a,"border3dColor"),C=k(a,"border3dAccuracy"),D=b.lineJoin,E=b.lineCap;if(b.lineJoin=k(a,"borderJoin")||dh,b.lineCap=k(a,"borderCap")||ch,v?(Ff(b,v,y,z,n),wf(b,e),b.fill(),u!==b&&wf(b,e)):wf(b,e),x&&w){var F=k(a,"borderWidthAbsolute");F&&(b.save(),b.setTransform(1,0,0,1,0,0)),b.lineWidth=x,b.strokeStyle=w,b.stroke(),F&&b.restore(),A&&Bf(b,w,B,x,f,C)}if(Li(b,r),k(a,"dash")){var G=k(a,"dashWidth")||x;if(G>0){r=k(a,"dashPattern")||bh;var u=Ki(b,r,k(a,"dashOffset")),H=m(a,"dashColor")||m(fg);u!==b&&wf(b,e),b.strokeStyle=H,b.lineWidth=G,b.stroke(),k(a,"dash3d")&&Bf(b,H,m(a,"dash3dColor"),G,f,k(a,"dash3dAccuracy")),Li(b,r)}}c===Da&&Lf(b,v,k(a,"depth"),n),b.lineJoin=D,b.lineCap=E,q&&t()}},v=function(a,c,j,l){var p=k(a,Ta,n),u=k(a,ib),v=o(a);if(p&&l.fitSize){var w=new bj,x=Wh(p),y=q(a,x,l),z=x.x+v.x*x.width,A=x.y+v.y*x.height,B=y.x+v.x*y.width,C=y.y+v.y*y.height,D=x.width?y.width/x.width:1,E=x.height?y.height/x.height:1;p.each(function(a){w.add({x:B+(a.x-z)*D,y:C+(a.y-A)*E})}),p=w,a.unionRect=null}var F=k(a,"scaleX"),G=k(a,"scaleY"),H=c===Ga,I=i;if(!j&&H&&(j=a.unionRect,j||(j=Wh(p),a.points.func||(a.unionRect=j)),I=j),j){H?I||(I=a.unionRect,I||(I=Wh(p),a.points.func||(a.unionRect=I))):I=j;var J,K,L,M,N=s(a,j,I,u,F,G,v),O=k(a,"borderPattern"),P=Ki(b,O),Q=m(a,"background"),R=yh(k(a,"repeatImage"),g,h),S=k(a,"gradientPack"),T=m(a,"borderColor"),U=k(a,"borderWidth"),V=k(a,"segments",r),W=k(a,"gradient"),X=m(a,"gradientColor"),Y=k(a,"border3d"),Z=m(a,"border3dColor"),$=k(a,"border3dAccuracy"),_=k(a,"closePath"),aa=k(a,"fillRule")||"nonzero",ba=b.lineJoin,ca=b.lineCap;if(b.lineJoin=k(a,"borderJoin")||dh,b.lineCap=k(a,"borderCap")||ch,H)if(Q||R||S){var da=k(a,"fillClipPercentage");if(1>da){0>da&&(da=0);var ea=fe(I,k(a,"fillClipDirection"),da);b.save(),b.beginPath(),b.rect(ea.x,ea.y,ea.width,ea.height),b.clip()}if(zf(b,p,V,_),S)xf(b,S);else if(R){var fa=b,ga=g,ha=h;Gf(b,R,g,h,d,e),b=fa,g=ga,h=ha}else{var fa=b;Ff(b,Q,W,X,I),b=fa}b.fill(aa),1>da&&b.restore(),S&&b.restore(),P!==b&&zf(P,p,V,_)}else zf(P,p,V,_);else if("roundRect"===c?J=k(a,"cornerRadius"):"polygon"===c?J=k(a,"polygonSide"):"arc"===c&&(J=k(a,"arcFrom"),K=k(a,"arcTo"),L=k(a,"arcClose"),M=k(a,"arcOval")),Q||R||S){var da=k(a,"fillClipPercentage");if(1>da){0>da&&(da=0);var ea=fe(I,k(a,"fillClipDirection"),da);b.save(),b.beginPath(),b.rect(ea.x,ea.y,ea.width,ea.height),b.clip()}if(Ef(b,c,I,J,K,L,M),S)xf(b,S);else if(R){var fa=b,ga=g,ha=h;Gf(b,R,g,h,d,e),b=fa,g=ga,h=ha}else Ff(b,Q,W,X,I);b.fill(aa),1>da&&b.restore(),S&&b.restore(),b!==P&&Ef(P,c,I,J,K,L,M)}else Ef(P,c,I,J,K,L,M);if(U&&T){var ia=k(a,"borderWidthAbsolute");ia&&(b.save(),b.setTransform(1,0,0,1,0,0)),b.lineWidth=U,b.strokeStyle=T,b.stroke(),ia&&b.restore(),Y&&Bf(b,T,Z,U,f,$)}if(Li(b,O),k(a,"dash")){var ja=k(a,"dashWidth")||U;if(ja>0){O=k(a,"dashPattern")||bh;var P=Ki(b,O,k(a,"dashOffset")),ka=m(a,"dashColor")||m(fg);P!==b&&(H?zf(P,p,V,_):Ef(P,c,I,J,K,L,M)),b.strokeStyle=ka,b.lineWidth=ja,b.stroke(),k(a,"dash3d")&&Bf(b,ka,m(a,"dash3dColor"),ja,f,k(a,"dash3dAccuracy")),Li(b,O)}}c===Da&&Lf(b,Q,k(a,"depth"),I),b.lineJoin=ba,b.lineCap=ca,N&&t()}},w=function(a,c){var f=g,i=h,j=g||k(a,jc),l=h||k(a,"blendMode"),m=yh(k(a,"name"),j,l);m&&(Bh(b,m,k(a,"stretch"),c.x,c.y,c.width,c.height,d,e,j,null,l),g=f,h=i)},x=function(a,c){var d=k(a,"text");d!=i&&Lh(b,d,k(a,"font"),m(a,jc),c.x,c.y,c.width,c.height,k(a,"align"),k(a,"vAlign"))},y=function(a,c){Kf(b,m(a,jc),c.x,c.y,c.width,c.height,k(a,"width"))},z=function(a,c){var e=k(a,Ua),f=0;if(e&&(e.forEach(function(a){f+=a}),f>0)){for(var g=k(a,"colors")||Si,h=k(a,"startAngle")||0,j=k(a,"hollow"),l=k(a,Xa),m=k(a,ab),n=k(a,bb),o=l?new bj:i,p=c.x,q=c.y,r=c.width,s=c.height,t=p+r/2,u=q+s/2,v=F(r,s)/2,w=0,x=0;x<e.length;x++){var y=e[x],z=N*y/f,A=h+z;if(b.fillStyle=g[w++],w===g.length&&(w=0),b.beginPath(),j){var B=t+H(h)*v/2,C=u+J(h)*v/2,D=t+H(A)*v,E=u+J(A)*v;b.moveTo(B,C),b.arc(t,u,v/2,h,A,!1),b.lineTo(D,E),b.arc(t,u,v,A,h,!0)}else b.moveTo(t,u),b.arc(t,u,v,A,h,!0);o&&(z=(h+A)/2,o.add({text:Gd(l)?l(y,x,f,d):y,x:t+H(z)*v*.75,y:u+J(z)*v*.75})),b.closePath(),b.fill(),h=A}o&&o.each(function(a){Lh(b,a.text,m,n,a.x,a.y,0,0,sa)})}},A=function(a,c){var e=k(a,Va);if(e&&e.length>0){var f=e.length,g=k(a,Xa),h=k(a,ab),j=k(a,bb),l=g?new bj:i,m=k(a,"minValue")||0,n=k(a,"maxValue");if(n==i&&(n=0,e.forEach(function(a){k(a,Ua).forEach(function(a){n=E(n,a)})})),m===n)return;for(var o=c.height/(n-m),p=c.y+n*o,q=k(e[0],Ua).length,r=c.width/(3*q+1),s=2*r/f,t=0,u=0;f>u;u++)for(var v=e[u],w=k(v,jc),x=k(v,"colors"),y=k(v,Ua),z=0;q>z;z++){x?b.fillStyle=x[z]:w?b.fillStyle=w:(b.fillStyle=Si[t++],t===Si.length&&(t=0));var A=y[z],B=A*o,C=c.x+(1+3*z)*r+u*s;if(Df(b,C,p-B,s,B),l){var D=Gd(g)?g(A,z,v,d):A,F=Mh(h,D).height;l.add({x:C,y:p-B-F,width:s,height:F,text:D})}}l&&l.each(function(a){Lh(b,a.text,h,j,a.x,a.y,a.width,a.height,sa)})}},C=function(a,c){var e=k(a,Va);if(e&&e.length>0){var f=e.length,g=k(e[0],Ua).length,h=c.width/(3*g+1),j=0,l=k(a,"maxValue"),m=k(a,Xa),n=k(a,ab),o=k(a,bb),p=m?new bj:i;if(l==i){l=0;for(var q=0;g>q;q++){for(var r=0,s=0;f>s;s++)r+=k(e[s],Ua)[q];l=E(l,r)}}if(l>0){for(var q=0;g>q;q++)for(var t=c.y+c.height,s=0;f>s;s++){var u=e[s],v=k(u,jc),w=k(u,Ua)[q],x=w/l*c.height;v?b.fillStyle=v:(b.fillStyle=Si[j++],j===Si.length&&(j=0)),t-=x;var y={x:c.x+(1+3*q)*h,y:t,width:2*h,height:x};Df(b,y.x,y.y,y.width,y.height),p&&(y.text=Gd(m)?m(w,q,u,d):w,p.add(y))}p&&p.each(function(a){Lh(b,a.text,n,o,a.x,a.y,a.width,a.height,sa)})}}},D=function(a,c){var e=k(a,Va);if(e&&e.length>0){for(var f=e.length,g=k(e[0],Ua).length,h=c.width/(3*g+1),j=0,l=k(a,Xa),m=k(a,ab),n=k(a,bb),o=l?new bj:i,p=0;g>p;p++){for(var q=0,r=0;f>r;r++)q+=k(e[r],Ua)[p];if(q>0){var s=c.y+c.height;for(r=0;f>r;r++){var t=e[r],u=k(t,jc),v=k(t,Ua)[p],w=v/q*c.height;u?b.fillStyle=u:(b.fillStyle=Si[j++],j===Si.length&&(j=0)),s-=w;var x={x:c.x+(1+3*p)*h,y:s,width:2*h,height:w};Df(b,x.x,x.y,x.width,x.height),o&&(x.text=Gd(l)?l(v,p,t,d):v,o.add(x))}}}o&&o.each(function(a){Lh(b,a.text,m,n,a.x,a.y,a.width,a.height,sa)})}},G=function(a,c){var e=k(a,Va);if(e&&e.length>0){var g=e.length,h=k(a,"minValue")||0,j=k(a,"maxValue");if(j==i&&(j=0,e.forEach(function(a){k(a,Ua).forEach(function(a){j=E(j,a)})})),h===j)return;for(var l=c.height/(j-h),m=c.y+j*l,n=k(e[0],Ua).length,o=c.width/(3*n+1),p=0,q=k(a,"lineWidth")||2,r=k(a,"line3d"),s=k(a,"linePoint"),t=k(a,Xa),u=k(a,ab),v=k(a,bb),w=0;g>w;w++){var x=e[w],y=k(x,jc),z=k(x,Ua);y?b.strokeStyle=y:(y=b.strokeStyle=Si[p++],p===Si.length&&(p=0)),b.beginPath();for(var A=0;n>A;A++){var B=c.x+(2+3*A)*o,C=m-z[A]*l;0===A?b.moveTo(B,C):b.lineTo(B,C)}if(b.lineWidth=q,b.stroke(),r&&Bf(b,y,i,q,f),s||t){var D,F=q/2+2;for(A=0;n>A;A++){var G=z[A];if(B=c.x+(2+3*A)*o,C=m-G*l,Gd(s)?s(b,B,C,y,A,x,d):s&&(b.fillStyle=y,b.beginPath(),b.arc(B,C,F,0,N,!0),b.fill()),Gd(t)?D=t(G,A,x,d):t&&(D=G),D){var H=Mh(u,D).height,I=b.shadowBlur;if(I){var J=b.shadowOffsetX,K=b.shadowOffsetY,L=b.shadowColor;b.shadowOffsetX=0,b.shadowOffsetY=0,b.shadowBlur=0,b.shadowColor=i}Lh(b,D,u,v,B,C-H-F+2,0,H,sa),I&&(b.shadowOffsetX=J,b.shadowOffsetY=K,b.shadowBlur=I,b.shadowColor=L)}}}}}},I=function(){b=null,d=null,e=null},K=function(a,b){var f;e&&e.getState?f=e.getState(d):(f=d instanceof ej?d.s(Sb):null,(f===c||null===f)&&(f=k(a,Sb)));var g=k(b,Sb);return g!==c&&null!==g&&g!==f?!1:k(b,kb)},L={border:y,image:w,text:x,pieChart:z,columnChart:A,stackedColumnChart:C,percentageColumnChart:D,lineChart:G};return function(q,w,x,y,z,A,B,C,D,E){if(w&&z&&A){var F=b?!1:!0;b=q,d=B,e=C,!d&&e&&e.isSelfViewEvent&&(d=e),f=e&&e._zoom?e._zoom:1,g=D,h=E;var G=z,H=A;if(kk()){var J,M,N;0===b[Rb]?kk[0]&&(J=!0):J=!0,b.texureImage2D?kk[1]&&(M=!0):M=!0,b.texureImage3D?kk[2]&&(N=!0):N=!0,J&&M&&N&&(G=x,H=y)}if(w.tagName)return Cd(ca)&&!a[ca]||b.drawImage(w,G,H,z,A),void(F&&I());if(k(w,"visible")===!1)return void(F&&I());g||(g=_i(w.color,d,e)),E||(h=_i(w.blendMode,d,e)),Cd(ca)&&!a[ca]&&(z=G,A=H);var O=Zi(w,d,e,z),P=$i(w,d,e,A),Q={x:0,y:0,width:O,height:P,fitSize:k(w,"fitSize")},R=k(w,"clip"),S=k(w,"opacity");if(Q.fitSize){var T=Q.rw=_i(w.width,d,e)||20;Q.widthScale=O/T;var U=Q.rh=_i(w.height,d,e)||20;Q.heightScale=P/U}if(b.save(),b.interactiveInfo){var V=b.interactiveInfo.matrix,W=V.clone();V.appendTranslate(G,H).appendScale(z/O,A/P)}Fe(b,G,H),(O!==z||P!==A)&&b.scale(z/O,A/P),R&&(Gd(R)?R(b,O,P,d,e,w):(b.beginPath(),b.rect(0,0,O,P),b.clip())),S!=i&&(b.globalAlpha*=S),k(w,"comps").forEach(function(a){if(a.prefix){var g=Ti,h=_i(a.prefix,d,e);h&&(Ti=Ti+h+".")}if(K(w,a)===!1)return void(a.prefix&&(Ti=g));if(Ui.splice(0,0,a),b.interactiveInfo)var q=b.interactiveInfo.matrix.clone();var x=k(a,"opacity"),y=k(a,"shadow"),z=k(a,"type"),A=p(a,Q);if(x!=i){var B=b.globalAlpha;b.globalAlpha*=x}if(y){var C=b.shadowOffsetX,D=b.shadowOffsetY,E=b.shadowBlur,F=b.shadowColor,G=k(a,"shadowOffsetX"),H=k(a,"shadowOffsetY"),I=k(a,"shadowBlur"),J=m(a,"shadowColor");b.shadowOffsetX=(G==i?3:G)*f,b.shadowOffsetY=(H==i?3:H)*f,b.shadowBlur=(I==i?6:I)*f,b.shadowColor=J||m(rg)}if("save"===z)b.save();else if("endClip"===z||"restore"===z)b.restore();else if("clip"===z)b.save(),zf(b,k(a,"points",n),k(a,"segments",r),!0),b.clip();else if(Rf[z])A=A||{x:0,y:0,width:Q.width,height:Q.height},v(a,z,A,Q);else if(z===Ga)v(a,z,A,Q);else if("SVGPath"===z)u(a,z,A);else{A=A||{x:0,y:0,width:Q.width,height:Q.height};var M=k(a,ib),N=k(a,"scaleX"),O=k(a,"scaleY"),P=o(a),R=s(a,A,A,M,N,O,P);if(Gd(z))j(a,z),l.drawCompType(z,b,A,a,d,e);else if(l.getCompType(z)){var S=l.getCompType(z),T=S.func||S;j(a,S),l.drawCompType(T,b,A,a,d,e)}else L[z]?L[z](a,A):l.getCompType(z)===c&&$c.test(z)&&Qi(z);R&&t()}y&&(b.shadowOffsetX=C,b.shadowOffsetY=D,b.shadowBlur=E,b.shadowColor=F),x!=i&&(b.globalAlpha=B),b.interactiveInfo&&(b.interactiveInfo.matrix=q),a.prefix&&(Ti=g),Ui.splice(0,1)}),b.interactiveInfo&&(b.interactiveInfo.matrix=W),b.restore(),F&&I()}}}();l.getCurrentComp=function(){return Ui[0]},l.getParentComp=function(){return Ui[1]},l.getInternal=function(){return{isEnter:jf,isEsc:kf,isSpace:hf,isLeft:df,isUp:ef,isRight:ff,isDown:gf,addMethod:Td,superCall:Wd,toPointsArray:Af,translateAndScale:Ee,appendArray:Rd,createWorldMatrix:Fi,vec3TransformMat4:yi,setCanvas:ue,createDiv:qe,createView:pe,createCanvas:re,createImage:rd,initContext:De,layout:Le,fillRect:Df,Mat:Hg,drawBorder:Kf,isString:Cd,setBorder:se,getPropertyValue:de,setPropertyValue:ee,drawVerticalLine:ge,draw3DRect:Lf,getPinchDist:Tf,isSameRect:Zd,getPosition:bg,intersectionLineRect:be,getNodeRect:hj,getEdgeAgentPosition:Aj,getEdgeHostPosition:zj,getImageWidth:Zi,getImageHeight:$i,initItemElement:oe,drawPoints:zf,createG2:Ki,closePopup:Oe,isH:vd,createAnim:Sd,createNormalMatrix:Jn,createNormals:fn,toFloatArray:dp,glMV:Kn,batchShape:po,createNodeMatrix:Ei,getFaceInfo:Qn,transformAppend:Km,drawFaceInfo:Rn,to3dPointsArray:gp,setGLDebugMode:function(a){Bm=a},cube:function(){return{vs:Fo,is:Go,uv:Ho}},ui:function(){return{DataUI:jl,NodeUI:kl,EdgeUI:ll,GroupUI:nl,ShapeUI:pl,GridUI:rl,Data3dUI:eq,Node3dUI:fq,Shape3dUI:hq}},getInternalVersion:function(){return"U2FsdGVkX1+q+KbvE4JHkZbnbuObksR1KM4FPaQ/B34="},getDragger:function(){return Pe},addMSMap:function(a){Td(Ug,a)},k:q,addEventListener:x,removeEventListener:y}},function(a,b,c){function d(a,b,c){a!=i&&(b==i&&hc!=typeof a?this._54O(a,256):this._54O(a,b))}function e(){return new d(i)}function f(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=B(g/67108864),c[d++]=67108863&g}return e}function h(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function j(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function k(a){return Fa.charAt(a)}function l(a,b){var c=Ga[a.charCodeAt(b)];return c==i?-1:c}function m(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function n(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+this.DV:this.t=0}function o(a){var b=e();return b._58O(a),b}function p(a,b){var c,e=this;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void e.fromRadix(a,b);c=2}e.t=0,e.s=0;for(var f=a.length,g=!1,h=0;--f>=0;){var i=8==c?255&a[f]:l(a,f);0>i?"-"==a.charAt(f)&&(g=!0):(g=!1,0==h?e[e.t++]=i:h+c>e.DB?(e[e.t-1]|=(i&(1<<e.DB-h)-1)<<h,e[e.t++]=i>>e.DB-h):e[e.t-1]|=i<<h,h+=c,h>=e.DB&&(h-=e.DB))}8==c&&0!=(128&a[0])&&(e.s=-1,h>0&&(e[e.t-1]|=(1<<e.DB-h)-1<<h)),e._57O(),g&&d.ZERO._78O(e,e)}function r(){for(var a=this,b=a.s&a.DM;a.t>0&&a[a.t-1]==b;)--a.t}function t(a){var b=this;if(b.s<0)return"-"+b._85O()[ta](a);var c;if(16==a)c=4;else if(8==a)c=3;else if(2==a)c=1;else if(32==a)c=5;else{if(4!=a)return b.toRadix(a);c=2}var d,e=(1<<c)-1,f=!1,g="",h=b.t,i=b.DB-h*b.DB%c;if(h-->0)for(i<b.DB&&(d=b[h]>>i)>0&&(f=!0,g=k(d));h>=0;)c>i?(d=(b[h]&(1<<i)-1)<<c-i,d|=b[--h]>>(i+=b.DB-c)):(d=b[h]>>(i-=c)&e,0>=i&&(i+=b.DB,--h)),d>0&&(f=!0),f&&(g+=k(d));return f?g:"0"}function u(){var a=e();return d.ZERO._78O(this,a),a}function v(){return this.s<0?this._85O():this}function w(a){var b=this,c=b.s-a.s;if(0!=c)return c;var d=b.t;if(c=d-a.t,0!=c)return b.s<0?-c:c;for(;--d>=0;)if(0!=(c=b[d]-a[d]))return c;return 0}function x(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function y(){var a=this;return a.t<=0?0:a.DB*(a.t-1)+x(a[a.t-1]^a.s&a.DM)}function z(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function A(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=E(this.t-a,0),b.s=this.s}function G(a,b){var c,d=this,e=a%d.DB,f=d.DB-e,g=(1<<f)-1,h=B(a/d.DB),i=d.s<<e&d.DM;for(c=d.t-1;c>=0;--c)b[c+h+1]=d[c]>>f|i,i=(d[c]&g)<<e;for(c=h-1;c>=0;--c)b[c]=0;b[h]=i,b.t=d.t+h+1,b.s=d.s,b._57O()}function I(a,b){var c=this;b.s=c.s;var d=B(a/c.DB);if(d>=c.t)return void(b.t=0);var e=a%c.DB,f=c.DB-e,g=(1<<e)-1;b[0]=c[d]>>e;for(var h=d+1;h<c.t;++h)b[h-d-1]|=(c[h]&g)<<f,b[h-d]=c[h]>>e;e>0&&(b[c.t-d-1]|=(c.s&g)<<f),b.t=c.t-d,b._57O()}function L(a,b){for(var c=this,d=0,e=0,f=F(a.t,c.t);f>d;)e+=c[d]-a[d],b[d++]=e&c.DM,e>>=c.DB;if(a.t<c.t){for(e-=a.s;d<c.t;)e+=c[d],b[d++]=e&c.DM,e>>=c.DB;e+=c.s}else{for(e+=c.s;d<a.t;)e-=a[d],b[d++]=e&c.DM,e>>=c.DB;e-=a.s}b.s=0>e?-1:0,-1>e?b[d++]=c.DV+e:e>0&&(b[d++]=e),b.t=d,b._57O()}function M(a,b){var c=this.abs(),e=a.abs(),f=c.t;for(b.t=f+e.t;--f>=0;)b[f]=0;for(f=0;f<e.t;++f)b[f+c.t]=c.am(0,e[f],b,f,0,c.t);b.s=0,b._57O(),this.s!=a.s&&d.ZERO._78O(b,b)}function O(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a._57O()}function P(a,b,c){var f=a.abs(),g=this;if(!(f.t<=0)){var h=g.abs();if(h.t<f.t)return b!=i&&b._58O(0),void(c!=i&&g._77O(c));c==i&&(c=e());var j=e(),k=g.s,l=a.s,m=g.DB-x(f[f.t-1]);m>0?(f._44O(m,j),h._44O(m,c)):(f._77O(j),h._77O(c));var n=j.t,o=j[n-1];if(0!=o){var p=o*(1<<g.F1)+(n>1?j[n-2]>>g.F2:0),q=g.FV/p,r=(1<<g.F1)/p,s=1<<g.F2,t=c.t,u=t-n,v=b==i?e():b;for(j._59O(u,v),c._52O(v)>=0&&(c[c.t++]=1,c._78O(v,c)),d.ONE._59O(n,v),v._78O(j,j);j.t<n;)j[j.t++]=0;for(;--u>=0;){var w=c[--t]==o?g.DM:B(c[t]*q+(c[t-1]+s)*r);if((c[t]+=j.am(0,w,c,u,0,n))<w)for(j._59O(u,v),c._78O(v,c);c[t]<--w;)c._78O(v,c)}b!=i&&(c._45O(n,b),k!=l&&d.ZERO._78O(b,b)),c.t=n,c._57O(),m>0&&c._46O(m,c),0>k&&d.ZERO._78O(c,c)}}}function Q(a){var b=e();return this.abs()._49O(a,i,b),this.s<0&&b._52O(d.ZERO)>0&&a._78O(b,b),b}function S(a){this.m=a}function T(a){return a.s<0||a._52O(this.m)>=0?a.mod(this.m):a}function U(a){return a}function W(a){a._49O(this.m,i,a)}function X(a,b,c){a._47O(b,c),this._74O(c)}function Y(a,b){a._48O(b),this._74O(b)}function Z(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function $(a){var b=this;b.m=a,b.mp=a._50O(),b.mpl=32767&b.mp,b.mph=b.mp>>15,b.um=(1<<a.DB-15)-1,b.mt2=2*a.t}function _(a){var b=e();return a.abs()._59O(this.m.t,b),b._49O(this.m,i,b),a.s<0&&b._52O(d.ZERO)>0&&this.m._78O(b,b),b}function aa(a){var b=e();return a._77O(b),this._74O(b),b}function ba(a){for(var b=this;a.t<=b.mt2;)a[a.t++]=0;for(var c=0;c<b.m.t;++c){var d=32767&a[c],e=d*b.mpl+((d*b.mph+(a[c]>>15)*b.mpl&b.um)<<15)&a.DM;for(d=c+b.m.t,a[d]+=b.m.am(0,e,a,c,0,b.m.t);a[d]>=a.DV;)a[d]-=a.DV,a[++d]++}a._57O(),a._45O(b.m.t,a),a._52O(b.m)>=0&&a._78O(b.m,a)}function ca(a,b){a._48O(b),this._74O(b)}function da(a,b,c){a._47O(b,c),this._74O(c)}function ea(){return 0==(this.t>0?1&this[0]:this.s)}function fa(a,b){if(a>4294967295||1>a)return d.ONE;var c=e(),f=e(),g=b._73O(this),h=x(a)-1;for(g._77O(c);--h>=0;)if(b._76O(c,f),(a&1<<h)>0)b._75O(f,g,c);else{var i=c;c=f,f=i}return b.revert(c)}function ga(a,b){var c;return c=256>a||b._51O()?new S(b):new $(b),this.exp(a,c)}function ha(){var a=this;if(a.s<0){if(1==a.t)return a[0]-a.DV;if(0==a.t)return-1}else{if(1==a.t)return a[0];if(0==a.t)return 0}return(a[1]&(1<<32-a.DB)-1)<<a.DB|a[0]}function ia(a,b){return new d(a,b)}function ja(){var a=this;a.n=i,a.e=0,a.d=i,a.p=i,a.q=i,a.dmp1=i,a.dmq1=i,a._10A=i}function ka(a){return a._53O(this.e,this.n)}function la(a){var b,c,d,e="",f=0;for(b=0;b<a.length&&a.charAt(b)!=Na;++b)d=Ma.indexOf(a.charAt(b)),0>d||(0==f?(e+=k(d>>2),c=3&d,f=1):1==f?(e+=k(c<<2|d>>4),c=15&d,f=2):2==f?(e+=k(c),e+=k(d>>2),c=3&d,f=3):(e+=k(c<<2|d>>4),e+=k(15&d),f=0));return 1==f&&(e+=k(c<<2)),e}function ma(a){var b=a.split(""),c=la(a);return b.forEach(function(a){var b=a.length;b>0&&c&&(Ic+=V(a))}),c}function na(a,b){var c=Ua._4O.Util._56O(a,"ss"),d={},e=0;return d.v=c==b,d.t=1,d.s=0>e?-1:0,Jc=d.v,e>0?d[0]=e:-1>e?d[0]=e+d.DV:d.t=0,[c,d]}function oa(a){var b=38,c=a.substring(0,b);if(c&&30==c.indexOf("05000420")){var d=["ss",a.substring(b)];return d}return[]}function pa(a,b,c,d){b=b.replace(Sa,""),b=b.replace(/[ \n]+/g,"");var e=ia(b,16);if(e._55O()>this.n._55O())return 0;var f=this._37O(e),g=f[ta](16).replace(/^1f+00/,""),h=oa(g);if(0==h.length)return!1;for(var i,j,k,l=.5,m=ji,n=[0,.5,.75,.875,.9375],o=[],p=[],q=[],r=N/m,s=h[1],t=na(a,s)[0],u=0,v=0;u<n.length;u++){var w=u%2===0?0:.5;for(i=0;m>=i;i++)j=(i+w)*r,k=1-n[u],o.push(H(j)*l*k,-l+n[u]*l*2,-J(j)*l*k),p.push((i+w)/m,k)}for(u=0;u<n.length-1;u++){var x=u*(m+1),y=(u+1)*(m+1);for(i=0;m>i;i++)q.push(x+i,y+i+1,y+i,x+i,x+i+1,y+i+1)}return q.forEach(function(a){v+=a}),s==t&&v>10}var qa,ra=0xdeadbeefcafe,sa=15715070==(16777215&ra),ta="toString",ua="",va="nat",xa=function(a){};s=a["D"+11182[ta](K(2,5))];var Aa=d.prototype;mb+=wa.substr(0,1);var Ba=a.navigator?a.navigator.appName:"";sa&&"Microsoft Internet Explorer"==Ba?(Aa.am=h,qa=30):sa&&"Netscape"!=Ba?(Aa.am=f,qa=26):(Aa.am=j,qa=28),Aa.DB=qa,Aa.DM=(1<<qa)-1,Aa.DV=1<<qa;var Ca=52;Aa.FV=K(2,Ca),Aa.F1=Ca-qa,Aa.F2=2*qa-Ca;var Da,Ea,Fa="0123456789abcdefghijklmnopqrstuvwxyz",Ga=[],Ha=function(a){return String.fromCharCode(a)};for(Da="0".charCodeAt(0),Ea=0;9>=Ea;++Ea)Ga[Da++]=Ea;for(Da="a".charCodeAt(0),Ea=10;36>Ea;++Ea)Ga[Da++]=Ea;for(Da="A".charCodeAt(0),Ea=10;36>Ea;++Ea)Ga[Da++]=Ea;var Ia=S.prototype;Ia._73O=T,Ia.revert=U,Ia._74O=W,Ia._75O=X,Ia._76O=Y;var Ja=$.prototype;Ja._73O=_,Ja.revert=aa,Ja._74O=ba,Ja._75O=da,Ja._76O=ca,Aa._77O=m,Aa._58O=n,Aa._54O=p,Aa._57O=r,Aa._59O=z,Aa._45O=A,Aa._44O=G,Aa._46O=I,Aa._78O=L,Aa._47O=M,Aa._48O=O,Aa._49O=P,Aa._50O=Z,Aa._51O=ea,Aa.exp=fa,Aa.toString=t,Aa._85O=u,Aa.abs=v,Aa._52O=w,Aa._55O=y,Aa.mod=Q,Aa._53O=ga,d.ZERO=o(0),d.ONE=o(1),Aa._86O=ha;var Ka=function(a,b){var c=this;c.isPublic=!0,typeof a!==hc?(c.n=a,c.e=b):a!=i&&b!=i&&a.length>0&&b.length>0&&(c.n=ia(a,16),c.e=V(b,16))};of=function(){var a,b,c=ma(Qa),d=c.substr(0,4),e=c.substr(4,2),f=c.substr(6,2),g=1,h=!g,j=q,k=[],l=nc.charAt(7);if(s&&(s[ta]().indexOf(va)<0||s[mb][ta]().indexOf(va)<0||!c?a=i:(c=new s(d-0,e-g,f-0),b=c.setHours(9),s[mb]()>b?a=yf[l]:h=!0)),c&&a&&a[0]&&a[C(.5)]&&j){var m=Ai(a[0]),n=Ai(a[1]);for(var o in n)k.push(o);var p,r=0,t=m[k[r]],u=n[k[r++]],v=n[k[r++]],w=n[k[r++]],x=n[k[r++]],y=n[k[r++]],z=n[k[r++]],A=m[k[r]],B=n[k[r++]],D=bb._27O(j);if(t===u&&D&&B){p=u+v+w+x+y+z;var E=!z||z===zc;if(!E&&z)for(var F,G=0,H=z.length;H>G;G++)z[G]===Bb[r]?F===zc?E=!0:F[0]===cb[5]&&zc&&zc.indexOf(F.substr(1))>=0?E=!0:F=i:(F==i?F=z[G]:F+=z[G],
G===H-1&&(F===zc?E=!0:F[0]===cb[5]&&zc&&zc.indexOf(F.substr(1))>=0&&(E=!0)));p&&D._31O(p,B)&&D._31O(t,A)&&E&&(!y||s[mb]()<y)&&(h=!0)}}return h||(Ef=Yd),l};var La=ja.prototype;La._37O=ka,La._38O=Ka;var Ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Na="=",Oa=25,Pa=10,Qa="IBkSJQ==",Ra=Ra||function(a,b){var c={},d=c._7A={},e=d._6A=function(){function a(){}return{_80O:function(b){a.prototype=this;var c=new a;return b&&c._5A(b),c.hasOwnProperty("_82O")||(c._82O=function(){c.$super._82O.apply(this,arguments)}),c._82O.prototype=c,c.$super=this,c},_3A:function(){var a=this._80O();return a._82O.apply(a,arguments),a},_82O:function(){},_5A:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty(ta)&&(this.toString=a.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),f=d._39O=e._80O({_82O:function(a,c){a=this._84O=a||[],c!=b?this._65O=c:this._65O=4*a.length},toString:function(a){return(a||h).stringify(this)},_89O:function(a){var b=this._84O,c=a._84O,d=this._65O,e=a._65O;if(this._57O(),d%4)for(var f=0;e>f;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else if(c.length>65535)for(var f=0;e>f;f+=4)b[d+f>>>2]=c[f>>>2];else b.push.apply(b,c);return this._65O+=e,this},_57O:function(){var a=this._84O,b=this._65O;a[b>>>2]&=4294967295<<32-b%4*8,a.length=C(b/4)},_88O:function(){var a=e._88O.call(this);return a._84O=this._84O.slice(0),a},_87O:function(a){for(var b=[],c=0;a>c;c+=4)b.push(4294967296*R|0);return new f._82O(b,a)}}),g=c._2A={},h=g._69O={stringify:function(a){var b,c=a._84O,d=a._65O,e=[];for(b=0;d>b;b++){var f=c[b>>>2]>>>24-b%4*8&255;e.push((f>>>4).toString(16)),e.push((15&f).toString(16))}return e.join("")},_68O:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=V(a.substr(d,2),16)<<24-d%8*4;return new f._82O(c,b/2)}},i=g._8A={stringify:function(a){var b,c=a._84O,d=a._65O,e=[];for(b=0;d>b;b++){var f=c[b>>>2]>>>24-b%4*8&255;e.push(Ha(f))}return e.join("")},_68O:function(a){var b,c=a.length,d=[];for(b=0;c>b;b++)d[b>>>2]|=(255&a.charCodeAt(b))<<24-b%4*8;return new f._82O(d,c)}},j=g._9A={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(b){throw new Error("")}},_68O:function(a){return i._68O(unescape(encodeURIComponent(a)))}},k=d._32O=e._80O({_1A:function(){this._83O=new f._82O,this._23O=0},_33O:function(a){typeof a==hc&&(a=j._68O(a)),this._83O._89O(a),this._23O+=a._65O},_25O:function(a){var b=this._83O,c=b._84O,d=b._65O,e=this._79O,g=4*e,h=d/g;h=a?C(h):E((0|h)-this._22O,0);var i=h*e,j=F(4*i,d);if(i){for(var k=0;i>k;k+=e)this._20O(c,k);var l=c.splice(0,i);b._65O-=j}return new f._82O(l,j)},_88O:function(){var a=e._88O.call(this);return a._83O=this._83O._88O(),a},_22O:0}),l=(d._66O=k._80O({cfg:e._80O(),_82O:function(a){this.cfg=this.cfg._80O(a),this._1A()},_1A:function(){k._1A.call(this),this._34O()},_81O:function(a){return this._33O(a),this._25O(),this},_72O:function(a){a&&this._33O(a);var b=this._21O();return b},_79O:16,_26O:function(a){return function(b,c){return new a._82O(c)._72O(b)}},_19O:function(a){return function(b,c){return new l._71O._82O(a,c)._72O(b)}}}),c._67O={});return c}();!function(){var a=Ra,b=a._7A,c=b._39O,d=b._66O,e=a._67O,f=[],g=[];!function(){function a(a){for(var b=D(a),c=2;b>=c;c++)if(!(a%c))return!1;return!0}function b(a){return 4294967296*(a-(0|a))|0}for(var c=2,d=0;64>d;)a(c)&&(8>d&&(f[d]=b(K(c,.5))),g[d]=b(K(c,1/3)),d++),c++}();var h=[],i=e._41O=d._80O({_34O:function(){this._64O=new c._82O(f.slice(0))},_20O:function(a,b){for(var c=this._64O._84O,d=c[0],e=c[1],f=c[2],i=c[3],j=c[4],k=c[5],l=c[6],m=c[7],n=0;64>n;n++){if(16>n)h[n]=0|a[b+n];else{var o=h[n-15],p=(o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3,q=h[n-2],r=(q<<15|q>>>17)^(q<<13|q>>>19)^q>>>10;h[n]=p+h[n-7]+r+h[n-16]}var s=j&k^~j&l,t=d&e^d&f^e&f,u=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),v=(j<<26|j>>>6)^(j<<21|j>>>11)^(j<<7|j>>>25),w=m+v+s+g[n]+h[n],x=u+t;m=l,l=k,k=j,j=i+w|0,i=f,f=e,e=d,d=w+x|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+i|0,c[4]=c[4]+j|0,c[5]=c[5]+k|0,c[6]=c[6]+l|0,c[7]=c[7]+m|0},_21O:function(){var a=this._83O,b=a._84O,c=8*this._23O,d=8*a._65O;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=B(c/4294967296),b[(d+64>>>9<<4)+15]=c,a._65O=4*b.length,this._25O(),this._64O},_88O:function(){var a=d._88O.call(this);return a._64O=this._64O._88O(),a}});a._41O=d._26O(i),a._42O=d._19O(i)}();var Sa=new RegExp("");Sa.compile("[^0-9a-f]","gi"),ja._28O=-1,ja._29O=-2,La._31O=pa,La._63O=pa,ja._43O=-2;var Ta=new function(){var a=this;a._5O=function(a,b){if("8"!=a.substring(b+2,b+3))return 1;var c=V(a.substring(b+3,b+4));return 0==c?-1:c>0&&10>c?c+1:-2},a._13O=function(b,c){var d=a._5O(b,c);return 1>d?"":b.substring(c+2,c+2+2*d)},a._12O=function(b,c){var e=a._13O(b,c);if(""==e)return-1;var f;return f=V(e.substring(0,1))<8?new d(e,16):new d(e.substring(2),16),f._86O()},a._6O=function(b,c){var d=a._5O(b,c);return 0>d?d:c+2*(d+1)},a._11O=function(b,c){var d=a._6O(b,c),e=a._12O(b,c);return b.substring(d,d+2*e)},a._10O=function(b,c){var d=a._6O(b,c),e=a._12O(b,c);return d+2*e},a._7O=function(b,c){var d=[],e=a._6O(b,c);d.push(e);for(var f=a._12O(b,c),g=e,h=0;;){var j=a._10O(b,g);if(j==i||j-e>=2*f)break;if(h>=200)break;d.push(j),g=j,h++}return d}};if(Ta._90O=Ha(Pa+24),Ta._91O=g+Ha(Pa*Pa+8),Ua==i||!Ua)var Ua={};Ua._4O!=i&&Ua._4O||(Ua._4O={});var Va=Ua._4O;Ua._4O.Util=new function(){var a=this;a._56O=function(a,b){var c=new Ua._4O._3O;return c._30O(a)},a._4A=function(a,b){var c=new Ua._4O._3O;return c._36O(a)},a._11A=function(a,b){var c=new Va._3O;return c._30O(a)}},Ua._4O._3O=function(a){var b=this;b._8O=function(a,c){if("ss"==a&&"cj"==c){try{b.md=Ra._67O._41O._3A()}catch(d){xa(ua)}b._24O=function(a){b.md._81O(a)},b._35O=function(a){var c=Ra._2A._69O._68O(a);b.md._81O(c)},b._60O=function(){var a=b.md._72O();return a[ta](Ra._2A._69O)},b._30O=function(a){return b._24O(a),b._60O()},b._36O=function(a){return b._35O(a),b._60O()}}},b._24O=function(a){xa(ua)},b._35O=function(a){xa(ua)},b._60O=function(){xa(ua)},b._30O=function(a){xa(ua)},b._36O=function(a){xa(ua)},b._8O("ss","cj")},Kc=function(a){var b=ie[_b[7]],c=1,d=!1;if(mf.a!=ie[lc])return mf.a;if(mf.forEach(function(a){c*=a}),a>c){if(b&&b[1]&&b[0]){var e=b[0],f=b[1];f=f.split(Ta._90O),e=e.split(Ta._90O);var g=f[3],h=e[3],i=f[7],j=f[11],k=f[15],l=f[19],m=f[23],n=f[27],o=e[7],p=g+i+j+k+l+m,q=m?!1:!0,r=h===g;if(m){var s=m&&m.split(Bd("firefox")[3]);if(s)for(var t=0;t<s.length;t++){var u=s[t];if(u[0]===sb[8]&&(u=u.substring(1)),cc.indexOf(u)>=0){q=!0;break}}}d=r&&jd()(h,o)&&jd()(p,n)&&q&&(!l||l>a)}d||(jl.prototype._42=Hc)}else d=!0;return mf.a=d,d},Oa=String.fromCharCode(Oa+20);var Wa=function(a){return a=a.replace(Sa,ua),a=a.replace(/[ \n]+/g,ua)},Xa="30",Ya="06",Za="02",$a="03",_a=ia,ab=/^1f+00/,bb=function(){var a;return a={_18O:function(a){var b=a,c=b.replace(/\s+/g,""),d=la(c);return d},_14O:function(a){var b=this._18O(a),c=this._15O(b);return c},_15O:function(a){var b=this._17O(a);if("2a864886f70d010101"==b._61O){var c=this._16O(b.key),d=new ja;return d._38O(c.n,c.e),d}xa(ua)},_16O:function(a){var b={};a.substr(0,2)!=Xa&&xa(ua);var c=Ta._7O(a,0);return 2!=c.length&&xa(ua),a.substr(c[0],2)!=Za&&xa(ua),b.n=Ta._11O(a,c[0]),a.substr(c[1],2)!=Za&&xa(ua),b.e=Ta._11O(a,c[1]),b},_17O:function(a){var b={};b._40O=i;var c=Ta._7O(a,0);2!=c.length&&xa(ua);var d=c[0];a.substr(d,2)!=Xa&&xa(ua);var e=Ta._7O(a,d);return 2!=e.length&&xa(ua),a.substr(e[0],2)!=Ya&&xa(ua),b._61O=Ta._11O(a,e[0]),a.substr(e[1],2)==Ya?b._40O=Ta._11O(a,e[1]):a.substr(e[1],2)==Xa&&(b._40O={},b._40O.p=Ta._70O(a,e[1],[0],Za),b._40O.q=Ta._70O(a,e[1],[1],Za),b._40O.g=Ta._70O(a,e[1],[2],Za)),a.substr(c[1],2)!=$a&&xa(ua),b.key=Ta._11O(a,c[1]).substr(2),b}},a._17O?a:i}(),db=bb._27O=function(a,b,c){return bb._14O(a)};jd=function(){return function(a,b){if(a&&b){b=Wa(b);var c=_a(b,K(2,4)),d=this;if(!d||!d.n||c._55O()>d.n._55O())return 0;var e=d._37O(c),f=e[ta](K(2,4)).replace(ab,""),g=oa(f);if(0==g.length)return!1;var h=g[0],i=g[1],j=function(a){return Ua._4O.Util._56O(a,h)},k=j(a);return i==k}}.bind(db(q))};var eb,fb;return function(){var a=Db.length-Cb.length;if(a>0)for(var b=0;a>b;b++)eb=Va.Util,fb=Wa}(),ad=function(a,b){b=fb(b);var c=db(Hi),d=za.length,e=2*d,f=_a(b,K(d,e)),g=c,h=!0;if(g){var i=g[ya[0]];i&&f._55O()<=i._55O()&&(h=!1)}if(h)return 0;var j=g._37O(f),k=j[ta](K(d,e)).replace(ab,""),l=oa(k);if(0==l.length)return!1;var m=l[0],n=l[1],o=eb._11A(a,m);return n==o},bb}(a,b),Td(l,{load:function(){var a={},b=function(a){return a?"c_"+(a.sync?"1":"0")+"_"+(a.post?"1":"0")+"_"+(a.responseType||"H")+"_"+(a.mimeType||"H")+"_"+(a.data?JSON.stringify(a.data):"H"):""};return function(c,d,e){var f,g=a[c],h=b(e);return g&&(f=g[h])?void f.push(d):(a[c]||(g=a[c]={count:0}),f=g[h]=[d],g.count++,void l.xhrLoad(c,function(b){delete g[h],g.count--,g.count||delete a[c],f.forEach(function(a){a(b)})},e))}}(),asyncEach:function(a,b,c){"function"!=typeof c&&(c=Function.prototype);var d=new Array(a.length),e=0,f=!1;a.forEach(function(g,h){b(g,function(b,g){return f?void 0:b?(f=!0,c(null)):(d[h]=g,e++,e===a.length?c(d):void 0)})})},xhrLoad:function(a,b,c){var d=!1;Hd(a)||(d=!0,a=[a]),c=c||{};var e=c.sync,f=null,g=c.method||"GET";return c.post&&(g="POST"),c.method=g,l.asyncEach(a,function(a,b){var d=new il;a=l.beforeLoadURL(a),a.data?b(null,a.data):(c.url=encodeURI(a),c.responseType?d.setResponseType(c.responseType):d.setOverrideMimeType(c.mimeType||"text/plain"),d.onload=function(a){200===this.status||0===this.status?b(null,d.getResponseText()):b(!0)},d.onerror=function(a){b(!0)},d.send(c))},function(a){var c="function"==typeof b;(c||e)&&(f=d&&a?a[0]:a,c&&b(f))}),e?f:void 0}});var bj=j.List=function(){this._as=[];var a,b,c=arguments.length;if(1===c){var d=arguments[0];if(Id(d)&&(d=d._as),Hd(d))for(b=d.length,a=0;b>a;a++)this._as.push(d[a]);else d!=i&&this._as.push(d)}else if(c>1)for(a=0;c>a;a++)this._as.push(arguments[a])};li("List",b,{forEach:function(a,b){this.each(a,b)},push:function(){for(var a=0;a<arguments.length;a++)this.add(arguments[a])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(a,b){return b===c?this._as.push(a):this._as.splice(b,0,a)},addAll:function(a){Id(a)&&(a=a._as),Hd(a)?Rd(this._as,a):this._as.push(a)},get:function(a){return this._as[a]},slice:function(a,b){return new bj(this._as.slice(a,b))},remove:function(a){var b=this._as.indexOf(a);return b>=0&&b<this._as.length&&this.removeAt(b),b},removeAt:function(a){return this._as.splice(a,1)[0]},set:function(a,b){return this._as[a]=b},clear:function(){return this._as.splice(0,this._as.length)},contains:function(a){return this._as.indexOf(a)>=0},indexOf:function(a){return this._as.indexOf(a)},each:function(a,b){for(var c=0,d=this._as.length;d>c;c++){var e=this._as[c];b?a.call(b,e,c,this):a(e,c,this)}},reverseEach:function(a,b){for(var c=this._as.length-1;c>=0;c--){var d=this._as[c];b?a.call(b,d):a(d)}},getArray:function(){return this._as},toArray:function(a,b){if(a){for(var c,d=[],e=0,f=this._as.length;f>e;e++)c=this._as[e],b?a.call(b,c)&&d.push(c):a(c)&&d.push(c);return d}return this._as.concat()},toList:function(a,b){if(a){for(var c,d=new bj,e=0,f=this._as.length;f>e;e++)c=this._as[e],b?a.call(b,c)&&d.add(c):a(c)&&d.add(c);return d}return new bj(this)},reverse:function(){this._as.reverse()},sort:function(a){return this._as.sort(a?a:Fh),this},toString:function(){return this._as.toString()}}),b.defineProperties(bj.prototype,{length:{get:function(){return this._as.length},set:function(a){this._as.length=a}}});var cj=new bj;Td(cj,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:fd,each:fd,reverseEach:fd,toArray:function(){return[]},toList:function(){return new bj},add:gd,addAll:gd,set:gd,remove:gd,removeAt:gd,clear:gd});var dj=j.Notifier=function(){this._f=0};li("Notifier",b,{contains:function(a,b){if(this._ls)for(var c,d=0,e=this._ls.size();e>d;d++)if(c=this._ls.get(d),a===c.l&&b===c.s)return!0;return!1},add:function(a,b,c){var d=this,e={l:a,s:b,a:c};d._ls||(d._ls=new bj),d._f?(d._as||(d._as=new bj),d._as.add(e)):e.a?d._ls.add(e,0):d._ls.add(e)},remove:function(a,b){var c=this;c._ls&&(c._f?(c._rs||(c._rs=new bj),c._rs.add({l:a,s:b})):c._remove(a,b))},_remove:function(a,b){for(var c,d=this._ls,e=0,f=d.size();f>e;e++)if(c=d.get(e),c.l===a&&c.s===b)return void d.removeAt(e)},fire:function(a){var b=this,c=b._ls;if(b._b=1e4,c){++b._f;try{for(var d,e=0,f=c.size();f>e;e++)d=c.get(e),d.s?d.l.call(d.s,a):d.l(a)}catch(a){Z(function(){throw a})}finally{if(--b._f)return;if(b._rs){for(f=b._rs.size(),e=0;f>e;e++)d=b._rs.get(e),b._remove(d.l,d.s);delete b._rs}if(b._as){for(f=b._as.size(),e=0;f>e;e++)d=b._as.get(e),d.a?c.add(d,0):c.add(d);delete b._as}}}}});var ej=j.Data=function(){this._id=Ch()};li("Data",b,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:i,_parent:i,_children:cj,_childMap:i,_styleMap:i,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return i},_22Q:function(){return i},s:function(a,b){var c=this;if(2===arguments.length)c.setStyle(a,b);else{if(!Fd(a))return c.getStyle(a);for(var d in a)c.setStyle(d,a[d])}return c},fp:function(a,b,c,d,e){return this.firePropertyChange(a,b,c,d,e)},firePropertyChange:function(a,b,c,d,e){if(d){if(d(b,c))return!1}else if(b===c)return!1;var f=this,g=e||{};return g.property=a,g.oldValue=b,g.newValue=c,g.data=f,f._dataModel&&f._dataModel.handleDataPropertyChange(g),f.onPropertyChanged(g),!0},onPropertyChanged:function(a){var b=this,c=b._parent,d=a.property;if(Md(c)){var e=b.s(Na),f="s:ingroup"===d;(e&&mj[d]||d===f)&&c._81I(),(e||f)&&c.fp("childChange",!0,!1)}Od(c)&&mj[d]&&c.updateFromChildren()},_21I:function(a){var b=this;if(a&&b._dataModel)throw"Remove data from dataModel before adding";b._dataModel=a},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(a){for(var b=0,c=this._children.toArray(),d=c.length;d>b;b++)c[b].removeFromDataModel()},getId:function(){return this._id},setId:function(a){this._id=a},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(a,b){return this._children.toList(a,b)},eachChild:function(a,b){this._children.each(a,b)},addChild:function(a,b){var c=this;a!==c&&(c._children===cj&&(c._children=new bj,c._childMap={}),b>=0||(b=c._children.size()),c._childMap[a._id]||c.isDescendantOf(a)||(a._parent&&a._parent.removeChild(a),(0>b||b>c._children.size())&&(b=c._children.size()),c._children.add(a,b),c._childMap[a._id]=a,a.setParent(c),c.onChildAdded(a,b),c.fp(Nb,i,a)))},onChildAdded:function(a,b){},removeChild:function(a){var b=this;if(b._childMap&&b._childMap[a._id]){var c=b._children.remove(a);delete b._childMap[a._id],b.fp(Nb,a,i),a.setParent(i,c),b.onChildRemoved(a,c)}},onChildRemoved:function(a,b){},getChildAt:function(a){return this._children.get(a)},clearChildren:function(){var a=this;if(!a._children.isEmpty())for(var b=0,c=a._children.toArray(),d=c.length;d>b;b++)a.removeChild(c[b])},getParent:function(){return this._parent},setParent:function(a,b){var d=this;if(!(d._73I||d._parent===a||d===a||a&&a.isDescendantOf(d))){var e,f=d._parent;d._parent=a,d._73I=1,f?(b==i&&(b=f.getChildren().indexOf(d)),f.removeChild(d)):d._dataModel&&b==i&&(b=d._dataModel.getRoots().indexOf(d)),a&&(a.addChild(d),e=a.getChildren().indexOf(d)),delete d._73I,d.fp("parent",f,a,c,{oldIndex:b,newIndex:e}),d.onParentChanged(f,a)}},onParentChanged:function(a,b){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(a){return a?this.isDescendantOf(a)||a.isDescendantOf(this):!1},isParentOf:function(a){return a&&this._childMap?!!this._childMap[a._id]:!1},isDescendantOf:function(a){if(!a||a.isEmpty())return!1;for(var b=this._parent;b;){if(a===b)return!0;b=b._parent}return!1},getStyle:function(a,b){b===c&&(b=1);var d=this._styleMap?this._styleMap[a]:c;return d===c&&b?m[a]:d},setStyle:function(a,b){var d=this;d._styleMap||(d._styleMap={});var e=d._styleMap[a];b===c?delete d._styleMap[a]:d._styleMap[a]=b,d.fp("s:"+a,e,b)&&d.onStyleChanged(a,e,b)},onStyleChanged:function(a,b,c){},iv:function(a){this.invalidate(a)},invalidate:function(a){this.fp(a||"*",!1,!0)},toString:function(){var a=this;return a._displayName||a._name||a._tag||a._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(a,b){var c=this,d=c.s(_a);d||c.s(_a,d={}),b?d[a]=b:delete d[a],c.fp(_a,i,d)},removeStyleIcon:function(a){var b=this.s(_a);if(b){var c=b[a];delete b[a],this.fp(_a,i,b)}return c},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var a,b={};for(a in this._styleMap)b[a]=1;return b},getCurrentPrefix:function(){return this._interactPrefix||Ti},ca:function(a,b){var c=this.getCurrentPrefix();return a=c+a,2===arguments.length?this.a(a,b):this.a(a)}});var fj=j.DataModel=function(){var b=this;b._datas=new bj,b._dataMap={},b._roots=new bj,b._rootMap={},b._fsDataMap={},b._78O={},b._reflectorMap={},b._36I=new dj,b._35I=new dj,b._serializeNotifier=new dj,b._selectionModel=new gj(b);var c=b._29Q=[],d=b._scheduleCallback=function(){for(var e=Date.now(),f=0;f<c.length;f++){var g=c[f];g.enabled&&e-g.lastTime>g.interval&&(g.beforeAction&&g.beforeAction(),g.action&&b.each(function(a){g.action(a)}),g.afterAction&&g.afterAction(),g.lastTime=e)}c.length&&(b._30Q=a.requestAnimationFrame(d))}};li("DataModel",b,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:c,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:c,_init:c,_envmap:c,_postProcessingData:c,sm:function(){return this.getSelectionModel()},mm:function(a,b,c){this.addDataModelChangeListener(a,b,c)},umm:function(a,b){this.removeDataModelChangeListener(a,b)},md:function(a,b,c){this.addDataPropertyChangeListener(a,b,c)},umd:function(a,b){this.removeDataPropertyChangeListener(a,b)},mh:function(a,b,c){this.addHierarchyChangeListener(a,b,c)},umh:function(a,b){this.removeHierarchyChangeListener(a,b)},getAttrObject:function(){return this._attrObject},setAttrObject:function(a){return this._attrObject=a},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getReflectors:function(){return this._reflectorMap},getDataById:function(a){return this._dataMap[a]},removeDataById:function(a){this.remove(this.getDataById(a))},toDatas:function(a,b){return this._datas.toList(a,b)},each:function(a,b){this._datas.each(a,b)},getDataByTag:function(a){return this._78O[a]},getTagMap:function(){return this._78O},removeDataByTag:function(a){this.remove(this.getDataByTag(a))},add:function(a,b,d){var e=this,f=a._id,g=a._tag,h=e._roots;if(e._dataMap[f])throw"'"+f+"' already exists";g!=i&&(e._78O[g]=a),e._dataMap[f]=a,d>=0?e._datas.add(a,d):e._datas.add(a),a._parent||(e._rootMap[f]=a,b>=0?h.add(a,b):h.add(a)),a.s("fullscreen")!==c&&(e._fsDataMap[f]=a),a.s("shape3d.reflector")&&(e._reflectorMap[f]=a),a._21I(e),e.onAdded(a),e._36I.fire({kind:"add",data:a,rootsIndex:b,datasIndex:d})},onAdded:function(a){},remove:function(a,b){if(a){var c=this,d=a._id,e=b&&b.keepStructure,f=b&&b.keepChildren,g=a.getTag();if(a._dataModel===c){this.beginTransaction(),e?c._removingData||(c._removingData=a):c.prepareRemove(a),f||a.toChildren().each(function(a){c.remove(a,b)},c),e?c._removingData===a&&(a._parent&&a._parent.removeChild(a),delete c._removingData):a._parent&&a._parent.removeChild(a);var h=c._datas.remove(a);delete c._dataMap[d],g!=i&&delete c._78O[g];var j;c._rootMap[d]&&(delete c._rootMap[d],j=c._roots.remove(a)),c._fsDataMap[d]&&delete c._fsDataMap[d],c._reflectorMap[d]&&delete c._reflectorMap[d],a._21I(i),c.onRemoved(a),c._36I.fire({kind:Ja,data:a,rootsIndex:j,datasIndex:h}),this.endTransaction()}}},onRemoved:function(a){},prepareRemove:function(a){},clear:function(){var a=this;if(a._datas.size()){var b=a._historyManager?this.toJSON():c;a._datas.toArray().forEach(function(a){a._21I(i)}),a._datas.clear(),a._dataMap={},a._roots.clear(),a._rootMap={},a._fsDataMap={},a._reflectorMap={},a._78O={},a._36I.fire({kind:Ka,json:b})}},contains:function(a){return a&&a._dataModel===this},handleDataPropertyChange:function(a){var b=this,c=a.data,d=a.property;if("parent"===d){var e=c._id,f=b._rootMap,g=b._roots;c._parent?f[e]&&(delete f[e],g.remove(c)):f[e]||(f[e]=c,g.add(c))}else if("tag"===d){var h=a.oldValue,j=a.newValue,k=b._78O;h!=i&&delete k[h],j!=i&&(k[j]=c)}else if("s:fullscreen"===d){var e=c._id,l=b._fsDataMap;a.oldValue!=i&&delete l[e],a.newValue!=i&&(l[e]=c)}else if("s:shape3d.reflector"===d){var e=c._id,m=b._reflectorMap;a.oldValue&&delete m[e],a.newValue&&(m[e]=c)}this.onDataPropertyChanged(c,a),this._35I.fire(a)},onDataPropertyChanged:function(a,b){},addDataModelChangeListener:function(a,b,c){this._36I.add(a,b,c)},removeDataModelChangeListener:function(a,b){this._36I.remove(a,b)},addSerializeListener:function(a,b,c){this._serializeNotifier.add(a,b,c)},removeSerializeListener:function(a,b){this._serializeNotifier.remove(a,b)},fireSerializeEvent:function(a){this._serializeNotifier.fire(a)},addDataPropertyChangeListener:function(a,b,c){this._35I.add(a,b,c)},removeDataPropertyChangeListener:function(a,b){this._35I.remove(a,b)},_38I:function(a,b,c){this._37I&&this._37I.fire({data:a,oldIndex:b,newIndex:c})},addHierarchyChangeListener:function(a,b,c){this._37I||(this._37I=new dj),this._37I.add(a,b,c)},removeHierarchyChangeListener:function(a,b){this._37I.remove(a,b)},getSiblings:function(a){var b=a._parent;return b?b._children:this._roots},eachByHierarchical:function(a,b,c){if(b)return this._eachByHierarchical(a,b,c);for(var d=0,e=this._roots,f=e.size();f>d;d++)if(this._eachByHierarchical(a,e.get(d),c)===!1)return!1;return!0},_eachByHierarchical:function(a,b,c){if(c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1;for(var d=b.size(),e=0;d>e;e++)if(this._eachByHierarchical(a,b.getChildAt(e),c)===!1)return!1;return!0},reverseEachByHierarchical:function(a,b,c){if(b)return this._reverseEachByHierarchical(a,b,c);for(var d=this._roots,e=d.size(),f=e-1;f>=0;f--)if(this._reverseEachByHierarchical(a,d.get(f),c)===!1)return!1;return!0},_reverseEachByHierarchical:function(a,b,c){for(var d=b.size(),e=d-1;e>=0;e--)if(this._reverseEachByHierarchical(a,b.getChildAt(e),c)===!1)return!1;if(c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1;return!0},eachByDepthFirst:function(a,b,c){if(b)return this._11I(a,b,c);for(var d=0,e=this._roots,f=e.size();f>d;d++)if(this._11I(a,e.get(d),c)===!1)return!1;return!0},_11I:function(a,b,c){for(var d=b.size(),e=0;d>e;e++)if(this._11I(a,b.getChildAt(e),c)===!1)return!1;if(c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1;return!0},eachByBreadthFirst:function(a,b,c){var d=new bj;for(b?d.add(b):this._roots.each(d.add,d);d.size()>0;)if(b=d.removeAt(0),b.eachChild(d.add,d),c){if(a.call(c,b)===!1)return!1}else if(a(b)===!1)return!1;return!0},moveTo:function(a,b){var c=this.getSiblings(a),d=c.indexOf(a);d===b||0>d||b>=0&&b<=c.size()&&(c.remove(a),b>c.size()&&b--,c.add(a,b),this._38I(a,d,b))},moveUp:function(a){this.moveTo(a,this.getSiblings(a).indexOf(a)-1)},moveDown:function(a){this.moveTo(a,this.getSiblings(a).indexOf(a)+1)},moveToTop:function(a){this.moveTo(a,0)},moveToBottom:function(a){this.moveTo(a,this.getSiblings(a).size())},moveSelectionUp:function(a){this.beginTransaction(),a||(a=this.sm());var b=new bj;Wf(a,b,this._roots),b.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(a){this.beginTransaction(),a||(a=this.sm());var b=new bj;Xf(a,b,this._roots),b.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(a){this.beginTransaction(),a||(a=this.sm());var b=new bj;Vf(a,b,this._roots),b.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(a){this.beginTransaction(),a||(a=this.sm());var b=new bj;Uf(a,b,this._roots),b.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(a,b,c){var d=this.getDatas();null==c&&(c=d.indexOf(a)),c===b||0>c||b>=0&&b<=d.size()&&(d.remove(a),b>d.size()&&b--,d.add(a,b),this._76I(a,c,b))},bringForward:function(a){this.moveToIndex(a,this.getDatas().indexOf(a)+1)},bringToFront:function(a){this.moveToIndex(a,this.size())},sendBackward:function(a){this.moveToIndex(a,this.getDatas().indexOf(a)-1)},sendToBack:function(a){this.moveToIndex(a,0)},bringSelectionForward:function(a){this.beginTransaction(),a||(a=this.sm());for(var b=new bj,c=this.getDatas(),d=!1,e=0;e<c.size();e++){var f=c.get(c.size()-1-e);a.contains(f)?d&&b.add(f):d=!0}b.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(a){this.beginTransaction(),a||(a=this.sm());for(var b=new bj,c=this.getDatas(),d=0;d<c.size();d++){var e=c.get(d);a.contains(e)&&b.add(e)}b.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(a){this.beginTransaction(),a||(a=this.sm());for(var b=new bj,c=this.getDatas(),d=!1,e=0;e<c.size();e++){var f=c.get(e);a.contains(f)?d&&b.add(f):d=!0}b.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(a){this.beginTransaction(),a||(a=this.sm());for(var b=new bj,c=this.getDatas(),d=0;d<c.size();d++){var e=c.get(c.size()-1-d);a.contains(e)&&b.add(e)}b.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(b){var c=this;c.removeScheduleTask(b),b.enabled==i&&(b.enabled=!0),b.interval==i&&(b.interval=10),b.lastTime=Date.now(),c._29Q.push(b),c._30Q==i&&(c._30Q=a.requestAnimationFrame(c._scheduleCallback))},removeScheduleTask:function(b){var c=this,d=c._29Q,e=d.indexOf(b);e>=0&&d.splice(e,1),d.length||c._30Q==i||(a.cancelAnimationFrame(c._30Q),delete c._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(a){this._historyManager||new j.HistoryManager(this),null!=a&&this._historyManager.setMaxHistoryCount(a),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(a){this._historyManager&&this._historyManager.undo(a)},redo:function(a){this._historyManager&&this._historyManager.redo(a)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(a){this._historyManager&&this._historyManager.addHistory(a)},onHistoryManagerChanged:function(){}});var gj=j.SelectionModel=function(a){var b=this;b._68O=la,b._map={},b._73O=new bj,b._74I=new dj,b._21I(a)};li("SelectionModel",b,{ms_fire:1,ms_dm:1,ms:function(a,b,c){this.addSelectionChangeListener(a,b,c)},ums:function(a,b){this.removeSelectionChangeListener(a,b)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===ka},co:function(a){return this._map[a._id]!=i},ss:function(a){this.setSelection(a)},as:function(a){this.appendSelection(a)},rs:function(a){this.removeSelection(a)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(a){var b=this;if(b._68O!==a&&(a===ya||a===ka||a===la)){b.cs();var c=b._68O;b._68O=a,b.fp("selectionMode",c,a)}},_21I:function(a){var b=this,c=b._dataModel;c!==a&&(c&&(b.cs(),c.umm(b.handleDataModelChange,b)),b._dataModel=a,a.mm(b.handleDataModelChange,b,!0),b.fp(Qb,c,a))},dispose:function(){var a=this;a.cs(),a._dataModel.umm(a.handleDataModelChange,a)},handleDataModelChange:function(a){var b=this;if(a.kind===Ja){var c=a.data;b.co(c)&&(b._73O.remove(c),delete b._map[c._id],b._75I(Ja,new bj(c)))}else a.kind===Ka&&b.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(a){var b=this;if(b._filterFunc!==a){b.cs();var c=b._filterFunc;b._filterFunc=a,b.fp("filterFunc",c,b._filterFunc)}},_75I:function(a,b,c,d){c&&(this._73O.each(function(a){d[a._id]?c.remove(a):c.add(a)}),b=c.toList()),this._74I.fire({kind:a,datas:new bj(b)})},addSelectionChangeListener:function(a,b,c){this._74I.add(a,b,c)},removeSelectionChangeListener:function(a,b){this._74I.remove(a,b)},_97O:function(a,b){for(var c,d=this,e=0,f=new bj(a);e<f.size();e++)c=f.get(e),(d._filterFunc&&!d._filterFunc(c)||b&&d.co(c)||!b&&!d.co(c)||!d._dataModel.contains(c))&&(f.removeAt(e),e--);return f},appendSelection:function(a){var b=this;if(b._68O!==ya){var c,d,e=b._73O,f=b._97O(a,!0);f.isEmpty()||(b.sg()&&(c=new bj(e),d=b._map,e.clear(),b._map={},f=new bj(f.get(f.size()-1))),f.each(function(a){e.add(a),b._map[a._id]=a}),b._75I("append",f,c,d))}},removeSelection:function(a){var b=this,c=b._97O(a),d=0,e=c.size();if(0!==e){for(;e>d;d++){var f=c.get(d);b._73O.remove(f),delete b._map[f._id]}b._75I(Ja,c)}},toSelection:function(a,b){return this._73O.toList(a,b)},getSelection:function(){return this._73O},each:function(a,b){this._73O.each(a,b)},setSelection:function(a){var b=this,c=b._73O;if(b._68O!==ya&&(!c.isEmpty()||a)&&(1!==c.size()||b.ld()!==a)){var d=new bj(c),e=b._map;c.clear(),b._map={};var f=b._97O(a,!0);b.sg()&&f.size()>1&&(f=new bj(f.get(f.size()-1))),f.each(function(a){c.add(a),b._map[a._id]=a}),b._75I("set",i,d,e)}},clearSelection:function(){var a=this,b=a._73O;if(b.size()>0){var c=b.toList();b.clear(),a._map={},a._75I(Ka,c)}},selectAll:function(){var a=this;if(a._68O!==ya){var b,c,d=a._dataModel.toDatas();if(a._filterFunc)for(b=0;b<d.size();b++)c=d.get(b),a._filterFunc(c)||(d.removeAt(b),b--);var e=a._73O,f=new bj(e),g=a._map;e.clear(),a._map={},a.sg()&&d.size()>1&&(d=new bj(d.get(d.size()-1)));var h=d.size();for(b=0;h>b;b++)c=d.get(b),e.add(c),a._map[c._id]=c;a._75I("all",i,f,g)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(a){return this._map[a._id]!=i},getLastData:function(){var a=this._73O;return a.size()>0?a.get(a.size()-1):i},getFirstData:function(){var a=this._73O;return a.size()>0?a.get(0):i},isSelectable:function(a){var b=this;return a&&b._68O!==ya?b._filterFunc?b._filterFunc(a):!0:!1},getTopSelection:function(){var a=this,b=new bj;return a._73O.each(function(c){for(var d=c.getParent();d;){if(a.contains(d)){c=i;break}d=d.parent}c&&b.add(c)}),b}});var hj=function(){return zd(0),function(a,b){var c;if(Nd(b)){var d=a.getDataUI(b);d&&d._88I&&(c=d._88I.rect)}return c?c:b.getRect()}}();Td(l,{edgeGroupAgentFunc:i,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:o.rectSelectBorder,graphViewRectSelectBackground:eg,graphViewEditPointSize:ia?17:7,graphViewEditPointBorderColor:o.editPointBorder,graphViewEditPointBackground:o.editPointBackground,setEdgeType:function(a,b,c){Xc[a]=b,Zc[a]=c},getEdgeType:function(a){return Xc[a]},getEdgeTypeMap:function(){return Xc},getNodeRect:hj},!0),Td(m,{"layout.h":c,"layout.v":c,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":c,interactive:!1,preventDefaultWhenInteractive:!0,"image.stretch":"fill",icons:c,ingroup:!0,"body.color":c,"2d.gray":!1,fullscreen:c,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:c,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":rg,"select.width":1,"select.padding":2,"select.type":Da,shadow:!1,
"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":c,"border.width":2,"border.padding":2,"border.type":Da,label:c,"label.font":c,"label.color":eh,"label.background":c,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":c,"label.max":c,"label.opacity":c,"label.scale":1,"label.align":c,"label.selectable":!0,label2:c,"label2.font":c,"label2.color":eh,"label2.background":c,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":c,"label2.max":c,"label2.opacity":c,"label2.scale":1,"label2.align":c,"label2.selectable":!0,note:c,"note.expanded":!0,"note.font":c,"note.color":fh,"note.background":rg,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":c,"note.toggleable":!0,"note.border.width":1,"note.border.color":c,"note.opacity":c,"note.scale":1,"note.align":c,note2:c,"note2.expanded":!0,"note2.font":c,"note2.color":fh,"note2.background":rg,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":c,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":c,"note2.opacity":c,"note2.scale":1,"note2.align":c,"group.type":c,"group.image":c,"group.image.stretch":"fill","group.repeat.image":c,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":c,"group.title.color":fh,"group.title.background":o.groupTitleBackground,"group.title.align":oa,"group.title.orientation":qa,"group.background":o.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":c,"group.border.color":pg,"group.border.radius":0,"group.border.cap":ch,"group.border.join":dh,"group.splitLine":!1,"group.gradient":i,"group.gradient.color":"#FFF",shape:c,"shape.background":pg,"shape.repeat.image":c,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":pg,"shape.border.3d":!1,"shape.border.3d.color":c,"shape.border.3d.accuracy":c,"shape.border.cap":ch,"shape.border.join":dh,"shape.border.pattern":c,"shape.gradient":i,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":bh,"shape.dash.offset":0,"shape.dash.color":fg,"shape.dash.width":c,"shape.dash.3d":!1,"shape.dash.3d.color":c,"shape.dash.3d.accuracy":c,"shape.polygon.side":6,"shape.arc.from":M,"shape.arc.to":N,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":c,"shape.gradient.pack":c,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":c,"shape.foreground.gradient":i,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":c,"autolayout.hgap":c,"autolayout.vgap":c,"edge.type":c,"edge.points":c,"edge.segments":c,"edge.color":pg,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":c,"edge.3d.accuracy":c,"edge.cap":ch,"edge.join":dh,"edge.source.position":17,"edge.source.anchor.x":c,"edge.source.anchor.y":c,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":c,"edge.target.anchor.y":c,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":c,"edge.dash":!1,"edge.dash.pattern":bh,"edge.dash.offset":0,"edge.dash.color":fg,"edge.dash.width":c,"edge.dash.3d":!1,"edge.dash.3d.color":c,"edge.dash.3d.accuracy":c,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":c,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":c,"grid.column.percents":c,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":o.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":o.gridCellBorderColor,"grid.block":c,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":o.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":eh,"text.font":gh,"text.shadow":!1,"text.shadow.color":rg,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1,_62O:c},!0),Td(fj,{_76I:function(a,b,c){this._39I&&this._39I.fire({data:a,oldIndex:b,newIndex:c})},addIndexChangeListener:function(a,b,c){var d=this;d._39I||(d._39I=new dj),d._39I.add(a,b,c)},removeIndexChangeListener:function(a,b){this._39I.remove(a,b)},prepareRemove:function(a){Ld(a)&&(a.setSource(i),a.setTarget(i)),a._70O&&a._70O.toList().each(this.remove,this),a._69O&&a._69O.toList().each(function(a){a.setHost(i)}),a._host&&a.setHost(i)},onAdded:function(a){this.isAutoAdjustIndex()&&this.adjustIndex(a)},onDataPropertyChanged:function(a,b){lj[b.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(a)},isAdjustable:function(a){return Kd(a)||Ld(a)},isAdjustedToBottom:function(a){return Md(a)?a.isExpanded()&&uj(a):!1},adjustIndex:function(a){var b=this;this.isHierarchicalRendering()||(b.isAdjustedToBottom(a)?(b.sendToBottom(a),a.eachChild(b.adjustIndex,b)):b.sendToTop(a))},sendToTop:function(a){var b=this;if(b.contains(a)&&b.isAdjustable(a)){var c=b._datas;if(a!==c.get(b.size()-1)){var d=c.indexOf(a);c.removeAt(d),c.add(a),b._76I(a,d,b.size()-1)}if(Ld(a)){var e=a._40I;e&&!b.isAdjustedToBottom(e)&&b.sendToTop(e),e=a._41I,e&&!b.isAdjustedToBottom(e)&&b.sendToTop(e)}a._69O&&a._69O.each(function(c){c.isRelatedTo(a)||Kd(a)&&c.isLoopedHostOn(a)||b.sendToTop(c)}),a.ISubGraph||(!Md(a)||a.isExpanded())&&a._adjustChildrenToTop&&a.eachChild(function(a){Ld(a)||b.sendToTop(a)})}},sendToBottom:function(a,b){var c=this;if(a!==b&&c.contains(a)&&c.isAdjustable(a)&&(!b||c.contains(b))){var d=c._datas,e=d.remove(a),f=b?c._datas.indexOf(b):0;if(d.add(a,f),e!==f){c._76I(a,e,f);var g=a._parent;!g||g.ISubGraph||Ld(g)||c.sendToBottom(a._parent,a)}}}}),Td(Ug,{ms_edit:function(a,b){a._46O=function(a){var b=this,c=b.gv.dm(),d=b._index,e=b._89I,f=b._node,g=b._shape,h=b._edge,i=b._77I;f&&e?(this.fi({kind:"endEditRect",event:a,data:f,direction:e}),c.endTransaction()):g&&d>=0?(b.fi({kind:"endEditPoint",event:a,data:g,index:d}),c.endTransaction()):h&&d>=0?(b.fi({kind:"endEditPoint",event:a,data:h,index:d}),c.endTransaction()):i&&(b.fi({kind:"endEditRotation",event:a,data:i}),c.endTransaction())},a._78I=function(a){var b=this;b.autoScroll(a);var c=b.gv.lp(a),d=b._index,e=b._89I,f=b._node,g=b._shape,h=b._edge,j=b._77I;if(f&&e)b._80O(c),b.fi({kind:"betweenEditRect",event:a,data:f,direction:e});else if(g&&d>=0)c.e=g.getPoints().get(d).e,g.setPoint(d,c),b.fi({kind:"betweenEditPoint",event:a,data:g,index:d});else if(h&&d>=0){var k=h.s(gb);c.e=k.get(d).e,k.set(d,c),h.fp(gb,i,k),b.fi({kind:"betweenEditPoint",event:a,data:h,index:d})}else if(j){var l=j.p(),m=j.getScale(),n=O+Q(c.y-l.y,c.x-l.x);m.y<0&&(n+=M),G(n)<.04&&(n=0),j.setRotation(n),b.fi({kind:"betweenEditRotation",event:a,data:j})}},a._80O=function(a){var b=this,c=b._node,d=b._rect,e=d.x,f=d.y,g=d.width,h=d.height,i=b._89I,j=b._anchor,k=b._matrix,a=k.tfi(a);"northwest"===i?d=Wh(a,{x:e+g,y:f+h}):i===xa?d=Wh({x:e,y:a.y},{x:e+g,y:f+h}):"northeast"===i?d=Wh({x:e,y:a.y},{x:a.x,y:f+h}):i===wa?d=Wh({x:a.x,y:f},{x:e+g,y:f+h}):i===va?d=Wh({x:e,y:f},{x:a.x,y:f+h}):"southwest"===i?d=Wh({x:a.x,y:f},{x:e+g,y:a.y}):"south"===i?d=Wh({x:e,y:f},{x:e+g,y:a.y}):"southeast"===i&&(d=Wh({x:e,y:f},a)),c.setPosition(k.tf(d.x+d.width*j.x,d.y+d.height*j.y)),c.setWidth(d.width),c.setHeight(d.height)},a._80I=function(a,b,c,d){var e=this,f=e.gv._zoom,g=(e.gv.getEditPointSize()+2)/f;return Yh({x:b-g/2,y:c-g/2,width:g,height:g},a)?(e._89I!==d&&(e._89I=d),!0):!1},a._79I=function(a,b,c){var d=this,e=d.gv,f=b?e.getDataUI(b):i,g=f?f._55O:i;if(g){var h,j,k,l,m=e._zoom,n=(e.getEditPointSize()+2)/m,o=e.lp(a);if(Kd(b)){if(g._56O&&Kd(b)&&(j=g._98o,Yh({x:j.x-n/2,y:j.y-n/2,width:n,height:n},o)))return d._77I=b,c&&d.fi({kind:"beginEditRotation",event:a,data:b}),d.setCursor("crosshair"),!0;if(g._43O&&b instanceof bl)for(k=b.getPoints(),h=k.size()-1;h>=0;h--)if(j=k.get(h),Yh({x:j.x-n/2,y:j.y-n/2,width:n,height:n},o))return d._index=h,d._shape=b,c&&d.fi({kind:"beginEditPoint",event:a,data:b,index:h}),d.setCursor("crosshair"),!0;if(g._42O)for(var p=b.getEditControlPoints(),q=["northwest",-1,-1,wa,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,va,1,0,"northeast",1,-1,xa,0,-1],h=0,l=p.length;l>h;h++){var r=q[3*h],s=p[h];if(d._80I(o,s.x,s.y,r)){d._node=b;var t=b.getWidth(),u=b.getHeight(),v=b.getAnchor();d._rect={x:-t*v.x,y:-u*v.y,width:t,height:u},d._anchor=v,d._matrix=b.getMatrix();var w=b.getRotation(),x=H(w),y=J(w),z=q[3*h+1]*_d(b.getScale().x),A=q[3*h+2]*_d(b.getScale().y),B=Math.atan2(-y*z-x*A,x*z-y*A),C=(Math.round(B/(Math.PI/4))+8)%8,D=[mc,"nesw-resize",nc,"nwse-resize",mc,"nesw-resize",nc,"nwse-resize"][C];return d.setCursor(D),c&&d.fi({kind:"beginEditRect",event:a,data:b,direction:d._89I}),!0}}}if(g._43O&&Ld(b)&&b.s(hb)===Ta&&(k=b.s(gb)))for(h=k.size()-1;h>=0;h--)if(j=k.get(h),Yh({x:j.x-n/2,y:j.y-n/2,width:n,height:n},o))return d._index=h,d._edge=b,c&&d.fi({kind:"beginEditPoint",event:a,data:b,index:h}),d.setCursor("crosshair"),!0}return!1}},ms_gv:function(a,b){a._currentSubGraph=i,a._fpsInfo={time:0,fps:0,frames:0},a.upSubGraph=function(){this.setCurrentSubGraph(sj(this._currentSubGraph))},a.isVisible=function(a){var b=this;if(sj(a)!==b._currentSubGraph)return!1;if(Ld(a)){var c=a._40I,d=a._41I;if(!c||!d)return!1;if(!(a.s("edge.independent")||b.isVisible(c)&&b.isVisible(d)))return!1;if(a.isEdgeGroupHidden())return!1}else for(var e=a._parent;e&&!e.ISubGraph;){if(Md(e)&&(!e.isExpanded()||!b.isVisible(e)))return!1;e=e._parent}if(a._parent instanceof $k&&!b.isVisible(a._parent))return!1;if(a._refGraph instanceof el&&!b.isVisible(a._refGraph))return!1;if(b instanceof Ip){if(!a.s("3d.visible"))return!1}else{var f=b.getLayersInfo();if(f){var g=f[a._layer];if(g&&g.visible===!1)return!1}if(!a.s("2d.visible"))return!1}return b._visibleFunc?b._visibleFunc(a):!0},a.handleSelectionChange=function(a){var b=this;a.datas.each(function(a){b.invalidateData(a);var c=a._parent;Md(c)&&Kd(a)&&a.s(Na)&&(b.invalidateData(c),c._49I&&c._49I.each(function(a){b.invalidateData(a)}))}),b.onSelectionChanged(a)},a.onSelectionChanged=function(a){var b=this,c=b.sm();if(1===c.size()&&("set"===a.kind||"append"===a.kind)){var d=c.ld();b.isAutoMakeVisible()&&b.makeVisible(d),b.adjustIndex&&b._dataModel.isAutoAdjustIndex()&&b.adjustIndex(d)}},a.makeVisible=function(a){if(a){var b=this,c=b.getDataUI?b.getDataUI(a):b.getData3dUI(a);if(c){var d=a,e=sj(a);for(e!==b._currentSubGraph&&b.setCurrentSubGraph(e);(d=d._parent)&&d!==e;)Md(d)&&d.setExpanded(!0);b._23I=a,b.iv()}}},a.getLabel=function(a){var b=a.getStyle(Xa);return b===c?a.getName():b},a.getLabelBackground=function(a){return a.getStyle("label.background")},a.getLabelColor=function(a){return a.getStyle("label.color")},a.getLabel2=function(a){return a.getStyle("label2")},a.getLabel2Background=function(a){return a.getStyle("label2.background")},a.getLabel2Color=function(a){return a.getStyle("label2.color")},a.getNote=function(a){return a.getStyle(Za)},a.getNoteBackground=function(a){return a.getStyle("note.background")},a.getNote2=function(a){return a.getStyle($a)},a.getNote2Background=function(a){return a.getStyle("note2.background")},a.handleClick=function(a,b,c){var d=this;b?(d.fi({kind:"clickData",event:a,data:b,part:c}),d.onDataClicked(b,a)):(d.fi({kind:"clickBackground",event:a}),d.onBackgroundClicked(a))},a.handleDoubleClick=function(a,b,c){var d=this;Nh(a)&&(b?(d.fi({kind:"doubleClickData",event:a,data:b,part:c}),d.onDataDoubleClicked(b,a,c),d.checkDoubleClickOnNote(a,b,c)||d.checkDoubleClickOnRotation&&d.checkDoubleClickOnRotation(a,b,c)||(Ld(b)?d.onEdgeDoubleClicked(b,a,c):b.ISubGraph?d.onSubGraphDoubleClicked(b,a,c):Md(b)?d.onGroupDoubleClicked(b,a,c):b.IDoorWindow?d.onDoorWindowDoubleClicked(b,a,c):b.ICSGBox&&d.onCSGBoxDoubleClicked(b,a,c))):(d.fi({kind:"doubleClickBackground",event:a}),d.onBackgroundDoubleClicked(a)))},a.onSubGraphDoubleClicked=function(a,b,c){this.setCurrentSubGraph(a)},a.onEdgeDoubleClicked=function(a,b,c){a.ISubGraph&&!Sh(b)?this.setCurrentSubGraph(a):a.s("edge.toggleable")&&a.toggle()},a._39Q=function(a){return this.isInteractive(a)?this.preventDefaultWhenInteractive(a):!1},a.preventDefaultWhenInteractive=function(a){return a.s("preventDefaultWhenInteractive")},a.onGroupDoubleClicked=function(a,b,c){a.s("group.toggleable")&&a.toggle()},a.onDoorWindowDoubleClicked=function(a,b,c){a.s("dw.toggleable")&&a.toggle(!0)},a.onCSGBoxDoubleClicked=function(a,b,c){var d=this;if(d instanceof Ip){var e=d.getHitFaceInfo(b);e&&e.face&&a.s(e.face+".toggleable")&&a.toggleFace(e.face,!0)}},a.onBackgroundClicked=function(a){},a.onBackgroundDoubleClicked=function(a){this.upSubGraph()},a.onDataClicked=function(a,b,c){},a.onDataDoubleClicked=function(a,b,c){},a.onAutoLayoutEnded=function(){},a.onMoveEnded=function(){},a.onPanEnded=function(){},a.onPinchEnded=function(){},a.onRectSelectEnded=function(){},a.onZoomEnded=function(){},a.serialize=function(a){return this.dm().serialize(a)},a.toJSON=function(){return this.dm().toJSON()},a.deserialize=function(a,b){var c=this;b=b instanceof ej?{rootParent:b}:Ed(b)?{setId:b}:Gd(b)?{finishFunc:b}:b||{},b.view=c;var d=c.dm(),e=b.finishFunc;return b.finishFunc=function(){e&&e.apply(b,arguments),Ed(d.a("zoomable"))&&c.setZoomable&&c.setZoomable(d.a("zoomable")),Ed(d.a("pannable"))&&c.setPannable&&c.setPannable(d.a("pannable")),Ed(d.a("rectSelectable"))&&c.setRectSelectable&&c.setRectSelectable(d.a("rectSelectable")),d.a("fitContent")===!0&&c.fitContent&&c.fitContent(!0,0)},d.deserialize(a,b.rootParent,b)},a.showDebugTip=function(){var a=this,b=a._debugDiv;if(!b){b=a._debugDiv=h.createElement("div"),b.style.position="absolute",b.style.overflow="hidden",b.style.backgroundColor="white",b.style.color="black";var c=a.getView();a._79O?c.insertBefore(b,a._79O):c.appendChild(b);var d=function(){a.redraw();var c=a._canvas,e="FPS : "+a._fpsInfo.fps+"<br/>Datas : "+a.dm().getDatas().length+(c?"<br/>Size : "+c.width+" * "+c.height:""),f=a.getDebugTip();f&&(e+="<br/>------<br/>"+f),b.innerHTML=e,a._isDebugging&&requestAnimationFrame(d)};requestAnimationFrame(d),a._isDebugging=!0}},a.hideDebugTip=function(){var a=this,b=a._debugDiv;b&&(delete a._debugDiv,a.getView().removeChild(b),a._isDebugging=!1)},a.updateDOMAppendMatrix=function(){var a=this.getView();a&&(a.updateAppendMatrix=!0)},a.countFrame=function(){if(this._isDebugging){var a=Date.now(),b=this._fpsInfo;a-b.time>1e3?(b.fps=Math.round(1e5*(b.frames+1)/(a-b.time))/100,b.time=a,b.frames=0):b.frames++}}},ms_icons:function(a,b){a.getRotation=function(a,b){return a==i?0:a},a._15O=function(){var a=this,b=a.s(_a);if(b){var c=a,d=a.data||a._data,e=a._38o={icons:b,rects:{}};for(var f in b){var g=b[f],h=_i(g.shape3d,d,c);if(!(_i(g.visible,d,c)===!1||_i(g.for3d,d,c)&&!a.I3d||h&&!a.I3d)){var j=h?[h]:_i(g.names,d,c),k=j?j.length:0,l=_i(g.position,d,c)||3,m=_i(g.offsetX,d,c)||0,n=_i(g.offsetY,d,c)||0,o=_i(g.direction,d,c)||va,p=_i(g.gap,d,c),q=p!=i?p:1,r=_i(g.rotation,d,c),s=_i(g.keepOrien,d,c),t=_i(g.rotationFixed,d,c)?r:a.getRotation(r,s,l),u=i,v=e.rects[f]=new Array(k);v.rotation=t;for(var w=0;k>w;w++){var x,y,z,A,B=j[w];if(h)z=0,A=0;else{var C=yh(B);z=_i(g.width,d,c),A=_i(g.height,d,c),z==i&&(z=Zi(C,d)),A==i&&(A=$i(C,d))}if(u?o===va?m+=z/2:o===wa?m-=z/2:o===xa?n-=A/2:n+=A/2:u={width:z,height:A},a.I3d){var D=-z/2,E=-A/2;y={width:z,height:A,mat:a._16O(_i(g.autorotate,d,c),l,u,_i(g.face,d,c)||ma,_i(g.t3,d,c),_i(g.r3,d,c),_i(g.rotationMode,d,c),m,n),vs:new pi([D,-E,0,D,-E-A,0,D+z,-E-A,0,D+z,-E,0])}}else x=a.getPosition(l,m,n,u,_i(g.positionFixed,d,c)),y={x:x.x-z/2,y:x.y-A/2,width:z,height:A},a._68o(y,t);v[w]=y,o===va?m+=z/2+q:o===wa?m-=z/2+q:o===xa?n-=A/2+q:n+=A/2+q}}}}}}});var ij={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},jj={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},kj={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},lj={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},mj={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},nj={"edge.type":1,"edge.group":1},oj={rotation:1,rotationX:1,rotationZ:1},pj={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},qj={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},rj={shape:1,thickness:1,position:1,anchor:1,scale:1},sj=function(a){if(!a)return i;if(Ld(a)){var b=a._40I,c=a._41I;if(!b||!c)return i;var d=sj(b),e=sj(c);return d===e?d:i}for(var f=a._parent;Ld(f)&&!f.ISubGraph;)f=f._parent;return f?f.ISubGraph?f:sj(f):i},tj=function(a,b,c,d){var e=b.getStyle(c)*d;e&&bi(a,e),e=b.getStyle(c+".left")*d,e&&(a.x-=e,a.width+=e),e=b.getStyle(c+".right")*d,e&&(a.width+=e),e=b.getStyle(c+".top")*d,e&&(a.y-=e,a.height+=e),e=b.getStyle(c+".bottom")*d,e&&(a.height+=e),a.width<0&&(a.width=-a.width,a.x-=a.width),a.height<0&&(a.height=-a.height,a.y-=a.height)},uj=function(a){for(var b,c=0,d=a.size();d>c;c++)if(b=a.getChildAt(c),Kd(b)&&uj(b))return!0;return a.hasAgentEdges()},vj=function(a){if(!a)return i;for(var b=a._parent;Md(b);){if(!Md(b._parent))return b.isExpanded()?a:b;b.isExpanded()||(a=b),b=b._parent}return a},wj=function(a,b){if(!a||!b)return i;var c,d,e,f=sj(a),g=sj(b);if(f!==g){for(;g&&f!==g;)g=sj(g);if(f===g)return a;c=new bj,c.add(a,0);for(var h=a._parent;Kd(h)&&!b.isDescendantOf(h);)c.add(h,0),h=h._parent;for(e=c.size(),d=0;e>d;d++){var j=c.get(d);if(Md(j)&&!j.isExpanded())return j;if(j.ISubGraph)return j}return a}return a},xj=function(a){if(a.isLooped())return a._source;var b=vj(a._source),c=vj(a._target);return b===c?a._source:wj(b,c)},yj=function(a){if(a.isLooped())return a._target;var b=vj(a._source),c=vj(a._target);return b===c?a._target:wj(c,b)},zj=function(a,b,d){"target"!==d&&(d="source");var e="target"===d?b.getTargetAgent():b.getSourceAgent(),f="edge."+d+".";if(Ld(e)){var g=a.getDataUI(e);g._79o();var h=b.s(f+"index");if(h!==c){var i=Yj(g);return i[Math.max(0,Math.min(h,i.length-1))]}var j=b.s(f+"percent")||0;j=Math.max(0,Math.min(j,1));var k=Tj(g);return Xj(k,100*j)}return Aj(a,e,b.s(f+"position"),b.s(f+"offset.x"),b.s(f+"offset.y"),b.s(f+"anchor.x"),b.s(f+"anchor.y"))},Aj=function(a,b,d,e,f,g,h){if(!b)return i;var j,k=b.getRotation?b.getRotation():0;if(g!==c||h!==c){g=g===c?.5:g,h=h===c?.5:h;var l=b.getScale();if(k&&!Nd(b,a)||l.x<0||l.y<0){var m=b.getPosition(),n=b.getWidth(),o=b.getHeight(),p=b.getAnchor(),q=new Hg(k,m.x,m.y,l.x,l.y);d=q.tf((g-p.x)*n,(h-p.y)*o)}else j=hj(a,b),d={x:j.x+g*j.width,y:j.y+h*j.height}}else d=bg(d,hj(a,b));if(k){var r=H(k),s=J(k),t=e*r-f*s;f=e*s+f*r,e=t}return d.x+=e,d.y+=f,d},Bj=function(a,b){if(!a||!b)return i;var c,d,e,f,g,h;if(a===b){if(f=a.getLoopedEdges(),!f)return i;f=new bj(f)}else{if(g=a.getAgentEdges(),h=b.getAgentEdges(),!g||!h)return i;for(d=g.size(),c=0;d>c;c++)e=g.get(c),h.contains(e)&&(f||(f=new bj),f.add(e))}if(f)for(c=0;c<f.size();c++)e=f.get(c),e.getStyle(hb)===Ta&&(e._22I(i),f.removeAt(c),c--);return f},Cj=function(a,b){var c=Bj(a,b);if(c&&!c.isEmpty()){if(1===c.size())return void c.get(0)._22I(i);var d=new bj,e=new bj;c.each(function(a){var b=a.s("edge.group");d.contains(b)||d.add(b)}),d.sort(),d.each(function(a){e.add(new j.EdgeGroup(c.toList(function(b){return a===b.s("edge.group")}),e))}),e.each(function(a){a.each(function(b){b._22I(a)})})}},Dj=function(a,b,c){var d=a._canvas,e=(a._zoom,ci(b,d)),f=ci(c,d);return{x:e.x-f.x,y:e.y-f.y}},Ej=function(a,b){if(b){var c=b.rect,d=b.color,e=b.rotation,f=b.labelWidth,g=b.background,h=b.opacity,j=b.scale,k=j!=i&&1!==j;if(h!=i){var l=a.globalAlpha;a.globalAlpha*=h}if(e||k){a.save();var m=c.x+c.width/2,n=c.y+c.height/2;Fe(a,m,n),e&&Ge(a,e),k&&a.scale(j,j),Fe(a,-m,-n)}if(g&&Df(a,c.x,c.y,c.width,c.height,g),f){var o=c.width,p=a.createLinearGradient(c.x,c.y,c.x+o,c.y);p.addColorStop(0,d),p.addColorStop(.9,d),p.addColorStop(1,dc),d=p,c.width=f}xe(a,b.ss,c,b.font,d,b.align),f&&(c.width=o),(e||k)&&a.restore(),h!=i&&(a.globalAlpha=l)}},Fj=function(a,b){if(b){var c=b.rect,d=c.x,e=c.y,f=c.width,g=c.height,h=b.background,j=b.backgroundImage,k=b.borderWidth,l=b.borderColor,m=b.labelWidth,n=b.opacity,o=b.scale,p=o!=i&&1!==o;if(n!=i){var q=a.globalAlpha;a.globalAlpha*=n}if(p){a.save();var r=c.x+c.width/2,s=c.y+c.height/2;Fe(a,r,s),a.scale(o,o),Fe(a,-r,-s)}if(b.expanded){var t=F(8,f/4),u=e+g-8;if(a.fillStyle=h,a.beginPath(),a.moveTo(d,e),a.lineTo(d,u),a.lineTo(d+f/2,u),a.lineTo(d+f/2,e+g),a.lineTo(d+f/2+t,u),a.lineTo(d+f,u),a.lineTo(d+f,e),a.closePath(),a.fill(),k&&(a.lineWidth=k,a.lineJoin="round",a.lineCap="round",l?(a.strokeStyle=l,a.stroke()):(a.strokeStyle=Kh(h),a.beginPath(),a.moveTo(d+f,e),a.lineTo(d+f,u),a.lineTo(d+f/2+t,u),a.lineTo(d+f/2,e+g),a.stroke(),a.strokeStyle=Jh(h),a.beginPath(),a.moveTo(d+f,e),a.lineTo(d,e),a.lineTo(d,u),a.lineTo(d+f/2,u),a.lineTo(d+f/2,e+g),a.stroke())),j)Bh(a,yh(j),bc,c.x,c.y,c.width,c.height-8,b.data,b.view);else{if(c.height-=8,h=b.color,m){var v=f,w=a.createLinearGradient(d,e,d+v,e);w.addColorStop(0,h),w.addColorStop(.9,h),w.addColorStop(1,dc),h=w,c.width=m}xe(a,b.ss,c,b.font,h,b.align),m&&(c.width=v),c.height+=8}}else if(b.icon)aj(a,yh(b.icon),d,e,f,g,b.data,b.view);else{var x=f/2;k&&(a.lineWidth=k,a.lineJoin="round",a.lineCap="round",a.strokeStyle=l?l:Kh(h),a.beginPath(),a.arc(d+x,e+x,x,O,1.6*M,!0),a.moveTo(d+x,e+g),a.lineTo(d+f-x/5,e+x),a.stroke(),a.strokeStyle=l?l:Jh(h),a.beginPath(),a.arc(d+x,e+x,x,1.6*M,O,!0),a.moveTo(d+x,e+g),a.lineTo(d+x/5,e+x),a.stroke()),a.fillStyle=h,a.beginPath(),a.arc(d+x,e+x,x,0,N,!0),a.moveTo(d+x,e+g),a.lineTo(d+f-x/5,e+x),a.lineTo(d+x/5,e+x),a.closePath(),a.fill(),a.fillStyle=b.color,a.beginPath(),a.arc(d+x,e+x,x/3,0,N,!0),a.fill()}p&&a.restore(),n!=i&&(a.globalAlpha=q)}},Gj=function(a,b){return b>2*a?a:b/2},Hj=function(a,b,c,d){if(!a||!b)return 0;var e=Q(b.y-a.y,b.x-a.x);return c||(e=b.x<a.x?e+M:e),e+d},Ij=function(a,b,c,d,e,f,g){g&&(a.x>b.x||a.x===b.x&&a.y>b.y)&&(c=ag[c],e=-e);var h=bg(c,{x:0,y:0,width:Vh(a,b),height:0},f);return h.x+=d,h.y+=e,h=new Hg(Q(b.y-a.y,b.x-a.x)).tf(h),h.x+=a.x,h.y+=a.y,h},Jj=function(a,b,c,d,e){if(a._19Q=!0,!c.getEdgeGroup())return d?c.s("edge.gap"):0;if(Ld(c.getSourceAgent())||Ld(c.getTargetAgent()))return 0;var f,g=0,h=0,i=0;if(c.getEdgeGroup().getSiblings().each(function(a){a.each(function(a){if(b.isVisible(a)&&a.s(hb)==e){var d=a.s("edge.gap");f?(h+=i/2+d/2,i=d):(f=a,i=d),a===c&&(g=h)}})}),d)return h-g+i;var j=g-h/2;return f&&c._40I!==f._40I&&(a._19Q=!1),j},Kj=function(){var a=function(a){var b=[];return a.forEach(function(a){b.push({x:a.x,y:a.y}),b.push({x:a.x+a.width,y:a.y+a.height}),b.push({x:a.x+a.width,y:a.y}),b.push({x:a.x,y:a.y+a.height})}),b};return function(b,c,d){if("oval"===b){var e=0,f=d.height/d.width,g=f*f,h=d.x+d.width/2,i=d.y+d.height/2,j=a(c);j.forEach(function(a){var b=a.x-h,c=a.y-i,d=b*b+c*c/g;d>e&&(e=d)}),e=D(e);var k=f*e;return{x:h-e,y:i-k,width:2*e,height:2*k}}if("circle"===b){var l=0,h=d.x+d.width/2,i=d.y+d.height/2,j=a(c);return j.forEach(function(a){var b=a.x-h,c=a.y-i,d=b*b+c*c;d>l&&(l=d)}),l=D(l),{x:h-l,y:i-l,width:2*l,height:2*l}}return"roundRect"===b?(bi(d,F(d.width,d.height)/16),d):d}}(),Lj=j.graph={},Mj=function(a,b,c){ki(g+".graph."+a,b,c)};j.layout={};var Nj={},Oj=function(a,b,c,d,e,f,g,h){var i=[b.uuid,Math.round(d),Math.round(e),c].join("_");b.cacheRule&&(i+=_i(b.cacheRule,f,g));var k=g._zoom;k!==g._cacheZoom&&(g._cacheZoom=k,g._cacheImage={}),k*=Xg;var l=g._cacheImage[i];return l||(l=g._cacheImage[i]=j.Default.toCanvas(b,Math.ceil(d*k),Math.ceil(e*k),c,f,g,h)),l};Td(l,{setImageCacheRule:function(a,b){var c;c=b||"object"!=typeof a?{_image:b}:a;for(var d in c){var e=c[d];Cd(d)?(ki=yh(d),ki?ki.cacheRule=e:Nj[d]=e):d.cacheRule=e}}});var Pj={comps:[{type:Ga,points:[85,50,70,115,100,71,86,107,88,49,47,51,73,81,74,84,104,69,83,55,55,83,114,84,89,66,48,110,53,107,97,117,50,51,54,81,107,117,110,81,87,103,89,61],borderWidth:1,borderColor:i}]};if(Pj[La]=Pj[Ma]=160,a.Image){var Qj=new a.Image;Qj.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",xh("default_blank",Qj)}xh("node_image",rd(30,30,[{type:Da,rect:[4,5,22,16],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[2,3,26,20],borderWidth:1,borderColor:pg},{type:Da,rect:[11,23,8,4],background:pg},{type:Da,rect:[6,27,18,2],background:pg}])),xh("node_icon",rd(16,16,[{type:Da,rect:[2,2,12,10],gradient:$g,gradientColor:qg,background:pg},{type:Ba,rect:[2,2,12,10],width:1,color:pg},{type:Da,rect:[6,12,4,2],background:pg},{type:Da,rect:[4,14,8,1],background:pg}])),xh("block_icon",rd(16,16,[{type:Ba,rect:[1,1,14,14],width:1,color:pg}])),xh("group_image",rd(66,39,[{type:Da,rect:[44.3,18,18.1,12.8],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[3.3,17.8,18.1,12.8],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:pg,gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[26.2,29.4,12.8,4.2],background:pg},{type:Da,rect:[21.3,33.5,22.5,2.3],background:pg},{type:Da,rect:[5.3,32.7,14.1,2.1],background:pg},{type:Da,rect:[9,30.4,6.7,2.4],background:pg},{type:Da,rect:[50,30.7,6.7,2.4],background:pg},{type:Da,rect:[46.3,33,14.1,2.1],background:pg}])),xh("group_icon",rd(16,16,[{type:Da,rect:[4,12,4,2],background:pg},{type:Da,rect:[2,13,8,1],background:pg},{type:Da,rect:[12,12,2,1],background:pg},{type:Da,rect:[11,13,4,1],background:pg},{type:Da,rect:[10,7,6,5],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[1,2,10,10],gradient:$g,gradientColor:qg,background:pg},{type:Ba,rect:[1,2,10,10],width:1,color:pg}])),xh("refGraph_icon",rd(16,16,[{type:"shape",borderWidth:1,borderColor:pg,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:pg,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),xh("edge_icon",rd(16,16,[{type:Da,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[10.8,1,4,4],background:pg},{type:Da,rect:[1,11,4,4],background:pg}])),xh("subGraph_image",rd(72,45,[{type:Ga,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[29.6,30.7,3.6,1.8],background:pg},{type:Da,rect:[28.4,32.3,6,1.2],background:pg},{type:Da,rect:[37.3,32,10.8,1.8],background:pg},{type:Da,rect:[39.1,29.9,7.2,2.3],background:pg},{type:Da,rect:[26.6,23.7,9.6,7.2],gradient:$g,gradientColor:qg,background:pg},{type:Da,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:pg,gradient:$g,gradientColor:qg,background:pg}])),xh("subGraph_icon",rd(17,17,[{type:Ga,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:$g,gradientColor:qg,background:pg}])),xh("shape_icon",rd(16,16,[{type:Ga,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:pg}])),xh("polyline_icon",rd(16,16,[{type:Ga,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:pg},sd(7.5,.4),sd(7.5,6.3),sd(13.6,6.3),sd(13.6,14),sd(.7,13.9),sd(.7,.3)])),xh("grid_icon",rd(16,16,[{type:Da,rect:[1,1,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[6,1,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[11,1,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[11,6,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[6,6,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[1,6,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[11,11,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[6,11,4,4],background:pg,gradient:$g,gradientColor:qg},{type:Da,rect:[1,11,4,4],background:pg,gradient:$g,gradientColor:qg}])),xh("light_icon",rd(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:pg},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:pg,gradient:$g,gradientColor:qg,background:{func:function(a){var b=a?a.s(vm):i;return Hd(b)?"rgb("+V(255*b[0])+","+V(255*b[1])+","+V(255*b[2])+")":b||pg}}}])),xh("text_icon",rd(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:pg}])),xh("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),xh("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),xh("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),xh("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Rj=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=[];if(Math.abs(d)>2*Math.PI&&(d=2*Math.PI),k=Math.ceil(Math.abs(d)/(Math.PI/4)),g=d/k,h=-g,i=-c,k>0){l=a+Math.cos(c)*e,m=b+Math.sin(-c)*f,r.push({x:l,y:m});for(var s=0;k>s;s++)i+=h,j=i-h/2,n=a+Math.cos(i)*e,o=b+Math.sin(i)*f,p=a+Math.cos(j)*(e/Math.cos(h/2)),q=b+Math.sin(j)*(f/Math.cos(h/2)),r.push({x:p,y:q}),r.push({x:n,y:o})}return r},Sj=function(a){if(a){var b=a._data;if(b instanceof j.Shape)return{points:b.getPoints(),segments:b.getSegments()};var c;if(b instanceof j.Edge&&(c=a._78o)){var d,e,f=c.type,g=c.points,h=c.segments,i=c.edgeTypeInfo;if(!f||g){var k=c.sourcePoint,l=k.x,m=k.y,n=c.targetPoint,o=n.x,p=n.y;if(f)h?(d=new bj({x:l,y:m}),d.addAll(g),d.add({x:o,y:p}),e=new bj(h._as)):(d=new bj({x:l,y:m}),g.each(function(a){d.add(a)}),d.add({x:o,y:p}));else if(c.looped){d=new bj(Rj(l,m,0,2*Math.PI,c.radius,c.radius)),e=new bj([1]);for(var q=0;q<(d.size()-1)/2;q++)e.add(3)}else d=new bj,c.center?(d.add({x:c.c1.x,y:c.c1.y}),d.add({x:l,y:m}),d.add({
x:o,y:p}),d.add({x:c.c2.x,y:c.c2.y})):(d.add({x:l,y:m}),d.add({x:o,y:p}))}else i&&(d=new bj(i.points._as),i.segments&&(e=new bj(i.segments._as)));return{points:d,segments:e}}}},Tj=function(a,b,c){if(null==b){var d=Sj(a);if(!d)return;b=d.points,c=d.segments}if(b){if(Array.isArray(b)&&(b=new bj(b)),"number"==typeof b.get(0)){for(var e=new j.List,f=0;f<b.size();f+=2)e.add({x:b.get(f),y:b.get(f+1)});b=e}if(!c){c=[1];for(var g=b.length-1;g>0;g--)c.push(2)}Array.isArray(c)&&(c=new bj(c));for(var h=Af(b._as,c._as,50),i=h.length,k=[],f=0;i>f;f++){var l=h[f];l.length>1&&k.push(l)}return k}},Uj=function(a){for(var b=0,c=a.length-1,d=0;c>d;d++){var e=a[d],f=a[d+1],g=f.x-e.x,h=f.y-e.y;b+=Math.sqrt(g*g+h*h)}return b},Vj=function(a,b){for(var c=0,d=b.length,e=0;d>e;e++){var f=b[e];if(c+=f,c>a)return e}return Math.min(e,d-1)},Wj=function(a,b){for(var c=0,d=0,e=0,f=a.length-1,g=0;f>g;g++){var h=a[g],i=a[g+1],j=i.x-h.x,k=i.y-h.y;if(e=Math.sqrt(j*j+k*k),c+=e,c>b){c-=e,d=g;break}}var l=a[d],m=a[d+1],n=Math.atan2(m.y-l.y,m.x-l.x),o=b-c,k=Math.sin(n)*o,j=Math.cos(n)*o;return{x:l.x+j,y:l.y+k}},Xj=function(a,b){if(a){var c;if(0===b)c=a[0][0];else if(100===b)a=a[a.length-1],c=a[a.length-1];else{for(var d=0,e=[],f=a.length,g=0;f>g;g++){var h=a[g],i=Uj(h);d+=i,e.push(i)}for(var j=d*b/100,k=Vj(j,e),l=0,m=0;k>m;m++)l+=e[m];j-=l,c=Wj(a[k],j)}return c}},Yj=function(a){var b,c,d,e,f=Sj(a),g=[],h=f.points,i=f.segments,j=-1;for(c=0,d=i?i.length:h.length;d>c;c++){if(b=i?i.get(c):1,3===b)e=2;else if(4===b)e=3;else{if(5===b)continue;e=1}j+=e,g.push(h.get(j))}return g},Zj=function(a,b,c,d){function e(c){if(c>=0&&1>=c){h=b(c);var d=(a.x-h.x)*(a.x-h.x)+(a.y-h.y)*(a.y-h.y);return f>d?(f=d,g=c,!0):!1}}c=c||100,d=d||1e-5;for(var f=1/0,g=0,h=new Lg,i=0;c>i;++i)e(i/c);for(var j=1/(2*c);j>d;)e(g-j)||e(g+j)||(j/=2);return g};Td(l,{_edgeProtectMethod:{getStraightLinePoints:Tj,calculateLineLength:Uj,calcSegmentIndexByDistance:Vj,calculatePointAlongLine:Wj,getPercentPosition:Xj,getRealPointsFromDataUI:Yj}});var $j=function(a,b){for(var c=a.vertices,d=0;d<c.length;d++){var e=c[d],f=e.y;e.y=e.z,e.z=-f,b&&(e.y+=b)}},_j=function(a){for(var b,c,d,e,f,g,h=[],i=[],j=[],k=a.faces,l=0,m=0,n=0,o=k.length;o>l;l++,m+=6,n+=9){var p=k[l];1===p.i?(b||(b=[],c=[],d=[]),ak(p,l,m,n,a,b,d,c)):2===p.i?(e||(e=[],f=[],g=[]),ak(p,l,m,n,a,e,g,f)):ak(p,l,m,n,a,h,j,i)}return{vs:h,uv:i,ns:j,top_vs:b,top_uv:c,top_ns:d,bottom_vs:e,bottom_uv:f,bottom_ns:g}},ak=function(a,b,c,d,e,f,g,h){var i=e.vertices,j=e.faceVertexUvs,k=i[a.a],l=i[a.b],m=i[a.c];f[d]=k.x,f[d+1]=k.y,f[d+2]=k.z,f[d+3]=l.x,f[d+4]=l.y,f[d+5]=l.z,f[d+6]=m.x,f[d+7]=m.y,f[d+8]=m.z;var n=a.vertexNormals;if(3===n.length){var o=n[0],p=n[1],q=n[2];g[d]=o.x,g[d+1]=o.y,g[d+2]=o.z,g[d+3]=p.x,g[d+4]=p.y,g[d+5]=p.z,g[d+6]=q.x,g[d+7]=q.y,g[d+8]=q.z}else{var r=a.normal;g[d]=r.x,g[d+1]=r.y,g[d+2]=r.z,g[d+3]=r.x,g[d+4]=r.y,g[d+5]=r.z,g[d+6]=r.x,g[d+7]=r.y,g[d+8]=r.z}var s=j[0][b][0],t=j[0][b][1],u=j[0][b][2];h[c]=s.x,h[c+1]=s.y,h[c+2]=t.x,h[c+3]=t.y,h[c+4]=u.x,h[c+5]=u.y},bk=function(){function a(a,b){return a.dot(b)>0}function d(b,c,d,e,f,g,h){for(var i,j,k=[c,d,e],l=[f,g,h],m=[],n=k.length,o=!0;n--&&o;){for(var p=k[n],v=l.length,w=!1;v--;)if(p.equals(l[v])){l.splice(v,1),m.push(p),w=!0;break}if(!w){if(i){o=!1;break}i=p}}return o&&2===m.length&&(j=l[0],q.subVectors(i,m[0]),s.subVectors(j,m[0]),r.subVectors(i,m[1]),q.x*r.y*s.z+r.x*s.y*q.z+s.x*q.y*r.z-s.x*r.y*q.z-s.y*r.z*q.x-s.z*r.x*q.y<1e-6&&(t.subVectors(j,m[1]),u.subVectors(m[1],m[0]),a(u,q)&&a(u,s)&&(u.negate(),a(u,r)&&a(u,t))))?(b.push(m[1].x,m[1].y,m[1].z),b.push(i.x,i.y,i.z),b.push(i.x,i.y,i.z),b.push(m[0].x,m[0].y,m[0].z),b.push(m[0].x,m[0].y,m[0].z),b.push(j.x,j.y,j.z),b.push(j.x,j.y,j.z),b.push(m[1].x,m[1].y,m[1].z),2):(b.push(c.x,c.y,c.z),b.push(d.x,d.y,d.z),b.push(d.x,d.y,d.z),b.push(e.x,e.y,e.z),b.push(e.x,e.y,e.z),b.push(c.x,c.y,c.z),1)}function e(){this._vertexMap={},this._lineMap={},this._lineList=[]}function f(a,b,c,d,e,f,g){var h=[c,e];a[0]===d&&h.reverse();var i=[h[0]._key,h[1]._key].join("|"),j=a._triangles[i];j||(a._triangles[i]=j={});var k=[f._key,g._key].join("|");j[k]||(j[k]=[f,g])}function g(a,b,c){var d=a._planes[c._key];if(!d)for(var e in a._planes){var f=a._planes[e];if(f._normal.angleTo(c)<.001){d=f;break}}return d?void(d._vertices.indexOf(b)<0&&d._vertices.push(b)):void(a._planes[c.key]={_normal:c,_vertices:[b]})}function h(a){var b=a._ctlineModel;if(b||(a._ctlineModel=b=[]),b[0])return b[0];var c;c=Hd(a)?a:[a];var e,f,g,h,i,j,q,r,s,t,u,v,w,x,y,z,A,B,C,D=["","top_","bottom_"];for(b=[],e=0,f=c.length;f>e;e++)if(t=c[e])for(cp(t),g=0,h=D.length;h>g;g++)if(s=t[D[g]+"lvs"])for(A=b.length,B=s.length,b.length=A+B,C=0;B>C;++C,++A)b[A]=s[C];else if(q=t[D[g]+"vs"]){r=t[D[g]+"is"],j=r?r.length:q.length/3;for(var i=0;j-1>i;)r?(u=r[i],v=r[i+1],w=r[i+2],x=r[i+3],y=r[i+4],z=r[i+5]):(u=i,v=i+1,w=i+2,x=i+3,y=i+4,z=i+5),k.fromArray(q,3*u),l.fromArray(q,3*v),m.fromArray(q,3*w),n.fromArray(q,3*x),o.fromArray(q,3*y),p.fromArray(q,3*z),i+=3*d(b,k,l,m,n,o,p);j>i&&(r?(u=r[i],v=r[i+1],w=r[i+2]):(u=i,v=i+1,w=i+2),k.fromArray(q,3*u),l.fromArray(q,3*v),m.fromArray(q,3*w),b.push(k.x,k.y,k.z),b.push(l.x,l.y,l.z),b.push(l.x,l.y,l.z),b.push(m.x,m.y,m.z),b.push(m.x,m.y,m.z),b.push(k.x,k.y,k.z))}return a._ctlineModel[0]=b,b}function i(a){var b=a._ctlineModel;if(b||(a._ctlineModel=b=[]),b[1])return b[1];var d;d=Hd(a)?a:[a];var f,g,h,i,j,k,l,m,n,o,p,q,r=["","top_","bottom_"],s=new e;for(b=[],f=0,g=d.length;g>f;f++)if(n=d[f])for(cp(n),h=0,i=r.length;i>h;h++)if(l=n[r[h]+"vs"]){m=n[r[h]+"is"],k=m?m.length:l.length/3;for(var j=0,j=0;k>j;j+=3)m?(o=m[j],p=m[j+1],q=m[j+2]):(o=j,p=j+1,q=j+2),s._addTriangle(l,c,o,p,q)}return s._toLineVS(b),a._ctlineModel[1]=b,b}function j(a){var b=a._ctlineModel;if(b||(a._ctlineModel=b=[]),b[2])return b[2];var c;c=Hd(a)?a:[a];var d,f,g,h,i,j,k,l,m,n,o,p,q,r=["","top_","bottom_"],s=new e;for(b=[],d=0,f=c.length;f>d;d++)if(n=c[d])for(cp(n),g=0,h=r.length;h>g;g++)if(k=n[r[g]+"vs"]){l=n[r[g]+"is"],m=n[r[g]+"ns"],j=l?l.length:k.length/3;for(var i=0,i=0;j>i;i+=3)l?(o=l[i],p=l[i+1],q=l[i+2]):(o=i,p=i+1,q=i+2),s._addTriangle(k,m,o,p,q)}return s._toLineVS(b),a._ctlineModel[2]=b,b}var k=new Kg,l=new Kg,m=new Kg,n=new Kg,o=new Kg,p=new Kg,q=new Kg,r=new Kg,s=new Kg,t=new Kg,u=new Kg,v=new Kg;e.prototype._findVertex=function(a,b){v.fromArray(a,3*b);var c=[v.x,v.y,v.z].join(","),d=this._vertexMap[c];if(!d){var e=v.clone();e._key=c,this._vertexMap[c]=d=e}return d},e.prototype._findLine=function(a,b){var c=[a,b];a._key>b._key&&c.reverse(),c._key=[c[0]._key,c[1]._key].join("|");var d=this._lineMap[c._key];return d||(this._lineMap[c._key]=d=c,c._triangles={},c._planes={},this._lineList.push(c)),d};var w=new Kg,x=new Kg;return e.prototype._addTriangle=function(a,b,c,d,e){var h,i,j,k=this._findVertex(a,c),l=this._findVertex(a,d),m=this._findVertex(a,e),n=this._findLine(k,l),o=this._findLine(l,m),p=this._findLine(m,k);b?(h=(new Kg).fromArray(b,3*c),h._key=[h.x,h.y,h.z].join("|"),i=(new Kg).fromArray(b,3*d),i._key=[i.x,i.y,i.z].join("|"),j=(new Kg).fromArray(b,3*e),j._key=[j.x,j.y,j.z].join("|"),f(n,k,h,l,i,m,j),f(o,l,i,m,j,k,h),f(p,m,j,k,h,l,i)):(x.subVectors(m,l),w.subVectors(l,k),h=(new Kg).crossVectors(w,x),h._key=[h.x,h.y,h.z].join("|"),g(n,m,h),g(o,k,h),g(p,l,h))},e.prototype._toLineVS=function(a){for(var c=this._lineList,d=0,e=c.length;e>d;++d){var f=c[d],g=!1;for(var h in f._triangles)if(1==b.keys(f._triangles[h]).length){a.push(f[0].x,f[0].y,f[0].z,f[1].x,f[1].y,f[1].z),g=!0;break}if(!g)for(var i in f._planes)if(1==f._planes[i]._vertices.length){a.push(f[0].x,f[0].y,f[0].z,f[1].x,f[1].y,f[1].z),g=!0;break}}},[h,i,j]}(),ck=function(a){var b=a._lineModel;if(b)return b;var c;c=Hd(a)?a:[a];var d,e,f,g,h,i,j,k,l,m,n,o,p=["","top_","bottom_"];for(b=[],d=0,e=c.length;e>d;d++)if(l=c[d])for(f=0,g=p.length;g>f;f++)if(j=l[p[f]+"vs"]){k=l[p[f]+"is"],i=k?k.length:j.length/3;for(var h=0;i>h;h+=3)k?(m=k[h],n=k[h+1],o=k[h+2]):(m=h,n=h+1,o=h+2),m*=3,n*=3,o*=3,b.push(j[m],j[m+1],j[m+2],j[n],j[n+1],j[n+2],j[n],j[n+1],j[n+2],j[o],j[o+1],j[o+2],j[o],j[o+1],j[o+2],j[m],j[m+1],j[m+2])}return a._lineModel=b,b},dk=function(a,b,c,d,e,f,g,h,j){c==i&&(c=!0),d==i&&(d=!0),g==i&&(g=1),h==i&&(h=0);var k=new xk;return zf(k,a,b,j),k=k.toShapes(),_j(new Nk(k,{top:c,bottom:d,curveSegments:e,amount:g,repeatUVLength:f},-g/2+h))},ek=function(a,b){this.x=a||0,this.y=b||0};ek.prototype={constructor:ek,add:function(a,b){return this.x+=a.x,this.y+=a.y,this},sub:function(a,b){return this.x-=a.x,this.y-=a.y,this},equals:function(a){return a.x===this.x&&a.y===this.y},multiplyScalar:function(a){return this.x*=a,this.y*=a,this},distanceTo:function(a){return D(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;return b*b+c*c},clone:function(){return new ek(this.x,this.y)}};var fk=function(a,b,c){this.x=a||0,this.y=b||0,this.z=c||0};fk.prototype={constructor:fk,set:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setY:function(a){return this.y=a,this},copy:function(a){return this.x=a.x,this.y=a.y,this.z=a.z,this},add:function(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this},addVectors:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this},sub:function(a,b){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this},multiplyScalar:function(a){return this.x*=a,this.y*=a,this.z*=a,this},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d+e[12],this.y=e[1]*b+e[5]*c+e[9]*d+e[13],this.z=e[2]*b+e[6]*c+e[10]*d+e[14],this},divideScalar:function(a){if(0!==a){var b=1/a;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},length:function(){return D(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(a,b){var c=this.x,d=this.y,e=this.z;return this.x=d*a.z-e*a.y,this.y=e*a.x-c*a.z,this.z=c*a.y-d*a.x,this},crossVectors:function(a,b){var c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this},distanceTo:function(a){return D(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d},clone:function(){return new fk(this.x,this.y,this.z)}};var gk=function(){this.elements=new Float32Array(16)};gk.prototype={constructor:gk,set:function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this},makeRotationAxis:function(a,b){var c=H(b),d=J(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this}};var hk=function(a){this.repeatUVLength=a};hk.prototype={generateTopUV:function(a,b,c,d,e,f,g){var h,i,j,k,l=a.vertices,m=l[d].x,n=l[d].y,o=l[e].x,p=l[e].y,q=l[f].x,r=l[f].y,s=this.repeatUVLength;if(s)h=0,i=0,j=s,k=s;else{this._bb||(this._bb=b.getBoundingBox());var t=this._bb;h=t.minX,i=t.minY,j=t.maxX-h,k=t.maxY-i}return g?[new ek((m-h)/j,(n-i)/k),new ek((o-h)/j,(p-i)/k),new ek((q-h)/j,(r-i)/k)]:[new ek((m-h)/j,1-(n-i)/k),new ek((o-h)/j,1-(p-i)/k),new ek((q-h)/j,1-(r-i)/k)]},generateBottomUV:function(a,b,c,d,e,f){return this.generateTopUV(a,b,c,d,e,f,!0)},generateSideWallUV:function(a,b,c,d,e,f,g,h,i,j,k,l){if(!this._cl){for(var m,n,o=[],p=0,q=c.length,r=0;q>r;r++){m=c[r],n=c[(r+1)%q];var s=m.x-n.x,t=m.y-n.y,u=D(s*s+t*t);o.push(p),p+=u}for(var r=0;q>r;r++)o[r]/=p;this._cl=o}var o=this._cl,v=1-i/j,w=1-(i+1)/j,x=o[k],y=o[l];return y>x&&(x+=1),[new ek(x,v),new ek(y,v),new ek(y,w),new ek(x,w)]}};var ik=function(a,b,c,d,e,f){this.a=a,this.b=b,this.c=c,this.i=f,this.normal=d instanceof fk?d:new fk,this.vertexNormals=d instanceof Array?d:[]};ik.prototype={constructor:ik};var jk=[-8,13,0,13,-3,7,-1,2,-1],kk=function(){if(kk[ta]!=i)return kk[ta];for(var b=tf[ta],c=jk,d=ej.prototype.getClassName(),e='"',f=0,g="",h=!1,j=+new(a[d.substr(3,3)+mc[f]]),k=f;k<c.length;k++){var l=c.length-k;g+=k%2===f?c[k]+l+"":c[k]-l+""}for(var k=f;4>k;k++)g+=f;if(g=g*g.length/g.length,j>g){if(b&&b[f]&&b[4/Da.length]){for(var m,n,o,p,q,r,s,t,u=b[0],v=b[1],w="",x=0,k=0;k<v.length;k++)v[k]===e?t?(t=!1,x%2!==0&&(m==i?m=w:n==i?n=w:o==i?o=w:p==i?p=w:q==i?q=w:r==i?r=w:s==i&&(s=w)),x++,w=""):t=!0:t&&(w+=v[k]);for(var y,z,A,B="",C=0,k=0;k<u.length;k++)u[k]===e?y?(y=!1,C%2!==0&&(z==i?z=B:A==i&&(A=B)),C++,B=""):y=!0:y&&(B+=u[k]);var D=m+n+o+p+q+r,E=!r||r===zc;if(!E&&r)for(var F,k=0,G=r.length;G>k;k++)r[k]===Fb[4]?F===zc?E=wb:F[0]===pb[7]&&zc&&zc.indexOf(F.substr(1))>=0?E=yb:F=i:(F==i?F=r[k]:F+=r[k],k===G-1&&(F===zc?E=wb:F[0]===pb[7]&&zc&&zc.indexOf(F.substr(1))>=0&&(E=yb)));(h=ad(D,s)&&ad(z,A)&&z===m&&E&&(!q||q>j))&&o.indexOf(hd[0])>=0&&(kk[hd[0]]=1),h&&o.indexOf(1)>=0&&(kk[1]=1),h&&o.indexOf(2)>=0&&(kk[2]=1)}}else h=!0,kk[hd[0]]=kk[1]=kk[2]=1;return kk[ta]=h,h},lk=function(){},mk=lk.prototype;mk.getPointAt=function(a){var b=this.getUtoTmapping(a);return this.getPoint(b)},mk.getPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPoint(b/a));return c},mk.getSpacedPoints=function(a){a||(a=5);var b,c=[];for(b=0;a>=b;b++)c.push(this.getPointAt(b/a));return c},mk.getLength=function(){var a=this.getLengths();return a[a.length-1]},mk.getLengths=function(a){if(a||(a=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var b,c,d=[],e=this.getPoint(0),f=0;for(d.push(0),c=1;a>=c;c++)b=this.getPoint(c/a),f+=b.distanceTo(e),d.push(f),e=b;return this.cacheArcLengths=d,d},mk.getUtoTmapping=function(a,b){var c,d=this.getLengths(),e=0,f=d.length;c=b?b:a*d[f-1];for(var g,h=0,i=f-1;i>=h;)if(e=B(h+(i-h)/2),g=d[e]-c,0>g)h=e+1;else{if(!(g>0)){i=e;break}i=e-1}if(e=i,d[e]==c){var j=e/(f-1);return j}var k=d[e],l=d[e+1],m=l-k,n=(c-k)/m,j=(e+n)/(f-1);return j},mk.getTangent=function(a){var b=1e-4,c=a-b,d=a+b;0>c&&(c=0),d>1&&(d=1);var e=this.getPoint(c),f=this.getPoint(d),g=f.clone().sub(e);return g.normalize()},mk.getTangentAt=function(a){var b=this.getUtoTmapping(a);return this.getTangent(b)},lk.create=function(a,b){return a.prototype=ne(lk.prototype),a.prototype.getPoint=b,a};var nk=function(){this.curves=[],this.autoClose=!1},ok=nk.prototype=ne(mk);ok.add=function(a){this.curves.push(a)},ok.closePath=function(){var a=this.curves[0].getPoint(0),b=this.curves[this.curves.length-1].getPoint(1);a.equals(b)||this.curves.push(new Ek(b,a))},ok.getPoint=function(a){for(var b,c,d=a*this.getLength(),e=this.getCurveLengths(),f=0;f<e.length;){if(e[f]>=d){b=e[f]-d,c=this.curves[f];var g=1-b/c.getLength();return c.getPointAt(g)}f++}return null},ok.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]},ok.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var a,b=[],c=0,d=this.curves.length;for(a=0;d>a;a++)c+=this.curves[a].getLength(),b.push(c);return this.cacheLengths=b,b},ok.getTransformedPoints=function(a){return this.getPoints(a)},ok.getBoundingBox=function(){var a,b,c,d,e,f,g=this.getPoints();a=b=Number.NEGATIVE_INFINITY,d=e=Number.POSITIVE_INFINITY;var h,i,j,k,l=g[0]instanceof fk;for(k=l?new fk:new ek,i=0,j=g.length;j>i;i++)h=g[i],h.x>a&&(a=h.x),h.x<d&&(d=h.x),h.y>b&&(b=h.y),h.y<e&&(e=h.y),l&&(h.z>c&&(c=h.z),h.z<f&&(f=h.z)),k.add(h);var m={minX:d,minY:e,maxX:a,maxY:b};return l&&(m.maxZ=c,m.minZ=f),m};var pk=function(a){nk.call(this),this.actions=[],a&&this.fromPoints(a)},qk=pk.prototype=ne(nk.prototype),rk="moveTo",sk="lineTo",tk="quadraticCurveTo",uk="bezierCurveTo",vk="arc",wk="ellipse";qk.fromPoints=function(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;c>b;b++)this.lineTo(a[b].x,a[b].y)},qk.moveTo=function(a,b){var c=Array.prototype.slice.call(arguments);this.actions.push({action:rk,args:c})},qk.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),d=this.actions[this.actions.length-1].args,e=d[d.length-2],f=d[d.length-1],g=new Ek(new ek(e,f),new ek(a,b));this.curves.push(g),this.actions.push({action:sk,args:c})},qk.quadraticCurveTo=function(a,b,c,d){var e=Array.prototype.slice.call(arguments),f=this.actions[this.actions.length-1].args,g=f[f.length-2],h=f[f.length-1],i=new Gk(new ek(g,h),new ek(a,b),new ek(c,d));this.curves.push(i),this.actions.push({action:tk,args:e})},qk.bezierCurveTo=function(a,b,c,d,e,f){var g=Array.prototype.slice.call(arguments),h=this.actions[this.actions.length-1].args,i=h[h.length-2],j=h[h.length-1],k=new Hk(new ek(i,j),new ek(a,b),new ek(c,d),new ek(e,f));this.curves.push(k),this.actions.push({action:uk,args:g})},qk.arc=function(a,b,c,d,e,f){var g=this.actions[this.actions.length-1].args,h=g[g.length-2],i=g[g.length-1];this.absarc(a+h,b+i,c,d,e,f)},qk.absarc=function(a,b,c,d,e,f){this.absellipse(a,b,c,c,d,e,f)},qk.ellipse=function(a,b,c,d,e,f,g){var h=this.actions[this.actions.length-1].args,i=h[h.length-2],j=h[h.length-1];this.absellipse(a+i,b+j,c,d,e,f,g)},qk.absellipse=function(a,b,c,d,e,f,g){var h=Array.prototype.slice.call(arguments),i=new Dk(a,b,c,d,e,f,g);this.curves.push(i);var j=i.getPoint(1);h.push(j.x),h.push(j.y),this.actions.push({action:wk,args:h})},qk.getSpacedPoints=function(a,b){a||(a=40);for(var c=[],d=0;a>d;d++)c.push(this.getPoint(d/a));return c},qk.getPoints=function(a,b){a=a||12;var c,d,e,f,g,h,i,j,k,l,n,o,p,q,r,s,t,u,v=[];for(c=0,d=this.actions.length;d>c;c++)switch(e=this.actions[c],f=e.action,g=e.args,f){case rk:v.push(new ek(g[0],g[1]));break;case sk:v.push(new ek(g[0],g[1]));break;case tk:for(h=g[2],i=g[3],l=g[0],n=g[1],v.length>0?(q=v[v.length-1],o=q.x,p=q.y):(q=this.actions[c-1].args,o=q[q.length-2],p=q[q.length-1]),r=1;a>=r;r++)s=r/a,t=zk.b2(s,o,l,h),u=zk.b2(s,p,n,i),v.push(new ek(t,u));break;case uk:for(h=g[4],i=g[5],l=g[0],n=g[1],j=g[2],k=g[3],v.length>0?(q=v[v.length-1],o=q.x,p=q.y):(q=this.actions[c-1].args,o=q[q.length-2],p=q[q.length-1]),r=1;a>=r;r++)s=r/a,t=zk.b3(s,o,l,j,h),u=zk.b3(s,p,n,k,i),v.push(new ek(t,u));break;case vk:var w,x=g[0],y=g[1],z=g[2],A=g[3],B=g[4],C=!!g[5],D=B-A,E=2*a;for(r=1;E>=r;r++)s=r/E,C||(s=1-s),w=A+s*D,t=x+z*H(w),u=y+z*J(w),v.push(new ek(t,u));break;case wk:var w,x=g[0],y=g[1],F=g[2],I=g[3],A=g[4],B=g[5],C=!!g[6],D=B-A,E=2*a;for(r=1;E>=r;r++)s=r/E,C||(s=1-s),w=A+s*D,t=x+F*H(w),u=y+I*J(w),v.push(new ek(t,u))}var K,L,M=m["shape3d.point.epsilon"],N=!1;for(d=v.length,c=0,d=v.length;d>c;c++)K=v[c],L=c===d-1?v[0]:v[c+1],K&&L&&G(K.x-L.x)<M&&G(K.y-L.y)<M&&(N=!0,v[c]=null);if(N){var O=[];for(c=0;d>c;c++)v[c]&&O.push(v[c]);v=O}return b&&v.push(v[0]),v},qk.toShapes=function(a,b){function d(a){var b,c,d,e,f,g=[],h=new pk;for(b=0,c=a.length;c>b;b++)d=a[b],f=d.args,e=d.action,e==rk&&0!=h.actions.length&&(g.push(h),h=new pk),h[e].apply(h,f);return 0!=h.actions.length&&g.push(h),g}function e(a){for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c],f=new xk;f.actions=e.actions,f.curves=e.curves,b.push(f)}return b}function f(a,b){for(var c=1e-10,d=b.length,e=!1,f=d-1,g=0;d>g;f=g++){var h=b[f],i=b[g],j=i.x-h.x,k=i.y-h.y;if(G(k)>c){if(0>k&&(h=b[g],j=-j,i=b[f],k=-k),a.y<h.y||a.y>i.y)continue;if(a.y==h.y){if(a.x==h.x)return!0}else{var l=k*(a.x-h.x)-j*(a.y-h.y);if(0==l)return!0;if(0>l)continue;e=!e}}else{if(a.y!=h.y)continue;if(i.x<=a.x&&a.x<=h.x||h.x<=a.x&&a.x<=i.x)return!0}}return e}var g=d(this.actions);if(0==g.length)return[];if(b===!0)return e(g);var h,i,j,k=[];if(1==g.length)return i=g[0],j=new xk,j.actions=i.actions,j.curves=i.curves,k.push(j),k;var l=!zk.isClockWise(g[0].getPoints());l=a?!l:l;var m,n=[],o=[],p=[],q=0;o[q]=c,p[q]=[];var r,s;for(r=0,s=g.length;s>r;r++)i=g[r],m=i.getPoints(),h=zk.isClockWise(m),h=a?!h:h,h?(!l&&o[q]&&q++,o[q]={s:new xk,p:m},o[q].s.actions=i.actions,o[q].s.curves=i.curves,l&&q++,p[q]=[]):p[q].push({h:i,p:m[0]});if(!o[0])return e(g);if(o.length>1){for(var t=!1,u=[],v=0,w=o.length;w>v;v++)n[v]=[];for(var v=0,w=o.length;w>v;v++)for(var x=(o[v],p[v]),y=0;y<x.length;y++){for(var z=x[y],A=!0,B=0;B<o.length;B++)f(z.p,o[B].p)&&(v!=B&&u.push({froms:v,tos:B,hole:y}),A?(A=!1,n[B].push(z)):t=!0);A&&n[v].push(z)}u.length>0&&(t||(p=n))}var C,D,E;for(r=0,s=o.length;s>r;r++)for(j=o[r].s,k.push(j),C=p[r],D=0,E=C.length;E>D;D++)j.holes.push(C[D].h);return k};var xk=function(){pk.apply(this,arguments),this.holes=[]},yk=xk.prototype=ne(qk);yk.getPointsHoles=function(a){var b,c=this.holes.length,d=[];for(b=0;c>b;b++)d[b]=this.holes[b].getTransformedPoints(a);return d},yk.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}},yk.extractPoints=function(a){return this.extractAllPoints(a)};var zk={triangulateShape:function(a,b){function d(a,b,c){return a.x!=b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function e(a,b,c,e,f){var g=1e-10,h=b.x-a.x,i=b.y-a.y,j=e.x-c.x,k=e.y-c.y,l=a.x-c.x,m=a.y-c.y,n=i*j-h*k,o=i*l-h*m;if(G(n)>g){var p;if(n>0){if(0>o||o>n)return[];if(p=k*l-j*m,0>p||p>n)return[]}else{if(o>0||n>o)return[];if(p=k*l-j*m,p>0||n>p)return[]}if(0==p)return!f||0!=o&&o!=n?[a]:[];if(p==n)return!f||0!=o&&o!=n?[b]:[];if(0==o)return[c];if(o==n)return[e];var q=p/n;return[{x:a.x+q*h,y:a.y+q*i}]}if(0!=o||k*l!=j*m)return[];var r=0==h&&0==i,s=0==j&&0==k;if(r&&s)return a.x!=c.x||a.y!=c.y?[]:[a];if(r)return d(c,e,a)?[a]:[];if(s)return d(a,b,c)?[c]:[];var t,u,v,w,x,y,z,A;return 0!=h?(a.x<b.x?(t=a,v=a.x,u=b,w=b.x):(t=b,v=b.x,u=a,w=a.x),c.x<e.x?(x=c,z=c.x,y=e,A=e.x):(x=e,z=e.x,y=c,A=c.x)):(a.y<b.y?(t=a,v=a.y,u=b,w=b.y):(t=b,v=b.y,u=a,w=a.y),c.y<e.y?(x=c,z=c.y,y=e,A=e.y):(x=e,z=e.y,y=c,A=c.y)),z>=v?z>w?[]:w==z?f?[]:[x]:A>=w?[x,u]:[x,y]:v>A?[]:v==A?f?[]:[t]:A>=w?[t,u]:[t,y]}function f(a,b,c,d){var e=1e-10,f=b.x-a.x,g=b.y-a.y,h=c.x-a.x,i=c.y-a.y,j=d.x-a.x,k=d.y-a.y,l=f*i-g*h,m=f*k-g*j;if(G(l)>e){var n=j*i-k*h;return l>0?m>=0&&n>=0:m>=0||n>=0}return m>0}function g(a,b){function d(a,b){var c=t.length-1,d=a-1;0>d&&(d=c);var e=a+1;e>c&&(e=0);var g=f(t[a],t[d],t[e],i[b]);if(!g)return!1;var h=i.length-1,j=b-1;0>j&&(j=h);var k=b+1;return k>h&&(k=0),g=f(i[b],i[j],i[k],t[a]),g?!0:!1}function g(a,b){var c,d,f;for(c=0;c<t.length;c++)if(d=c+1,d%=t.length,f=e(a,b,t[c],t[d],!0),f.length>0)return!0;return!1}function h(a,c){var d,f,g,h,i;for(d=0;d<u.length;d++)for(f=b[u[d]],g=0;g<f.length;g++)if(h=g+1,h%=f.length,i=e(a,c,f[g],f[h],!0),i.length>0)return!0;return!1}for(var i,j,k,l,m,n,o,p,q,r,s,t=a.concat(),u=[],v=[],w=0,x=b.length;x>w;w++)u.push(w);for(var y=0,z=2*u.length;u.length>0&&(z--,!(0>z));)for(k=y;k<t.length;k++){l=t[k],j=-1;for(var w=0;w<u.length;w++)if(n=u[w],o=l.x+":"+l.y+":"+n,v[o]===c){i=b[n];for(var A=0;A<i.length;A++)if(m=i[A],d(k,A)&&!g(l,m)&&!h(l,m)){j=A,u.splice(w,1),p=t.slice(0,k+1),q=t.slice(k),r=i.slice(j),s=i.slice(0,j+1),t=p.concat(r).concat(s).concat(q),y=k;break}if(j>=0)break;v[o]=!0}if(j>=0)break}return t}for(var h,i,j,k,l,m,n={},o=a.concat(),p=0,q=b.length;q>p;p++)Array.prototype.push.apply(o,b[p]);for(h=0,i=o.length;i>h;h++)l=o[h].x+":"+o[h].y,n[l]!==c,n[l]=h;var r=g(a,b),s=Ak.Triangulate(r,!1);for(h=0,i=s.length;i>h;h++)for(k=s[h],j=0;3>j;j++)l=k[j].x+":"+k[j].y,m=n[l],m!==c&&(k[j]=m);return s.concat()},isClockWise:function(a){return Ak.Triangulate.area(a)<0},b2p0:function(a,b){var c=1-a;return c*c*b},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,b,c,d){return this.b2p0(a,b)+this.b2p1(a,c)+this.b2p2(a,d)},b3p0:function(a,b){var c=1-a;return c*c*c*b},b3p1:function(a,b){var c=1-a;return 3*c*c*a*b},b3p2:function(a,b){var c=1-a;return 3*c*a*a*b},b3p3:function(a,b){return a*a*a*b},b3:function(a,b,c,d,e){return this.b3p0(a,b)+this.b3p1(a,c)+this.b3p2(a,d)+this.b3p3(a,e)}},Ak={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var a=b.keys(this.faces);return a.length?a[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(a){var b=a.familyName.toLowerCase(),c=this;return c.faces[b]=c.faces[b]||{},c.faces[b][a.cssFontWeight]=c.faces[b][a.cssFontWeight]||{},c.faces[b][a.cssFontWeight][a.cssFontStyle]=a,a},drawText:function(a){var b,c=this.getFace(),d=this.size/c.resolution,e=0,f=String(a).split(""),g=f.length,h=[];for(b=0;g>b;b++){var i=new pk,j=this.extractGlyphPoints(f[b],c,d,e,i);j&&(e+=j.offset*this.spacing,h.push(j.path))}var k=e/2;return{paths:h,offset:k}},extractGlyphPoints:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=[],z=b.glyphs[a]||b.glyphs["?"];if(z){if(z.o)for(i=z._cachedOutline||(z._cachedOutline=z.o.split(" ")),k=i.length,l=c,m=c,f=0;k>f;)switch(j=i[f++]){case"m":n=i[f++]*l+d,o=i[f++]*m,e.moveTo(n,o);break;case"l":n=i[f++]*l+d,o=i[f++]*m,e.lineTo(n,o);break;case"q":if(p=i[f++]*l+d,q=i[f++]*m,t=i[f++]*l+d,u=i[f++]*m,e.quadraticCurveTo(t,u,p,q),x=y[y.length-1])for(r=x.x,s=x.y,g=1,h=this.divisions;h>=g;g++){var A=g/h;zk.b2(A,r,t,p),zk.b2(A,s,u,q)}break;case"b":if(p=i[f++]*l+d,q=i[f++]*m,t=i[f++]*l+d,u=i[f++]*m,v=i[f++]*l+d,w=i[f++]*m,e.bezierCurveTo(t,u,v,w,p,q),x=y[y.length-1])for(r=x.x,s=x.y,g=1,h=this.divisions;h>=g;g++){var A=g/h;zk.b3(A,r,t,v,p),zk.b3(A,s,u,w,q)}}return{offset:z.ha*c,path:e}}}};Ak.generateShapes=function(a,b){b=b||{};var d=b.font;if(d===c&&(d=Ak.getDefaultFont(),!d))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var e=b.size!==c?b.size:1,f=b.curveSegments!==c?b.curveSegments:4,g=b.spacing!==c?b.spacing:1,h=b.weight!==c?b.weight:"normal",i=b.style!==c?b.style:"normal";Ak.size=e,Ak.divisions=f,Ak.face=d,Ak.weight=h,Ak.style=i,Ak.spacing=g;for(var j=Ak.drawText(a),k=j.paths,l=[],m=0,n=k.length;n>m;m++)Array.prototype.push.apply(l,k[m].toShapes());return l},function(a){var b=1e-10,c=function(a,b){var c=a.length;if(3>c)return null;var f,g,h,i=[],j=[],k=[];if(d(a)>0)for(g=0;c>g;g++)j[g]=g;else for(g=0;c>g;g++)j[g]=c-1-g;var l=c,m=2*l;for(g=l-1;l>2;){if(m--<=0)return b?k:i;if(f=g,f>=l&&(f=0),g=f+1,g>=l&&(g=0),h=g+1,h>=l&&(h=0),e(a,f,g,h,l,j)){var n,o,p,q,r;for(n=j[f],o=j[g],p=j[h],i.push([a[n],a[o],a[p]]),k.push([j[f],j[g],j[h]]),q=g,r=g+1;l>r;q++,r++)j[q]=j[r];l--,m=2*l}}return b?k:i},d=function(a){for(var b=a.length,c=0,d=b-1,e=0;b>e;d=e++)c+=a[d].x*a[e].y-a[e].x*a[d].y;return.5*c},e=function(a,c,d,e,f,g){var h,i,j,k,l,m,n,o,p;if(i=a[g[c]].x,j=a[g[c]].y,k=a[g[d]].x,l=a[g[d]].y,m=a[g[e]].x,n=a[g[e]].y,b>(k-i)*(n-j)-(l-j)*(m-i))return!1;var q,r,s,t,u,v,w,x,y,z,A,B,C,D,E;for(q=m-k,r=n-l,s=i-m,t=j-n,u=k-i,v=l-j,h=0;f>h;h++)if(o=a[g[h]].x,p=a[g[h]].y,!(o===i&&p===j||o===k&&p===l||o===m&&p===n)&&(w=o-i,x=p-j,y=o-k,z=p-l,A=o-m,B=p-n,E=q*z-r*y,C=u*x-v*w,D=s*B-t*A,E>=-b&&D>=-b&&C>=-b))return!1;return!0};return a.Triangulate=c,a.Triangulate.area=d,a}(Ak),a._typeface_js={faces:Ak.faces,loadFace:Ak.loadFace};var Bk=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Ck=Bk.prototype={constructor:Bk,computeFaceNormals:function(){for(var a=new fk,b=new fk,c=0,d=this.faces.length;d>c;c++){var e=this.faces[c],f=this.vertices[e.a],g=this.vertices[e.b],h=this.vertices[e.c];a.subVectors(h,g),b.subVectors(f,g),a.cross(b),a.normalize(),e.normal.copy(a)}},computeVertexNormals:function(a){var b,c,d,e,f,g;for(g=new Array(this.vertices.length),b=0,c=this.vertices.length;c>b;b++)g[b]=new fk;if(a){var h,i,j,k=new fk,l=new fk;for(d=0,e=this.faces.length;e>d;d++)f=this.faces[d],h=this.vertices[f.a],i=this.vertices[f.b],j=this.vertices[f.c],k.subVectors(j,i),l.subVectors(h,i),k.cross(l),g[f.a].add(k),g[f.b].add(k),g[f.c].add(k)}else for(d=0,e=this.faces.length;e>d;d++)f=this.faces[d],g[f.a].add(f.normal),g[f.b].add(f.normal),g[f.c].add(f.normal);for(b=0,c=this.vertices.length;c>b;b++)g[b].normalize();for(d=0,e=this.faces.length;e>d;d++)f=this.faces[d],f.vertexNormals[0]=g[f.a].clone(),f.vertexNormals[1]=g[f.b].clone(),f.vertexNormals[2]=g[f.c].clone()},mergeVertices:function(){var a,b,d,e,f,g,h,i,j={},k=[],l=[],m=4,n=K(10,m);for(d=0,e=this.vertices.length;e>d;d++)a=this.vertices[d],b=A(a.x*n)+"_"+A(a.y*n)+"_"+A(a.z*n),j[b]===c?(j[b]=d,k.push(this.vertices[d]),l[d]=k.length-1):l[d]=l[j[b]];var o=[];for(d=0,e=this.faces.length;e>d;d++){f=this.faces[d],f.a=l[f.a],f.b=l[f.b],f.c=l[f.c],g=[f.a,f.b,f.c];for(var p=0;3>p;p++)if(g[p]==g[(p+1)%3]){o.push(d);break}}for(d=o.length-1;d>=0;d--){var q=o[d];for(this.faces.splice(q,1),h=0,i=this.faceVertexUvs.length;i>h;h++)this.faceVertexUvs[h].splice(q,1)}var r=this.vertices.length-k.length;return this.vertices=k,r}},Dk=function(a,b,c,d,e,f,g){this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e,this.aEndAngle=f,this.aClockwise=g};Dk.prototype=ne(mk),Dk.prototype.getPoint=function(a){var b,c=this.aEndAngle-this.aStartAngle;0>c&&(c+=N),c>N&&(c-=N),b=this.aClockwise===!0?this.aEndAngle+(1-a)*(N-c):this.aStartAngle+a*c;var d=this.aX+this.xRadius*H(b),e=this.aY+this.yRadius*J(b);return new ek(d,e)};var Ek=function(a,b){this.v1=a,this.v2=b},Fk=Ek.prototype=ne(mk);Fk.getPoint=function(a){var b=this.v2.clone().sub(this.v1);return b.multiplyScalar(a).add(this.v1),b},Fk.getPointAt=function(a){return this.getPoint(a)},Fk.getTangent=function(a){var b=this.v2.clone().sub(this.v1);return b.normalize()};var Gk=function(a,b,c){this.v0=a,this.v1=b,this.v2=c};Gk.prototype=ne(mk),Gk.prototype.getPoint=function(a){var b,c;return b=zk.b2(a,this.v0.x,this.v1.x,this.v2.x),c=zk.b2(a,this.v0.y,this.v1.y,this.v2.y),new ek(b,c)};var Hk=function(a,b,c,d){this.v0=a,this.v1=b,this.v2=c,this.v3=d};Hk.prototype=ne(mk),Hk.prototype.getPoint=function(a){var b,c;return b=zk.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=zk.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new ek(b,c)};var Ik=(lk.create(function(a,b){this.v1=a,this.v2=b},function(a){var b=new fk;return b.subVectors(this.v2,this.v1),b.multiplyScalar(a),b.add(this.v1),b}),lk.create(function(a,b,c){this.v0=a,this.v1=b,this.v2=c},function(a){var b,c,d;return b=zk.b2(a,this.v0.x,this.v1.x,this.v2.x),c=zk.b2(a,this.v0.y,this.v1.y,this.v2.y),d=zk.b2(a,this.v0.z,this.v1.z,this.v2.z),new fk(b,c,d)})),Jk=lk.create(function(a,b,c,d){this.v0=a,this.v1=b,this.v2=c,this.v3=d},function(a){var b,c,d;return b=zk.b3(a,this.v0.x,this.v1.x,this.v2.x,this.v3.x),c=zk.b3(a,this.v0.y,this.v1.y,this.v2.y,this.v3.y),d=zk.b3(a,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new fk(b,c,d)}),Kk=function(a,b,d,e,f,g,h,i){Bk.call(this),e=e!==c?e:.5,f=f!==c?f:.5,i=i!==c?i:1,a=a||8,g=g||0,h=h||N;var j,k,l=1,m=i/2,n=[],o=[],p=this.vertices,q=this.faces,r=this.faceVertexUvs;for(k=0;l>=k;k++){var s=[],t=[],u=k/l,v=u*(f-e)+e;for(j=0;a>=j;j++){var w=j/a,x=new fk,y=-(w*h+g);x.z=v*J(y),x.y=-u*i+m,x.x=v*H(y),p.push(x),s.push(p.length-1),t.push(new ek(w,u))}n.push(s),o.push(t)}var z,A,B=(f-e)/i;for(j=0;a>j;j++)for(0!==e?(z=p[n[0][j]].clone(),A=p[n[0][j+1]].clone()):(z=p[n[1][j]].clone(),A=p[n[1][j+1]].clone()),z.setY(D(z.x*z.x+z.z*z.z)*B).normalize(),A.setY(D(A.x*A.x+A.z*A.z)*B).normalize(),k=0;l>k;k++){var C=n[k][j],E=n[k+1][j],F=n[k+1][j+1],G=n[k][j+1],I=z.clone(),K=z.clone(),L=A.clone(),M=A.clone(),O=o[k][j].clone(),P=o[k+1][j].clone(),Q=o[k+1][j+1].clone(),R=o[k][j+1].clone();q.push(new ik(C,E,G,[I,K,M])),r[0].push([O,P,R]),q.push(new ik(E,F,G,[K.clone(),L,M.clone()])),r[0].push([P.clone(),Q,R.clone()])}if(b&&e>0)for(this.vertices.push(new fk(0,m,0)),j=0;a>j;j++){var C=n[0][j],E=n[0][j+1],F=this.vertices.length-1,I=new fk(0,1,0),K=new fk(0,1,0),L=new fk(0,1,0),O=o[0][j].clone(),P=o[0][j+1].clone(),Q=new ek(P.x,0);q.push(new ik(C,E,F,[I,K,L],null,1));var S=j/a*N,T=H(S),U=J(S),V=(j+1)/a*N,W=H(V),X=J(V);r[0].push([new ek(.5+.5*T,.5+.5*U),new ek(.5+.5*W,.5+.5*X),new ek(.5,.5)])}if(d&&f>0)for(this.vertices.push(new fk(0,-m,0)),j=0;a>j;j++){var C=n[k][j+1],E=n[k][j],F=p.length-1,I=new fk(0,-1,0),K=new fk(0,-1,0),L=new fk(0,-1,0),O=o[k][j+1].clone(),P=o[k][j].clone();q.push(new ik(C,E,F,[I,K,L],null,2));var S=j/a*N,T=H(S),U=J(S),V=(j+1)/a*N,W=H(V),X=J(V);r[0].push([new ek(.5+.5*W,.5-.5*X),new ek(.5+.5*T,.5-.5*U),new ek(.5,.5)]);
}};Kk.prototype=ne(Ck);var Lk=function(a,b,d,e,f,g,h){Bk.call(this),h=h||.5,a=a||16,b=b||16,d=(d!==c?d:0)-M,e=e!==c?e:N,f=f!==c?f:0,g=g!==c?g:M;var i,j,k=[],l=[],m=this.vertices,n=this.faces,o=this.faceVertexUvs;for(j=0;b>=j;j++){var p=[],q=[];for(i=0;a>=i;i++){var r=i/a,s=j/b,t=new fk;t.x=-h*H(d+r*e)*J(f+s*g),t.y=h*H(f+s*g),t.z=h*J(d+r*e)*J(f+s*g),m.push(t),p.push(m.length-1),q.push(new ek(r,s))}k.push(p),l.push(q)}for(j=0;b>j;j++)for(i=0;a>i;i++){var u=k[j][i+1],v=k[j][i],w=k[j+1][i],x=k[j+1][i+1],y=m[u].clone().normalize(),z=m[v].clone().normalize(),A=m[w].clone().normalize(),B=m[x].clone().normalize(),C=l[j][i+1].clone(),D=l[j][i].clone(),E=l[j+1][i].clone(),F=l[j+1][i+1].clone();G(m[u].y)===h?(C.x=(C.x+D.x)/2,n.push(new ik(u,w,x,[y,A,B])),o[0].push([C,E,F])):G(m[w].y)===h?(E.x=(E.x+F.x)/2,n.push(new ik(u,v,w,[y,z,A])),o[0].push([C,D,E])):(n.push(new ik(u,v,x,[y,z,B])),o[0].push([C,D,F]),n.push(new ik(v,w,x,[z.clone(),A,B.clone()])),o[0].push([D.clone(),E,F.clone()]))}};Lk.prototype=ne(Ck);var Mk=function(a,b,c,d,e,f){Bk.call(this),a=a||.33,b=b||.17,d=d||8,c=c||6,e=e||0,f=f||N;for(var g=new fk,h=[],i=[],j=0;d>=j;j++)for(var k=j/d*N+M,l=0;c>=l;l++){var m=l/c*f+e;g.x=a*H(m),g.z=-a*J(m);var n=new fk,o=a+b*H(k);n.x=o*H(m),n.z=-o*J(m),n.y=b*J(k),this.vertices.push(n),h.push(new ek(l/c,1-j/d)),i.push(n.clone().sub(g).normalize())}for(var j=1;d>=j;j++)for(var l=1;c>=l;l++){var p=(c+1)*j+l-1,q=(c+1)*(j-1)+l-1,r=(c+1)*(j-1)+l,s=(c+1)*j+l,t=new ik(p,q,s,[i[p].clone(),i[q].clone(),i[s].clone()]);this.faces.push(t),this.faceVertexUvs[0].push([h[p].clone(),h[q].clone(),h[s].clone()]),t=new ik(q,r,s,[i[q].clone(),i[r].clone(),i[s].clone()]),this.faces.push(t),this.faceVertexUvs[0].push([h[q].clone(),h[r].clone(),h[s].clone()])}this.computeFaceNormals()};Mk.prototype=ne(Ck);var Nk=function(a,b,c){return a?(Bk.call(this),a=a instanceof Array?a:[a],this.addShapeList(a,b),b.convertYZ!==!1&&$j(this,c),void this.computeFaceNormals()):void(a=[])},Ok=Nk.prototype=ne(Bk.prototype);Ok.addShapeList=function(a,b){for(var c=a.length,d=0;c>d;d++){var e=a[d];this.addShape(e,b)}},Ok.addShape=function(a,b){function d(){if(b.bottom)for(var a=0;I>a;a++)G=D[a],h(G[2],G[1],G[0],!0);if(b.top)for(a=0;I>a;a++)G=D[a],h(G[0]+H*q,G[1]+H*q,G[2]+H*q,!1)}function e(){var a=0;for(f(E,a),a+=E.length,v=0,w=B.length;w>v;v++)u=B[v],f(u,a),a+=u.length}function f(a,b){for(var c,d,e=a.length;--e>=0;){c=e,d=e-1,0>d&&(d=a.length-1);var f=0,g=q;for(f=0;g>f;f++){var h=H*f,j=H*(f+1),k=b+c+h,l=b+d+h,m=b+d+j,n=b+c+j;i(k,l,m,n,a,f,g,c,d)}}}function g(a,b,c){x.vertices.push(new fk(a,b,c))}function h(c,d,e,f){c+=y,d+=y,e+=y,x.faces.push(new ik(c,d,e,null,null,f?2:1));var g=f?t.generateBottomUV(x,a,b,c,d,e):t.generateTopUV(x,a,b,c,d,e);x.faceVertexUvs[0].push(g)}function i(c,d,e,f,g,h,i,j,k){c+=y,d+=y,e+=y,f+=y,x.faces.push(new ik(c,d,f)),x.faces.push(new ik(d,e,f));var l=t.generateSideWallUV(x,a,g,b,c,d,e,f,h,i,j,k);x.faceVertexUvs[0].push([l[0],l[1],l[3]]),x.faceVertexUvs[0].push([l[1],l[2],l[3]])}var j,k,l,m,n,o=b.amount,p=b.curveSegments||ii,q=b.steps||1,r=b.extrudePath,s=!1,t=new hk(b.repeatUVLength);r&&(j=r.getSpacedPoints(q),s=!0,k=b.frames!==c?b.frames:new Pk.FrenetFrames(r,q,!1),l=new fk,m=new fk,n=new fk);var u,v,w,x=this,y=this.vertices.length,z=a.extractPoints(p),A=z.shape,B=z.holes,C=!zk.isClockWise(A);if(C){for(A=A.reverse(),v=0,w=B.length;w>v;v++)u=B[v],zk.isClockWise(u)&&(B[v]=u.reverse());C=!1}var D=zk.triangulateShape(A,B),E=A;for(v=0,w=B.length;w>v;v++)u=B[v],A=A.concat(u);for(var F,G,H=A.length,I=D.length,J=0;H>J;J++)F=A[J],s?(m.copy(k.normals[0]).multiplyScalar(F.x),l.copy(k.binormals[0]).multiplyScalar(F.y),n.copy(j[0]).add(m).add(l),g(n.x,n.y,n.z)):g(F.x,F.y,0);var K;for(K=1;q>=K;K++)for(J=0;H>J;J++)F=A[J],s?(m.copy(k.normals[K]).multiplyScalar(F.x),l.copy(k.binormals[K]).multiplyScalar(F.y),n.copy(j[K]).add(m).add(l),g(n.x,n.y,n.z)):g(F.x,F.y,o/q*K);d(),e()};var Pk=function(a,b,c,d,e){function f(a,b,c){return B.vertices.push(new fk(a,b,c))-1}Bk.call(this),b=b||64,c=c||1,d=d||8,e=e||!1;var g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=[],B=this,C=b+1,D=new fk,E=new Pk.FrenetFrames(a,b,e),F=E.tangents,G=E.normals,I=E.binormals;for(this.tangents=F,this.normals=G,this.binormals=I,o=0;C>o;o++)for(A[o]=[],j=o/(C-1),n=a.getPointAt(j),g=F[o],h=G[o],i=I[o],p=0;d>p;p++)k=p/d*N,l=-c*H(k),m=c*J(k),D.copy(n),D.x+=l*h.x+m*i.x,D.y+=l*h.y+m*i.y,D.z+=l*h.z+m*i.z,A[o][p]=f(D.x,D.y,D.z);for(o=0;b>o;o++)for(p=0;d>p;p++)q=e?(o+1)%b:o+1,r=(p+1)%d,s=A[o][p],t=A[q][p],u=A[q][r],v=A[o][r],w=new ek(o/b,p/d),x=new ek((o+1)/b,p/d),y=new ek((o+1)/b,(p+1)/d),z=new ek(o/b,(p+1)/d),this.faces.push(new ik(s,t,v)),this.faceVertexUvs[0].push([w,x,z]),this.faces.push(new ik(t,u,v)),this.faceVertexUvs[0].push([x.clone(),y,z.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Pk.prototype=ne(Ck),Pk.FrenetFrames=function(a,b,c){function d(){n[0]=new fk,o[0]=new fk,f=Number.MAX_VALUE,g=G(m[0].x),h=G(m[0].y),i=G(m[0].z),f>=g&&(f=g,l.set(1,0,0)),f>=h&&(f=h,l.set(0,1,0)),f>=i&&l.set(0,0,1),p.crossVectors(m[0],l).normalize(),n[0].crossVectors(m[0],p),o[0].crossVectors(m[0],n[0])}var e,f,g,h,i,j,k,l=new fk,m=[],n=[],o=[],p=new fk,q=new gk,r=b+1,s=1e-4;for(this.tangents=m,this.normals=n,this.binormals=o,j=0;r>j;j++)k=j/(r-1),m[j]=a.getTangentAt(k),m[j].normalize();for(d(),j=1;r>j;j++)n[j]=n[j-1].clone(),o[j]=o[j-1].clone(),p.crossVectors(m[j-1],m[j]),p.length()>s&&(p.normalize(),e=I($d(m[j-1].dot(m[j]),-1,1)),n[j].applyMatrix4(q.makeRotationAxis(p,e))),o[j].crossVectors(m[j],n[j]);if(c)for(e=I($d(n[0].dot(n[r-1]),-1,1)),e/=r-1,m[0].dot(p.crossVectors(n[0],n[r-1]))>0&&(e=-e),j=1;r>j;j++)n[j].applyMatrix4(q.makeRotationAxis(m[j],e*j)),o[j].crossVectors(m[j],n[j])};var Qk=function(a,b,c,d){Bk.call(this),b=b||18,c=c||0,d=d==i?N:d;for(var e=1/(a.length-1),f=1/b,g=0,h=b;h>=g;g++)for(var j=c+g*f*d,k=H(j),l=J(j),m=0,n=a.length;n>m;m++){var o=a[m],p=new fk;p.x=k*o.x-l*o.y,p.y=l*o.x+k*o.y,p.z=o.z,this.vertices.push(p)}for(var q=a.length,g=0,h=b;h>g;g++)for(var m=0,n=a.length-1;n>m;m++){var r=m+q*g,s=r,t=r+q,k=r+1+q,u=r+1,v=g*f,w=m*e,x=v+f,y=w+e;this.faces.push(new ik(s,u,t)),this.faceVertexUvs[0].push([new ek(v,w),new ek(v,y),new ek(x,w)]),this.faces.push(new ik(t,u,k)),this.faceVertexUvs[0].push([new ek(x,w),new ek(v,y),new ek(x,y)])}this.mergeVertices(),$j(this),this.computeFaceNormals(),this.computeVertexNormals()};Qk.prototype=ne(Ck);var Rk=function(a,b){b=b||{};var d=Ak.generateShapes(a,b);b.amount=b.amount!==c?b.amount:.5,b.convertYZ=!1,b.fill!==!1&&(b.bottom=!0,b.top=!0),Nk.call(this,d,b)};Rk.prototype=ne(Ok);var Sk=j.Node=function(){Wd(Sk,this)},Tk={X:Bi,Y:Ci,Z:Di},Uk={X:0,Y:1,Z:2},Vk={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Wk="xzy",Xk=function(a,b,c){if(b){var d=b[0],e=b[1],f=b[2];"xzy"===c?(Ci(a,e),Di(a,f),Bi(a,d)):"xyz"===c?(Di(a,f),Ci(a,e),Bi(a,d)):"yxz"===c?(Di(a,f),Bi(a,d),Ci(a,e)):"yzx"===c?(Bi(a,d),Di(a,f),Ci(a,e)):"zxy"===c?(Ci(a,e),Bi(a,d),Di(a,f)):"zyx"===c?(Bi(a,d),Ci(a,e),Di(a,f)):(Ci(a,e),Di(a,f),Bi(a,d))}};li("Node",ej,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Wk,_64O:0,_rotationX:0,_53O:0,_host:i,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return kl},_22Q:function(){return fq},getX:function(){return this.p().x},setX:function(a){this.p(a,this.p().y)},getY:function(){return this.p().y},setY:function(a){this.p(this.p().x,a)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(a){this.setAnchor(a,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(a){this.setAnchor(this.getAnchor().x,a)},getScaleX:function(){return this.getScale().x},setScaleX:function(a){this.setScale(a,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(a){this.setScale(this.getScale().x,a)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(a,b){yi(a,Fi(i,i,this.r3(),this.getRotationMode())),this.translate3d(a[0]*b,a[1]*b,a[2]*b)},translateFront:function(a){this.translate3dBy([0,0,1],a)},translateBack:function(a){this.translate3dBy([0,0,-1],a)},translateLeft:function(a){this.translate3dBy([-1,0,0],a)},translateRight:function(a){this.translate3dBy([1,0,0],a)},translateTop:function(a){this.translate3dBy([0,1,0],a)},translateBottom:function(a){this.translate3dBy([0,-1,0],a)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]),this.p(a,c),this.setElevation(b)},translate3d:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]),this.translate(a,c),this.setElevation(this._54O+b)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]),this.setSize(a,c),this.setTall(b)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]),this.setRotationX(a),this.setRotation(-b),this.setRotationZ(c)},setRotationY:function(a){this.setRotation(-a)},getRotationY:function(){return-this._64O},lookAtDirection:function(a,b){b=b||ma;var c=this,d=Vh(a);b===ma?(c.r3([-L(a[1]/d),-Q(a[2],a[0])+O,0]),c.setRotationMode("xzy")):b===pa?(c.r3(0,-Q(a[2],a[0]),L(a[1]/d)),c.setRotationMode("zyx")):b===oa?(c.r3(0,-Q(a[2],a[0])+M,-L(a[1]/d)),c.setRotationMode("zyx")):b===qa?(c.r3([-L(a[1]/d)+O,-Q(a[2],a[0])+O,0]),c.setRotationMode("xzy")):b===ra&&(c.r3([-L(a[1]/d)-O,-Q(a[2],a[0])+O,0]),c.setRotationMode("xzy")),b===na&&(c.r3([-L(a[1]/d)+M,-Q(a[2],a[0])+O,M]),c.setRotationMode("zxy"))},lookAt:function(a,b){return this.lookAtDirection(qi(a,this.p3()),b)},lookAtX:function(){var a=new Kg,b=new Kg,c=new Kg,d=new Rg,e=new Rg,f=new Tg;return function(g,h){var i=Ei(this);if(d.fromArray(i),c.copy(this.p3()),a.copy(g).sub(c),!(a.lengthSq()<1e-6)){a.normalize(),h===ma?b.set(0,0,1):h===na?b.set(0,0,-1):h===oa?b.set(-1,0,0):h===pa?b.set(1,0,0):h===qa?b.set(0,1,0):h===ra&&b.set(0,-1,0),b.applyMatrix4(d).sub(c).normalize();var j=Math.acos(a.dot(b));if(j){var k=a.clone().cross(b);k.lengthSq()<1e-6&&(h===qa||h===ra?k.set(0,0,1).applyMatrix4(d).sub(c):k.set(0,1,0).applyMatrix4(d).sub(c)),k.normalize(),f.set(this.r3(),this.getRotationMode(),!0),d.makeRotationFromEuler(f),e.makeRotationAxis(k,-j),f.setFromRotationMatrix(e.multiply(d)),this.r3([f.x,f.y,f.z])}}}}(),getHost:function(){return this._host},setHost:function(a){var b=this;if(b!==a&&b._host!==a){var c=b._host;c&&c._removeAttach(b),b._host=a,b._host&&b._host._addAttach(b),b.fp("host",c,a),b.onHostChanged(c,a)}},getAttaches:function(){return this._69O},_addAttach:function(a){var b=this;b._69O||(b._69O=new bj),b._69O.add(a),b.fp("attaches",i,a)},_removeAttach:function(a){var b=this;b._69O.remove(a),b._69O.isEmpty()&&delete b._69O,b.fp("attaches",a,i)},getImage:function(){if(this._pendingCheckImageJSON){var a=l.getImage(this._image);a&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof el&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(a){var b=this,c=b._image,d=b.getWidth(),e=b.getHeight();b._image=a,b.fp("image",c,a)&&(null!=a&&(Fd(a)||Cd(a)&&/\.json$/i.test(a))&&(this._pendingCheckImageJSON=!0),b.fp(La,d,b.getWidth()),b.fp(Ma,e,b.getHeight()))},getElevation:function(){return this._54O},setElevation:function(a){var b=this;if(!b._50O){b._50O=1;var c=b._54O;b._54O=a,b.fp(Mb,c,a),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(a){var b=this;if(!b._49O){b._49O=1;var c=b._64O;b._64O=a,b.fp(ib,c,a),delete b._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(a){var b=this;if(!b._51O){b._51O=1;var c=b._rotationX;b._rotationX=a,b.fp("rotationX",c,a),delete b._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(a){var b=this;if(!b._52O){b._52O=1;var c=b._53O;b._53O=a,b.fp("rotationZ",c,a),delete b._52O}},getPosition:function(){return this._position},setPosition:function(a,b){var c=this;if(!c._50I){c._50I=1;var d;if(d=2===arguments.length?{x:a,y:b}:a,d.x!==c._position.x||d.y!==c._position.y){var e=c._position;c._position=d,c.fp(Lb,e,d)}delete c._50I}},translate:function(a,b){var c=this._position;this.p(c.x+a,c.y+b)},getWidth:function(){var a=this;if(a._width>=0)return a._width;var b=a.getStyle("shape3d");if(b){var c=ym(b);if(c&&c.rawS3)return c.rawS3[0];if("billboard"===b||"plane"===b){var d=yh(a.getStyle("shape3d.image"));return d?Zi(d,a):20}}var d=yh(a._image);return d?Zi(d,a):20},setWidth:function(a){var b=this,c=b._width;b._width=a,b.fp(La,c,a)},getHeight:function(){var a=this;if(a._height>=0)return a._height;var b=a.getStyle("shape3d");if(b){var c=ym(b);if(c&&c.rawS3)return c.rawS3[2];if("plane"===b){var d=yh(a.getStyle("shape3d.image"));return d?$i(d,a):20}if("billboard"===b)return 2}var d=yh(a._image);return d?$i(d,a):20},setHeight:function(a){var b=this,c=b._height;b._height=a,b.fp(Ma,c,a)},getTall:function(){var a=this;if(a._tall>=0)return a._tall;var b=a.getStyle("shape3d");if(b){var c=ym(b);if(c&&c.rawS3)return c.rawS3[1];if("billboard"===b){var d=yh(a.getStyle("shape3d.image"));return d?$i(d,a):20}if("plane"===b)return 2}return 20},setTall:function(a){var b=this,c=b._tall;b._tall=a,b.fp("tall",c,a)},setSize:function(a,b){var c=this;2===arguments.length?(c.setWidth(a),c.setHeight(b)):(c.setWidth(a.width),c.setHeight(a.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(a,b,c,d,e){var f=this,g=f.getAnchor(),h=f.getScale();arguments.length<=2&&(e=b,b=a.y,c=a.width,d=a.height,a=a.x);var i=e&&h.x<0?1-g.x:g.x,j=e&&h.y<0?1-g.y:g.y;f.p(a+c*i,b+d*j),e&&(c/=Math.abs(h.x),d/=Math.abs(h.y)),f.setWidth(c),f.setHeight(d)},getMatrix:function(){var a=this,b=a._64O,c=a._position,d=a.getScale();return new Hg(b,c.x,c.y,d.x,d.y)},getAnchorRect:function(){var a=this,b=a.getWidth(),c=a.getHeight(),d=a.getAnchor();return{x:-b*d.x,y:-c*d.y,width:b,height:c}},toLocal:function(a){return this.getMatrix().tfi(a)},toGlobal:function(a){return this.getMatrix().tf(a)},getAttachPosition:function(){var a=new Hg;return function(b,c,d,e){d=d||0,e=e||0;var f=this,g=f.getAnchor(),h=f._64O,i=f._position,j=f.getScale();return a.setFromTransform(h,i.x,i.y).tf({x:d+j.x*f.getWidth()*(b-g.x),y:e+j.y*f.getHeight()*(c-g.y)})}}(),isInRect:function(a){a=this.toLocal(a);var b=this.getWidth(),c=this.getHeight();return a.x+=b*this.getAnchorX(),a.y+=c*this.getAnchorY(),!(a.x<0||a.y<0||a.x>b||a.y>c)},getRect:function(){var a=this,b=a.getWidth(),c=a.getHeight(),d=a.getAnchor(),e={x:-b*d.x,y:-c*d.y,width:b,height:c},f=a.getMatrix();return e=Wh([f.tf(e.x,e.y),f.tf(e.x+e.width,e.y),f.tf(e.x+e.width,e.y+e.height),f.tf(e.x,e.y+e.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var a=this,b=a.getAnchor(),c=a._anchorElevation;return{x:b.x,y:c,z:b.y}},setAnchorElevation:function(a){var b=this,c=b._anchorElevation;return c!==a?(b._anchorElevation=a,b.fp("anchorElevation",c,a),!0):!1},setAnchor3d:function(a,b,c,d){var e,f=this;"number"==typeof a?e={x:a,y:b,z:c}:(e=a.length?{x:a[0],y:a[1],z:a[2]}:a,d=b);var g=f.getDataModel();g&&g.beginTransaction();var h=f.getAnchor3d(),i=f.setAnchor(e.x,e.z);if(f.setAnchorElevation(e.y)&&(i=!0),i&&d&&!Lc){var j=(f.getAnchor3d(),Ei(f)),k=yi([e.x-h.x,e.y-h.y,e.z-h.z],j);f.p3(k)}return g&&g.endTransaction(),i},getAnchor:function(){var a=this;if(a.hasOwnProperty("_anchor"))return a._anchor;var b=yh(a._image);return b&&b.anchorX!==c?{x:b.anchorX,y:b.anchorY}:a._anchor},setAnchor:function(a,b,c){var d,e=this;"number"==typeof a?d={x:a,y:b}:(d=a.length?{x:a[0],y:a[1]}:a,c=b);var f=e.getAnchor();if(f.x!==d.x||f.y!==d.y){var g=e.getDataModel();if(g&&g.beginTransaction(),e._anchor=d,e.fp("anchor",f,d),c&&!Lc){var h=e.getPosition(),i=e.getSize(),j=e.getRotation(),k=e.getScale(),l=-i.width*(f.x-d.x)*k.x,m=-i.height*(f.y-d.y)*k.y,n=J(j),o=H(j);e.setPosition(h.x+o*l-n*m,h.y+n*l+o*m)}return g&&g.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(a,b){var c,d=this;c=2===arguments.length?{x:a,y:b}:a;var e=d.getScale();(e.x!==c.x||e.y!==c.y)&&(d._scale=c,d.fp("scale",e,c))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var a=this,b=a._scaleTall,c=a.getScale();return[c.x,b,c.y]},getFinalScale3d:function(){var a=this,b=a.s3(),c=a._dynamicScale3d,d=a.getScale3d();return b&&(d[0]*=b[0],d[1]*=b[1],d[2]*=b[2]),c&&(d[0]*=c[0],d[1]*=c[1],d[2]*=c[2]),d},getFinalRotation3d:function(){var a=this;return a._dynamicRotation||a.r3()},setScaleTall:function(a){var b=this,c=b._scaleTall;c!==a&&(b._scaleTall=a,b.fp("scaleTall",c,a))},setScale3d:function(a,b,c){var d,e=this;d="number"==typeof a?{x:a,y:b,z:c}:a.length?{x:a[0],y:a[1],z:a[2]}:a,e.setScaleTall(d.y),e.setScale(d.x,d.z)},getCorners:function(a,b){a==i&&(a=0),b==i&&(b=a);var c=this,d=c.getAnchor(),e=c.getWidth(),f=c.getHeight(),g=-e*d.x-a,h=-f*d.y-b,j=e+2*a,k=f+2*b,l=c.getMatrix();return[l.tf(g,h),l.tf(g,h+k),l.tf(g+j,h+k),l.tf(g+j,h)]},getEditControlPoints:function(a,b,c){b==i&&(b=0),c==i&&(c=b);var d=this,e=d.getAnchor(),f=d.getWidth(),g=d.getHeight(),h=-f*e.x-b,j=-g*e.y-c,k=f+2*b,l=g+2*c;if(a)return[{x:h,y:j},{x:h,y:0},{x:h,y:j+l},{x:0,y:j+l},{x:h+k,y:j+l},{x:h+k,y:0},{x:h+k,y:j},{x:0,y:j}];var m=d.getMatrix();return[m.tf(h,j),m.tf(h,0),m.tf(h,j+l),m.tf(0,j+l),m.tf(h+k,j+l),m.tf(h+k,0),m.tf(h+k,j),m.tf(0,j)]},rotateAt:function(a,b,c){var d=this,e=d._position,f=d._64O,g=new Hg(f,e.x,e.y).tf(a,b),h=D(a*a+b*b),i=Q(e.y-g.y,e.x-g.x)+c;d.setRotation(f+c),d.p(g.x+h*H(i),g.y+h*J(i))},onParentChanged:function(a,b){Sk.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var a={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(b){a[b]=!0}),function(b){var c=this;Sk.superClass.onPropertyChanged.call(c,b),a[b.property]&&!c._layoutUpdating&&c.updateLayoutParameters(null,b.property),c._69O&&c._69O.each(function(a){a.handleHostPropertyChange(b)}),c._49I&&c._49I.each(function(a){a.fp("agentChange",!0,!1)})}}(),onHostChanged:function(a,b){this.updateAttach(),this.updateLayoutParameters()},handleHostPropertyChange:function(a){this.updateAttach(a)},onStyleChanged:function(a,b,c){Sk.superClass.onStyleChanged.apply(this,arguments),qj[a]&&this.updateAttach()},updateAttach:function(a){var b=this;return Lc?void b.updateLayoutParameters():void(b._51I||(b._51I=1,b._71O(a),delete b._51I))},_71O:function(a){var b,c,d,e,f,g,h=this,k=h._host,l=a?a.property:i,m=a?a.oldValue:i,n=a?a.newValue:i;if(k instanceof j.Grid){if(l===Mb)h.setElevation(h._54O+n-m);else if(!a||pj[l]){if(b=h.s("attach.row.index"),c=h.s("attach.column.index"),d=k.getCellRect(b,c),!d)return;e=h.s("attach.row.span"),f=h.s("attach.column.span"),(1!==e||1!==f)&&(d=Xh(d,k.getCellRect(b+e-1,c+f-1))),tj(d,h,"attach.padding",1),h.setRect(d)}}else if(k instanceof bl&&(g=h.s("attach.index"))>=0&&(!a||rj[l])){var o=h.s("attach.thickness");o!=i&&h.setHeight(k.getThickness()*o);var p=h.s("attach.offset"),q=k.getPoints(),r=q.size();if(r>g){var s=q.get(g),t=r===g+1?q.get(0):q.get(g+1),u=[t.x-s.x,t.y-s.y],v=Vh(u);if(v){h.s("attach.offset.relative")&&(p*=v),h.s("attach.offset.opposite")&&(p=v-p);var w={x:s.x+u[0]/v*p,y:s.y+u[1]/v*p},x=h.s("attach.gap");x&&(h.s("attach.gap.relative")&&(x*=k.getThickness()),w=Tm(i,w,t,x)),h.p(w),h.setRotation(Q(u[1],u[0]))}}}else a&&(l===Lb?h.translate(n.x-m.x,n.y-m.y):l===Mb?h.setElevation(h._54O+n-m):oj[l]?h._11Q(k,l,n-m):("anchor"===l||"width"===l||"height"===l||"scale"===l)&&h.layout(k))},_11Q:function(){var a=new j.Math.Euler,b=j.Math.Euler.ReverseOrder,c=new j.Math.Vector2,d=new j.Math.Vector2;return function(e,f,g){var h=this,i=e.p3(),j=e.r3(),k=h.p3(),l=h.r3();if(f===ib&&(f="rotationY",g=-g),(f===ib||"rotationY"===f)&&0===l[0]&&0===l[2]&&0===j[0]&&0===j[2]&&0===k[1]&&0===i[1])return h.setRotation(-l[1]-g),c.set(k[0],k[2]).rotateAround(d.set(i[0],i[2]),-g),void h.p(c.x,c.y);var m=Vk[e.getRotationMode()],n=m[0],o=m[1],p=m[2],q=Tk[n],r=Tk[o],s=Tk[p],t=ti();f===ib+n?(s(t,j[Uk[p]]),r(t,j[Uk[o]]),q(t,g),r(t,-j[Uk[o]]),s(t,-j[Uk[p]])):f===ib+o?(s(t,j[Uk[p]]),r(t,g),s(t,-j[Uk[p]])):f===ib+p&&s(t,g);var u=qi(k,i);yi(u,t),h.p3(i[0]+u[0],i[1]+u[1],i[2]+u[2]);var v=h.getRotationMode();Xk(t,h.r3(),v),a.setFromRotationMatrix(t,b(v)),h.r3([a.x,a.y,a.z])}}(),isHostOn:function(a){var b=this;if(b._host&&a&&a._69O)for(var c={},d=b._host;d&&d!==b&&!c[d._id];){if(d===a)return!0;c[d._id]=d,d=d._host}return!1},isLoopedHostOn:function(a){return this.isHostOn(a)&&a.isHostOn(this)},getScaledSize:function(){var a=this.getSize(),b=this.getScale();return a.width*=Math.abs(b.x),a.height*=Math.abs(b.y),a},layout:function(a){if(a=a||this.getHost()){var b=this,d=b.s("layout.h")||"center",e=b.s("layout.v")||"center";if("center"!==d||"center"!==e){var f,g,h,i,k,l=new j.Math.Vector2,m=a.getPosition(),n=a.getAnchor(),o=a.getScaledSize(),p=(b.getPosition(),1),q=1;switch(b._layoutUpdating=!0,d){case"left":l.setX(b._layoutHValue-n.x*o.width);break;case"right":l.setX((1-n.x)*o.width-b._layoutHValue);break;case"leftright":f=o.width-b._layoutHValue[2],h=b.getRotation()-a.getRotation(),i=Math.abs(Math.sin(h)),k=Math.abs(Math.cos(h)),p+=k*f/b._layoutHValue[3],q+=i*f/b._layoutHValue[4],l.setX(b._layoutHValue[1]+(b._layoutHValue[5]-n.x)*o.width);break;case"center":l.setX((.5-n.x)*o.width-b._layoutHValue);break;case"scale":h=b.getRotation()-a.getRotation(),i=Math.abs(Math.sin(h)),k=Math.abs(Math.cos(h)),l.setX((.5-n.x)*o.width-b._layoutHValue[1]*o.width/b._layoutHValue[0]),g=o.width/b._layoutHValue[2]-1,p+=k*g,q+=i*g}switch(e){case"top":l.setY(b._layoutVValue-n.y*o.height);break;case"bottom":l.setY((1-n.y)*o.height-b._layoutVValue);break;case"topbottom":h||(h=b.getRotation()-a.getRotation(),i=Math.abs(Math.sin(h)),k=Math.abs(Math.cos(h))),f=o.height-b._layoutVValue[2],p+=i*f/b._layoutVValue[3],q+=k*f/b._layoutVValue[4],l.setY(b._layoutVValue[1]+(b._layoutVValue[5]-n.y)*o.height);break;case"center":l.setY((.5-n.y)*o.height-b._layoutVValue);break;case"scale":h||(h=b.getRotation()-a.getRotation(),i=Math.abs(Math.sin(h)),k=Math.abs(Math.cos(h))),l.setY((.5-n.y)*o.height-b._layoutVValue[1]*o.height/b._layoutVValue[0]),g=o.height/b._layoutVValue[2]-1,p+=i*g,q+=k*g}if("leftright"===d||"scale"===d||"topbottom"===e||"scale"===e){var r=this.getScale(),s=Math.abs(r.x),t=Math.abs(r.y);"leftright"===d||"scale"===d?b.setSize(b._layoutHValue[3]*p/s,b._layoutHValue[4]*q/t):b.setSize(b._layoutVValue[3]*p/s,b._layoutVValue[4]*q/t)}l.rotateAround(null,a.getRotation()),this.setPosition(l.x+m.x,l.y+m.y),b._layoutUpdating=c}}},updateLayoutParameters:function(a,b){if(a=a||this.getHost()){var c=this,d=c.s("layout.h"),e=c.s("layout.v");if(d||e){var f,g,h,i,k,l,m=new j.Math.Vector2,n=a.getPosition(),o=a.getAnchor(),p=a.getScaledSize(),q=c.getPosition(),r=c.getScaledSize();switch(m.set(q.x-n.x,q.y-n.y),m.rotateAround(null,-a.getRotation()),d){case"left":c._layoutHValue=m.x+o.x*p.width;break;case"right":c._layoutHValue=-m.x+(1-o.x)*p.width;break;case"center":c._layoutHValue=-m.x+(.5-o.x)*p.width;break;case"leftright":case"scale":"scale"===d?f=-m.x+(.5-o.x)*p.width:(g=c.getAnchor(),h=c.getRotation()-a.getRotation(),i=Math.cos(h),k=Math.sin(h),l=-Math.min(-g.x*i+g.y*k,-g.x*i-(1-g.y)*k,(1-g.x)*i+g.y*k,(1-g.x)*i-(1-g.y)*k),f=m.x-(l-o.x)*p.width),"position"===b&&"object"==typeof c._layoutHValue?(c._layoutHValue[0]=p.width,c._layoutHValue[1]=f):c._layoutHValue=[p.width,f,p.width,r.width,r.height,l]}switch(e){case"top":c._layoutVValue=m.y+o.y*p.height;break;case"bottom":c._layoutVValue=-m.y+(1-o.y)*p.height;break;case"center":c._layoutVValue=-m.y+(.5-o.y)*p.height;break;case"topbottom":case"scale":"scale"===e?f=-m.y+(.5-o.y)*p.height:(h||(g=c.getAnchor(),h=c.getRotation()-a.getRotation(),i=Math.cos(h),k=Math.sin(h)),l=-Math.min(-g.x*k-g.y*i,-g.x*k+(1-g.y)*i,(1-g.x)*k-g.y*i,(1-g.x)*k+(1-g.y)*i),f=m.y-(l-o.y)*p.height),"position"===b&&"object"==typeof c._layoutVValue?(c._layoutVValue[0]=p.height,c._layoutVValue[1]=f):c._layoutVValue=[p.height,f,p.height,r.width,r.height,l]}}}},getSerializableProperties:function(){var a=Sk.superClass.getSerializableProperties.call(this);return Td(a,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),a}});var Yk=j.Edge=function(a,b){var c=this;Wd(Yk,c),c.setSource(a),c.setTarget(b)};li("Edge",ej,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return ll},_22Q:function(){return gq},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(a,b){if(a===this)return!1;if(Kd(a))return!0;for(var c,d,e,f,g,h=[this],i=-1,j=0;j>i;)if(i++,c=h[i],d=c._44I)for(d=d.getArray(),f=0,g=d.length;g>f;f++)if(e=d[f],Ld(e)&&!(h.indexOf(e)>=0)){if(e===a)return!1;h.push(e),j++}return!0},setSource:function(a){var b=this;if(b._source!==a&&b.canSetSourceTarget(a)){var c=b._source;b._source=a,c&&c._16I(b),a&&a._2I(b),b._7I(),b.fp("source",c,a)}},setTarget:function(a){var b=this;if(b._target!==a&&b.canSetSourceTarget(a)){var c=b._target;b._target=a,c&&c._18I(b),a&&a._4I(b),b._7I(),b.fp("target",c,a)}},isLooped:function(){var a=this;return a._source===a._target&&Kd(a._source)&&Kd(a._target)},onPropertyChanged:function(){var a=this;a._49I&&a._49I.each(function(a){a.fp("agentChange",!0,!1)})},_7I:function(){var a,b=this,c=xj(b);b._40I!==c&&(a=this._40I,a&&a._15I(b),b._40I=c,c&&c._1I(b),b.fp("sourceAgent",a,c),Cj(a,b._41I),Cj(c,b._41I));var d=yj(b);b._41I!==d&&(a=b._41I,a&&a._17I(b),b._41I=d,d&&d._3I(b),b.fp("targetAgent",a,d),Cj(a,b._40I),Cj(d,b._40I))},_22I:function(a){this._52I=a,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var a=this;return a._52I&&a._52I.get(0)!==a&&!a.getStyle(fb)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var a=this,b=a._52I;return b&&!a.getStyle(fb)&&b.size()>1&&a===b.get(0)},toggle:function(){var a=this._52I,b=!this.s(fb);a&&a.size()>1&&(a.each(function(a){a.s(fb,b)}),a.getSiblings().each(function(b){b!==a&&b.each(function(a){a.fp("edgeGroup",i,b)})}))},setStyle:function(a,b){(a===gb||"edge.segments"===a)&&(b=Jd(b)),Yk.superClass.setStyle.call(this,a,b)},onStyleChanged:function(a,b,c){Yk.superClass.onStyleChanged.apply(this,arguments),nj[a]&&Cj(this._41I,this._40I)},getSerializableProperties:function(){var a=Yk.superClass.getSerializableProperties.call(this);return Td(a,{source:1,target:1}),a}});var Zk=j.Group=function(){Wd(Zk,this)};li("Group",Sk,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return nl},onChildAdded:function(a,b){Zk.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(a,b){Zk.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var a=this;if(!a._54I&&!Lc){var b=a.getChildrenRect();b&&(a._53I=1,a.p(bg(a.s("group.position"),b,a.getSize())),delete a._53I)}},getChildrenRect:function(){var a,b=this;return b.eachChild(function(c){Kd(c)&&(a=Xh(a,b.getChildRect(c)))}),a},getChildRect:function(a){var b;return Kd(a)&&a.s(Na)&&(Md(a)&&a.isExpanded()&&a.eachChild(function(c){b=Xh(b,a.getChildRect(c))}),!b&&a.getRect&&(b=a.getRect())),b},setPosition:function(a,b){var c=this;if(!c._54I){var d;d=2===arguments.length?{x:a,y:b}:a,Lc||c._53I||(c._54I=1,Yf(c._children,d.x-c._position.x,d.y-c._position.y),delete c._54I),Zk.superClass.setPosition.call(this,d)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(a){var b=this;if(b._57O!==a){var c=b._57O;b._57O=a,b.fp("expanded",c,b._57O),b._fireInvalidateDeep(),b._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(a){Md(a)?a._fireInvalidateDeep():a.iv()})},_8I:function(){Zk.superClass._8I.call(this),this.eachChild(function(a){Kd(a)&&a._8I()})},onStyleChanged:function(a,b,c){Zk.superClass.onStyleChanged.apply(this,arguments),"group.position"===a&&this._81I()},getSerializableProperties:function(){var a=Zk.superClass.getSerializableProperties.call(this);return a.expanded=1,a}});var $k=j.Block=function(){Wd($k,this)};li("Block",Sk,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return ol},onChildAdded:function(a,b){$k.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(a,b){$k.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var a=this;if(!Lc&&!a._updatingToChildren&&a._syncSize&&!a._freezeSyncFromChildren){var b,c,d,e,f,g=[],h=a.getRotation();if(a.eachChild(function(a){Kd(a)&&g.push.apply(g,a.getCorners())}),g.length){a._updatingFromChildren=1;var i=H(-h),j=J(-h),k=1/0,l=-(1/0),m=1/0,n=-(1/0);for(e=0,f=g.length;f>e;e++)d=g[e],b=d.x,c=d.y,d.x=i*b-j*c,d.y=j*b+i*c,k=F(k,d.x),l=E(l,d.x),m=F(m,d.y),n=E(n,d.y);var o=a.getScale();a.setSize(G((l-k)/o.x),G((n-m)/o.y));var p;o.x<0&&(p=k,k=l,l=p),o.y<0&&(p=m,m=n,n=p),i=H(h),j=J(h);var q=a.getAnchor();b=k+(l-k)*q.x,c=m+(n-m)*q.y,a.setPosition(i*b-j*c,j*b+i*c),delete a._updatingFromChildren}}},setPosition:function(a,b){var c=this;if(!c._updatingToChildren){var d;d=2===arguments.length?{x:a,y:b}:a,Lc||c._updatingFromChildren||(c._updatingToChildren=1,Yf(c._children,d.x-c._position.x,d.y-c._position.y),delete c._updatingToChildren),$k.superClass.setPosition.call(this,d)}},setWidth:function(a){return this.setSize(a,this.getHeight())},setHeight:function(a){return this.setSize(this.getWidth(),a)},setSize:function(a,b){1>a&&(a=1),1>b&&(b=1);var c=this;if(!c._updatingToChildren){2!==arguments.length&&(b=a.height,a=a.width);var d=c.getWidth(),e=c.getHeight();if(a!==d&&$k.superClass.setWidth.call(c,a),b!==e&&$k.superClass.setHeight.call(c,b),!Lc&&!c._updatingFromChildren){c._updatingToChildren=1;var f=a/d,g=b/e;c._adjustChildScaleOrSize(f,g,"size"),delete c._updatingToChildren,c.updateFromChildren()}}},_adjustChildScaleOrSize:function(a,b,c){var d=this;if(d._syncSize){var e=d.getPosition(),f=d.getRotation();d.getScale(),d.eachChild(function(d){if(Kd(d)){var g=d.getPosition(),h=d.getRotation(),i=d.getWidth(),k=d.getHeight(),l=d.getScale(),m=l.x*i,n=l.y*k,o=new Hg(h,g.x,g.y,m,n);o.translate(-e.x,-e.y),o.rotate(-f),h=Q(o.b*Math.sign(m),o.a*Math.sign(m)),o.scale(a,b);var p,q,r,s=H(h);if(Math.abs(s)<.001?(p=J(h),q=o.b/p,r=-o.c/p):(q=o.a/s,r=o.d/s),"scale"===c)d.setScale(q/i,r/k);else if("size"===c){var t=q/l.x,u=r/l.y;d.setScale(_d(q)*Math.abs(l.x),_d(r)*Math.abs(l.y)),d instanceof j.Shape?(d.setWidthForce(Math.max(Math.abs(t),1e-5)),d.setHeightForce(Math.max(Math.abs(u),1e-5))):d.setSize(Math.max(.01,Math.abs(t)),Math.max(.01,Math.abs(u)))}o.rotate(f),o.translate(e.x,e.y),d.setPosition(o.tx,o.ty)}})}},_calcChangeFactor:function(a,b,c,d){var e,f,g,h;return e=G(a),f=G(c),g=e>f?e/f:f/e,e=G(b),f=G(d),h=e>f?e/f:f/e,E(g,h)},setAnchor:function(a,b,c){var d=this;if(!d._updatingToChildren){var e=d.getAnchor();if($k.superClass.setAnchor.apply(d,arguments),!Lc&&!d._updatingFromChildren&&d._syncSize){d._updatingToChildren=1;var f=d.getAnchor(),g=(d.getPosition(),d.getSize()),h=d.getScale(),i=d.getRotation(),j=-g.width*h.x*(e.x-f.x),k=-g.height*h.y*(e.y-f.y),l=J(i),m=H(i),n=m*j-l*k,o=l*j+m*k;d.eachChild(function(a){
if(Kd(a)){var b=a.getPosition();a.setPosition(b.x-n,b.y-o)}}),delete d._updatingToChildren}}},setRotation:function(a){var b=this;if(!b._updatingToChildren){var c=b.getRotation();if($k.superClass.setRotation.apply(b,arguments),!Lc&&!b._updatingFromChildren){b._updatingToChildren=1;var d=b.getPosition(),e=a-c;b.eachChild(function(a){if(Kd(a)){var b=a.getMatrix();b.translate(-d.x,-d.y),b.rotate(e),b.translate(d.x,d.y);var c=Math.sign(a.getScale().x);a.setRotation(Q(b.b*c,b.a*c)),a.setPosition(b.tx,b.ty)}}),delete b._updatingToChildren}}},setScale:function(a,b){var c=this;if(!c._updatingToChildren){null==b&&(b=a.y,a=a.x);var d=c.getScale();if(G(a)<.01&&(a=.01*(_d(a)||_d(d.x))),G(b)<.01&&(b=.01*(_d(b)||_d(d.y))),$k.superClass.setScale.call(c,a,b),!Lc&&!c._updatingFromChildren){c._updatingToChildren=1;var e=a/d.x,f=b/d.y;c._adjustChildScaleOrSize(e,f,"size"),delete c._updatingToChildren,c.updateFromChildren()}}},getSerializableProperties:function(){var a=$k.superClass.getSerializableProperties.call(this);return a.clickThroughEnabled=1,a.syncSize=1,a}});var _k=j.Grid=function(){Wd(j.Grid,this)};li("Grid",Sk,{IRotatable:!1,_icon:"grid_icon",_image:i,getUIClass:function(){return rl},setRotation:function(){},getCellRect:function(a,b){var c=this,d=c.s("grid.row.count"),e=c.s("grid.column.count");if(0>=d||0>=e||0>a||a>=d||0>b||b>=e)return i;var f,g,h,j=c.getRect(),k=c.s("grid.row.percents"),l=c.s("grid.column.percents");if(tj(j,c,"grid.border",-1),k&&k._as&&(k=k._as),l&&l._as&&(l=l._as),k&&k.length===d){for(h=0,f=0;a>f;f++)h+=j.height*k[f];j.y+=h,j.height=j.height*k[a]}else j.height=j.height/d,j.y+=j.height*a;if(l&&l.length===e){for(g=0,f=0;b>f;f++)g+=j.width*l[f];j.x+=g,j.width=j.width*l[b]}else j.width=j.width/e,j.x+=j.width*b;return bi(j,-c.s("grid.gap")),j}});var al=j.Text=function(){Wd(al,this),this.setSize(100,50),this.s("text","TEXT")};li("Text",Sk,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return sl},setWidth:function(a){a||(a=.001),al.superClass.setWidth.call(this,a)},setHeight:function(a){a||(a=.001),al.superClass.setHeight.call(this,a)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),xh("__text__",{width:{value:100,isSafeFunc:!0,func:function(a){return a._width}},height:{value:50,isSafeFunc:!0,func:function(a){return a._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var bl=j.Shape=function(){Wd(bl,this),this._59O=new bj};bl.__de__=Pj,li("Shape",Sk,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return pl},_22Q:function(){return hq},getLength:function(a){return je(Af(this._59O,this._58O,a,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var a=this._58O;return a?new bj(a._as.slice(0)):a},setSegments:function(a){var b=this._58O;a=a?new bj(Hd(a)?a.slice(0):a._as.slice(0)):null,(b&&a&&b._as.join(",")!==a._as.join(",")||b!==a)&&(this._58O=a,this.fp("segments",b,a))},getPoints:function(){return this._59O},toPoints:function(){var a=this._59O;return new bj(a._as.slice(0))},setPoints:function(a,b){var c=this,d=c._59O;a=a?new bj(Hd(a)?a.slice(0):a._as.slice(0)):new bj;var e,f,g,h,i,j;b&&(e=c.getPosition(),j=new Hg(c.getRotation(),0,0,c.getScale().x,c.getScale().y)),(d&&a&&d._as.join(",")!==a._as.join(",")||d!==a)&&(c._59O=a,c.fs(),c.fp("points",d,a)),b&&(f=c.getPosition(),g=f.x-e.x,h=f.y-e.y,i=j.tf(g,h),c.setPosition(f.x-g+i.x,f.y-h+i.y))},addPoint:function(a,b,c){var d=this.toPoints();d.add(a,b),this.setPoints(d,c)},setPoint:function(a,b,c){var d=this.toPoints();d.set(a,b),this.setPoints(d,c)},removePointAt:function(a){var b=this.toPoints();b.removeAt(a),this.setPoints(b)},setWidthForce:function(a){var b=this;if(!b._55I&&!Lc&&b.getWidth()){b._55I=1;var c=b._position.x,d=a/b.getWidth(),e=b.toPoints(),f=new bj;1!==d&&(e.each(function(a){f.add({x:(a.x-c)*d+c,y:a.y,e:a.e})}),b.setPoints(f),yf(b,[d,0,0,1,c*(1-d),0]),b.fs()),delete b._55I}bl.superClass.setWidth.call(b,a)},setWidth:function(a){return this.setWidthForce(1>a?1:a)},setHeightForce:function(a){var b=this;if(!b._55I&&!Lc&&b.getHeight()){b._55I=1;var c=b._position.y,d=a/b.getHeight(),e=b.toPoints(),f=new bj;1!==d&&(e.each(function(a){f.add({x:a.x,y:(a.y-c)*d+c,e:a.e})}),b.setPoints(f),yf(b,[1,0,0,d,0,c*(1-d)]),b.fs()),delete b._55I}bl.superClass.setHeight.call(b,a)},setHeight:function(a){return this.setHeightForce(1>a?1:a)},setAnchorElevation:function(a){var b=this;b._55I=!0;var c=b._updatingAnchor3d,d=!Lc&&!c;if(d){var e,f=a,g=b.getAnchorElevation(),h=b.getTall();e=h*(g-f),0!==e&&b.shiftPointsElevation(e)}var i=bl.superClass.setAnchorElevation.apply(b,arguments);return c||delete b._55I,i},getShapeElevation:function(a){var b=this,c=b._54O;return c-(b.getTall()||0)*(b._anchorElevation-.5)},setAnchor3d:function(a,b,c,d){var e,f=this;"number"==typeof a?e={x:a,y:b,z:c}:(e=a.length?{x:a[0],y:a[1],z:a[2]}:a,d=b),f._55I=!0,f._updatingAnchor3d=!0;var g=f.getDataModel();if(g&&g.beginTransaction(),!Lc){var h=f.getAnchor3d(),i=f.getSize(),j=f.getTall(),k=i.width*(h.x-e.x),l=i.height*(h.z-e.z),m=j*(h.y-e.y);d||f.shiftPoints(k,l,m);var n=f.p3()}var o=bl.superClass.setAnchor3d.apply(f,arguments);if(!Lc&&d){var p=f.p3();f.shiftPoints(p[0]-n[0]+k,p[2]-n[2]+l,p[1]-n[1]+m)}return g&&g.endTransaction(),delete f._updatingAnchor3d,delete f._55I,o},setAnchor:function(a,b,c){var d=this;d._55I=!0;var e=d._updatingAnchor3d,f=!Lc&&!e;if(f){var g,h,i;"number"==typeof a?i={x:a,y:b}:(i=a.length?{x:a[0],y:a[1]}:a,c=b);var j=d.getAnchor(),k=d.getSize();g=k.width*(j.x-i.x),h=k.height*(j.y-i.y),c||d.shiftPoints(g,h);var l=d.getPosition()}var m=bl.superClass.setAnchor.apply(d,arguments);if(f){var n=d.getPosition();c&&d.shiftPoints(n.x-l.x+g,n.y-l.y+h)}return e||delete d._55I,m},shiftPoints:function(a,b,c){if(a||b||c){var d=this,e=d.getElevation()||0,f=d.toPoints(),g=new bj;f.each(function(d){var f=d.e;c&&(f=(f==i?e:f)+c),g.add({x:d.x+a,y:d.y+b,e:f})}),d.setPoints(g),d.fs()}},shiftPointsElevation:function(a){return this.shiftPoints(0,0,a)},setPosition:function(a,b){var c,d=this;if(!d._28Q){if(d._28Q=1,!d._55I&&!Lc){c=2===arguments.length?{x:a,y:b}:a;var e=c.x-d._position.x,f=c.y-d._position.y;if(0===e&&0===f)return void delete d._28Q;d._55I=1,d.shiftPoints(e,f),yf(d,[1,0,0,1,e,f]),delete d._55I}bl.superClass.setPosition.apply(d,arguments),delete d._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var a=this;if(2!==a._59O.size())return!1;var b=a._58O;return b?2===b.size()&&1===b.get(0)&&2===b.get(1)?!0:!1:!0},fireShapeChange:function(){var a=this;if(!a._55I&&!Lc){var b=Wh(a._59O);b&&(a._55I=1,a.setRect(b),delete a._55I)}a.fp(Ga,!1,!0)},getSerializableProperties:function(){var a=bl.superClass.getSerializableProperties.call(this);return a.segments=1,a.points=1,a.thickness=1,a.closePath=1,a}});var cl=j.Polyline=function(){Wd(cl,this),this.s({"shape.background":null,"shape.border.width":2})};li("Polyline",bl,{_icon:"polyline_icon",_22Q:function(){return iq},getUIClass:function(){return ql},setClosePath:function(a){},setTall:function(a){var b=this,c=b.getDataModel();if(c&&c.beginTransaction(),!b._55I&&!b._24Q&&!Lc&&b.getTall()){b._24Q=1;var d=b._54O,e=a/b.getTall();if(1!==e){var f=b.toPoints(),g=new bj;f.each(function(a){g.add({x:a.x,y:a.y,e:a.e==i?a.e:(a.e-d)*e+d})}),b.setPoints(g),b.fs()}delete b._24Q}cl.superClass.setTall.call(b,a),c&&c.endTransaction()},setElevation:function(a){var b=this,c=b.getDataModel();if(c&&c.beginTransaction(),!b._55I&&!b._24Q&&!Lc){b._24Q=1;var d=a-b._54O;0!==d&&b.shiftPointsElevation(d),delete b._24Q}cl.superClass.setElevation.apply(b,arguments),c&&c.endTransaction()},fireShapeChange:function(){var a=this,b=a._59O;if(!a._55I&&!a._24Q&&!Lc){var c=b.size();if(c){var d=1,e=b.get(0),f=a._54O;e.e==i&&(e.e=f);for(var g=e.e,h=0;c>d;d++){e=b.get(d),e.e==i&&(e.e=f);var j=F(g,e.e),k=E(g+h,e.e);g=j,h=k-j}a._24Q=1,a.setTall(h),a.setElevation(g+h*a._anchorElevation),delete a._24Q}}cl.superClass.fireShapeChange.apply(a,arguments)}});var dl=j.SubGraph=function(){Wd(dl,this)};li("SubGraph",Sk,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){dl.superClass._8I.call(this),this.eachChild(function(a){Kd(a)&&a._8I()})}}),l.loadingRefGraph=0;var el=j.RefGraph=function(){Wd(el,this)};li("RefGraph",$k,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(a){var b=this._ref;this._ref=a,this.fp("ref",b,a),this.updateRef()},_21I:function(a){el.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var a=this;if(l.loadingRefGraph++,a.clearChildrenFromDataModel(),l.loadingRefGraph--,a._ref&&a._dataModel){a._xhrLoadHandler&&(a._xhrLoadHandler.cancel=!0);var b=Lc,c=a._xhrLoadHandler=function(c){if(c&&a._dataModel){l.loadingRefGraph++;var d=a._pendingUpdateInfo={needToRestore:b};b&&(d.position=a.p(),d.width=a.getWidth(),d.height=a.getHeight(),d.rotation=a.getRotation(),d.anchor=a.getAnchor(),d.scale=a.getScale()),a.p(0,0),a.setAnchor(.5,.5),a.setRotation(0),a.setScale(1,1);var e=l.parse(c),f=a._dataModel.deserialize(e,a,{justDatas:!0});f.each(function(b){b._refGraph=a}),a.checkPendingUpdateInfo(),l.loadingRefGraph--,l.handleRefGraphLoaded(a,f,e)}};c.xhrLoadCalled=!1,l.load(a._ref,function(a){c.cancel||(c.xhrLoadCalled?c(a):Dh(function(){c(a)}))}),c.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var a=this,b=a._pendingUpdateInfo;if(!b)return void(a.onPendingUpdated&&(l.loadingRefGraph++,a.onPendingUpdated(),l.loadingRefGraph--));var c=!0;this.eachChild(function(a){(a._pendingCheckImageJSON||a._pendingUpdateInfo)&&(c=!1)}),c&&(l.loadingRefGraph++,a._pendingUpdateInfo=null,a.updateFromChildren(),b.needToRestore&&(a.setSize(b.width,b.height),a.setAnchor(b.anchor),a.setRotation(b.rotation),a.setScale(b.scale),a.p(b.position)),this.getParent()instanceof el&&this.getParent().checkPendingUpdateInfo(),a.onPendingUpdated&&a.onPendingUpdated(),l.loadingRefGraph--)},getSerializableProperties:function(){var a=el.superClass.getSerializableProperties.call(this);return a.ref=1,a}}),j.EdgeGroup=function(a,b){this._70O=a,this._siblings=b;for(var c,d,e=0,f=a.size(),g=m[fb];f>e;e++)if(c=a.get(e).getStyle(fb,!1),c!=i){g=c;break}g==i&&(g=!0);var h=l.edgeGroupAgentFunc;for(h&&(d=h(a),d&&d!==a.get(0)&&(a.remove(d),a.add(d,0))),e=0;f>e;e++)a.get(e).s(fb,g)},li("EdgeGroup",b,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(a){return this._70O.get(a)},indexOf:function(a){return this._70O.indexOf(a)},each:function(a,b){this._70O.each(a,b)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(a,b){this._siblings.each(function(c){c._70O.each(a,b)})}});var fl=function(a,b,c){var d=Yc[a]={type:a,action:b};if(c)for(var e in c)d[e]=c[e]};Td(l,{setConnectAction:fl,getConnectAction:function(a,b){if(!b){if(!a)return null;b=a.getCurrentConnectActionType()}return Yc[b]},doConnectAction:function(a,b,c,d){d=d||a.getCurrentConnectActionType();var e=Yc[d];if(!e)return!1;var f=e.action;return f?(b instanceof Hl.Group?a.sm().getSelection().each(function(b){f.call(null,a,b,c)}):f.call(null,a,b,c),!0):!1},doDeleteConnectionAction:function(a,b,c){c=c||a.getCurrentConnectActionType();var d=Yc[c];if(!d||!d["delete"])return!1;var e=d["delete"].action;return e?(b instanceof Hl.Group?a.sm().getSelection().each(function(b){e.call(null,a,b)}):e.call(null,a,b),!0):!1}});var gl=j.JSONSerializer=function(a,b){this.dm=this._dataModel=a,l.forceHierarchicalSerialization?this._hierarchical=!0:b==i?this._hierarchical=a.isHierarchicalRendering():this._hierarchical=b};li("JSONSerializer",b,{ms_ac:["hierarchical"],serialize:function(a){return l.stringify(this.toJSON(),a)},toJSON:function(){var a=this,b=a.dm,d=b.getRoots(),e=a.json={v:l.getVersion(),p:{},a:{},d:[]},f=b.getSerializableAttrs();b.getInit()&&(e.init=b.getInit()),b.getName()&&(e.p.name=b.getName()),b.getBackground()&&(e.p.background=b.getBackground()),b.getLayers()&&(e.p.layers=b.getLayers()),b.getEnvmap()&&(e.p.envmap=b.getEnvmap()),e.p.autoAdjustIndex=b.isAutoAdjustIndex(),e.p.hierarchicalRendering=b.isHierarchicalRendering();for(var g in f){var h=b.a(g);h!==c&&a[_b](g,h,e.a)}return Xd(e.a)&&delete e.a,a._hierarchical?d.each(a.serializeData,this):b.each(function(b){a.serializeData(b)}),b.fireSerializeEvent({type:"serialize",json:e}),b.getPostProcessingData()&&(e.p.postProcessingData=b.getPostProcessingData()),e},isSerializable:function(a){return!0},getProperties:function(a){return a.getSerializableProperties()},getStyles:function(a){return a.getSerializableStyles()},getAttrs:function(a){return a.getSerializableAttrs()},serializeData:function(a){var b=this;if(b.isSerializable(a)&&!a._refGraph){var d,e,f,g,h=Hh(a.getClassName())||a.getClass(),i=new h,k={c:a.getClassName(),i:a.getId(),p:{},s:{},a:{}};b.json.d.push(k),d=b.getProperties(a);for(e in d)if(/^_/.test(e)){if(f=a[e],("_width"===e||"_height"===e)&&f===c){var l;((a.s("layout.h")||a.s("layout.v"))&&a.getHost()||a instanceof j.Node&&(l=a.getParent())&&l instanceof j.Block||a.s("fullscreen"))&&(f=a[e]="_width"===e?a.getWidth():a.getHeight())}f!==i[e]&&b[_b](e.substr(1),f,k.p)}else g=Ad(e),a[g]&&(f=a[g](),f!==i[g]()&&b[_b](e,f,k.p));d=b.getStyles(a);for(e in d)f=a.s(e),f!==i.s(e)&&b[_b](e,f,k.s);d=b.getAttrs(a);for(e in d)f=a.a(e),f!==i.a(e)&&b[_b](e,f,k.a);Xd(k.p)&&delete k.p,Xd(k.s)&&delete k.s,Xd(k.a)&&delete k.a}b._hierarchical&&a.getChildren().each(b.serializeData,b)},serializeValue:function(a,b,c){Id(b)?b={__a:b._as}:b instanceof ej&&(b={__i:b.getId()}),c[a]=b},deserialize:function(a,b,c){var d=this;return Cd(a)&&/.json$/.test(a)?void l.xhrLoad(a,function(a){d.deserializeImpl(a,b,c)}):d.deserializeImpl(a,b,c)},deserializeImpl:function(a,b,c){var d=this,e=d.dm;c=Ed(c)?{setId:c}:Gd(c)?{finishFunc:c}:c||{},a=d.json=Cd(a)?l.parse(a):a,a.a&&a.a.onPreDeserialize&&!c.disableOnPreDeserialize&&a.a.onPreDeserialize(a,e,c.view),e.beginTransaction(),Lc++,d._82I={};var f=new bj,g=new bj,h=0,j=a.d.length;if(c.justDatas||(Gd(a.init)&&a.init(e),e.setInit(a.init)),!c.justDatas){for(var k in a.a)e.a(k,d[ac](a.a[k]));for(var m in a.p)e[Bd(m)](a.p[m])}for(;j>h;h++){var n=a.d[h],o=Hh(n.c),p=new o,q=n.i;c.setId&&q!=i&&(p._id=q),d._82I[q]=p,f.add(p),g.add(n)}for(h=0;j>h;h++)d.deserializeData(f.get(h),g.get(h));return f.each(function(a){b&&!a.getParent()&&a.setParent(b),e.add(a)}),e.fireSerializeEvent({type:"deserialize",json:a}),Lc--,e.endTransaction(),a.a&&a.a.onPostDeserialize&&!c.disableOnPostDeserialize&&a.a.onPostDeserialize(a,e,c.view,f),c.finishFunc&&c.finishFunc(a,e,c.view,f),f},deserializeData:function(a,b){for(var c in b.p)a[Bd(c)](this[ac](b.p[c]));for(c in b.s)a.s(c,this[ac](b.s[c]));for(c in b.a)a.a(c,this[ac](b.a[c]))},deserializeValue:function(a){if(Fd(a)){var b=a.__i;if(b!=i)return this._82I[b];if(b=a.__a,Hd(b))return new bj(b)}return a}}),Td(fj,{serialize:function(a,b){return new gl(this,b).serialize(a)},toJSON:function(a){return new gl(this,a).toJSON()},deserialize:function(a,b,c){return new gl(this).deserialize(a,b,c)}});var hl=j.OverlappingBox=function(a){this.gv=a,this.boxes={}};li("OverlappingBox",b,{clear:function(){var a,b,c=this.boxes;for(a in c)b=c[a],b.length=0},isOverlapping:function(a,b){var c,d,e=this,f=e.boxes,g=f[a];g?(c=g.rects,d=g.length):g=f[a]={rects:c=[],length:d=0};var h,i,b;for(h=0;d>h;h++)if(i=c[h],i.x<b.x+b.w&&i.x+i.w>b.x&&i.y<b.y+b.h&&i.h+i.y>b.y)return!0;return c.length<=d?(c.push(b),g.length++):c[g.length++]=b,!1}}),Td(l,{fetch:function(a,b){var c="GET",d=!1,e=null,f="";b&&(c=b.method||"GET",d=b.sync,f=b.url,e=b.data||null),a.open(c,f,!d),b.responseType?a.responseType=b.responseType:b.overrideMimeType&&a.overrideMimeType&&a.overrideMimeType(b.overrideMimeType),a.send(e)},convertImageSrc:function(a,b){b&&"function"==typeof b||(b=function(){}),b(a)}});var il=j.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};li("Request",b,{_responseType:null,_overrideMimeType:"text/plain",send:function(a){var b=this._xhr,c=this.onload,d=this.onerror;this.getResponseType()?a.responseType=this.getResponseType():this.getOverrideMimeType()&&(a.overrideMimeType=this.getOverrideMimeType()),b.onload=c,b.onerror=d,l.fetch(b,a)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(a){this._responseType=a},getOverrideMimeType:function(a){return this._overrideMimeType},setOverrideMimeType:function(a){this._overrideMimeType=a},getResponseText:function(){var a=this._xhr;return a.response||a.responseText}}),Lj.GraphView=function(a){var b=this;b._24I={},b._34I=new bj,b._25I={},b._56I={},b._view=pe(1,b),b._canvas=re(b._view),b.dm(a?a:new fj),this._coreInteractor=new Al(this),b.setEditable(!1),b.setScrollBarVisible(l.graphViewScrollBarVisible)},Mj("GraphView",b,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[tb,ub,rb,sb,"resettable","editInteractor",pb,"zoomable","pannable","rectSelectable","autoScrollZone",Bb,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:l.graphViewZoomable,_resettable:l.graphViewResettable,_pannable:l.graphViewPannable,_rectSelectable:l.graphViewRectSelectable,_autoScrollZone:l.graphViewAutoScrollZone,_rectSelectBackground:l.graphViewRectSelectBackground,_rectSelectBorderColor:l.graphViewRectSelectBorderColor,_editPointSize:l.graphViewEditPointSize,_editPointBorderColor:l.graphViewEditPointBorderColor,_editPointBackground:l.graphViewEditPointBackground,_scrollBarColor:lh,_scrollBarSize:mh,_autoHideScrollBar:Zg,_autoMakeVisible:Yg,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(a){this._dataModel.setLayers(a)},setEditable:function(a){var b=this,c=b.__interactorMap__;if(!c){var d=Lj.XEditInteractor;c=b.__interactorMap__={scrollBar:new Fl(b),select:new Cl(b),edit:d?new d(b):new Jl(b),text:new El(b),move:new Dl(b),"default":new Bl(b),touch:new Gl(b,{editable:!1})}}a?(b._uieditable=!0,b.setInteractors([c.scrollBar,c.select,c.edit,c.text,c.move,c["default"],c.touch])):(b._uieditable=!1,b.setInteractors([c.scrollBar,c.select,c.move,c["default"],c.touch]))},getCanvas:function(){return this._canvas},_33I:function(a){var b=a.getUIClass();return b?new b(this,a):i},getDataUI:function(a){var b=this,d=b._25I[a._id];return d===c&&(d=b._33I(a),b._25I[a._id]=d),d},getNodeRect:function(a){return l.getNodeRect(this,a)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(a){var b=this.getDataUI(a);return b?(b._79o(),b._78o):null},getEdgeSourcePosition:function(a){var b=this,c=b.getDataUI(a),d=c.s,e=c._data._40I;return Aj(b,e,d("edge.source.position"),d("edge.source.offset.x"),d("edge.source.offset.y"),d("edge.source.anchor.x"),d("edge.source.anchor.y"))},getEdgeTargetPosition:function(a){var b=this,c=b.getDataUI(a),d=c.s,e=c._data._41I;return Aj(b,e,d("edge.target.position"),d("edge.target.offset.x"),d("edge.target.offset.y"),d("edge.target.anchor.x"),d("edge.target.anchor.y"))},invalidateAll:function(a){var b=this;if(a){for(var c in b._25I){var d=b._25I[c];d&&d.dispose()}b._25I={},b._56I={},b._24I={},b._34I.clear(),b.redraw()}else b.dm().each(function(a){b.invalidateData(a)})},invalidateSelection:function(){var a=this;a.sm().each(function(b){a.invalidateData(b)})},invalidateData:function(a){var b=this;b._24I[a._id]=a,b._21Q(a),b.iv()},_21Q:function(a){var b=this,c=b._24I;if(Ld(a)&&Zc[a.s(hb)]){var d=a.getSourceAgent();d&&d.getAgentEdges().each(function(a){c[a._id]=a}),d=a.getTargetAgent(),d&&d.getAgentEdges().each(function(a){c[a._id]=a}),b.iv()}},redraw:function(a){var b=this;b._32I||(a?b._34I.add(a):(b._32I=1,b._34I.clear()),b.iv())},each:function(a,b){var c,d,e,f=0,g=this.getLayers(),h=this._dataModel,i=h._datas._as,j=i.length;if(g){for(var k=g.length;k>f;f++)if(e=g[f],Fd(e)&&(e=e.name),h.isHierarchicalRendering()){var l=function(c){return c._layer===e?b?a.call(b,c):a(c):void 0};if(this._dataModel.eachByHierarchical(l)===!1)return}else for(var m=0;j>m;m++)if(c=i[m],c._layer===e&&(d=b?a.call(b,c):a(c),d===!1))return}else if(h.isHierarchicalRendering())this._dataModel.eachByHierarchical(a,null,b);else for(;j>f;f++)if(c=i[f],d=b?a.call(b,c):a(c),d===!1)return},reverseEach:function(a,b){var c,d,e,f,g=this._dataModel,h=g._layers,i=g._datas._as,j=i.length;if(h){for(c=h.length-1;c>=0;c--)if(f=h[c],Fd(f)&&(f=f.name),g.isHierarchicalRendering()){var k=function(c){return c._layer===f?b?a.call(b,c):a(c):void 0};if(g.reverseEachByHierarchical(k)===!1)return}else for(var l=j-1;l>=0;l--)if(d=i[l],d._layer===f&&(e=b?a.call(b,d):a(d),e===!1))return}else if(g.isHierarchicalRendering())g.reverseEachByHierarchical(a,null,b);else for(c=j-1;c>=0;c--)if(d=i[c],e=b?a.call(b,d):a(d),e===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var a=this,b=a._84I;if(!b){var c=this.dm().a("width"),d=this.dm().a("height");c>0&&d>0?a._84I={x:0,y:0,width:c,height:d}:(a.each(function(c){a.isVisible(c)&&(b=Xh(b,a.getDataUIBounds(c)))}),a._84I=b?b:id)}return a._84I},getScrollRect:function(){return Xh(this.getContentRect(),this._29I)},makeCenter:function(a,b,c){var d=this;if(!d.getWidth()||!d.getHeight())return void(c||Dh(d.makeCenter,d,[a,b,!0],500));d.makeVisible(a),d.validate();var e=d.getDataUIBounds(a);if(e){var f=d.getWidth(),g=d.getHeight(),h=e.x+e.width/2,i=e.y+e.height/2,j=-h*d._zoom+f/2,k=-i*d._zoom+g/2;d.setTranslate(j,k,b)}},fitData:function(a,b,c,d,e){var f=this;if(!f.getWidth()||!f.getHeight())return void(e||Dh(f.fitData,f,[a,b,c,d,!0],500));var g=function(){f.makeVisible(a),f.validate();var e=f.getDataUIBounds(a);e&&(e=Gh(e),bi(e,c==i?20:c),f.fitRect(e,b,d))};b?l.callWhenLoaded(g):g()},fitContent:function(a,b,c,d){var e=this;if(!e.getWidth()||!e.getHeight())return void(d||Dh(e.fitContent,e,[a,b,c,!0],500));var f=function(){e.validate();var d=Gh(e.getContentRect());bi(d,b==i?20:b),e.fitRect(d,a,c)};a?l.callWhenLoaded(f):f()},fitRect:function(a,b,c){var d=this,e=d.getWidth(),f=d.getHeight(),g=a.x+a.width/2,h=a.y+a.height/2,i=F(e/a.width,f/a.height),j=d._zoom,k=-g*j+e/2,l=-h*j+f/2;0===i||isNaN(i)||(c&&(i=F(1,i)),b?(d._65I&&(delete d._65I.finishFunc,d._65I.stop(!0)),d._14o&&d._14o.stop(!0),d.setTranslate(k,l,{finishFunc:function(){d.setZoom(i,b)}})):(d.setTranslate(k,l),d.setZoom(i)))},toCanvas:function(a,b){b=b||this._zoom,this.validateImpl();var c=this,d=c.getContentRect();d.width||(d.width=10),d.height||(d.height=10);var e=re(),f=d.x*b,g=d.y*b,h=d.width*b,i=d.height*b;ue(e,h,i,1);var j=De(e);return a=a||this._dataModel.getBackground(),a&&Df(j,0,0,h,i,a),Fe(j,-f,-g),j.scale(b,b),c._42(j),j.restore(),e},toDataURL:function(a,b,c){return this.toCanvas(a,c).toDataURL(b||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(a,b){var c=this,d=c.dm().getBackground();if(d){var e=c.dm().a("width"),f=c.dm().a("height");e>0&&f>0&&Df(a,0,0,e,f,d)}var g=c.__htmlOrderList,h=[];if(c._93db(a,b),c.each(function(d){var e=c.getDataUI(d);if(e){var f=c._56I[d._id],g=e._htmlView;if(f){var i=e._79o();if(g=e._htmlView,j.HtmlNode&&d instanceof j.HtmlNode)e._42(a);else{var k=c.getViewRect(),l=g&&g.layoutHTML;!b||$h(b,i)?(l&&(g.layoutHTML(),e.__outerLayout&&delete e.__outerLayout),e._42(a)):$h(k,i)||!l||e.__outerLayout||(g.layoutHTML(),e.__outerLayout=!0)}}g&&(h.push(g),g.getView&&(g=g.getView()),g.style.display=f?"block":ya)}}),g&&h.length>0){var i=!1;if(g.length!==h.length)i=!0;else for(var k=0;k<h.length;k++)if(h[k]!==g[k]){i=!0;break}i&&(h.forEach(function(a){a.autoAdjustIndex!==!1&&c.appendHTML(a,!0)}),this.__htmlOrderList=h)}else this.__htmlOrderList=h;c._92db(a,b)},validateImpl:function(){this.tryUpdateRootData();var a,b,c,d,e,f=this,g=f.tx(),h=f.ty(),i=f._zoom,j=f._canvas,k=this.getWidth(),l=this.getHeight(),m=f._29I,n={x:-g/i,y:-h/i,width:k/i,height:l/i},o={},p=f._34I,q=f._24I,r=f._32I,s=f._23I;f._24I={},(k!==j.clientWidth||l!==j.clientHeight)&&(ue(j,k,l),r=1),r||Zd(n,m)||(r=1),f._29I=n,f.each(function(a){b=a._id;var d=o[b]=f.isVisible(a);d!==f._56I[b]&&(q[b]=a,c=f.getDataUI(q[b]),c&&c._84o(d),f._84o(a,d))},f);for(b in q)c=f.getDataUI(q[b]),c&&(!r&&f._56I[b]&&(e=c._79o(),e&&p.add(e)),c.invalidate()),f._83I=1;if(f._56I=o,!r)for(b in q)o[b]&&(c=f.getDataUI(q[b]),c&&(e=c._79o(),e&&p.add(e)));if(r?d=n:(p.each(function(a){$h(n,a)&&(d=Xh(d,a))}),d&&(bi(d,E(1,1/i)),d.x=B(d.x*i)/i,d.y=B(d.y*i)/i,d.width=C(d.width*i)/i,d.height=C(d.height*i)/i,d=_h(n,d))),f._74O=d,d){a=De(j);var t=d.x,u=d.y,v=d.width,w=d.height;t=Math.floor((t*i+g)*Xg),u=Math.floor((u*i+h)*Xg),v=Math.ceil(v*i*Xg)+1,w=Math.ceil(w*i*Xg)+1,a.beginPath(),a.rect(t,u,v,w),a.clip(),a.clearRect(t,u,v,w),Ee(a,g,h,i),f._42(a,d),a.restore(),delete f._74O}if(p.clear(),delete f._32I,s&&k>0&&l>0){var c=f.getDataUI(s);if(c){var e=c._79o(),x=f._29I,y=x.x,z=x.y,A=x.width,D=x.height,i=f._zoom;e&&!$h(e,x)&&(e.x+e.width<y&&f.tx(-e.x*i),e.x>y+A&&f.tx(-(e.x+e.width-A)*i),e.y+e.height<z&&f.ty(-e.y*i),e.y>z+D&&f.ty(-(e.y+e.height-D)*i))}delete f._23I}f._83I&&(delete f._83I,delete f._84I),f._98O(),f.countFrame(),Xd(f._24I)||Dh(f.iv,f)},isValidGuideLineSource:function(a){return!0},tryUpdateRootData:function(){if(!this._rootDataUpdating){this._rootDataUpdating=!0;var a,b=this.getFullscreenDatas();for(var c in b)a=b[c],this.scaleRootData(a);this._rootDataUpdating=!1}},scaleRootData:function(a){var b=a.s("fullscreen");if("uniform"===b||"fill"===b){a.getRotation()&&a.setRotation(0);var c=a.s("fullscreen.gap")||0,d=this.getWidth(),e=this.getHeight();if(d&&e){var f,g,h,i=d-2*c,j=e-2*c,k=a.getAnchor(),l=a.getScaledSize(),m=l.width,n=l.height,o=a.s("fullscreen.lock");if(o)return"uniform"===b?i/j>m/n?(f=j/n,m=n*i/j):(f=i/m,n=m*j/i):"v"===o?(f=j/n,m=i/f,a.getWidth()!==m&&a.setWidth(m)):(f=i/m,n=j/f,a.getHeight()!==n&&a.setHeight(n)),this.setZoom(f),g=c-(a.getX()-k.x*m)*f,h=c-(a.getY()-k.y*n)*f,g!==this.tx()&&this.tx(g),void(h!==this.ty()&&this.ty(h));g=this.tx(),h=this.ty(),f=this._zoom;var p={x:(-g+c)/f,y:(-h+c)/f,width:i/f,height:j/f};if("uniform"===b){var q=m/n,r=Math.min(p.width,p.height*q),s=r/q;p.x+=.5*(p.width-r),p.y+=.5*(p.height-s),p.width=r,p.height=s}i=p.width/a.getScaleX(),j=p.height/a.getScaleY(),(a.getWidth()!=i||a.getHeight()!==j)&&a.setSize(i,j);var t=p.x+k.x*p.width,u=p.y+k.y*p.height,v=a.getPosition();(t!==v.x||u!==v.y)&&a.setPosition(t,u)}}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(a){var b=this;a!==b.isScrollBarVisible()&&(a?(ve(b._view,b._79O=qe()),ve(b._79O,b._27I=qe()),ve(b._79O,b._28I=qe())):(fi(b._79O),delete b._79O,delete b._27I,delete b._28I),b.fp("scrollBarVisible",!a,a))},getDebugTip:function(){return""},showScrollBar:function(){var a=this;a._79O&&(a._85I||(Z(function(){a._86I()},nh),a.iv()),a._85I=new Date)},_86I:function(){var a=this;if(a._85I){var b=new Date,c=b.getTime();c-a._85I.getTime()>=nh?(delete a._85I,a.iv()):Z(function(){a._86I()},nh)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var a=this,b=this._27I,c=this._28I;if(a._79O){if(a._autoHideScrollBar&&!a._85I)return b.style.visibility=jb,void(c.style.visibility=jb);var d=a.getScrollBarColor(),e=a._zoom,f=a.getScrollBarSize(),g=a.getViewRect(),h=a.getScrollRect(),i=g.height*e,j=h.height*e,k=g.width*e-f-2,l=i*((g.y-h.y)*e/j),m=i*(i/j),n=b.style;j-.5>i?(oh>m&&(l=l+m/2-oh/2,0>l&&(l=0),l+oh>i&&(l=i-oh),m=oh),Le(b,k,l,f,m),n.visibility=kb,n.background=d,n.borderRadius=f/2+za):n.visibility=jb;var o=g.width*e,p=h.width*e,l=g.height*e-f-2,k=o*((g.x-h.x)*e/p),q=o*(o/p),n=c.style;p-.5>o?(oh>q&&(k=k+q/2-oh/2,0>k&&(k=0),k+oh>o&&(k=o-oh),q=oh),Le(c,k,l,q,f),n.visibility=kb,n.background=d,n.borderRadius=f/2+za):n.visibility=jb}},setDataModel:function(a){var b=this,c=b._dataModel,d=b._selectionModel;c!==a&&(c&&(c.ump(b.handleDataModelPropertyChange,b),c.umm(b.handleDataModelChange,b),c.umd(b.handleDataPropertyChange,b),c.removeIndexChangeListener(b._75O,b),c.removeHierarchyChangeListener(b.handleHierarchyChange,b),d||c.sm().ums(b.handleSelectionChange,b)),b._dataModel=a,a.mp(b.handleDataModelPropertyChange,b),a.mm(b.handleDataModelChange,b),a.md(b.handleDataPropertyChange,b),a.addIndexChangeListener(b._75O,b),a.addHierarchyChangeListener(b.handleHierarchyChange,b),d?d._21I(a):a.sm().ms(b.handleSelectionChange,b),b.invalidateAll(!0),b.fp(Qb,c,a),b.updateBackground())},getLayersInfo:function(){if(this._layersInfo===c){var a=this.getLayers();a?(this._layersInfo={},a.forEach(function(a){var b=Fd(a)?a.name:a;this._layersInfo[b]=a},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(a,b,c){var d,e,f=this,g=f.getDataUI(a),h=Tj(g),i=Zj(b,function(a){return Xj(h,100*a)},100,.001),j=Xj(h,100*i);if(!c){var k=Yj(g),l=new Lg(j.x,j.y),m=49/(f._zoom*f._zoom);for(d=0,e=k.length;e>d;d++)if(l.distanceToSquared(k[d])<m)return{index:d,point:k[d],distance:Math.sqrt((k[d].x-b.x)*(k[d].x-b.x)+(k[d].y-b.y)*(k[d].y-b.y))}}return{percent:i,point:j,distance:Math.sqrt((j.x-b.x)*(j.x-b.x)+(j.y-b.y)*(j.y-b.y))}},calculateAttachPoint:function(){var a=new Lg,b=new Lg,c=new Lg;return function(d,e){var f=this.getAttachPoints(d);if(!f||!f.length)return null;c.set(e.x,e.y);for(var g,h,i,j,k=1/0,l=0,m=f.length;m>l;l++)i=f[l],b.x=i.x,b.y=i.y,a.x=i.offsetX||0,a.y=i.offsetY||0,j=Aj(this,d,0,a.x,a.y,b.x,b.y),h=c.distanceToSquared(j),k>h&&(g=l,k=h);k=Math.sqrt(k);var n=this.getAttachStyle(d);if("close"===n){var o=d.s("attach.close.threshold")/this._zoom;if(k>o)return null}return{index:g,distance:k,info:f[g]}}}(),getAttachPoints:function(a){var b=a.s("attach.points");if(b)return b;var c=yh(a._image);return c?_i(c.attachPoints,a,this)||null:void 0},getAttachStyle:function(a){var b=a.s("attach.style");if(b)return b;var c=yh(a._image);return c?_i(c.attachStyle,a,this)||"close":void 0},updateLayers:function(){this._layersInfo=c,this.invalidateSelection(),this.redraw()},updateBackground:function(){var a=this.dm().a("width"),b=this.dm().a("height");a>0&&b>0?this._canvas.style.background="":this._canvas.style.background=this.dm().getBackground()||""},handleDataModelPropertyChange:function(a){if("background"===a.property){var b=this._canvas.style.background,c=a.newValue||"";this.updateBackground(),this.fp("canvasBackground",b,c),this.redraw()}else"a:width"===a.property||"a:height"===a.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===a.property?this.updateLayers():"hierarchicalRendering"===a.property&&this.redraw()},handleDataPropertyChange:function(a){this.dm().isHierarchicalRendering()&&"parent"===a.property&&a.data.hasChildren()&&this.redraw(),this.invalidateData(a.data)},onPropertyChanged:function(a){var b=this,c=a.property;if(b.redraw(),"zoom"===c){var d=b.sm().getSelection();d.size()&&d.each(function(a){a.invalidate()})}else"dataModel"===c&&(b._83I=1);kj[c]?b.showScrollBar():c===pb&&b.onCurrentSubGraphChanged(a)},onCurrentSubGraphChanged:function(a){this.sm().cs(),this.reset()},handleDataModelChange:function(a){var b=this,c=a.kind,d=a.data;if(b._83I=1,"add"===c)b.invalidateData(d),Ld(d)&&d.getEdgeGroup()&&d.getEdgeGroup().eachSiblingEdge(b.invalidateData,b);else if(c===Ja){b._21Q(d);var e=d._id,f=b._25I[e];if(f){if(b._56I[e]){var g=f._79o();g&&b.redraw(g)}f.dispose(),delete b._25I[e],delete b._24I[e],delete b._56I[e]}d===b._currentSubGraph&&b.setCurrentSubGraph(i)}else c===Ka&&(b.invalidateAll(!0),b.setCurrentSubGraph(i))},_75O:function(a){this.invalidateData(a.data)},handleHierarchyChange:function(a){
this.dm().isHierarchicalRendering()&&a.data.hasChildren()&&this.redraw(),this.invalidateData(a.data)},adjustIndex:function(a){var b=this;if(b.isVisible(a)){b.dm().beginTransaction();for(var c=a;c._parent&&b.isVisible(c._parent);)c=c._parent;c&&c!==a&&b._dataModel.adjustIndex(c),b._dataModel.adjustIndex(a),b.dm().endTransaction()}},getImage:function(a){return a.getImage?a.getImage():c},getSelectWidth:function(a){var b=yh(this.getImage(a));return b&&_i(b.disableSelectedBorder,a,this)?0:a.s("select.width")},getSelectColor:function(a){return a.s("select.color")},isSelectable:function(a,b){if(this.isSelected(a))return!0;if(!b&&a.getParent()instanceof $k&&this.isSelectable(a.getParent(),!0)&&a.getParent().isSyncSize())return!1;var c=this.getLayersInfo();if(c){var d=c[a._layer];if(d&&d.selectable===!1)return!1}return a.s("2d.selectable")&&this.sm().isSelectable(a)},isMovable:function(a){var b=this;if(Ld(a)&&a.getStyle(hb)!==Ta)return!1;var c=this.getLayersInfo();if(c){var d=c[a._layer];if(d&&d.movable===!1)return!1}return a.s("2d.movable")?b._movableFunc?b._movableFunc(a):!0:!1},isEditable:function(a){var b=this;if(j._uiSerializing)return b._uieditable;if(!b._editInteractor||!b.isSelected(a))return!1;if(Md(a)){var c=b.getDataUI(a);if(!c||c._88I)return!1}if(Ld(a)&&a.getStyle(hb)!==Ta)return!1;var d=this.getLayersInfo();if(d){var e=d[a._layer];if(e&&e.editable===!1)return!1}return a.s("2d.editable")?b._editableFunc?b._editableFunc(a):!0:!1},handleDelete:function(a){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(a){return Kd(a)&&0!==a.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(a):!0},isRectEditable:function(a){return this._rectEditableFunc?this._rectEditableFunc(a):!0},isAnchorEditable:function(a){return this._anchorEditableFunc?this._anchorEditableFunc(a):!0},isRotationEditable:function(a){return a.setRotation&&a.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(a):!0:!1},getRotationPoint:function(a){var b=a.getAnchor(),c=a.getScale(),d=this._zoom,e=Sf(a.getRotation(),0,-a.getHeight()*c.y*b.y-(c.y<0?-1:1)*(ia?32:16)/d),f=a.p();return e.x+=f.x,e.y+=f.y,e},getLogicalPoint:function(a){var b=this;return ci(a,b._canvas,b.tx(),b.ty(),b._zoom,b._zoom)},getScreenPoint:function(a,b){var d,e=this;return"object"==typeof a?a.x!==c?(d=a.x,b=a.y):(d=a[0],b=a[1]):d=a,di(d,b,e._canvas,e.tx(),e.ty(),e._zoom,e._zoom)},getSelectedDataAt:function(a){var b=this;return this.getDataAt(a,function(a){return b.isSelected(a)})},getDataInfoAt:function(a,b,c){var d,e=this.lp(a),f=this.getDataAt(e,b,c);if(f){var g=this.getDataUI(f);d={data:f,ui:g,point:e};var h=g._38o;if(h){var j=h.icons;for(var k in j){var l=j[k],m=h.rects[k];if(m)for(var n=_i(l.names,f,this),o=n?n.length:0,p=m.rotation,q=o-1;q>=0;q--){var r=n[q],s=m[q];if(Yh(s,e,p))return d.part="icons",d.name=k,d.icon=r,d.rect=s,d.index=q,d.rotation=p,d}}}if(this.isNoteVisible(f)){if(g.note2Info&&Yh(g.note2Info.clickRect,e,i,g.note2Info.scale))return d.part="note2",d;if(g.noteInfo&&Yh(g.noteInfo.clickRect,e,i,g.noteInfo.scale))return d.part="note",d}if(this.isLabelVisible(f)){if(g.label2Info&&Yh(g.label2Info.rect,e,g.label2Info.rotation,g.label2Info.scale))return d.part="label2",d;if(g.labelInfo&&Yh(g.labelInfo.rect,e,g.labelInfo.rotation,g.labelInfo.scale))return d.part="label",d}if(f.isInRect&&f.isInRect(e))return d.part="body",d}return d},getDataAt:function(a,b,c){a.target&&(a=this.lp(a));var d,e=this._zoom;return this.reverseEach(function(f){return(b?b(f):this.isSelectable(f))&&this.rectIntersects(f,yd(a.x,a.y,c,e))?(d=f,!1):void 0},this),d},getIconInfoAt:function(a,b){var c=this;if(a.target&&(a=c.lp(a)),b||(b=c.getDataAt(a)),b){var d=c.getDataUI(b);if(d&&d._38o){var e,f=d._38o,g=new bj;for(e in f.icons)g.add(e);for(var h=g.size()-1;h>=0;h--){e=g.get(h);for(var j=f.rects[e],k=j.rotation,l=j.length-1;l>=0;l--){var m=j[l],n=m.width,o=m.height,p={x:a.x-m.x-n/2,y:a.y-m.y-o/2};k!=i&&(p=Sf(-k,p.x,p.y));var m={x:-n/2,y:-o/2,width:n,height:o};if(Yh(m,p))return{key:e,index:l,name:f.icons[e].names[l],rect:j[l],point:a,rotation:k,relativeRect:m,relativePoint:p,data:b}}}}}return i},getDatasInRect:function(a,b,d){d===c&&(d=1);var e=this,f=new bj;return e.reverseEach(function(c){d&&!e.isSelectable(c)||(b?e.rectIntersects(c,a):e.rectContains(c,a))&&f.add(c)}),f},moveSelection:function(a,b){var c=this;c.dm().beginTransaction(),Yf(c.sm().toSelection(c.isMovable,c),a,b),c.dm().endTransaction()},moveDatas:function(a,b,c){var d=this;d.dm().beginTransaction(),a instanceof bj||(a=new bj(a)),Yf(a,b,c),d.dm().endTransaction()},getDataUIBounds:function(a){var b=this.getDataUI(a);return b?b._79o():i},drawData:function(a,b,c){var d=this.getDataUI(b);if(d){var e=d._79o();(!c||$h(c,e))&&(d._42(a),b instanceof j.Block&&b.eachChild(function(b){this.drawData(a,b,c)},this))}},getBoundsForGroup:function(a){return a.s(Na)?this.getDataUIBounds(a):i},isPixelPerfect:function(a){return a.s("pixelPerfect")},rectIntersects:function(a,b){this.validate();var c=i;if(this._56I[a._id]){var d=this._25I[a._id];if(d){var e=d._79o();if(Zh(b,e))c=!0;else if((b=_h(b,e))&&(d.rectIntersects&&(c=d.rectIntersects(b)),c==i)){if(!this.isPixelPerfect(a))return!0;var f=b.x,g=b.y,h=b.width,j=b.height,k=this._zoom,m=l.hitMaxArea,n=h*j*k*k;if(n>m){var o=Math.sqrt(m/n);k*=o}h*=k,j*=k,2>h&&(h=2),2>j&&(j=2),f*=k,g*=k;var p=pf(h,j);Fe(p,-f,-g),p.scale(k,k),this._drawForChecking=!0,this.drawData(p,a,b),this._drawForChecking=!1;try{for(var q=0,r=p.getImageData(0,0,h,j).data;q<r.length;q+=4)if(0!==r[q+3]){c=!0;break}p.restore()}catch(s){nf=i,c=!1}}}}return c?!0:!1},rectContains:function(a,b){if(this._56I[a._id]){var c=this._25I[a._id];if(c)return Zh(b,c._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(a){if(!l.isInput(a.target)){var b=this,c=b._focusData,d=c&&b._25I[c._id],e=0,f=b._dataModel._datas;if(!(c&&c._enabled&&c._editable&&d&&d.onKeyDown&&d.onKeyDown(a)===!0))if(9===a.keyCode&&(c&&(e=f.indexOf(c),Rh(a)?-1===--e&&(e=0):++e===f.size()&&(e=0)),b._focusData=c=f.get(e),b.sm().setSelection(c)),We(a)?b.selectAll():hf(a)&&b.isResettable()&&b.reset(),b.sm().isEmpty()){if(b._editing)return;var g=b.tx(),h=b.ty(),i=!1,j=Rh()?100:10;df(a)&&(g-=j,i=!0),ef(a)&&(h-=j,i=!0),ff(a)&&(g+=j,i=!0),gf(a)&&(h+=j,i=!0),i&&b.setTranslate(g,h)}else{Xe(a)&&b.handleDelete(a);var k=Rh()?10:1;df(a)&&(b.moveSelection(-k,0),b.fi({kind:"moveLeft"})),ef(a)&&(b.moveSelection(0,-k),b.fi({kind:"moveUp"})),ff(a)&&(b.moveSelection(k,0),b.fi({kind:"moveRight"})),gf(a)&&(b.moveSelection(0,k),b.fi({kind:"moveDown"}))}}},handleScroll:function(a,b){if(wh(a),this.isZoomable()){if(!this.getEditInteractor()){var c=this.getDataAt(a);if(c){var d=yh(this.getImage(c));if(d&&_i(d.scrollable,c,this))return}}var e=this.lp(a);b>0?this.scrollZoomIn(e):0>b&&this.scrollZoomOut(e)}},handlePinch:function(a,b,c){this.isZoomable()&&(b>c?this.pinchZoomIn(a):this.pinchZoomOut(a))},checkDoubleClickOnNote:function(a,b){var c=this,d=c.lp(a),e=c.getDataUI(b),f=e.note2Info;return f&&b.s("note2.toggleable")&&Yh(f.clickRect,d)?(b.s(eb,!b.s(eb)),c.fi({kind:"toggleNote2",event:a,data:b}),!0):(f=e.noteInfo,f&&b.s("note.toggleable")&&Yh(f.clickRect,d)?(b.s(db,!b.s(db)),c.fi({kind:"toggleNote",event:a,data:b}),!0):!1)},_84o:function(a,b){},isNoteVisible:function(a){return this._zoom>.15},isLabelVisible:function(a){return this._zoom>.15},isEditVisible:function(a){return this._zoom>.15},autoScroll:function(a,b){var c=this,d=c.getAutoScrollZone(),e=d/c.getZoom(),f=d/4,g=c._29I,h=c.lp(a),i={x:c.tx(),y:c.ty()};return h&&d>0&&g&&(h.x-g.x<e?c.translate(f,0):g.x+g.width-h.x<e&&c.translate(-f,0),h.y-g.y<e?c.translate(0,f):g.y+g.height-h.y<e&&c.translate(0,-f)),i.x=c.tx()-i.x,i.y=c.ty()-i.y,b&&(b.x+=i.x,b.y+=i.y),i},getMoveMode:function(a,b){var c=b.s("2d.move.mode");return c?c:Vc[88]?"x":Vc[89]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(a,b,c){var d=this;return"currentSubGraph"===b?{__i:a.getId()}:c.serializeProperty(a,b,d)},deserializeProperty:function(a,b,c){var d=this;if("currentSubGraph"===b){var e=d.dm(),f=e.__idMap;return f[a.__i]}return c.deserializeProperty(a,b,d)},setDefaultCursor:function(a,b){this._defaultCursor=a,b!==!1&&this.setCursor(a)},setCursor:function(a){"default"===a&&(a=this._defaultCursor||a);var b=this.getView().style;b.cursor=a,b.cursor="-webkit-"+a,b.cursor="-moz-"+a},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(a){return a===i||l.getConnectAction(null,a)?(this._currentActionType=a,this.redraw(),!0):!1},getEditStyle:function(a){var b=this.getEditInteractor();return b?b.getStyle(a):c},setEditStyle:function(a,b,c){var d=this.getEditInteractor();return d?(d.setStyle(a,b,c),!0):!1},isConnectActionVisible:function(a){var b=l.getConnectAction(this);if(!b)return!1;var c=b.visible;return Gd(c)&&(c=c(this,a)),c},isInteractive:function(a){var b=yh(this.getImage(a));return b&&_i(b.interactive,a,this)?!0:a.s("interactive")},appendHTML:function(a,b){var c=this.getView();if(!(b||a&&a.parentNode!==c))return!1;var d=a.getView&&a.getView();if(!b&&d&&d.parentNode===c)return!1;(a.getView||a.isSelfViewEvent)&&(a=a.getView());var e=this.getEditInteractor();return e&&e._canvas?c.insertBefore(a,e._canvas):this.isScrollBarVisible()?c.insertBefore(a,this.getView().lastChild):ve(c,a),!0},_layoutHTMLImpl:function(a,b,c){if(arguments.length>1){var d,e=this,f=e._zoom;if(b.getView&&(d=b,b=b.getView()),b.style.position="absolute",c){var g=a.getRect();Le(d||b,e.tx()+g.x*f,e.ty()+g.y*f,g.width*f,g.height*f)}else{var h=new Gg,g=a.getAnchorRect(),i=a.getPosition(),j=a.getScale(),k=b.style;Le(d||b,g),h.appendTranslate(e.tx(),e.ty()),h.appendScale(f,f),h.append(new Gg(a.getRotation(),i.x,i.y,j.x,j.y)),Be(k,"transform","matrix("+h.a.toFixed(5)+", "+h.b.toFixed(5)+", "+h.c.toFixed(5)+",\n    "+h.d.toFixed(5)+", "+h.tx.toFixed(5)+", "+h.ty.toFixed(5)+")"),Be(k,"transformOrigin",(-g.x).toFixed(5)+"px "+(-g.y).toFixed(5)+"px"),b.updateAppendMatrix=!0}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(a){return a instanceof al?{name:"text",accessType:"s",isMultiline:!1}:void 0},getState:function(a){var b="state",c=a.s(b);if(c)return c;var d=yh(a._image);return d?_i(d[b],a,this)||null:void 0}}),b.defineProperties(Lj.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(a){this._layoutHTML=a}}});var jl=function(a,b){var c=this;c.gv=a,c.s=function(a){return b.getStyle(a)},c._data=b,c._87I=new bj};ki(jl,b,{_6I:i,ms_icons:1,_84o:function(a){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var a=this,b=a.gv.isSelected(a._data);return!b||a.isShadowed()?0:a.gv.getSelectWidth(a._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(a){var b=this._data,c=this.gv.getBodyColor(b);return c?c:a?b.getStyle(a):i},_2Q:function(a){return this.s(a)},_1Q:function(a,b,c,d){var e=this.s,f=e("2d.gray"),g=e(b+".dash.color");if(f&&(g=l.toGrayColor(g)),a.strokeStyle=g,a.lineWidth=c,a.stroke(),e(b+".dash.3d")){var h=e(b+".dash.3d.color");Bf(a,g,f?l.toGrayColor(h):h,c,this.gv._zoom,e(b+".dash.3d.accuracy"))}Li(a,d)},invalidate:function(){this._6I=i},_79o:function(){var a=this;if(!a._6I){var b=a._data,c=a.gv;a.labelInfo=a.label2Info=a.noteInfo=a.note2Info=a._38o=i,a._87I.clear(),a.interactiveInfo=c.isInteractive(b)?{}:i,a._3O(),a._55O=c.isEditable(b)?{_42O:c.isRectEditable(b),_43O:c.isPointEditable(b),_56O:c.isRotationEditable(b)}:i,a._6I=a._81o()}return a._6I},_3O:function(){},getPosition:function(a,b,c,d){return id},_68o:function(a,b){a&&this._87I.add(uf(a,b))},_81o:function(){var a=this,b=a.s;a._24O(Xa,"getLabel"),a._24O(Ya,"getLabel2"),a._26O(Za,"getNote"),a._26O($a,"getNote2"),a._15O(),a._55O&&a._48O();var c;if(a._87I.each(function(a){c=Xh(c,a)}),c&&a.isShadowed()){var d=Gh(c);d.x+=b("shadow.offset.x"),d.y+=b("shadow.offset.y"),bi(d,b("shadow.blur")),c=Xh(c,d)}return a._87I.clear(),c},_42:function(a){var b=this,c=b._data,d=b.gv,e=b.s,f=e("opacity"),g=this.isShadowed();if(g){var h=a.shadowOffsetX,j=a.shadowOffsetY,k=a.shadowBlur,l=a.shadowColor,m=d.getZoom();a.shadowOffsetX=e("shadow.offset.x")*m,a.shadowOffsetY=e("shadow.offset.y")*m,a.shadowBlur=e("shadow.blur")*m,a.shadowColor=b.getSelectColor()}if(f!=i){var n=a.globalAlpha;a.globalAlpha=f}b._80o(a),d.isLabelVisible(c)&&((!d._drawForChecking||e("label.selectable"))&&Ej(a,b.labelInfo),(!d._drawForChecking||e("label2.selectable"))&&Ej(a,b.label2Info)),d.isNoteVisible(c)&&(Fj(a,b.noteInfo),Fj(a,b.note2Info)),b._99O(a),f!=i&&(a.globalAlpha=n),g&&(a.shadowOffsetX=h,a.shadowOffsetY=j,a.shadowBlur=k,a.shadowColor=l)},_80o:function(a){},_47O:function(a){},_24O:function(a,b){var c=this,d=c._data,e=c.gv,f=c.s,g=e[b](d);if(g!=i){var h=f(a+".scale"),j=f(a+".max"),k=f(a+".position"),l=c[a+"Info"]={label:g,scale:h,color:e[b+"Color"](d),font:f(a+".font"),opacity:f(a+".opacity"),align:f(a+".align"),rotation:c.getRotation(f(a+".rotation"),!1,k),background:e[b+"Background"](d)},m=we(l,g);j>0&&j<m.width&&(l.labelWidth=m.width,m.width=j),1!==h&&(m.width*=h,m.height*=h);var n=c.getPosition(k,f(a+".offset.x"),f(a+".offset.y"),m,f(a+".position.fixed"));if(m.x=n.x-m.width/2,m.y=n.y-m.height/2,c._68o(l.rect=m,l.rotation),1!==h){var o=m.width/h,p=m.height/h;l.rect={x:n.x-o/2,y:n.y-p/2,width:o,height:p}}}},_26O:function(a,b){var c=this,d=c.gv,e=c._data,f=c.s,g=d[b](e);if(g!=i){var h,j,k=f(a+".scale"),l=c[a+"Info"]={note:g,scale:k,data:e,view:d,expanded:f(a+".expanded"),font:f(a+".font"),color:f(a+".color"),opacity:f(a+".opacity"),align:f(a+".align"),icon:f(a+".icon"),backgroundImage:f(a+".backgroundImage"),borderWidth:f(a+".border.width"),borderColor:f(a+".border.color"),background:d[b+"Background"](e)},m=c.getPosition(f(a+".position"),f(a+".offset.x"),f(a+".offset.y")),n=m.x,o=m.y;if(l.expanded){var p,q=f(a+".max"),r=f(a+".backgroundImage");r?(r=yh(r),p={width:Zi(r,e),height:$i(r,e)}):p=we(l,g),p.width+=6,p.height+=2,q>0&&q<p.width&&(l.labelWidth=p.width,p.width=q),h=p.width,j=p.height+8,l.clickRect={x:n-h*k/2,y:o-j*k,width:h*k,height:j*k*p.height/j}}else{var s=f(a+".icon");s?(s=yh(s),h=Zi(s,e),j=$i(s,e)):(h=12,j=18),l.clickRect={x:n-h*k/2,y:o-j*k,width:h*k,height:j*k}}l.rect={x:n-h/2,y:o-j*k/2-j/2,width:h,height:j};var t=C(l.borderWidth/2)*k;c._68o({x:n-h*k/2-t,y:o-j*k-t,width:h*k+2*t,height:j*k+2*t})}},_48O:function(){},_99O:function(a){var b=this,c=b._38o;if(c){var d=b.gv,e=b._data,f=c.icons,g=b.interactiveInfo;g&&(g._38o={});for(var h in f){var j=f[h],k=c.rects[h];if(k){g&&(g._38o[h]=[]);var l=_i(j.opacity,e,d),m=_i(j.names,e,d),n=m?m.length:0,o=k.rotation;if(l!=i){var p=a.globalAlpha;a.globalAlpha*=l}for(var q=0;n>q;q++){var r=m[q],s=yh(r),t=k[q];if(o){var u=t.x+t.width/2,v=t.y+t.height/2;a.save(),Fe(a,u,v),Ge(a,o),Fe(a,-u,-v)}g&&g._38o[h].push(a.interactiveInfo={compInfos:[],matrix:o?new Gg(o,u,v).appendTranslate(-u,-v):new Gg}),Bh(a,s,_i(j.stretch,e,d),t.x,t.y,t.width,t.height,b._data,b.gv),a.interactiveInfo=i,o&&a.restore()}l!=i&&(a.globalAlpha=p)}}}}});var kl=function(a,b){Wd(kl,this,[a,b])};ki(kl,jl,{_checkEmptyRect:!0,_40O:function(a,b){var c=this,d=c.s,e=a.rect;(a.borderColor=c.gv.getBorderColor(c._data))&&(a.borderType=d("border.type"),a.borderWidth=d("border.width"),a.borderPadding=d("border.padding"),b=E(b,a.borderPadding+a.borderWidth/2));var f=c._data.getScale(),g=E(1,E(G(f.x),G(f.y)));if(a.selectWidth=c.getSelectWidth()){var h=c.gv._zoom;a.selectType=d("select.type"),a._97o=c.getSelectColor(),a.selectPadding=d("select.padding"),b=E(b,(a.selectPadding+a.selectWidth/2/h)/g)}b>0&&(b*=g,e=Gh(e),bi(e,b)),c._68o(e)},_39O:function(a,b){var c,d=this,e=b.rect;if(b.borderWidth>0&&(c=b.borderPadding,a.strokeStyle=b.borderColor,a.lineWidth=b.borderWidth,Ef(a,b.borderType,{x:e.x-c,y:e.y-c,width:e.width+2*c,height:e.height+2*c}),a.stroke()),b.selectWidth>0){var f=d.gv._zoom;if(c=b.selectPadding,a.strokeStyle=b._97o,a.lineWidth=b.selectWidth/f,b.rotation!=i){a.save(),a.translate(b.position.x,b.position.y),a.rotate(b.rotation);var g=d._data,h=g.getWidth(),j=g.getHeight(),k=b.scale,l=b.anchor;e={x:k.x*(-h*l.x),y:k.y*(-j*l.y),width:k.x*h,height:k.y*j}}Ef(a,b.selectType,{x:e.x-c,y:e.y-c,width:e.width+2*c,height:e.height+2*c}),b.rotation!=i&&a.restore(),a.stroke()}},dispose:function(){var a=this,b=a._htmlView;kl.superClass._3O.call(a),b&&(b.onHTMLRemoved&&b.onHTMLRemoved(),fi(b))},_3O:function(){var a=this,b=a.s,c=a._data,d=a.gv,e=c.getStyle(Ga),f=a.getBodyColor(),g=a._83o=e?{shape:e,_53o:a.getBodyColor("shape.background"),_27Q:yh(b("shape.repeat.image"),f),shapeGradientPack:b("shape.gradient.pack"),_54o:b("shape.border.width"),_55o:b("shape.border.color"),_56o:b("shape.border.3d"),_57o:b("shape.border.3d.color"),_58o:b("shape.border.3d.accuracy"),shapeGradient:b("shape.gradient"),_59o:b("shape.gradient.color"),_60o:b("shape.border.pattern"),_61o:b("shape.border.cap"),_62o:b("shape.border.join"),shapeForeground:b("shape.foreground"),bodyColor:f,gray:b("2d.gray")}:{img:yh(d.getImage(c),f),bodyColor:f,gray:b("2d.gray"),stretch:b("image.stretch")};if(T&&!U);else{var h,j=g.img;j&&j.renderHTML?(a._htmlInfo&&a._htmlInfo.img!==j&&(a._htmlInfo=i),a._htmlInfo||(a._htmlInfo={img:j,cache:{}}),h=j.renderHTML(c,d,a._htmlInfo.cache)):a._htmlInfo=i,a._htmlView&&a._htmlView!==h&&(a._htmlView.onHTMLRemoved&&a._htmlView.onHTMLRemoved(),fi(a._htmlView.getView?a._htmlView.getView():a._htmlView)),(a._htmlView=h)&&d.appendHTML(h)&&(h.onHTMLAddedSync&&h.onHTMLAddedSync(),h.onHTMLAdded&&Dh(h.onHTMLAdded)),g.rect=c.getRect(),g.position=c.p(),g.scale=c.getScale(),g.anchor=c.getAnchor(),g.rotation=c.getRotation(),e===Da&&(g._63o=b("shape.depth"));var k=0;if(e)k=tf(i,g._54o/2,g._62o),a.s("shape.dash")&&(k=E(k,(a.s("shape.dash.width")||g._54o)/2));else if(j&&j.boundExtend)if(k=_i(j.boundExtend,c,d),j.boundExtendAbsolute){var l=c.getScale();k/=d._zoom*E(1,E(G(l.x),G(l.y)))}else if(!_i(j.fitSize,c,d)){var m=_i(j.width,c,d),n=_i(j.height,c,d);k*=E(c.getWidth()/m,c.getHeight()/n)}a._40O(g,k);var o=b("clip.percentage");if(1>o&&(0>o&&(o=0),g.clipRect=fe(c.getAnchorRect(),b("clip.direction"),o)),e){var p=b("shape.fill.clip.percentage");1>p&&(0>p&&(p=0),g.shapeClipRect=fe(c.getAnchorRect(),b("shape.fill.clip.direction"),p));var q=b("shape.foreground.clip.percentage");1>q&&(0>q&&(q=0),g.shapeForegroundClipRect=fe(c.getAnchorRect(),b("shape.foreground.clip.direction"),q))}}},getPosition:function(a,b,c,d){var e=bg(a,this._83o.rect,d);return e.x+=b,e.y+=c,e},_80o:function(a){var b=this,c=b.s,d=b.gv,e=b._data,f=b._83o,g=f.rect,h=f.position,j=f.rotation,k=f.anchor,m=f.scale,n=f.shape,o=f.clipRect;if(!b._checkEmptyRect||g.width>0&&g.height>0){var p=e.getSize();if(p.x=-p.width*k.x,p.y=-p.height*k.y,a.save(),Fe(a,h.x,h.y),Ge(a,j),He(a,m.x,m.y),o&&(a.beginPath(),a.rect(o.x,o.y,o.width,o.height),a.clip()),d._drawForChecking&&f.img&&_i(f.img.pixelPerfect,e,d)===!1)Df(a,p.x,p.y,p.width,p.height,"#888888");else if(b.freeDraw)b.freeDraw(a,p,f);else if(n){var q,r,s,t,u=f._60o,v=Ki(a,u),w=f._27Q,x=f._54o,y=f.shapeGradientPack,z=f.gray,A=a.lineJoin,B=a.lineCap,C=function(a){return z?l.toGrayColor(a):a};"roundRect"===n?q=c("shape.corner.radius"):"polygon"===n?q=c("shape.polygon.side"):"arc"===n&&(q=c("shape.arc.from"),r=c("shape.arc.to"),s=c("shape.arc.close"),t=c("shape.arc.oval")),a.lineJoin=f._62o,a.lineCap=f._61o;var D=C(f._53o);if(D||w||y){var E=f.shapeClipRect;E&&(a.save(),a.beginPath(),a.rect(E.x,E.y,E.width,E.height),a.clip()),Ef(a,n,p,q,r,s,t),y?xf(a,y):w?Gf(a,w,C(f.bodyColor),null,e,d):Ff(a,D,f.shapeGradient,C(f._59o),p),a.fill(),E&&a.restore(),y&&a.restore(),a!==v&&Ef(v,n,p,q,r,s,t)}else Ef(v,n,p,q,r,s,t);var F=f.shapeForeground;if(F){a.save();var G=f.shapeForegroundClipRect;G&&(a.beginPath(),a.rect(G.x,G.y,G.width,G.height),a.clip()),Ef(a,n,p,q,r,s,t),Ff(a,F,c("shape.foreground.gradient"),C(c("shape.foreground.gradient.color")),p),a.fill(),a.restore()}if(x>0){var H=c("shape.border.width.absolute");H&&(a.save(),a.setTransform(1,0,0,1,0,0)),a.lineWidth=x;var I=C(f._55o);a.strokeStyle=I,a.stroke(),H&&a.restore(),f._56o&&Bf(a,I,C(f._57o),x,d._zoom,f._58o)}if(Li(a,u),c("shape.dash")){var J=c("shape.dash.width")||x;if(J>0){u=c("shape.dash.pattern");var v=Ki(a,u,b._2Q("shape.dash.offset"));v!==a&&Ef(v,n,p,q,r,s,t),b._1Q(a,"shape",J,u)}}Lf(a,D,f._63o,p),a.lineJoin=A,a.lineCap=B}else{var K=b.interactiveInfo;K&&(a.interactiveInfo=K.bodyInfo={compInfos:[],matrix:new Gg(j,h.x,h.y,m.x,m.y)}),f.gray&&(a.compGray=!0);var L=f.img;L&&L.cacheRule!=i&&(L=Oj(a,L,f.stretch,p.width,p.height,e,d,f.bodyColor)),Bh(a,L,f.stretch,p.x,p.y,p.width,p.height,e,d,f.bodyColor),a.compGray=!1,a.interactiveInfo=i}a.restore()}b._39O(a,f)},_48O:function(){},_47O:function(a){}});var ll=function(a,b){Wd(ll,this,[a,b])},ml=function(a,b,c,d){var e=Vh(a,b);return c=d?F(c,e):Gj(c,e),e?c/=e:c=0,{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}};ki(ll,jl,{_3O:function(){var a,b=this,d=b._data,e=b.gv,f=b.s,g=f(hb),h=d.isLooped(),j=f("edge.width"),k=f("edge.center"),m=f("edge.offset"),n=e.getBorderColor(d),o=n?f("border.width"):0,p=b.getSelectWidth(),q=d._40I,r=d._41I,s=b._78o=q&&r?{looped:h,type:g,width:j,center:k,color:b.getBodyColor("edge.color"),borderColor:n,borderWidth:o,_97o:p?b.getSelectColor():i,selectWidth:p,pattern:f("edge.pattern"),cap:f("edge.cap"),join:f("edge.join"),is3d:f("edge.3d"),_67o:f("edge.3d.color"),_66o:f("edge.3d.accuracy"),gray:f("2d.gray")}:i;if(s){var t=l.getEdgeType(g);if(t){var u=t(d,Jj(b,e,d,h,g),e,b._19Q);u.points&&u.points.size()>1?(s.edgeTypeInfo=u,a=Wh(s.edgeTypeInfo.points)):u[nb]&&u.rect&&(s.edgeTypeInfo=u,a=u.rect)}else{var v=f("edge.source.anchor.x"),w=f("edge.source.anchor.y"),x=f("edge.target.anchor.x"),y=f("edge.target.anchor.y"),z=zj(e,d,"source"),A=zj(e,d,"target");if(g===Ta){var B=s.points=f(gb)||cj,C=B.size();s.segments=f("edge.segments");var D=v!==c||w!==c||Ld(q),F=x!==c||y!==c||Ld(r);if(!k)if(m)D||(z=ml(z,C?B.get(0):A,m,C)),F||(A=ml(A,C?B.get(C-1):z,m,C));else{var G;D||(G=be(z,C?B.get(0):A,hj(e,q)),G&&(z={x:G[0],y:G[1]})),F||(G=be(C?B.get(C-1):z,A,hj(e,r)),G&&(A={x:G[0],y:G[1]}))}a=Xh(Wh(s.points),Wh(z,A))}else{var H=Jj(b,e,d,h,g);if(b._19Q||(H=-H),h)z=Gh(z),z.x=e.getNodeRect(q).x,s.radius=H,a={x:z.x-H,y:z.y-H,width:2*H,height:2*H};else{var I=Vh(z,A),J=Gj(m,I),K={x:J,y:H},L={x:I-J,y:H},N=Q(A.y-z.y,A.x-z.x),O=s.mat=new Hg(N);if(s.orienAngle=N,s.angle=A.x<z.x?N+M:N,s.rect={x:K.x,y:K.y,width:L.x-K.x,height:0},s.origin=z,K=O.tf(K),K.x+=z.x,K.y+=z.y,L=O.tf(L),L.x+=z.x,L.y+=z.y,k){var P={x:I,y:0};P=O.tf(P),P.x+=z.x,P.y+=z.y,a=Wh([z,K,L,P]),s.c1=z,s.c2=P}else a=Wh(K,L);z=K,A=L}}s.sourcePoint=z,s.targetPoint=A,d._lastSourcePoint=z,d._lastTargetPoint=A}var R=0;f("edge.dash")&&(R=f("edge.dash.width")||j);var S="square"===s.cap?.71:.5;tf(a,E(R*S,j*S+o+p),s.join),b._68o(a)}},getRotation:function(a,b,c){a=a||0;var d=this._78o;if(d){var e,f=d.angle,g=d.points,h=d.edgeTypeInfo;if(f!=i)return b?d.orienAngle+a:f+a;if(h&&h[nb])return h.getRotation?h.getRotation(this,a,b,c):0;if(h&&h.points){var j=h.points;return e=j.size(),jj[c]?e&&e%2===0?Hj(j.get(e/2-1),j.get(e/2),b,a):a:ij[c]?Hj(j.get(0),j.get(1),b,a):Hj(j.get(e-2),j.get(e-1),b,a)}if(g)return e=g.size(),jj[c]?e&&e%2===0?Hj(g.get(e/2-1),g.get(e/2),b,a):a:ij[c]?Hj(d.sourcePoint,e?g.get(0):d.targetPoint,b,a):Hj(e?g.get(e-1):d.sourcePoint,d.targetPoint,b,a)}return a},getPosition:function(a,b,c,d,e){var f=this._78o;if(f){var g,h=f.type,i=f.points,j=f.edgeTypeInfo,k=f.sourcePoint,l=f.targetPoint;if(!h)return f.looped?{x:k.x-f.radius+b,y:k.y+c}:(e&&k&&l&&(k.x>l.x||k.x===l.x&&k.y>l.y)&&(a=ag[a],c=-c),g=bg(a,f.rect,d),g.x+=b,g.y+=c,g=f.mat.tf(g),g.x+=f.origin.x,g.y+=f.origin.y,g);if(j&&j[nb])return j.getPosition?j.getPosition(this,a,b,c,d,e):{x:(k.x+l.x)/2,y:(k.y+l.y)/2};if(i){var g,m=i.size();if(jj[a]){if(m){var n=m%2;if(0===n)return Ij(i.get(m/2-1),i.get(m/2),a,b,c,d,e);g=i.get((m-n)/2)}else g={x:(k.x+l.x)/2,y:(k.y+l.y)/2};return g=bg(a,{x:g.x,y:g.y,width:0,height:0},d),g.x+=b,g.y+=c,g}return ij[a]?Ij(k,m?i.get(0):l,a,b,c,d,e):Ij(m?i.get(m-1):k,l,a,b,c,d,e)}if(j){var o=j.points,m=o.size();if(jj[a]){var n=m%2;return 0===n?Ij(o.get(m/2-1),o.get(m/2),a,b,c,d,e):(g=o.get((m-n)/2),g=bg(a,{x:g.x,y:g.y,width:0,height:0},d),g.x+=b,g.y+=c,g)}return ij[a]?Ij(o.get(0),o.get(1),a,b,c,d,e):Ij(o.get(m-2),o.get(m-1),a,b,c,d,e)}}return id},_42:function(a){this._78o&&ll.superClass._42.call(this,a)},drawPath:function(a,b){a.beginPath();var c=b.type,d=b.points,e=b.segments,f=b.edgeTypeInfo;if(!c||d){var g=b.sourcePoint,h=g.x,i=g.y,j=b.targetPoint,k=j.x,l=j.y;if(c)if(e){var m=new bj({x:h,y:i});m.addAll(d),m.add({x:k,y:l}),zf(a,m,e)}else a.moveTo(h,i),d.each(function(b){a.lineTo(b.x,b.y)}),a.lineTo(k,l);else b.looped?a.arc(h,i,b.radius,0,N,!0):b.center?(a.moveTo(b.c1.x,b.c1.y),a.lineTo(h,i),a.lineTo(k,l),a.lineTo(b.c2.x,b.c2.y)):(a.moveTo(h,i),a.lineTo(k,l))}else f&&(f.points?zf(a,f.points,f.segments):f[nb]&&f[nb](a,f))},_80o:function(a){var b=this,c=b.s,d=b._78o,e=d.width,f=d.selectWidth,g=d.borderWidth,h=a.lineJoin,i=a.lineCap,j=d.gray,k=d.pattern;a.lineJoin=d.join,a.lineCap=d.cap,b.drawPath(Ki(a,k),d);var m=c("edge.width.absolute");m&&(a.save(),a.setTransform(1,0,0,1,0,0)),f&&(a.strokeStyle=d._97o,a.lineWidth=e+2*(g+f),a.stroke()),g&&(a.strokeStyle=j?l.toGrayColor(d.borderColor):d.borderColor,a.lineWidth=e+2*g,a.stroke());var n=j?l.toGrayColor(d.color):d.color,o=j?l.toGrayColor(d._67o):d._67o;if(a.strokeStyle=n,a.lineWidth=e,a.stroke(),d.is3d&&Bf(a,n,o,e,b.gv._zoom,d._66o),m&&a.restore(),Li(a,k),c("edge.dash")){k=c("edge.dash.pattern");var p=Ki(a,k,b._2Q("edge.dash.offset"));p!==a&&b.drawPath(p,d),b._1Q(a,"edge",c("edge.dash.width")||e,k)}a.lineJoin=h,a.lineCap=i},_48O:function(){},_47O:function(a){}});var nl=function(a,b){Wd(nl,this,[a,b])};ki(nl,kl,{_3O:function(){var a,b,c=this,d=c.s,e=c._data,f=c.gv;if(c._88I=i,e.isExpanded()&&e.eachChild(function(c){if(Kd(c)){var d=f.getBoundsForGroup(c);d&&(b||(b=[]),b.push(d),a=Xh(a,d))}}),a){var g=f.getLabel(e),h=d("group.type");a=Kj(h,b,a),tj(a,e,"group.padding",1);var j=c._88I={type:h,rect:a,_64o:a};if(!h&&g!=i){var k,l=c.labelInfo={label:g,color:d("group.title.color"),font:d("group.title.font"),align:d("group.title.align")},m=we(l,g),n=m.width,o=m.height,p=d("group.title.align"),q=d("group.title.orientation");if((q===qa||q===ra)&&n>a.width?a.width=n:(q===oa||q===pa)&&n>a.height&&(a.height=n),l.rect={y:a.y-o,width:m.width,height:o},k=p===oa?a.x:p===pa?a.x+a.width-n:a.x+a.width/2-n/2,l.rect.x=k,q===ra)j.titleRect={x:a.x,y:a.y+a.height,width:a.width,height:o},j.rect={x:a.x,y:a.y,width:a.width,height:a.height+o},l.rect={x:k,y:a.y+a.height,width:n,height:o};else if(q===oa){var r=j.titleRect={x:a.x-o,y:a.y,width:o,height:a.height};j.rect={x:a.x-o,y:a.y,width:a.width+o,height:a.height},l.rect={x:r.x+o/2-a.height/2,y:r.y+a.height/2-o/2,width:a.height,height:o},l.rotation=-Math.PI/2}else if(q===pa){var r=j.titleRect={x:a.x+a.width,y:a.y,width:o,height:a.height};j.rect={x:a.x,y:a.y,width:a.width+o,height:a.height},l.rect={x:r.x+o/2-a.height/2,y:r.y+a.height/2-o/2,width:a.height,height:o},l.rotation=Math.PI/2}else j.titleRect={x:a.x,y:a.y-o,width:a.width,height:o+1},j.rect={x:a.x,y:a.y-o,width:a.width,height:a.height+o}}c._40O(j,d("group.border.width")/2)}else nl.superClass._3O.call(c)},getPosition:function(a,b,c,d){var e=this._88I;if(e){var f=bg(a,e.rect,d);return f.x+=b,f.y+=c,f}return nl.superClass.getPosition.apply(this,arguments)},_24O:function(a,b){var c=this._88I;(!c||c.type||"label2"===a)&&nl.superClass._24O.call(this,a,b)},_80o:function(a){var b=this,c=b._88I;if(c){var d=b._data,e=b.s,f=b.gv,g=c.type,h=c.rect,i=c._64o,j=c.titleRect,k=b.getBodyColor(),l=yh(e("group.image"),k),m=e("group.image.stretch"),n=b.getBodyColor("group.background"),o=yh(e("group.repeat.image"),k),p=e("group.gradient.pack"),q=e("group.gradient"),r=e("group.gradient.color"),s=e("group.border.width"),t=e("group.border.color"),u=e("group.border.pattern"),v=e("group.title.orientation"),w=e("group.depth");if(g){var x=a.lineJoin,y=a.lineCap;if(a.lineJoin=e("group.border.join"),a.lineCap=e("group.border.cap"),l){if(a.save(),Ef(a,g,h),a.clip(),Bh(a,l,m,h.x,h.y,h.width,h.height,d,f,k),a.restore(),s>0){var z=Ki(a,u);Ef(z,g,h),a.lineWidth=s,a.strokeStyle=t,a.stroke(),Li(a,u)}}else{var z=Ki(a,u);n||o||p?(Ef(a,g,h),p?xf(a,p):o?Gf(a,o,k,null,d,f):Ff(a,n,q,r,h),a.fill(),p&&a.restore(),a!==z&&Ef(z,g,h)):Ef(z,g,h),s>0&&(a.lineWidth=s,a.strokeStyle=e("group.border.color"),a.stroke()),Li(a,u),g===Da&&Lf(a,n,w,h)}a.lineJoin=x,a.lineCap=y}else{var A=e("group.title.background"),B=e("group.border.radius");if(l)Bh(a,l,m,i.x,i.y,i.width,i.height,d,f,b.getBodyColor());else if(n||o)if(o?Gf(a,o,k,null,d,f):Ff(a,n,q,r,i),0===s)Ef(a,Da,i),a.fill(),Lf(a,n,w,i);else{switch(a.beginPath(),v){case ra:Jf(a,i.x,i.y,i.width,i.height,B,B,0,0);break;case oa:Jf(a,i.x,i.y,i.width,i.height,0,B,0,B);break;case pa:Jf(a,i.x,i.y,i.width,i.height,B,0,B,0);break;case qa:Jf(a,i.x,i.y,i.width,i.height,0,0,B,B)}a.fill()}if(j&&A)if(0===s)Df(a,j.x,j.y,j.width,j.height,A),Lf(a,A,w,j);else{switch(a.beginPath(),a.fillStyle=A,v){case ra:Jf(a,j.x,j.y,j.width,j.height,0,0,B,B);break;case oa:Jf(a,j.x,j.y,j.width,j.height,B,0,B,0);break;case pa:Jf(a,j.x,j.y,j.width,j.height,0,B,0,B);break;case qa:Jf(a,j.x,j.y,j.width,j.height,B,B,0,0)}a.fill()}if(s>0){var z=Ki(a,u);if(Ef(z,"roundRect",h,B),a.lineWidth=s,a.strokeStyle=t,j&&e("group.splitLine")){var C=j.x,D=j.y,E=j.width,F=j.height;v===ra?(a.moveTo(C,D),a.lineTo(C+E,D)):v===oa?(a.moveTo(C+E,D),a.lineTo(C+E,D+F)):v===pa?(a.moveTo(C,D),a.lineTo(C,D+F)):(a.moveTo(C,D+F),a.lineTo(C+E,D+F))}a.stroke(),Li(a,u)}}b._39O(a,c)}else nl.superClass._80o.call(b,a)}});var ol=function(a,b){Wd(ol,this,[a,b])};ki(ol,kl,{_80o:function(a){this._39O(a,this._83o)}});var pl=function(a,b){Wd(pl,this,[a,b])};ki(pl,kl,{_3O:function(){var a=this,b=a._data,c=a.s,d=a.gv,e=b.getPoints(),f=d.getBorderColor(b),g=f?c("border.width"):0,h=a.getSelectWidth(),j=c("shape.border.width"),k=b.getRect(),l=b.getAnchorRect(),m=d.getBodyColor(b),n=a._99o=e.isEmpty()?i:{rect:k,rotation:b.getRotation(),fillRule:c("shape.fill.rule"),scale:b.getScale(),position:b.p(),points:e,segments:b.getSegments(),bodyColor:m,borderColor:f,borderWidth:g,_94o:c("shape.border.3d"),_95o:c("shape.border.3d.color"),_96o:c("shape.border.3d.accuracy"),_97o:h?a.getSelectColor():i,selectWidth:h,_53o:c("shape.background"),_27Q:yh(c("shape.repeat.image"),m),shapeGradientPack:c("shape.gradient.pack"),_54o:j,_55o:c("shape.border.color"),shapeGradient:c("shape.gradient"),_59o:c("shape.gradient.color"),_60o:c("shape.border.pattern"),_61o:c("shape.border.cap"),_62o:c("shape.border.join"),shapeForeground:c("shape.foreground"),gray:c("2d.gray")};if(n){l.x+=n.position.x,l.y+=n.position.y,n.gradientRect=l;var o=b.getScale(),p=E(1,E(G(o.x),G(o.y)));c("shape.dash")&&c("shape.dash.width")>j&&(j=c("shape.dash.width"));var q=j*("square"===n._61o?.71:.5)+g+h/a.gv._zoom/p;q&&(q*=p,k=Gh(k),tf(k,q,n._62o)),a._68o(k);var r=c("clip.percentage");1>r&&(0>r&&(r=0),n.clipRect=fe(b.getAnchorRect(),c("clip.direction"),r));var s=c("shape.fill.clip.percentage");1>s&&(0>s&&(s=0),n.shapeClipRect=fe(b.getAnchorRect(),c("shape.fill.clip.direction"),s));var t=c("shape.foreground.clip.percentage");1>t&&(0>t&&(t=0),n.shapeForegroundClipRect=fe(b.getAnchorRect(),c("shape.foreground.clip.direction"),t))}},getPosition:function(a,b,c,d){var e=this._99o;
if(e){var f=bg(a,e.rect,d);return f.x+=b,f.y+=c,f}return id},_42:function(a){this._99o&&pl.superClass._42.call(this,a)},_80o:function(a){var b,c=this,d=c.s,e=c._99o,f=e.position,g=e.scale,h=e.rotation,i=e.borderWidth,j=e.selectWidth/c.gv._zoom,k=e._27Q,m=e.shapeGradientPack,n=e._54o,o=e.clipRect,p=e.shapeClipRect,q=e.points,r=e.segments,s=c._data.isClosePath(),t=e.fillRule,u=e.gray,v=function(a){return u?l.toGrayColor(a):a},w=v(e._53o),x=w||k||m;a.save(),Fe(a,f.x,f.y),Ge(a,h),He(a,g.x,g.y),o&&(a.beginPath(),a.rect(o.x,o.y,o.width,o.height),a.clip()),x&&p&&(a.save(),a.beginPath(),a.rect(p.x,p.y,p.width,p.height),a.clip()),Fe(a,-f.x,-f.y);var y=e._60o,z=Ki(a,y),A=a.lineJoin,B=a.lineCap;a.lineJoin=e._62o,a.lineCap=e._61o;var C=v(e.bodyColor);x?(zf(a,q,r,s),m?xf(a,m):k?Gf(a,k,C,null,c._data,c.gv):(b=C?C:w,Ff(a,b,e.shapeGradient,v(e._59o),e.gradientRect)),a.fill(t),p&&(a.restore(),Fe(a,-f.x,-f.y)),m&&a.restore(),z!==a&&zf(z,q,r,s)):zf(z,q,r,s);var D=e.shapeForeground;if(D){a.save();var E=e.shapeForegroundClipRect;E&&(Fe(a,f.x,f.y),a.beginPath(),a.rect(E.x,E.y,E.width,E.height),a.clip(),Fe(a,-f.x,-f.y)),zf(a,q,r,s),Ff(a,D,d("shape.foreground.gradient"),v(d("shape.foreground.gradient.color")),e.gradientRect),a.fill(t),a.restore()}var F=d("shape.border.width.absolute");if(F&&(a.save(),a.setTransform(1,0,0,1,0,0)),j&&(a.strokeStyle=e._97o,a.lineWidth=n+2*(i+j),a.stroke()),i&&(a.strokeStyle=v(e.borderColor),a.lineWidth=n+2*i,a.stroke()),n&&(b=v(e._55o),!w&&C&&(b=C),a.strokeStyle=b,a.lineWidth=n,a.stroke(),e._94o&&Bf(a,b,v(e._95o),n,c.gv._zoom,e._96o)),F&&a.restore(),Li(a,y),d("shape.dash")){var G=d("shape.dash.width")||n;if(G>0){y=d("shape.dash.pattern");var z=Ki(a,y,c._2Q("shape.dash.offset"));z!==a&&zf(z,q,r,s),c._1Q(a,"shape",G,y)}}a.lineJoin=A,a.lineCap=B,a.restore()},_48O:function(){},_47O:function(a){}});var ql=function(a,b){Wd(ql,this,[a,b])};ki(ql,pl,{getRotation:function(a,b,c){a=a||0;var d=this._data.getPoints(),e=d.size();return e>1?jj[c]?e&&e%2===0?Hj(d.get(e/2-1),d.get(e/2),b,a):a:ij[c]?Hj(d.get(0),d.get(1),b,a):Hj(d.get(e-2),d.get(e-1),b,a):a},getPosition:function(a,b,c,d,e){var f=this._data.getPoints(),g=f.size();if(g>1){if(jj[a]){var h=g%2;if(0===h)return Ij(f.get(g/2-1),f.get(g/2),a,b,c,d,e);var i=f.get((g-h)/2),j={x:i.x,y:i.y,width:0,height:0};return i=bg(a,j,d),i.x+=b,i.y+=c,i}return ij[a]?Ij(f.get(0),f.get(1),a,b,c,d,e):Ij(f.get(g-2),f.get(g-1),a,b,c,d,e)}return id}});var rl=function(a,b){Wd(rl,this,[a,b])};ki(rl,kl,{_3O:function(){var a=this;rl.superClass._3O.call(a);var b=a.s,c=a._83o;a._82o=c.img||c.shape?i:{background:a.getBodyColor("grid.background"),depth:b("grid.depth"),rect:c.rect,_88o:b("grid.cell.depth"),cellBorderColor:b("grid.cell.border.color"),_89o:b("grid.row.count"),_90o:b("grid.column.count"),block:b("grid.block"),_91o:b("grid.block.color"),_92o:b("grid.block.padding"),_93o:b("grid.block.width")}},_80o:function(a){var b=this,c=b._82o;if(!c)return void rl.superClass._80o.call(b,a);var d,e,f=b._data,g=c.background,h=c.rect,i=c.block,j=c._91o,k=c._92o,l=c._93o,m=c._88o,n=c.cellBorderColor,o=c._89o,p=c._90o;if(g)if(Df(a,h.x,h.y,h.width,h.height,g),Lf(a,g,c.depth,h),m)for(d=0;o>d;d++)for(e=0;p>e;e++)h=f.getCellRect(d,e),h&&Lf(a,g,m,h);else if(n){for(a.beginPath(),d=0;o>d;d++)for(e=0;p>e;e++)h=f.getCellRect(d,e),h&&a.rect(h.x,h.y,h.width,h.height);a.strokeStyle=n,a.lineWidth=1,a.stroke()}if("h"===i)for(d=0;o>d;d++)h=Xh(f.getCellRect(d,0),f.getCellRect(d,p-1)),bi(h,k),Kf(a,j,h.x,h.y,h.width,h.height,l);else if("v"===i)for(e=0;p>e;e++)h=Xh(f.getCellRect(0,e),f.getCellRect(o-1,e)),bi(h,k),Kf(a,j,h.x,h.y,h.width,h.height,l);b._39O(a,b._83o)}});var sl=function(a,b){Wd(sl,this,[a,b])};ki(sl,kl,{_checkEmptyRect:!1,_81o:function(){var a=this._data,b=sl.superClass._81o.call(this),c=a.s("text");if(c!=i){var d,e,f=a.s("text.font"),g=a.s("text.align"),h=a.s("text.vAlign"),j=Mh(f,c),k=j.width,l=j.height,m=a.getAnchor(),n=a.getWidth(),o=a.getHeight();"left"===g?d=-n*m.x:"center"===g?d=-n*m.x+(n-k)/2:"right"===g&&(d=n*(1-m.x)-j.width),"top"===h?e=-o*m.y:"middle"===h?e=-o*m.y+(o-l)/2:"bottom"===h&&(e=o*(1-m.y)-j.height);var p,q=a.getMatrix();if(p=Wh([q.tf(d,e),q.tf(d+k,e),q.tf(d+k,e+l),q.tf(d,e+l)]),b=Xh(b,p),b&&a.s("text.shadow")){var r=Gh(b);r.x+=a.s("text.shadow.offset.x"),r.y+=a.s("text.shadow.offset.y"),bi(r,a.s("text.shadow.blur")),b=Xh(b,r)}}return b}});var tl=Lj.Interactor=function(a){this.gv=this._graphView=a};Mj("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(a){this.gv.fi(a)},setCursor:function(a){ia||this.gv.setCursor(a)},startDragging:function(a){var b=this;b._lastClientPoint=Th(a),b._lastLogicalPoint=b.gv.lp(a),ei(b,a)},clearDragging:function(a){var b=this;b._lastClientPoint=b._lastLogicalPoint=b._logicalPoint=i},autoScroll:function(a){return this.gv.autoScroll(a,this._lastClientPoint)}});var ul=i,vl=function(a){ul.handleWindowTouchMove(a)},wl=function(b){ul.handleWindowTouchEnd(b),y(a,vc,vl),y(a,wc,wl),ul=i},xl=function(a){ul.handleWindowMouseMove(a)},yl=function(b){ul.handleWindowMouseUp(b),y(a,rc,xl),y(a,sc,yl),ul=i},zl=function(b,c){b!==ul&&(ul?ia?ul.handleWindowTouchEnd(c):ul.handleWindowMouseUp(c):ia?(x(a,vc,vl),x(a,wc,wl)):(x(a,rc,xl),x(a,sc,yl)),ul=b)},Al=function(a){var b=this;b.gv=a,b._is2d=a instanceof Lj.GraphView,b._eventListeners={},b._is2d&&(b.filter=function(b){return a.isSelectable(b)&&a.isInteractive(b)}),a.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",Ac].forEach(function(a){b.addListener(a)}),b.initImageResource()};ki(Al,tl,{enableVR:function(a){var b=this;if(!!b._vrEnable!==a)if(b._vrEnable=a,a)b.gv.vr.mp(b.onVRControllerChange,b);else if(b.gv.vr.ump(b.onVRControllerChange,b),b._vrRayPolyline){var d=b.gv.dm();d.remove(b._vrRayPolyline),d.remove(b._vrRayHitPoint),b._vrRayPolyline=c,b._vrRayHitPoint=c}},onVRControllerChange:function(a){var b=this,c=a.property,d=a.newValue,e=b.gv.vr.getController(d.id),f=e.getRay();f&&("gamepad.button.trigger"===c?"down"===d._62O?b.handle_mousedown(f):b.handleWindowMouseUp(f):"gamepad.pose"===c&&(b.handle_mousemove(f),b.handleWindowMouseMove(f)))},drawVRRay:function(a,b,c){var d,e=this,f=e.gv,g=e._vrRayPolyline,h=!1;if(g)d=e._vrRayHitPoint;else{var i=f.dm();e._vrRayPolyline=g=new j.Polyline,e._vrRayHitPoint=d=new j.Node,d.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),d.setAnchor3d(.5,.5,.499);var k=.2/f.vr.measureOflength;d.s3(k,k,k),g.s("intersect",!1),d.s("intersect",!1),i.add(g),i.add(d),h=!0}if(b){var l=c.world,m=c.worldNormal,n=l.x,o=l.y,p=l.z;g.s("shape.border.color","red"),g.setPoints([{x:a.origin.x,y:a.origin.z,e:a.origin.y},{x:n,y:p,e:o}]),d.s("3d.visible",!0),d.p3(n,o,p),d.lookAtDirection([m.x,m.y,m.z],"front")}else{g.s("shape.border.color","blue");var q=new j.Math.Vector3;q.copy(a.direction).setLength(1e3/e.gv.vr.measureOflength).add(a.origin),g.setPoints([{x:a.origin.x,y:a.origin.z,e:a.origin.y},{x:q.x,y:q.z,e:q.y}]),d.s("3d.visible",!1)}f.fi({kind:"vrRayIntersect",ray:a,data:b,intersect:c,polyline:g,hitNode:d,begin:h})},setPreventEventDefault:function(a,b){var d=this,e=d._eventListeners[a];e?e._prevent=b:d._eventListeners[a]=e={_removal:c,_prevent:b}},removeListener:function(a){var b=this,d=b._eventListeners[a];d&&d._removal&&(d._removal(),d._removal=c)},addListener:function(a){var b=this,d=b._eventListeners[a];if(d||(b._eventListeners[a]=d={_removal:c,_prevent:!0}),!d||!d._removal){var e=function(c){d._prevent&&l.preventDefault(c),b.disabled||b["handle_"+a](c)};x(b.gv.getView(),a,e),d._removal=function(){y(b.gv.getView(),a,e)}}},handleWindowTouchMove:function(a){this.handleWindowMouseMove(a)},handleWindowMouseMove:function(a){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",a):(this.handleDownInfo("onBeginDrag",a),this.isDragging=!0))},handleWindowTouchEnd:function(a){this.handleWindowMouseUp(a)},handleWindowMouseUp:function(a){if(this.isDragging&&(this.handleDownInfo("onEndDrag",a),this.isDragging=!1),this.downInfo){var b=this.handle("onUp",a);if(b&&b.data===this.downInfo.data){this.handleMissingUp(a);var c=this,d=2===a.button?"onContextMenu":"onClick";if(!c._dbclickTimer)return void(c._dbclickTimer=Z(function(){delete c._dbclickTimer,c.handleClick(a,d,b),this.downInfo=i},l.clickDelay));$(c._dbclickTimer),delete c._dbclickTimer,d="onDoubleClick",c.handleClick(a,d,b)}else this.handleDownInfo("onUp",a);this.downInfo=i}},handle_mouseleave:function(a){var b=this,c=b.gv,d=b.currentInfo?b.currentInfo.data:i;if(d){d.s("onLeave")&&d.s("onLeave")(a,d,c),b.fire("data","onLeave",a,d);var e=b.currentInfo?b.currentInfo.hits:i;if(e)for(var f in e)b.handleLeave(a,f);b.currentInfo=i}},handle_mousewheel:function(a){a.scrollDelta=a.wheelDelta/40,this.handle("onScroll",a)},handle_DOMMouseScroll:function(a){a.scrollDelta=2===a.axis?-a.detail:0,this.handle("onScroll",a)},handle_touchstart:function(a){this.handle_mousedown(a)},handle_touchmove:function(a){this.handle("onMove",a)},handle_mousedown:function(a){this.isDragging&&(this.handleDownInfo("onEndDrag",a),this.isDragging=!1),this.downInfo=this.handle("onDown",a),this.downInfo&&zl(this,a)},handle_mousemove:function(a){var b=this,c=b.gv;b._hoverTimer&&($(b._hoverTimer),delete b._hoverTimer);var d,e,f,g=b.handle("onMove",a),h=this.currentInfo?this.currentInfo.data:i,j=this.currentInfo?this.currentInfo.hits:i;if(g&&(e=g.data,f=g.hits,b._hoverTimer=Z(function(){$(b._hoverTimer),delete b._hoverTimer,b.handle("onHover",a,g)},c.getHoverDelay()||l.hoverDelay)),e!==h){if(h&&(h.s("onLeave")&&h.s("onLeave")(a,h,c),this.fire("data","onLeave",a,h)),e&&(e.s("onEnter")&&e.s("onEnter")(a,e,c),this.fire("data","onEnter",a,e)),j)for(d in j)this.handleLeave(a,d);if(f)for(d in f){var k=f[d];k.target.onEnter&&k.target.onEnter(a,e,c,k.point,k.width,k.height),this.fire(k.type,"onEnter",k.event,k.data,k.image,k.comp,k.point,k)}}else{if(j)for(d in j)f&&f[d]||this.handleLeave(a,d);if(f)for(d in f)if(!j||!j[d]){var k=f[d];k.target.onEnter&&k.target.onEnter(a,e,c,k.point,k.width,k.height),this.fire(k.type,"onEnter",k.event,k.data,k.image,k.comp,k.point,k)}}this.currentInfo=g},handle:function(a,b,c){var d,e=this,f=e.gv;if(e._is2d){if(c=c||f.getDataInfoAt(b,this.filter),!c)return;if(d=c.ui.interactiveInfo){var g,h=c.data;if(h.s(a)&&h.s(a)(b,h,f),this.fire("data",a,b,h),"body"===c.part&&d.bodyInfo)g="body",c.hits=this.handleImage(g,f.getImage(h),a,b,h,c.point,d.bodyInfo);else if("icons"===c.part&&d._38o){var i=d._38o[c.name];i&&i[c.index]&&(g="icons|"+c.name+"|"+c.index,c.hits=this.handleImage(g,c.icon,a,b,h,c.point,i[c.index]))}}return c}var h,k;if(!c)if(b&&b instanceof j.Math.Ray){var l=f.vr.intersectWorld(b);if(h=l.data,k=l.intersect,e.drawVRRay(b,h,k),!h)return;var m=f.getData3dUI(h);if(d=m.interactiveInfo,!d)return;c={data:h,part:k.part,ui:m}}else{if(c=f.getDataInfoAt(b),!c)return;c&&(c={data:c.data,part:c.part})}if(f.isInteractive(c.data)){if(!k){h=c.data;var m=f.getData3dUI(h);if(c.ui=m,d=m.interactiveInfo,!d)return c;if(k=f.intersectObject(b,h),!k)return}h.s(a)&&h.s(a)(b,h,f),this.fire("data",a,b,h);var n,o=k.part;return"body"!==o&&(n=h.s(o+".image")||h.s("shape3d."+o+".image")),n||(n=h.s("all.image")||h.s("shape3d.image")),d="object"==typeof n?d[n.uuid]:d[n],d&&d.bodyInfo?(c.part="body",c.interactiveInfo=d,c.point=k.uv.multiply({x:d.bodyInfo.rect.width,y:d.bodyInfo.rect.height}),c.image=n,c.hits=this.handleImage("body",n,a,b,h,c.point,d.bodyInfo),c):c}},_handleLeaveOrMissing:function(a,b,c){var d="leave"===a?this.currentInfo:this.downInfo;if(d){var e=d.interactiveInfo||d.ui.interactiveInfo;if(e){var f,g,h=d.data;if(this._is2d){if(g=this.gv.lp(b),"body"===d.part&&e.bodyInfo)f="body","leave"===a?this.handleLeaveImage(c,f,this.gv.getImage(h),b,h,g,e.bodyInfo):this.handleMissingUpImage(f,this.gv.getImage(h),b,h,g,e.bodyInfo);else if("icons"===d.part&&e._38o){var i=e._38o[d.name];i&&i[d.index]&&(f="icons|"+d.name+"|"+d.index,"leave"===a?this.handleLeaveImage(c,f,d.icon,b,h,g,i[d.index]):this.handleMissingUpImage(f,d.icon,b,h,g,i[d.index]))}}else{if(!e.bodyInfo)return;var j=this.gv.intersectObject(b,h);g=j?j.uv.multiply({x:e.bodyInfo.rect.width,y:e.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===a?this.handleLeaveImage(c,"body",d.image,b,h,g,e.bodyInfo):this.handleMissingUpImage("body",d.image,b,h,g,e.bodyInfo)}}}},handleClick:function(a,b,c){var d=this,e=this.downInfo;if(e&&c){var f,g=c.interactiveInfo||c.ui.interactiveInfo,h=c.data,i=this.gv;if(h.s(b)&&h.s(b)(a,h,i),d.fire("data",b,a,h),g)if(this._is2d){if(e.part===c.part){var j=i.lp(a);"body"===c.part&&g.bodyInfo&&(f="body",this.handleClickImage(f,i.getImage(h),b,a,h,j,g.bodyInfo,c))}}else{if(!g.bodyInfo)return;var k=i.intersectObject(a,h);if(!k)return;j=k.uv.multiply({x:g.bodyInfo.rect.width,y:g.bodyInfo.rect.height}),this.handleClickImage("body",e.image,b,a,h,j,g.bodyInfo,c)}}},handleDownInfo:function(a,b){if(this.downInfo){var c=this.downInfo,d=this.gv,e=c.interactiveInfo||c.ui.interactiveInfo;if(e){var f,g=c.data;if(g.s(a)&&g.s(a)(b,g,d),this.fire("data",a,b,g),this._is2d){var h=d.lp(b);if("body"===c.part&&e.bodyInfo)f="body",this.handleDownInfoImage(f,d.getImage(g),a,b,g,h,e.bodyInfo);else if("icons"===c.part&&e._38o){var i=e._38o[c.name];i&&i[c.index]&&(f="icons|"+c.name+"|"+c.index,this.handleDownInfoImage(f,c.icon,a,b,g,h,i[c.index]))}}else{if(!e.bodyInfo)return;var j=d.intersectObject(b,g);if(!j)return;h=j.uv.multiply({x:e.bodyInfo.rect.width,y:e.bodyInfo.rect.height}),this.handleDownInfoImage("body",c.image,a,b,g,h,e.bodyInfo)}}}},fire:function(a,b,d,e,f,g,h,i){this.gv.fi({kind:b,type:a,event:d,data:e,image:f,comp:g,view:this.gv,point:h,width:i?i.width:c,height:i?i.height:c})},handleImage:function(a,b,d,e,f,g,h){var i={};if(b&&(b=yh(b))){var j=this.gv,k=h.rect,l=this.convertPoint(g,h);l.inRect&&(b[d]&&b[d](e,f,j,l,k.width,k.height),this.fire("image",d,e,f,b,c,l,k),i[a+"|image"]={target:b,type:"image",image:b,data:f,event:e,point:l,width:k.width,height:k.height});for(var m=h.compInfos,n=b,o=m.length-1;o>=0;o--){var p=m[o],q=p.comp;if(l=this.convertPoint(g,p,n,q,j,f),l.inRect){k=p.rect;var r=f._interactPrefix=p.prefix,s=r&&f.a(r+d)||q[d];s&&s.call(q,e,f,j,l,k.width,k.height),this.fire("comp",d,e,f,b,q,l,k),(b=k.image)&&(b[d]&&b[d](e,f,j,l,k.width,k.height),this.fire("image",d,e,f,b,c,l,k)),f._interactPrefix=null,i[a+"|"+o]={target:q,type:"comp",comp:q,image:b,data:f,event:e,point:l,width:k.width,height:k.height},b&&(i[a+"|"+o+"|image"]={target:b,type:"image",image:b,data:f,event:e,point:l,width:k.width,height:k.height})}}}return i},handleLeave:function(a,b){return this._handleLeaveOrMissing("leave",a,b)},handleMissingUp:function(a){return this._handleLeaveOrMissing("missing",a)},handleLeaveImage:function(a,b,d,e,f,g,h){if(d&&(d=yh(d))){var i=this.gv,j=h.rect,k=this.convertPoint(g,h);a===b+"|image"&&(d.onLeave&&d.onLeave(e,f,i,k,j.width,j.height),this.fire("image","onLeave",e,f,d,c,k,j));for(var l=h.compInfos,m=d,n=l.length-1;n>=0;n--){var o=l[n],p=o.comp;k=this.convertPoint(g,o,m,p,i,f),j=o.rect;var q=f._interactPrefix=o.prefix;if(a===b+"|"+n){var r=q&&f.a(q+"onLeave")||p.onLeave;r&&r.call(p,e,f,i,k,j.width,j.height),this.fire("comp","onLeave",e,f,d,p,k,j)}(d=j.image)&&a===b+"|"+n+"|image"&&(d.onLeave&&d.onLeave(e,f,i,k,j.width,j.height),this.fire("image","onLeave",e,f,d,c,k,j)),f._interactPrefix=null}}},handleMissingUpImage:function(a,b,d,e,f,g){var h="onUp",i=this.downInfo.hits;if(i&&b&&(b=yh(b))){var j=this.gv,k=g.rect,l=this.convertPoint(f,g);!l.inRect&&i[a+"|image"]&&(b[h]&&b[h](d,e,j,l,k.width,k.height),this.fire("image",h,d,e,b,c,l,k));for(var m=g.compInfos,n=b,o=m.length-1;o>=0;o--){var p=m[o],q=p.comp;if(l=this.convertPoint(f,p,n,q,j,e),!l.inRect){k=p.rect;var r=e._interactPrefix=p.prefix;if(i[a+"|"+o]){var s=r&&e.a(r+h)||q[h];s&&s.call(q,d,e,j,l,k.width,k.height),this.fire("comp",h,d,e,b,q,l,k)}(b=k.image)&&i[a+"|"+o+"|image"]&&(b[h]&&b[h](d,e,j,l,k.width,k.height),this.fire("image",h,d,e,b,c,l,k)),e._interactPrefix=null}}}},handleDownInfoImage:function(a,b,d,e,f,g,h){var i=this.downInfo.hits;if(i&&b&&(b=yh(b))){var j=this.gv,k=h.rect,l=this.convertPoint(g,h);i[a+"|image"]&&(b[d]&&b[d](e,f,j,l,k.width,k.height),this.fire("image",d,e,f,b,c,l,k));for(var m=h.compInfos,n=b,o=m.length-1;o>=0;o--){var p=m[o],q=p.comp;l=this.convertPoint(g,p,n,q,j,f),k=p.rect;var r=f._interactPrefix=p.prefix;if(i[a+"|"+o]){var s=r&&f.a(r+d)||q[d];s&&s.call(q,e,f,j,l,k.width,k.height),this.fire("comp",d,e,f,b,q,l,k)}(b=k.image)&&i[a+"|"+o+"|image"]&&(b[d]&&b[d](e,f,j,l,k.width,k.height),this.fire("image",d,e,f,b,c,l,k)),f._interactPrefix=null}}},handleClickImage:function(a,b,d,e,f,g,h,i){var j=this.downInfo.hits,k=i.hits;if(j&&b&&(b=yh(b))){var l=this.gv,m=h.rect,n=this.convertPoint(g,h);j[a+"|image"]&&(b[d]&&b[d](e,f,l,n,m.width,m.height),this.fire("image",d,e,f,b,c,n,m));for(var o=h.compInfos,p=b,q=o.length-1;q>=0;q--){var r=o[q],s=r.comp;n=this.convertPoint(g,r,p,s,l,f),m=r.rect;var t=f._interactPrefix=r.prefix;if(j[a+"|"+q]&&k[a+"|"+q]){var u=t&&f.a(t+d)||s[d];u&&u.call(s,e,f,l,n,m.width,m.height),this.fire("comp",d,e,f,b,s,n,m)}(b=m.image)&&j[a+"|"+q+"|image"]&&(b[d]&&b[d](e,f,l,n,m.width,m.height),this.fire("image",d,e,f,b,c,n,m)),f._interactPrefix=null}}},initImageResource:function(){l.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function(a,b,d,e,f,g){var h=b.rect,j=b.matrix.applyInverse(a).sub(h),k=j.x>=0&&j.y>=0&&j.x<=h.width&&j.y<=h.height;if(!k)return j;if(e&&_i(e.pixelPerfect,g,f)){var h,m=1;this._is2d?(m=f.getZoom(),h=yd(a.x,a.y,c,m)):h=yd(a.x,a.y);var n=!1,o=h.x,p=h.y,q=h.width,r=h.height,s=l.hitMaxArea,t=q*r*m*m;if(t>s){var u=Math.sqrt(s/t);m*=u}q*=m,r*=m,2>q&&(q=2),2>r&&(r=2),o*=m,p*=m;var v=pf(q,r),w=new Gg(0,-o,-p,m,m);w.append(b.matrix),f._drawForChecking=!0,e.transform=w;var x=d.comps;d.comps=[e],aj(v,d,0,0,q,r,g,self),d.comps=x,delete e.transform,f._drawForChecking=!1;try{for(var y=0,z=v.getImageData(0,0,q,r).data;y<z.length;y+=4)if(0!==z[y+3]){n=!0;break}v.restore()}catch(A){nf=i,n=!1}j.inRect=n}else j.inRect=!0;return j}});var Bl=Lj.DefaultInteractor=function(a){Wd(Bl,this,[a])};Mj("DefaultInteractor",tl,{handle_mousedown:function(a){wh(a);var b=this,c=b.gv,d=c.getDataAt(a);if(c.setFocus(a)&&!c._editing&&!c._scrolling){Qh(a)?c.handleDoubleClick(a,d):c.handleClick(a,d);var e=Oh(a);!hf()&&!e&&d&&(c.isMovable(d)||c._39Q(d))||!c.isPannable()||!Nh(a)&&!e||Sh(a)||(b._tx=c.tx(),b._ty=c.ty(),b.startDragging(a))}},handleWindowMouseUp:function(a){var b=this,c=b.gv;c._panning&&(delete c._panning,c.onPanEnded(),b.fi({kind:"endPan",event:a})),delete b._tx,delete b._ty,b.clearDragging()},handle_mousemove:function(a){var b=this,c=b.gv;b._hoverTimer&&($(b._hoverTimer),delete b._hoverTimer),b._hoverTimer=Z(function(){b.fi({kind:"hover",event:a}),$(b._hoverTimer),delete b._hoverTimer},c.getHoverDelay()||l.hoverDelay)},handle_touchmove:function(a){this.handle_mousemove(a)},handleWindowMouseMove:function(a){var b=this,c=b.gv;b.fi({kind:c._panning?"betweenPan":"beginPan",event:a}),c._panning=1;var d=Dj(c,a,b._lastClientPoint);c.setTranslate(b._tx+d.x,b._ty+d.y)},handle_mousewheel:function(a){this.gv.handleScroll(a,a.wheelDelta)},handle_DOMMouseScroll:function(a){2===a.axis&&this.gv.handleScroll(a,-a.detail)},handle_keydown:function(a){this.gv.handleKeyDown(a)}});var Cl=Lj.SelectInteractor=function(a){Wd(Cl,this,[a])};Mj("SelectInteractor",tl,{_42:function(){var a=this,b=a.gv,c=b.getZoom(),d=a.mark,e=a.div;e||(e=a.div=qe(),ve(a.getView(),e));var f={};f.x=d.x*c+b.tx(),f.y=d.y*c+b.ty(),f.width=d.width*c,f.height=d.height*c,Le(e,f),this.intersects()?(e.style.border="",e.style.background=b.getRectSelectBackground()):(e.style.background="",e.style.border="1px solid "+b.getRectSelectBorderColor())},handle_mousedown:function(a){var b=this,c=b.gv;if(b._57I=i,b.pendingClickThrough=i,!(c._editing||c._scrolling||hf()||Oh(a))){var d=c.getDataAt(a),e=c.sm();d?Sh(a)?e.co(d)?e.rs(d):e.as(d):e.co(d)?d instanceof $k&&d.isClickThroughEnabled()&&Nh(a)&&(b.pendingClickThrough=Th(a)):e.ss(d):Sh(a)||!c.isPannable()?Nh(a)&&(Sh(a)||e.cs(),c.isRectSelectable()&&(b.startDragging(a),c._77O=1)):Nh(a)&&(b._57I=Th(a))}},handle_mouseup:function(a){var b=this,c=b.gv,d=b._57I;if(d&&(Vh(d,Th(a))<=1&&c.sm().cs(),b._57I=i),b.pendingClickThrough){if(Vh(b.pendingClickThrough,Th(a))<=1){var e=c.getDataAt(a);if(e instanceof $k&&e.isClickThroughEnabled()){var f=c.getDataAt(a,function(a){var b=a.getParent()===e&&c.isSelectable(a,!0);return b});f&&(a.clickThrough=!0,c.sm().ss(f))}}b.pendingClickThrough=i}},handleWindowMouseUp:function(a){this.clear(a)},handleWindowMouseMove:function(a){var b=this,c=b.gv;b._logicalPoint=c.lp(a),b.mark?(b.fi({kind:"betweenRectSelect",event:a}),c.isPannable()&&b.autoScroll(a),b.redraw()):b.fi({kind:"beginRectSelect",event:a}),b.mark=Wh(b._lastLogicalPoint,b._logicalPoint),b.redraw()},intersects:function(){var a=this,b=a._lastLogicalPoint,c=a._logicalPoint;return b.x>c.x||b.y>c.y},clear:function(a){var b=this,c=b.gv,d=b.mark;if(b._57I=i,b.pendingClickThrough=i,b._lastLogicalPoint){if(d){if(0!==d.width&&0!==d.height){var e=c.getDatasInRect(d,b.intersects());if(!e.isEmpty()){var f=c.sm(),g=f.toSelection();e.each(function(a){f.co(a)?g.remove(a):g.add(a)}),f.ss(g)}}fi(b.div),delete b.div,delete b.mark,b.redraw(),b.fi({kind:"endRectSelect",event:a}),c.onRectSelectEnded()}b.clearDragging(),delete c._77O}},redraw:function(){var a=this;a._draw||(a._draw=1,Z(function(){a.mark&&a._42(),delete a._draw},16))}});var Dl=Lj.MoveInteractor=function(a){Wd(Dl,this,[a])};Mj("MoveInteractor",tl,{handle_mousedown:function(a){var b=this,c=b.gv;if(Nh(a)&&!c._editing&&!c._scrolling&&!hf()){var d=c.getSelectedDataAt(a);!d||c._39Q(d)&&!c.isMovable(d)?c._focusData=i:(b._data=d,c.handleMouseDown&&c.handleMouseDown(a,d),b.startDragging(a),c.isMovable(d)&&(c._moving=1))}},handleWindowMouseUp:function(a){var b=this,c=b.gv;c.handleMouseUp&&c.handleMouseUp(a,b._data),b.clear(a)},handleWindowMouseMove:function(a){var b=this,c=b._data,d=b.gv;if((!d._93O||!d._93O(a,c))&&d._moving){b._logicalPoint||b.fi({kind:"prepareMove",event:a});var e=b._logicalPoint?"betweenMove":"beginMove",f={kind:e,event:a},g=b._logicalPoint=d.lp(a);"beginMove"!==e||b._alreadyBeginTransaction||(b._alreadyBeginTransaction=!0,d.getDataModel().beginTransaction());var h=b._calcShift(e,a),i=h.x,j=h.y,k=b.gv.getMoveMode(a,c);k&&("x"===k?j=0:"y"===k?i=0:"xy"!==k&&(i=j=0)),d.moveSelection(i,j),b._lastLogicalPoint=g,b.autoScroll(a),b.fi(f)}},_calcShift:function(a,b){var c=this,d=c._logicalPoint,e=c._lastLogicalPoint,f=d.x-e.x,g=d.y-e.y;return{x:f,y:g}},clear:function(a){var b=this,c=b.gv;b._lastLogicalPoint&&(b._lastLogicalPoint=b._data=c._moving=i,b._logicalPoint&&(b.fi({kind:"endMove",event:a}),c.onMoveEnded()),b.clearDragging()),b._alreadyBeginTransaction&&(b._alreadyBeginTransaction=!1,c.getDataModel().endTransaction())}});var El=Lj.TextEditInteractor=function(a){Wd(El,this,[a]),this.init()};Mj("TextEditInteractor",tl,{init:function(){var a=this,b=this.input=h.createElement("input"),c=b.style;b.text="text",c.border="1px solid #d8d8d8",c.position="absolute",c.padding="2px 3px",c.outline="none",c.marginLeft="-90px",c.marginTop="-16px",c.backgroundColor="rgba(255,255,255, 0.9)",c.fontSize="14px",c.width="180px",c.height="32px",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.textAlign="center",c.boxSizing="border-box",x(b,"keyup",function(b){jf(b)&&a.endTextEdit()}),x(b,"focus",function(a){b.select()});var d=this.textarea=h.createElement("textarea"),e=this.wrap=h.createElement("div");e.appendChild(d),c=d.style,c.margin=0,c.padding="4px",c.overflow="hidden",c.boxSizing="border-box",c.position="absolute",c.outline="none",c.backgroundColor="transparent",c.resize="none",c.textAlign="center",c.fontSize="14px",c.border="none",c.borderWidth=0,c.width="100%",c.top="50%",c=e.style,c.boxSizing="border-box",c.margin=0,c.padding=0,c.position="absolute",c.boxShadow="0 0 13px rgba(16,142,233, 0.5)",c.border="1px solid #d8d8d8",c.backgroundColor="rgba(255,255,255, 0.9)",c.width="180px",c.marginLeft="-90px",x(d,"keydown",function(b){return(Rh()||Sh())&&jf(b)?void a.endTextEdit():void a.calculateTextareaHeight(String.fromCharCode(b.keyCode))}),x(d,"focus",function(a){d.select()});var f=function(a){a.stopPropagation()};x(b,"mousedown",f),x(b,"touchstart",f),x(d,"mousedown",f),x(d,"touchstart",f),a.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],a.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",a.handleWindowClick=function(b){var c=a._editingDOM;if(c){var d=c.getBoundingClientRect(),e=Th(b);Yh(d,e)||a.endTextEdit()}}},handle_mousedown:function(a){var b=this,c=b.gv;if(Qh(a)&&!c._editing){var d=c.getDataAt(a);if(d){var e=c.getTextEditInfo(d);e&&(this._editInfo=e,this._editTarget=d,c._editing=!0,e.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var b=this,d=b.gv,e=b._editTarget,f=b.getTargetValue(),g=b.textarea,h=b.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===f||f===c)&&(f=""),g.value=f,b._editingDOM=g,d.getView().appendChild(h),this.layoutHTML(h,e),this.calculateTextareaHeight(),Z(function(){g.focus(),x(a,"mousedown",b.handleWindowClick),x(a,"touchstart",b.handleWindowClick)},10)},handleTextEdit:function(){var b=this,d=b.gv,e=b._editTarget,f=b.getTargetValue(),g=b.input;(null===f||f===c)&&(f=""),g.value=f,b._editingDOM=g,d.getView().appendChild(g),this.layoutHTML(g,e),Z(function(){g.focus(),x(a,"mousedown",b.handleWindowClick),x(a,"touchstart",b.handleWindowClick)},10)},layoutHTML:function(a,b){var c=this.gv,d=c.getZoom();if(b instanceof j.Node){var e=b.getRect();a.style.left=(e.x+e.width/2)*d+c.tx()+"px",a.style.top=(e.y+e.height/2)*d+c.ty()+"px"}else if(b instanceof j.Edge){var f=c.getDataUI(b),e=f._6I;a.style.left=(e.x+e.width/2)*d+c.tx()+"px",a.style.top=(e.y+e.height/2)*d+c.ty()+"px"}},endTextEdit:function(){var b=this,c=b._editInfo.isMultiline?b.wrap:b.input,d=b._editInfo.isMultiline?b.textarea:b.input;b.setTargetValue(d.value),b.gv.getView().removeChild(c),b.gv._editing=!1,delete b._editingDOM,y(a,"mousedown",b.handlelick),y(a,"touchstart",b.handleWindowClick)},setTargetValue:function(a){var b=this,c=b._editTarget,d=b._editInfo,e=d.accessType,f=d.name;if(f&&e||(e="p",f="name"),"p"===e){var g=j.Default.setter(f);c[g](a)}else"a"===e?c.a(f,a):c.s(f,a)},getTargetValue:function(){var a=this,b=a._editTarget,c=a._editInfo,d=c.accessType,e=c.name;if(e&&d||(d="p",e="name"),"p"===d){var f=j.Default.getter(e);return b[f]()}return"a"===d?b.a(e):b.s(e)},createHiddenTextarea:function(){this.hiddenTextarea=h.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(b,c){if(c&&this.computedStyleCache)return this.computedStyleCache;var d=this,e=a.getComputedStyle(b),f=e.getPropertyValue("box-sizing")||e.getPropertyValue("-moz-box-sizing")||e.getPropertyValue("-webkit-box-sizing"),g=parseFloat(e.getPropertyValue("padding-bottom"))+parseFloat(e.getPropertyValue("padding-top")),h=parseFloat(e.getPropertyValue("border-bottom-width"))+parseFloat(e.getPropertyValue("border-top-width")),i=d.SIZING_STYLE.map(function(a){return a+":"+e.getPropertyValue(a)}).join(";"),j={sizingStyle:i,paddingSize:g,borderSize:h,boxSizing:f};return c&&(this.computedStyleCache=j),j},calculateTextareaHeight:function(a){a=a||"";var b=this,c=b.textarea,d=b.hiddenTextarea,e=b.wrap,f=32,g=b.calculateHTMLStyle(c,!1),h=g.paddingSize,i=g.borderSize,j=g.boxSizing,k=g.sizingStyle;d.setAttribute("style",k+";"+b.HIDDEN_TEXTAREA_STYLE),d.value=c.value+a;var l=d.scrollHeight;"border-box"===j?l+=i:"content-box"===j&&(l-=h),c.style.height=l+"px",c.style.marginTop=0-.5*l+"px",e.style.height=Math.max(l,f)+"px",e.style.marginTop=l*-.5+"px"}});var Fl=Lj.ScrollBarInteractor=function(a){Wd(Fl,this,[a])};Mj("ScrollBarInteractor",tl,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(a){var b=this.gv.getViewRect();return this._41o()&&(b.x+b.width-this.gv.lp(a).x)*this.gv.getZoom()<ph},isH:function(a){var b=this.gv.getViewRect();return this._40o()&&(b.y+b.height-this.gv.lp(a).y)*this.gv.getZoom()<ph},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(a){if(!Pe&&Nh(a)&&this.gv.isScrollBarVisible()){var b=this,c=b.isV(a),d=b.isH(a);(c||d)&&b.gv.showScrollBar(),b.gv._scrolling=c||d}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=i,this.fi({kind:"endScroll",event:a})},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this;if(b.gv.setFocus(a),wh(a),b.handle_touchmove(a),!(Ph(a)>1)&&b.gv._scrolling&&b.gv.isScrollBarVisible()){b._cp=Th(a),b._tx=b.gv.tx(),b._ty=b.gv.ty();var c=b.isV(a);c?b._state="vScroll":b._state="hScroll",ei(b,a),b.fi({kind:"beginScroll",event:a})}},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=Th(a),c=this.gv.getViewRect(),d=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-b.y)*d.height/c.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-b.x)*d.width/c.width),this.fi({kind:"betweenScroll",event:a})}});var Gl=Lj.TouchInteractor=function(a,b){b=b||{},b.selectable===c&&(b.selectable=!0),b.movable===c&&(b.movable=!0),b.pannable===c&&(b.pannable=!0),b.pinchable===c&&(b.pinchable=!0),b.editable===c&&(b.editable=!0),this.params=b,Wd(Gl,this,[a])};Mj("TouchInteractor",tl,{ms_edit:1,setUp:function(){var a=this;Gl.superClass.setUp.call(a),ia&&a.params.editable&&a.gv.setEditInteractor(a)},tearDown:function(){var a=this;Gl.superClass.tearDown.call(a),ia&&a.params.editable&&a.gv.setEditInteractor(i)},clear:function(a){var b=this,c=b.gv;c._moving&&(b.fi({kind:"endMove",event:a}),delete c._moving,c.onMoveEnded(),c.dm().endTransaction()),c._panning&&(b.fi({kind:"endPan",event:a}),delete c._panning,c.onPanEnded()),c._pinching&&(b.fi({kind:"endPinch",event:a}),delete c._pinching,c.onPinchEnded()),c._editing&&(b._46O(a),b._77I=b._node=b._edge=b._shape=b._rect=b._89I=b._index=c._editing=i),b._moving=b._panning=b._pinching=b._editing=b._57I=b._data=b._beginHistory=i,b.clearDragging()},handle_touchstart:function(a){var b=this;if(!b.gv._editing){wh(a),b._57I=i;var c=b.params,d=b.gv,e=d.sm(),f=d.getDataAt(a),g=Ph(a);if(1===g){if(Qh(a))return void d.handleDoubleClick(a,f);d.handleClick(a,f),f&&(d.handleMouseDown&&d.handleMouseDown(a,f),b._data=f),c.selectable||(f=i),f&&(e.co(f)||e.ss(f),c.editable&&d.isEditable(f)&&b._79I(a,f,!0)?(b._editing=1,b.startDragging(a)):c.movable&&d.isMovable(f)&&(b._moving=1,b.startDragging(a))),f&&d.isMovable(f)||(b._57I=Th(a),c.pannable&&d.isPannable()&&(b._panning=1,b.startDragging(a),b._translate={x:d.tx(),y:d.ty()}))}else if(c.pinchable&&2===g){if(f&&d._39Q(f))return;b._pinching=1,b.startDragging(a);var h=d.getView(),j=d.getZoom(),k=h.getBoundingClientRect(),l=a.touches[0],m=a.touches[1],n={x:(l.clientX+m.clientX)/2-k.left,y:(l.clientY+m.clientY)/2-k.top
};n.x-=d.tx(),n.y-=d.ty(),n.x/=j,n.y/=j,b._p=n,b._d=Tf(a)}}},handle_touchend:function(a){var b=this,c=b.gv,d=b._57I,e=b._data;d&&(Vh(d,Th(a))<=1&&!graphView.getDataAt(a)&&c.sm().cs(),b._57I=i),e&&c.handleMouseUp&&c.handleMouseUp(a,e)},handleWindowTouchEnd:function(a){this.clear(a)},handleWindowTouchMove:function(a){var b=this,c=b.gv,d=Ph(a);if(1===d){if(b._editing&&(b._beginHistory||(b._beginHistory=1,c.dm().beginTransaction()),c._editing=1,b._78I(a)),b._moving)b._beginHistory||(b._beginHistory=1,c.dm().beginTransaction()),b.handleMove(a);else if(b._panning){var e=Th(a),f=Dj(c,e,b._lastClientPoint);c.setTranslate(b._translate.x+f.x,b._translate.y+f.y),b.fi({kind:c._panning?"betweenPan":"beginPan",event:a}),c._panning=1}}else if(2===d&&b._pinching){var g=Tf(a);c.handlePinch(b._p,g,b._d),b._d=g,b.fi({kind:c._pinching?"betweenPinch":"beginPinch",event:a}),c._pinching=1}},handleMove:function(a){var b=this,c=b.gv,d=c.lp(a);c._93O&&c._93O(a,b._data)||(c.moveSelection(d.x-b._lastLogicalPoint.x,d.y-b._lastLogicalPoint.y),b._lastLogicalPoint=d,b.autoScroll(a),b.fi({kind:c._moving?"betweenMove":"beginMove",event:a}),c._moving=1)}});var j=a.ht,Hl=j.graph._editor={Math:j.Math,Guide:{}};Hl.getStyle=function(a){var b,d=Hl.StyleMap;return d&&(b=d[a],b!==c)?b:Hl.DefaultStyleMap[a]},Hl.setStyle=function(a,b){var c=Hl.StyleMap;c||(c=Hl.StyleMap={}),c[a]=b},Hl.inEdit=function(a){return a._inXEdit===!0},Hl.startEdit=function(a){a._inXEdit=!0,Hl.Inject.doInject(a)},Hl._46O=function(a){a._inXEdit=!1,Hl.Inject.undoInject(a)},Hl.toScreenPosition=function(a,b){var c=a.tx(),d=a.ty(),e=a._zoom;return new Hl.Math.Vector2(b.x*e+c,b.y*e+d)},Hl.checkHit=function(a,b,c){return a.distanceTo(b)<c?!0:!1},Hl.toWorldPosition=function(a,b){var c=a.tx(),d=a.ty(),e=a._zoom;return{x:(b.x-c)/e,y:(b.y-d)/e}},Hl.setAntialias=function(a,b){for(var c,d=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],e=0,f=d.length;f>e&&(c=d[e],!(c in a));e++);a[c],a[c]=b},Hl.getTargetCornersOnScreen=function(a,b){if(!b)return null;var c,d=[];if(Nd(b,a)){var e=hj(a,b);c=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}else{if(!b.getCorners)return null;c=b.getCorners()}return c.forEach(function(b){var c=Hl.toScreenPosition(a,b);d.push(c.x,c.y)}),d},Hl.log=function(){};var Il=Hl.Inject={_modules:[]};Il.registAsModule=function(a,b){var c={},d={};for(var e in a){var f=b.prototype[e];c[e]=f}a.getBackup=function(a){return c[a]},a.getBackups=function(){return c},d.doInject=function(c){for(var d in a)"getBackup"!==d&&(b.prototype[d]=a[d])},d.undoInject=function(d){for(var e in a)"getBackup"!==e&&(b.prototype[e]=c[e])},Il._modules.push(d)},Il.doInject=function(a){for(var b,c=Il._modules,d=0,e=c.length;e>d;d++)b=c[d],b.doInject(a)},Il.undoInject=function(a){for(var b,c=Il._modules,d=0,e=c.length;e>d;d++)b=c[d],b.undoInject(a)};var tl=j.graph.EditInteractor=function(a){var b=this,c=h.createElement("canvas");c.className="editCanvas",c.style.position="absolute",b._styleMap={},b._canvas=c,b._context=c.getContext("2d"),tl.superClass.constructor.call(b,a),this._editDetail=!1,Hl.setAntialias(b._context,!1),b._subModules=[new Hl.Anchor(b),new Hl.RotateX(b),new Hl.MoveDummy(b),new Hl.Rect(b),new Hl.Curve(b),new Hl.MoveHelper(b)],b._gridGuide=new Hl.Guide.Grid(b),b._rectGuide=new Hl.Guide.Rect(b),b._hoverGuide=new Hl.Guide.Hover(b)},Jl=tl;j.Default.def(tl,j.graph.Interactor,{ms_edit:1,ms_fire:1}),b.defineProperties(tl.prototype,{editDetail:{get:function(){var a=!!this._editDetail;return a},set:function(a){var b=this,c=b._editDetail;c!==a&&(b._editDetail=a,b.gv._editing=a,b.fp("editDetail",c,a),b.fp("pointsEditingMode",c,a),b.fi({kind:a?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(a){(!this._editDetail||a)&&(this.gv._editing=a,a||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(a){this._editing=a,this.gvEditing=a}},pointsEditingMode:{get:function(){return this.editDetail},set:function(a){var b=this;b.editDetail!==a&&(a?b._tryEnterEditDetailMode():b._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var a=this._gridEnabled;if(!a)return!1;var b=this.gv;return b?!0:!0},set:function(a){a!==this._gridEnabled&&(this._gridEnabled=a,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(a){a!==this._agEnabled&&(this._agEnabled=a,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),tl.prototype.getSubModule=function(a){var b,c,d,e=this._subModules;for(c=0,d=e.length;d>c;c++)if(b=e[c],b.catalog===a)return b},tl.prototype.invokeSubModule=function(a,b){var d=this,e=d._subModules;if(e)for(var f,g,h,i=Array.prototype.slice.call(arguments,2),j=0,k=e.length;k>j;j++)if(f=e[j],g=f[a],g&&(h=g.apply(f,i),h!=c&&b))return f},tl.prototype.invokeSubModuleInverse=function(a,b){var d=this,e=d._subModules;if(e)for(var f,g,h,i=Array.prototype.slice.call(arguments,2),j=e.length-1;j>=0;j--)if(f=e[j],g=f[a],g&&(h=g.apply(f,i),h!=c&&b))return f},tl.prototype.setUp=function(){Hl.log("setUp");var a=this,b=a.gv,c=b.getView(),d=a._canvas;tl.superClass.setUp.call(a),b.setEditInteractor(a),b._79O?c.insertBefore(d,b._79O):c.appendChild(d),Hl.startEdit(b),a.invokeSubModule("setUp"),b.dm().mm(a._onDataModelChanged,a),b.dm().md(a._onDataPropertyChanged,a)},tl.prototype.tearDown=function(){Hl.log("tearDown");var a=this,b=a.gv,c=b.getView();a._resetCustomCursorStyle(),tl.superClass.tearDown.call(a),b.dm().umm(a._onDataModelChanged,a),b.dm().umd(a._onDataPropertyChanged,a),b.setEditInteractor(null),c.removeChild(a._canvas),a._drawTimer&&($(a._drawTimer),a._drawTimer=null),Hl._46O(b),a.invokeSubModule("tearDown")},tl.prototype._onDataModelChanged=function(a){var b=this;("clear"===a.kind||"remove"===a.kind&&b.editDetail&&a.data===b.getSubModule("Curve").target)&&(b.editDetail=!1,b._42())},tl.prototype._onDataPropertyChanged=function(a){var b=this;if(b.editDetail){var c=b.getSubModule("Curve"),d=a.data;d===c.target&&(d._writing||c._handleDataChanged(a))}},tl.prototype.clear=function(){Hl.log("clear")},tl.prototype.redraw=function(){this._42()},tl.prototype._42=function(){var a=this;a._drawTimer||(a._drawTimer=Z(function(){a._drawTimer=null,a.drawImpl()},0))},tl.prototype.drawImpl=function(){var b;for(b in{_42:!0})break;return function(){var c=this,d=c._canvas,e=c.gv,f=e.getWidth(),g=e.getHeight(),h=c._context,i=j.Default.getInternal(),k=a.devicePixelRatio;(d.width!==f||d.height!==g)&&i.setCanvas(d,f,g,k),h.clearRect(0,0,d.width,d.height);var l=c._getValidSelection();h.save(),h.scale(k,k),c._gridGuide._42(),c.invokeSubModuleInverse(b,!1,h,e,l),c._rectGuide._42(),c._hoverGuide._42(),h.restore()}}(),tl.prototype._getValidSelection=function(){var a=this,b=a.gv,c=b.sm().getSelection(),d=[];return c.each(function(a){b.isVisible(a)&&b.isEditable(a)&&d.push(a)}),d},tl.prototype.handle_touchmove=function(a){return this.handle_mousemove(a)},tl.prototype.handle_mousemove=function(a){if(!j.Default.isDragging()){var b=this;if((b.editDetail||!hf()&&!Oh(a))&&!b.gv._externalEditing)if(b.gvEditing=!1,b._checkEdit(a))b.gvEditing=!0;else{if(!b.getStyle("hoverGuideVisible"))return;b.hoverData=b.gv.getDataAt(a),b._42()}}},tl.prototype.handle_touchstart=function(a){return this.handle_mousedown(a)},tl.prototype.handle_mousedown=function(a){wh(a);var b=this;if((b.editDetail||!hf()&&!Oh(a))&&!b.gv._externalEditing){if(Qh(a)&&!a.clickThrough){if(b.editDetail){if(b._tryQuitEditDetailMode(a))return}else if(b._tryEnterEditDetailMode())return;b.gv.dm().beginTransaction();var c=b.invokeSubModule("handleDoubleClick",!0,a);if(b.gv.dm().endTransaction(),c)return}var d=b._checkEdit(a);d&&(b._downPosition=b._getLogicalPoint(a),b.gv.dm().beginTransaction(),d.startEdit(b,a),b.editing=!0)}},tl.prototype._checkEdit=function(a){var b=this,c=b.gv,d=b._getLogicalPoint(a),e=b.invokeSubModule("check",!0,c,a,d)||null;return b._editMod=e,e},tl.prototype.handleWindowTouchMove=function(a){return this.handleWindowMouseMove(a)},tl.prototype.handleWindowMouseMove=function(a){var b=this,c=b._downPosition;if(c){var d=b._getLogicalPoint(a);if(d.distanceTo(c)<b.getStyle("moveSensitivity"))return;delete b._downPosition}var e=b._editMod;e&&e.handleEdit(b.gv,a)},tl.prototype._getLogicalPoint=function(a){var b=this,c=j.Default.getLogicalPoint(a,b._canvas);return new Hl.Math.Vector2(c)},tl.prototype.handleWindowTouchEnd=function(a){return this.handleWindowMouseUp(a)},tl.prototype.handleWindowMouseUp=function(a){var b;for(b in{_46O:!0})break;return function(a){var c=this;c.editing=!1,c.setCursor("default"),c.invokeSubModule(b,!1,a),c._42(),c.gv.dm().endTransaction()}}(),tl.prototype.handle_mousewheel=function(a){var b=this;wh(a),b.invokeSubModule("preHandleScroll",!0)||b.gv.handleScroll(a,a.wheelDelta)},tl.prototype.handleDelete=function(){var a=this;if(!a.editDetail){a.gv.dm().beginTransaction();var b=a.invokeSubModule("handleNormalStateDelete",!0);return a.gv.dm().endTransaction(),void(b||a.gv.removeSelection())}a.gv.dm().beginTransaction(),a.invokeSubModule("handleDelete",!0),a.gv.dm().endTransaction(),a._42()},tl.prototype.handle_keydown=function(a){var b=this;if((a.metaKey||a.ctrlKey)&&b._42(),hf(a)&&!b.editing)return b.gvEditing=!1,b.setCursor("default"),void b._42();var c=jf(a);return b.editDetail?((c||kf(a))&&(b.editDetail=!1,b._42()),b.gv.dm().beginTransaction(),b.invokeSubModule("handle_keydown",!0,a),void b.gv.dm().endTransaction()):(b.gv.dm().beginTransaction(),b.invokeSubModule("handleNormalStateKeyDown",!0,a),b.gv.dm().endTransaction(),void(c&&b._tryEnterEditDetailMode()))},tl.prototype.handle_keyup=function(a){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,a),this.gv.dm().endTransaction()},tl.prototype._tryEnterEditDetailMode=function(){var a=this;return!a.editDetail&&a.invokeSubModule("canEnterEditDetailMode",!0)&&1===a._getValidSelection().length?(a.editDetail=!0,a._42(),!0):void 0},tl.prototype._tryQuitEditDetailMode=function(a){var b=this;return!b.editDetail||a&&!b.invokeSubModule("canQuitEditDetailMode",!0,a)?!1:(b.editDetail=!1,b._42(),!0)},tl.prototype.setStyle=function(a,b,c){var d=this;c?Hl.setStyle(a,b):d._styleMap[a]=b,"baseColor"===a&&(Tl=b),d.fp("styleChanged",null,{key:a,value:b,base:c}),d._42()},tl.prototype.getStyle=function(a,b){var d=this,e=d._styleMap[a];return e!==c?e:Hl.getStyle(a)},tl.prototype.setCursor=function(a){this._resetCustomCursorStyle(),j.graph.EditInteractor.superClass.setCursor.call(this,a)},tl.prototype._resetCustomCursorStyle=function(){var a=this;if(a._customStyle){var b=this.gv.getView();b.classList&&b.classList.remove&&b.classList.remove(a._customStyle),a._customStyle=null}},tl.prototype._setRotateCursor=function(a){var b=this,c=b._cursorFactory;c||(c=b._cursorFactory=new Hl.CursorFactory(b));var d=c.getRotateCursor(a),e=b.gv.getView();b._resetCustomCursorStyle(),b._customStyle=d,e.classList&&e.classList.add&&e.classList.add(d)};var Kl=Hl.Group=function(a){var b=this;b._entities=a,b._64O=0,b._position={x:0,y:0},b._scale={x:1,y:1},b._anchor={x:.5,y:.5},b._anchor2={x:.5,y:.5}};Kl.prototype={},Kl.prototype.constructor=Kl;var Ll=null;Kl.findOrCreateGroup=function(a){if(Ll&&Ll.checkIsMe(a))return Ll;var b=new Hl.Group(a);return b.getKeyOb()?(Ll=b,b):void 0},Kl.prototype.checkIsMe=function(a){var b=this._entities;if(b.length!==a.length)return!1;var c,d={},e=a.length;for(c=0;e>c;c++)d[a[c]._id]=!0;for(c=0;e>c;c++)if(!d[b[c]._id])return!1;return!0},Kl.prototype.getRotation=function(){return this._64O},Kl.prototype.getPosition=function(){return this._position},Kl.prototype.getAnchor=function(){return this._anchor},Kl.prototype.getWidth=function(){return this._width},Kl.prototype.getScale=function(){return this._scale},Kl.prototype.getSize=function(){return{width:this._width,height:this._height}},Kl.prototype.getHeight=function(){return this._height},Kl.prototype.getKeyOb=function(){for(var a=this._entities,b=a.length-1;b>=0;b--){var c=a[b];if(this.isNode(c))return c}},Kl.prototype.getAnchor2=function(){var a=this,b=a.rotateCenter;if(b)return b;var c=a.getKeyOb();if(!c)return a._anchor;var d=a._anchor2,e=c.getMatrix();return e.tf({x:c.getWidth()*(d.x-c.getAnchor().x),y:c.getHeight()*(d.y-c.getAnchor().y)})},Kl.prototype.setAnchor2=function(a,b){var c=this,d=c.getKeyOb();if(d){var e,f=d.getMatrix();e="number"==typeof a?{x:a,y:b}:a;var g=f.tfi(e);c._anchor2={x:d.getAnchor().x+g.x/d.getWidth(),y:d.getAnchor().y+g.y/d.getHeight()}}},Kl.prototype.setRotation=function(a){},Kl.prototype.beginRotate=function(a){this.rotateCenter=a.pos,this.rotateMode=a.groupRotateMode},Kl.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Kl.prototype.addRotation=function(a,b){return"batch"===b?this._addRotationInBatchMode(a):"block"===b?this._addRotationInBlockMode(a):void 0},Kl.prototype._addRotationInBlockMode=function(a){var b=this,c=b.rotateCenter||b.getPosition();b._entities.forEach(function(d){if(b.isNode(d)){var e=d.getMatrix();e.translate(-c.x,-c.y),e.rotate(a),e.translate(c.x,c.y);var f=Math.sign(d.getScale().x);d.setRotation(Q(e.b*f,e.a*f)),d.setPosition(e.tx,e.ty)}})},Kl.prototype._addRotationInBatchMode=function(a){var b=this,c=b._anchor2;b._entities.forEach(function(d){if(b.isNode(d)){var e=d.getAnchor(),f=d.getMatrix(),g=f.tf({x:d.getWidth()*(c.x-e.x),y:d.getHeight()*(c.y-e.y)}),h=new Hl.Math.Matrix2d;h.set(f.a,f.b,f.c,f.d,f.tx,f.ty),h.translate(-g.x,-g.y),h.rotate(a),h.translate(g.x,g.y);var i=Math.sign(d.getScale().x);d.setRotation(Q(h.b*i,h.a*i)),d.setPosition(h.tx,h.ty)}})},Kl.prototype.setPosition=function(a){var b,c,d,e,f=this,g=f._position,h=a.x-g.x,i=a.y-g.y,j=f._entities;for(c=0,d=j.length;d>c;c++)b=j[c],Kd(b)&&(e=b.getPosition(),b.setPosition(e.x+h,e.y+i));f._position=a},Kl.prototype.setScale=function(a,b){var c=this,d=a/c._scale.x,e=b/c._scale.y;c._adjustChildScaleOrSize(d,e,"size"),c._scale={x:a,y:b}},Kl.prototype.getRect=function(){var a=this,b=a._position,c=a._width,d=a._height;return{x:b.x-c/2,y:b.y-d/2,width:c,height:d}},Kl.prototype.setSize=function(a,b){var c=this,a=Math.max(1,a),b=Math.max(1,b),d=a/c._width,e=b/c._height;c._adjustChildScaleOrSize(d,e,"size"),c._width=a,c._height=b},Kl.prototype._adjustChildScaleOrSize=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r=this,s=r._position,t=r._entities,u=new Hl.Math.Matrix2d;for(e=0,f=t.length;f>e;e++)if(d=t[e],r.isNode(d)){if(g=d.getPosition(),h=d.getRotation(),i=d.getWidth(),j=d.getHeight(),k=d.getScale(),n=k.x*i,o=k.y*j,u.identity().scale(n,o).rotate(h).translate(g.x,g.y).translate(-s.x,-s.y).rotate(-r._64O),h=Q(u.b*Math.sign(n),u.a*Math.sign(n)),u.scale(a,b),l=Math.cos(h),m=Math.sin(h),Math.abs(l)<.001?(p=u.b/m,q=-u.c/m):(p=u.a/l,q=u.d/l),"scale"===c)d.setScale(p/i,q/j);else if("size"===c){var v=p/k.x,w=q/k.y;d.setScale(_d(p)*Math.abs(k.x),_d(q)*Math.abs(k.y)),d.setSize(Math.max(.1,Math.abs(v)),Math.max(.1,Math.abs(w)))}u.rotate(r._64O).translate(s.x,s.y),d.setPosition(u.tx,u.ty)}},Kl.prototype.getMatrix=function(){var a=this,b=a._position,c=j.Default.getInternal(),d=a._scale;return new c.Mat(a._64O,b.x,b.y,d.x,d.y)},Kl.prototype.toGlobal=function(a){return this.getMatrix().tf(a)},Kl.prototype.getCorners=function(){var a=this,b=a._width,c=a._height,d=a._anchor,e=-b*d.x,f=-c*d.y,g=a.getMatrix();return[g.tf(e,f),g.tf(e,f+c),g.tf(e+b,f+c),g.tf(e+b,f)]},Kl.prototype.calcInfo=function(){var a,b,c,d,e,f,g=this,h=[],i=g._entities,j=g._64O;for(d=0,e=i.length;e>d;d++)f=i[d],g.isNode(f)&&f.getCorners&&h.push.apply(h,f.getCorners());if(h.length){var k=Math.cos(-j),l=Math.sin(-j),m=1/0,n=-(1/0),o=1/0,p=-(1/0);for(d=0,e=h.length;e>d;d++)c=h[d],a=c.x,b=c.y,c.x=k*a-l*b,c.y=l*a+k*b,m=Math.min(m,c.x),n=Math.max(n,c.x),o=Math.min(o,c.y),p=Math.max(p,c.y);g._width=(n-m)/g._scale.x,g._height=(p-o)/g._scale.y,k=Math.cos(j),l=Math.sin(j);var q=g._anchor;a=m+(n-m)*q.x,b=o+(p-o)*q.y,g._position={x:k*a-l*b,y:l*a+k*b}}},Kl.prototype.isNode=function(a){return Kd(a)?Nd(a)?!1:!0:!1},Kl.prototype._42=function(a,b,c){var d,e,f,g,h,i,j,k,l=this,m=l._entities,n=l.rotateMode;for("batch"===n&&(k=l.getKeyOb()),d=0,e=m.length;e>d;d++)f=m[d],l.isNode(f)&&(i=f.getRect(),g=Hl.toScreenPosition(c,{x:i.x,y:i.y}),h=Hl.toScreenPosition(c,{x:i.x+i.width,y:i.y+i.height}),j={min:g,max:h},f===k&&(j.isKeyOb=!0),Hl.Icons.DrawIcon(a,b,Hl.Icons.GroupSubEntityRect,j))};var Ml=Hl.CurveActiving=function(a,b){this._curve=a,this._interactor=a._interactor;for(var c in b)this[c]=b[c]};Ml.prototype={},Ml.prototype.constructor=Ml,b.defineProperties(Ml.prototype,{point:{get:function(){return this._point},set:function(a){var b=this;b._point=a,b.editingCtrl||b._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(a){var b=this;b._pairs=a,b.editingCtrl&&b._firePointChange()}}}),Ml.prototype._firePointChange=function(){var a=this,b=a.getCurrentEditingPoint(),d=a._interactor;if(!b)return void d.fi({kind:"selectPoint"});var e=this._curve.target;if(e){var f=Hl.getDataMatrix(e).invert(),g=b.e;b=f.apply(Hl.toWorldPosition(d.gv,b)),b.e=g;var h=a._lastFirePoint;h&&Math.abs(b.x-h.x)<1e-5&&Math.abs(b.y-h.y)<1e-5&&(b.e==c&&h.e==c||Math.abs(b.e-h.e)<1e-5)||(a._lastFirePoint=b,d.fi({kind:"selectPoint",x:b.x,y:b.y,e:b.e}))}},Ml.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},Ml.prototype.getCurrentEditingPoint=function(){var a=this,b=a.editingCtrl;if(b){var c=a.pairs;if(c){var d=c[b.pairId],e=d[b.type];if(e)return e}}return a._point};var Nl=Hl.CursorFactory=function(a){var b=this;b._interactor=a,b._rotateCursorStyles={}};Nl.prototype={},Nl.prototype.constructor=Nl,Nl.prototype.getRotateCursor=function(a){var b=this;0>a&&(a+=2*Math.PI);var c=b._interactor,d=c.getStyle("rotateCursorSize"),e=c.getStyle("rotateCursorRound"),f=Math.round(a/Math.PI*180/e);f*e>=360&&(f=0);var g=b._rotateCursorStyles,h="htCustomRotateStyle_"+d+"_"+e+"_"+f;return g[h]||(b._produceRotateCursor(h,d,e,f),g[h]=!0),h},Nl.prototype._produceRotateCursor=function(a,b,c,d){var e=this,f=(e._interactor,e._canvas);f||(f=e._canvas=h.createElement("canvas")),f.width=f.height=b*devicePixelRatio,f.style.width=f.style.height=b+" px";var g=f.getContext("2d");Hl.setAntialias(g,!1),g.scale(devicePixelRatio,devicePixelRatio);var i,j,k,l,m,n=Math.round(b/2),o=""+n+" "+n+",auto !important;";i=Math.PI/180*d*c,g.clearRect(0,0,b,b),g.save(),g.scale(b/32,b/32),g.translate(16,16),g.rotate(i+Math.PI/2),g.beginPath(),g.moveTo(-8,0),g.lineTo(-8,3),g.lineTo(-5,3),g.moveTo(8,0),g.lineTo(8,3),g.lineTo(5,3),g.moveTo(-8,3),g.quadraticCurveTo(0,-6,8,3),g.restore(),g.strokeStyle="white",g.lineWidth=4,g.stroke(),g.strokeStyle="black",g.lineWidth=2,g.stroke(),j=JSON.stringify(f.toDataURL()),l="cursor:url("+j+")"+o,1!==devicePixelRatio&&(k='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+b+'px" height="'+b+'px"><image xlink:href='+j+' width="'+b+'" height="'+b+'"/></svg>',l+="cursor:url(data:image/svg+xml;base64,"+btoa(k)+")"+o,l+="cursor:-webkit-image-set(url("+j+")"+devicePixelRatio+"x,url("+j+")1x)"+o),m=h.createElement("style"),m.textContent="body."+a+" *, ."+a+"{"+l+"}",h.head.appendChild(m)};var _k=Hl.Guide.Grid=function(a){var b=this;b._interactor=a,b._alignmentGuideId=0,b._xAlignmentGuide=[],b._yAlignmentGuide=[]};_k.prototype={},_k.prototype.constructor=_k,b.defineProperties(_k.prototype,{gridBlockSize:{get:function(){var a=this;return a._gridBlockSize||a._interactor.getStyle("gridBlockSize")},set:function(a){this._gridBlockSize=a,this._interactor._42()}},gridThickLinesEvery:{get:function(){var a=this;return a._gridThickLinesEvery||a._interactor.getStyle("gridThickLinesEvery")},set:function(a){this._gridThickLinesEvery=a,this._interactor._42()}},gridEnabled:{get:function(){var a=this,b=a._interactor;return b.gridEnabled&&a.isValidGrid()}}}),_k.prototype._42=function(){var a=this,b=a._interactor;a.gridEnabled&&a.drawGrid(),b.alignmentGuideEnabled&&a.drawAlignmentGuide()},_k.prototype.makeMatrix=function(){var a=this,b=a._interactor.getStyle("gridAngle"),c=a._interactor.getStyle("gridRotation"),d=new Hl.Math.Matrix2d,e=Math.sin(b),f=Math.cos(b);return d.set(1,0,f,e,0,0),d.rotate(c),d},_k.prototype.isValidGrid=function(){var a=this,b=Math.PI,c=a._interactor,d=c.gv;if(d._zoom<c.getStyle("gridZoomThreshold"))return!1;var e=c.getStyle("gridAngle"),f=Math.abs(e%b/b*180),g=1-1e-8;return g>f||f>180-g?!1:!0},_k.prototype.drawAlignmentGuide=function(){var a=this,b=a._interactor,c=b.gv,d=b._canvas,e=b._context,f=d.width,g=d.height,h=c.tx(),i=c.ty(),j=c._zoom;e.beginPath(),e.strokeStyle=b.getStyle("gridAlignmentGuideColor"),e.lineWidth=1,a._xAlignmentGuide.forEach(function(a){var b=a.p*j+h;e.moveTo(b,0),e.lineTo(b,g)}),a._yAlignmentGuide.forEach(function(a){var b=a.p*j+i;e.moveTo(0,b),e.lineTo(f,b)}),e.stroke()},_k.prototype.drawGrid=function(){function a(a,b,c,d){var e=Hl.toScreenPosition(h,m.apply({x:a,y:b})),f=Hl.toScreenPosition(h,m.apply({x:c,y:d}));j.moveTo(e.x,e.y),j.lineTo(f.x,f.y)}var b=this,c=b._interactor,d=b.gridBlockSize,e=b.gridThickLinesEvery,f=c.getStyle("gridThickColor"),g=c.getStyle("gridLightColor"),h=c.gv,i=c._canvas,j=c._context,k=i.width,l=i.height,m=b.makeMatrix(),n=m.applyInverse(Hl.toWorldPosition(h,{x:0,y:0})),o=m.applyInverse(Hl.toWorldPosition(h,{x:k,y:0})),p=m.applyInverse(Hl.toWorldPosition(h,{x:0,y:l})),q=m.applyInverse(Hl.toWorldPosition(h,{x:k,y:l})),r=Math.min(n.x,o.x,p.x,q.x),s=Math.max(n.x,o.x,p.x,q.x),t=Math.min(n.y,o.y,p.y,q.y),u=Math.max(n.y,o.y,p.y,q.y);k=s-r,l=u-t;var v,w,x,y=Math.ceil(r/d),z=Math.floor(s/d),A=Math.ceil(t/d),B=Math.floor(u/d);for(h.tx(),h.ty(),h._zoom,j.save(),j.lineWidth=1,j.beginPath(),j.strokeStyle=f,x=Math.ceil(y/e)*e;z>=x;x+=e)v=x*d,a(v,t,v,u);for(x=Math.ceil(A/e)*e;B>=x;x+=e)w=x*d,a(r,w,s,w);for(j.stroke(),j.beginPath(),j.strokeStyle=g,x=y;z>=x;x++)x%e!==0&&(v=x*d,a(v,t,v,u));for(x=A;B>=x;x++)x%e!==0&&(w=x*d,a(r,w,s,w));j.stroke(),j.restore()},_k.prototype.getAlignmentGuides=function(){var a=this;return{x:a._xAlignmentGuide,y:a._yAlignmentGuide}},_k.prototype.addAlignmentGuide=function(a,b,c){var d=this,e="x"===a?d._xAlignmentGuide:d._yAlignmentGuide,c=c?c:++d._alignmentGuideId,f={p:b,id:c};if(e.length){var g=d._findClosestAlignmentGuide(f.p,e);g.dis<0?e.splice(g.index+1,0,f):e.splice(g.index,0,f)}else e.push(f);return d._interactor._42(),c},_k.prototype.findClosest=function(a,b,c){var d=this,e=d._interactor,f=e.gv;c&&(a=Hl.toWorldPosition(f,a));var g,h,i,j=1/0,k=1/0,l=a.x,m=a.y;if(d.gridEnabled){var n=d.gridBlockSize,o=d.makeMatrix(),p=o.applyInverse(a);p=o.apply({x:Math.round(p.x/n)*n,y:Math.round(p.y/n)*n}),j=p.x-l,k=p.y-m,i=!0}if(e.alignmentGuideEnabled&&(g=d._findClosestAlignmentGuide(l,d._xAlignmentGuide).dis,h=d._findClosestAlignmentGuide(m,d._yAlignmentGuide).dis,Math.abs(g)<Math.abs(j)&&(j=g,i=!0),Math.abs(h)<Math.abs(k)&&(k=h,i=!0)),i){i=!1;var q=f._zoom,r=e.getStyle("smartGuideThreshold")/q,s={};if(Math.abs(j)<r&&"y"!==b&&(s.x=c?j*q:j,i=!0),Math.abs(k)<r&&"x"!==b&&(s.y=c?k*q:k,i=!0),i)return s}},_k.prototype._findClosestAlignmentGuide=function(a,b){if(!b.length)return{dis:1/0};for(var c,d=0,e=b.length-1;e-d>1;)c=Math.floor((d+e)/2),b[c].p<a?d=c:e=c;var f=b[d].p-a,g=b[e].p-a;return Math.abs(f)<=Math.abs(g)?{line:b[d],dis:f,index:d}:{line:b[e],dis:g,index:e}},_k.prototype.removeAllAlignmentGuide=function(a){var b=this;"y"!==a&&(b._xAlignmentGuide=[]),"x"!==a&&(b._yAlignmentGuide=[]),b._interactor._42()},_k.prototype.removeAlignmentGuide=function(a){for(var b,c,d,e=this,f=e._xAlignmentGuide,g=0;2>g;g++)for(f=0===g?e._xAlignmentGuide:e._yAlignmentGuide,b=0,c=f.length;c>b;b++)if(d=f[b],d.id===a)return f.splice(b,1),e._interactor._42(),{axis:0===g?"x":"y",position:d.p};return!1},_k.prototype.adjustAlignmentGuide=function(a,b){var c=this,d=c.removeAlignmentGuide(a);return d?(c.addAlignmentGuide(d.axis,b,a),!0):!1};var Ol=Hl.Guide.Rect=function(a){var b=this;b._interactor=a};Ol.prototype={},Ol.prototype.constructor=Ol,Ol.prototype.gatherRects=function(){var a,b,c,d,e=this,f=e._interactor.gv,g=[],h=[],i={x:g,y:h},j={},k=f.getDataModel(),l=k.a("width"),m=k.a("height");l&&m&&(a=0,b=0,c=l,d=m,g.push({node:k,type:0,p:a},{node:k,type:1,p:a+c/2},{node:k,type:2,p:a+c}),h.push({node:k,type:0,p:b},{node:k,type:1,p:b+d/2},{node:k,type:2,p:b+d}),j[k._id||0]={x:a,y:b,width:c,height:d}),k.each(function(e){if(Kd(e)&&!f.isSelected(e)&&f.isVisible(e)&&f.isValidGuideLineSource(e)){var i=!1;if(f.sm().getSelection().each(function(a){i||(e.isHostOn(a)?i=!0:e.isDescendantOf(a)&&(i=!0))}),!i){var k=e.getRect();a=k.x,b=k.y,c=k.width,d=k.height,g.push({node:e,type:0,p:a},{node:e,type:1,p:a+c/2},{node:e,type:2,p:a+c}),h.push({node:e,type:0,p:b},{node:e,type:1,p:b+d/2},{node:e,type:2,p:b+d}),j[e._id]=k}}}),g.sort(function(a,b){return a.p-b.p}),h.sort(function(a,b){return a.p-b.p}),e._grid=i,e._87I=j},Ol.prototype.gatherLines=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=[p.findClosest({x:a.x,y:a.y},b),p.findClosest({x:a.x+a.w/2,y:a.y+a.h/2},b),p.findClosest({x:a.x+a.w,y:a.y+a.h},b)],r={},s=p._87I;c=c||255;var t,u;for(p._guideLine=[],d=0;2>d;d++)for(r={},0===d?(g="y",k=a.x,l=k+a.w):(g="x",k=a.y,l=k+a.h),e=0;3>e;e++)h=q[e],h&&isFinite(h[g])&&(t=1<<3*d+e,c&t&&(i=h[g+"Line"],j=i.node,u=j._id||0,r[u]||(r[u]=!0,o=s[u],"y"===g?(m=o.x,n=o.x+o.width):(m=o.y,n=o.y+o.height),f=i.p,p._guideLine.push({type:g,a:k,b:l,c:m,d:n,p:f,center:1===i.type}))))},Ol.prototype._binarySearchClosest=function(a,b){if(!b.length)return{dis:1/0};for(var c,d=0,e=b.length-1;e-d>1;)c=Math.floor((d+e)/2),b[c].p<a?d=c:e=c;var f=b[d].p-a,g=b[e].p-a;return Math.abs(f)<=Math.abs(g)?{line:b[d],dis:f}:{line:b[e],dis:g}},Ol.prototype.findClosest=function(a,b,c){var d=this,e=d._interactor,f=e.gv,g=d._grid;c&&(a=Hl.toWorldPosition(f,a));var h,i=d._binarySearchClosest(a.x,g.x),j=d._binarySearchClosest(a.y,g.y),k=i.dis,l=j.dis,m=f._zoom,n=e.getStyle("smartGuideThreshold")/m,o={};return Math.abs(k)<n&&"y"!==b&&(o.x=c?k*m:k,o.xLine=i.line,h=!0),Math.abs(l)<n&&"x"!==b&&(o.y=c?l*m:l,o.yLine=j.line,h=!0),h?o:void 0},Ol.prototype._42=function(){var a=this,b=a._guideLine;if(b&&!j.Default.isCtrlDown()){var c=a._interactor;if(c.getStyle("guideLineVisible")){var d,e,f,g,h,i,k,l,m,n,o,p,q,r,s,t,u,v=c.gv,w=c._context,x=v.tx(),y=v.ty(),z=v._zoom,A=c.getStyle("guideLineTextSpacing");for(d=0,e=b.length;e>d;d++)f=b[d],l=f.type,m=f.p,n=f.a,o=f.b,p=f.c,q=f.d,r=Math.min(n,p),s=Math.max(o,q),"x"===l?(g=m*z+x,h=r*z+y,i=g,k=s*z+y):(g=r*z+x,h=m*z+y,i=s*z+x,k=h),Hl.Icons.DrawIcon(c,w,Hl.Icons.MoveLineGuide,{rect:[g,h,i,k],center:f.center}),q>=n&&o>=p||(r=n>q?q:o,s=n>q?n:p,u=s-r,"x"===l?(f.center2center||(g-=A,i=g),h=r*z+y,k=s*z+y,t=Hl.Icons.MoveLineGuideDistanceV):"y"===l&&(f.center2center||(h-=A,k=h),g=r*z+x,i=s*z+x,t=Hl.Icons.MoveLineGuideDistanceH),Hl.Icons.DrawIcon(c,w,t,{x0:g,y0:h,x1:i,y1:k,dis:u}))}}},Ol.prototype.clear=function(){this._guideLine=null};var Pl=Hl.Guide.Hover=function(a){var b=this;b._interactor=a};Pl.prototype={},Pl.prototype.constructor=Pl,b.defineProperties(Pl.prototype,{}),Pl.prototype._42=function(){var a=this._interactor;if(a.getStyle("hoverGuideVisible")&&!a.gvEditing){var b=a.hoverData,c=a.gv;if(!Kd(b)||c.isSelected(b))return void(a.hoverData=null);var d=hj(c,b),e=Hl.toScreenPosition(c,{x:d.x,y:d.y}),f=Hl.toScreenPosition(c,{x:d.x+d.width,y:d.y+d.height});Hl.Icons.DrawIcon(a,a._context,Hl.Icons.HoverDataRect,{min:e,max:f,color:a.getStyle("hoverGuideColor")||a.getStyle("baseColor")})}},Hl.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,moveDummyThreshold:32,moveDummyPosition:[0,0,-16,-16],moveDummyLineExtraShift:[-32,0],moveDummySensitivity:16,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideThreshold:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineVisible:!0,guideLineTextSpacing:0,hoverGuideVisible:!1,hoverGuideColor:null,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Ql=Hl.Icons={},Rl=1e4,Sl=null,Tl=Hl.DefaultStyleMap.baseColor,Ul="rgb(183,232,135)",Vl="rgb(255,204,153)",Wl=6;j.Default.setImage("Icons.RectPoint",{width:Wl,height:Wl,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Tl}},rect:[0,0,Wl,Wl]}]}),Ql.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var a=Ql.GroupSubEntityRect.data;if(!a)return[];var b=a.min,c=a.max;return[b.x,b.y,b.x,c.y,c.x,c.y,c.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ql.GroupSubEntityRect.data.isKeyOb?Tl:Tl}}}]};var Xl=4;Ql.HoverDataRect={comps:[{type:"shape",points:{func:function(){var a=Ql.HoverDataRect.data;if(!a)return[];var b=a.min,c=a.max,d=Xl;return b.x-=d,b.y-=d,c.x+=d,c.y+=d,[b.x,b.y,b.x,c.y,c.x,c.y,c.x,b.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Ql.HoverDataRect.data.color}},borderCap:"round",borderPattern:[1,4]}]},Ql.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ql.Line.data.P1.x,Ql.Line.data.P1.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Ql.Line.data.P2.x,Ql.Line.data.P2.y],Wl,Wl]}}}]},Ql.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Ql.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Ql.Rect={comps:[{type:"shape",points:{func:function(){var a=Ql.Rect.data;if(!a)return[];var b=a.LT,c=a.LB,d=a.RB,e=a.RT;return[b.x,b.y,c.x,c.y,d.x,d.y,e.x,e.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Tl}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},rect:{func:function(){return[[Ql.Rect.data.LT.x,Ql.Rect.data.LT.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},rect:{func:function(){return[[Ql.Rect.data.LB.x,Ql.Rect.data.LB.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},rect:{func:function(){return[[Ql.Rect.data.RB.x,Ql.Rect.data.RB.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},rect:{func:function(){return[[Ql.Rect.data.RT.x,Ql.Rect.data.RT.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},visible:{func:function(){return Ql.Rect.data.L?!0:!1}},rect:{func:function(){return[[Ql.Rect.data.L.x,Ql.Rect.data.L.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},visible:{func:function(){return Ql.Rect.data.R?!0:!1}},rect:{func:function(){return[[Ql.Rect.data.R.x,Ql.Rect.data.R.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){
return Ql.Rect.data.rotation}},visible:{func:function(){return Ql.Rect.data.T?!0:!1}},rect:{func:function(){return[[Ql.Rect.data.T.x,Ql.Rect.data.T.y],Wl,Wl]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Ql.Rect.data.rotation}},visible:{func:function(){return Ql.Rect.data.B?!0:!1}},rect:{func:function(){return[[Ql.Rect.data.B.x,Ql.Rect.data.B.y],Wl,Wl]}}}]};var Yl=16;j.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Tl}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Tl}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Ql.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Ql.Anchor.data.POS.x,Ql.Anchor.data.POS.y],Yl,Yl]}}}]},Ql.TipShiftX=12,Ql.TipShiftY=12;var Zl=[8,28];Ql.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Ql.TipHelper.data.helperPos.x,Ql.TipHelper.data.helperPos.y,Zl[0]*Ql.TipHelper.data.size,Zl[1]]}},background:{func:function(){return Sl.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Ql.TipHelper.data.text}},rect:{func:function(){return[Ql.TipHelper.data.helperPos.x,Ql.TipHelper.data.helperPos.y,Zl[0]*Ql.TipHelper.data.size,Zl[1]]}},color:{func:function(){return Sl.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var $l=7;Ql.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!Ql.ShapePoint.data.dynamicVisible}},rect:{func:function(){var a=Ql.ShapePoint.data.point,b=Ql.ShapePoint.data.size||$l;return[a,b+10,b+10]}},background:{func:function(){var a=Date.now(),b=Ql.ShapePoint.data.dynamicPeriod||1500,c=Math.sin(a%b/b*Math.PI);return"rgba(27,124,22,"+.5*c+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var a=Ql.ShapePoint.data.point,b=Ql.ShapePoint.data.size||$l;return[a,b,b]}},background:{func:function(){var a=Ql.ShapePoint.data.isEnd;return a?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return Ql.ShapePoint.data.color||Tl}}},{type:"rect",visible:{func:function(){return!!Ql.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Tl}},rect:{func:function(){var a=5;return[Ql.ShapePoint.data.point,a,a]}}}]},Ql.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!Ql.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return Ql.ShapeBgCurve.data.P}},segments:{func:function(){return Ql.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var a=Date.now(),b=Ql.ShapeBgCurve.data.dynamicPeriod||1500,c=Math.sin(a%b/b*Math.PI);return"rgba(27,124,22,"+.3*c+")"}}},{type:"shape",points:{func:function(){return Ql.ShapeBgCurve.data.P}},segments:{func:function(){return Ql.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return Ql.ShapeBgCurve.data.color||Tl}}}]};var _l=8;Ql.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var a=Ql.ShapeHighlighPoint.data;return[[a.x,a.y],_l,_l]}},background:{func:function(){return Sl.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var am=10;Ql.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var a=Ql.ShapeHighlighRealPoint.data;return[[a.x,a.y],am,am]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Tl}}}]};var bm=8;Ql.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var a=Ql.ShapeHighlighCtrlPoint.data,b=a.x,c=a.y,d=bm/2;return[b-d,c-d,b-d,c+d,b+d,c+d,b+d,c-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Sl.getStyle("shapeCtrlPointBorderColor")||Tl}}}]};var cm=3;Ql.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Ql.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:cm,borderColor:{func:function(){return Sl.getStyle("curveHighlightColor")}}}]},Ql.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Ql.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Ql.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Ql.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Ql.MoveLineGuide.data.center?Ul:Vl}}}]};var dm=5;Ql.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var a=Ql.MoveLineGuideDistanceH.data,b=a.x0,c=a.y0;return[b,c-dm,b,c+dm]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Vl},{type:"shape",points:{func:function(){var a=Ql.MoveLineGuideDistanceH.data,b=a.x1,c=a.y1;return[b,c-dm,b,c+dm]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Vl},{type:"text",text:{func:function(){return Math.round(Ql.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var a=Ql.MoveLineGuideDistanceH.data;return[[(a.x0+a.x1)/2,a.y0-10],20,20]}},color:Vl,font:"12px Arial",align:"center"}]},Ql.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var a=Ql.MoveLineGuideDistanceV.data,b=a.x0,c=a.y0;return[b-dm,c,b+dm,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Vl},{type:"shape",points:{func:function(){var a=Ql.MoveLineGuideDistanceV.data,b=a.x1,c=a.y1;return[b-dm,c,b+dm,c]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:Vl},{type:"text",text:{func:function(){return Math.round(Ql.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var a=Ql.MoveLineGuideDistanceV.data;return[[a.x0-10,(a.y0+a.y1)/2],20,20]}},color:Vl,font:"12px Arial",align:"center"}]},j.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Ql.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var a=Ql.EdgeElevationGuide.data,b=a.x,c=a.y,d=Sl.getStyle("curveElevationIntersectSize"),e=Sl.getStyle("curveElevationGuideShift");return b+=e[0],c+=e[1],[b-d,c-d,2*d,2*d]}}}]},j.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),j.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Ql.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Ql.ConnectGuide.data.rotation}},rect:{func:function(){var a=Ql.ConnectGuide.data.connect,b=(a.x,a.y,Sl.getStyle("connectGuideIntersectSize"));return[[a.x,a.y],2*b,2*b]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var a=Ql.ConnectGuide.data.cursorPos||Ql.ConnectGuide.data.connect,b=Sl.getStyle("connectGuideIntersectSize");return[[a.x,a.y],2*b-2,2*b-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var a=Ql.ConnectGuide.data.connect,b=Ql.ConnectGuide.data.cursorPos||a;return[a.x,a.y,a.x+.5*(b.x-a.x),a.y,b.x+.5*(a.x-b.x),b.y,b.x,b.y]}}}]},j.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),j.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Ql.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var a=Ql.ConnectGuideGarbage.data.hover;return a?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var a=Ql.ConnectGuideGarbage.data,b=Sl.getStyle("connectGuideGarbageIntersectsize");return a.hover&&(b+=5),[[a.x,a.y],2*b,2*b]}}}]};var em=6;Ql.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Ql.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var a=Ql.ShapeActivingCtrl.data;return[a.point.x,a.point.y,a.c1.x,a.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Tl}}},{type:"shape",visible:{func:function(){return Ql.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var a=Ql.ShapeActivingCtrl.data;return[a.point.x,a.point.y,a.c2.x,a.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Tl}}},{type:"shape",visible:{func:function(){return Ql.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var a=Ql.ShapeActivingCtrl.data.c1,b=a.x,c=a.y,d=em/2;return"c1"===Ql.ShapeActivingCtrl.data.hl&&(d+=.5),[b-d,c-d,b-d,c+d,b+d,c+d,b+d,c-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Ql.ShapeActivingCtrl.data.hl?Sl.getStyle("shapeCtrlPointHighlightBorder")||Tl:Sl.getStyle("shapeCtrlPointBorderColor")||Tl}}},{type:"shape",visible:{func:function(){return Ql.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var a=Ql.ShapeActivingCtrl.data.c2,b=a.x,c=a.y,d=em/2;return"c2"===Ql.ShapeActivingCtrl.data.hl&&(d+=.5),[b-d,c-d,b-d,c+d,b+d,c+d,b+d,c-d]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Sl.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Ql.ShapeActivingCtrl.data.hl?Sl.getStyle("shapeCtrlPointHighlightBorder")||Tl:Sl.getStyle("shapeCtrlPointBorderColor")||Tl}}}]},Ql.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Tl}},rect:{func:function(){return[[Ql.RoundPoint.data.x,Ql.RoundPoint.data.y],Wl,Wl]}}}]},Ql.AttachPoint={comps:[{type:"rect",background:{func:function(){return Ql.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Tl}},rect:{func:function(){var a=Ql.AttachPoint.data.isAttach?Wl+4:Wl;return[[Ql.AttachPoint.data.x,Ql.AttachPoint.data.y],a,a]}}}]},Ql.SimpleRect={comps:[{type:"rect",background:null,borderWidth:{func:function(){return Ql.SimpleRect.data.borderWidth||1}},borderColor:{func:function(){return Ql.SimpleRect.data.color||Tl}},rect:{func:function(){var a=Ql.SimpleRect.data;return[a.x,a.y,a.width,a.height]}}}]},j.Default.setImage("Icons.MoveDummyImage",{width:32,height:32,boundExtend:12,attachStyle:"close",comps:[{type:"oval",background:"rgb(255,255,255)",borderColor:"#979797",shadow:!0,shadowColor:"rgba(0,0,0,0.25)",shadowOffsetX:0,rect:[0,0,32,32]},{type:"shape",background:"rgb(51,153,255)",pixelPerfect:!0,points:[8.65079,11.90713,9.05502,11.46921,9.70629,11.46921,10.11052,11.90713,10.51476,12.28891,10.51476,12.92895,10.11052,13.34441,8.49359,14.97258,12.2889,14.97258,12.85034,14.97258,13.29949,15.42172,13.29949,15.99439,13.29949,16.57828,12.85034,17.0162,12.2889,17.0162,8.49359,17.0162,10.11052,18.6556,10.51476,19.0486,10.51476,19.7111,10.11052,20.09288,9.70629,20.50834,9.05502,20.50834,8.65079,20.09288,5.32709,16.76917,5.28217,16.71303,4.87794,16.32002,4.87794,15.67998,5.28217,15.26452,8.65079,11.90713,8.65079,11.90713,8.65079,11.90713,13.3444,10.09931,13.3444,10.09931,12.94017,10.50354,12.2889,10.50354,11.88467,10.09931,11.48043,9.69507,11.48043,9.0438,11.88467,8.63957,15.27574,5.25973,15.66874,4.86672,16.32001,4.86672,16.73547,5.25973,16.76917,5.31586,20.10409,8.63957,20.50832,9.0438,20.50832,9.68385,20.10409,10.09931,19.69986,10.49231,19.07105,10.50354,18.64436,10.09931,17.02742,8.45991,17.02742,12.26646,17.02742,12.83912,16.55581,13.31072,15.99438,13.31072,15.43295,13.31072,14.98379,12.83912,14.98379,12.26646,14.96134,8.45991,13.3444,10.09931,13.3444,10.09931,13.3444,10.09931,21.90069,13.33318,21.90069,13.33318,21.49646,12.91771,21.49646,12.27768,21.90069,11.89591,22.31615,11.45798,22.94497,11.45798,23.36043,11.89591,26.72904,15.2533,27.12205,15.66876,27.12205,16.3088,26.72904,16.7018,26.6729,16.75794,23.36043,20.08165,22.94497,20.49711,22.31615,20.49711,21.90069,20.08165,21.49646,19.69987,21.49646,19.03737,21.90069,18.64437,23.51763,17.00498,19.72231,17.00498,19.14965,17.00498,18.71173,16.56705,18.71173,15.98316,18.71173,15.41049,19.14965,14.96135,19.72231,14.96135,23.51763,14.96135,21.90069,13.33318,21.90069,13.33318,21.90069,13.33318,11.88467,23.32675,11.88467,23.32675,11.48043,22.94498,11.48043,22.27125,11.88467,21.88948,12.2889,21.48523,12.94017,21.48523,13.3444,21.88948,14.96134,23.52887,14.98379,19.7111,14.98379,19.14966,15.43295,18.67805,15.99438,18.67805,16.55581,18.67805,17.02742,19.14966,17.02742,19.7111,17.02742,23.52887,18.64436,21.88948,19.07105,21.48523,19.69986,21.48523,20.10409,21.88948,20.50832,22.27125,20.50832,22.94498,20.10409,23.32675,16.76917,26.65045,16.73547,26.72905,16.32001,27.13329,15.66874,27.13329,15.27574,26.72905,11.88467,23.32675,11.88467,23.32675,11.88467,23.32675],segments:[1,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,4,2,2,4,4,2,2,4,4,2,2,2,2,1,2,4,4,2,2,4,4,2,2,4,4,2,2,4,2,2,2]}]}),Ql.MoveDummy={comps:[{type:"image",name:"Icons.MoveDummyImage",rect:{func:function(){var a=Ql.MoveDummy.data;return[[a.pos.x,a.pos.y],2*a.size,2*a.size]}}}]},Hl.Icons.DrawIcon=function(a,b,c,d){c.width=c.height=Rl,c.data=d,Sl=a,j.Default.drawImage(b,c,0,0,Rl,Rl)},Hl.Icons.MapPoints=function(a,b){for(var c=0,d=a.length;d>c;c++)a[c]/=b},Hl.roundTo=function(a,b,c){var d=Math.abs(a%b);return c>d||c>b-d?b*Math.round(a/b):a},Hl.toFixed=function(a){return Math.round(100*a)/100},Hl.getDataMatrix=function(a){if(a instanceof j.Shape){var b=new j.Math.Matrix2d,c=a.getPosition();return b.translate(-c.x,-c.y).scale(a.getScale().x,a.getScale().y).rotate(a.getRotation()).translate(c.x,c.y),b}return a.getMatrix?a.getMatrix():new j.Math.Matrix2d};var fm=Hl.Math.Curve=function(){this._curves=[]};fm.prototype={},fm.prototype.constructor=fm,fm.prototype.createFromHtShape=function(a,b,d){b instanceof j.List&&(b=b.toArray());var e,f,g,h,i,k,l,m=this,n=null,o=null,p=0,q=Hl.Math.Vector2,r=Hl.Math.CubicBezier,s=function(b){return new q(a[b],a[b+1],d?d[b/2]:c)};for(f=0,g=b.length;g>f;f++){switch(h=b[f],i=null,h){case 1:o=s(p),n=o,p+=2;break;case 2:e=s(p),p+=2,i=new r(o,o.clone(),e.clone(),e),o=e;break;case 3:k=s(p),e=s(p+2),p+=4,i=new r(o,k.clone().sub(o).multiplyScalar(2/3).add(o),k.clone().sub(e).multiplyScalar(2/3).add(e),e),o=e;break;case 4:k=s(p),l=s(p+2),e=s(p+4),p+=6,i=new r(o,k,l,e),o=e;break;case 5:if(!n)break;i=new r(o,o.clone(),n.clone(),n),o=null,n=null}i&&(i._index=m._curves.length,m._curves.push(i))}},fm.prototype.checkPoint=function(a,b){var c,d,e,f,g,h=this,i=h._curves;for(c=0,d=i.length;d>c;c++)if(f=i[c],g=f.intersectRect(a,b,b),g.length)return e=0,g.forEach(function(a){e+=a.t}),e/=g.length,a=f.getPointAt(e),a.t=e,{bezier:f,intersection:a}},fm.prototype.insertKnot=function(a,b){var c=a.insertKnot(b),d=this,e=d._curves;e.splice(a._index,1,c[0],c[1])},fm.prototype._isCloseEnough=function(a,b){return Math.abs(a.x-b.x)<1e-6&&Math.abs(a.y-b.y)<1e-6},fm.prototype._isSamePoint=function(a,b){return a===b},fm.prototype.moveRealPoint=function(a,b){var c=this,d=c._curves,e=b.clone().sub(a);d.forEach(function(d){var f=d._p1,g=(d._p2,d._p3,d._p4);c._isSamePoint(f,a)&&(d._p2.add(e),d._p1=b),c._isSamePoint(g,a)&&(d._p3.add(e),d._p4=b)})},fm.prototype.moveCtrlDueToRealPointMovement=function(a,b){var c=this,d=c._curves,e=function(a){a.add(b),a.e&&b.e&&(a.e+=b.e)};d.forEach(function(b){var d=b._p1,f=(b._p2,b._p3,b._p4);c._isSamePoint(d,a)&&e(b._p2),c._isSamePoint(f,a)&&e(b._p3)})},fm.prototype.moveCtrlPoint=function(a,b,d){var e=a[d];if(e){e.e!==c&&(b.e=e.e);var f=this,g=f._curves;b.clone().sub(e),g.forEach(function(a){var c;"c2"===d?c="_p2":"c1"===d&&(c="_p3"),f._isSamePoint(a[c],e)&&(a[c]=b)}),a[d]=b}},fm.prototype.deleteRealPoint=function(a,b){var c,d,e,f,g,h,i,j=this,k=j._curves,l={},m=[],n=Hl.Math.CubicBezier;for(d=0,e=k.length;e>d;d++)c=k[d],f=c._p1,g=c._p2,h=c._p3,i=c._p4,(l[d]||!j._isSamePoint(f,a))&&(j._isSamePoint(i,a)?e>d+1&&j._isSamePoint(k[d+1]._p1,a)&&(b||m.push(new n(f,g,k[d+1]._p3,k[d+1]._p4))):m.push(c));j._curves=m},fm.prototype.findPairs=function(a,b){var c,d,e,f,g,h,i,j,k=this,l=k._curves,m={},n=[];for(d=0,e=l.length;e>d;d++)c=l[d],f=c._p1,g=c._p2,h=c._p3,i=c._p4,!m[d]&&k._isSamePoint(f,a)&&(b?n.push({point:f,r2:i}):n.push({point:f,c2:g})),k._isSamePoint(i,a)&&(j=b?{point:i,r1:f}:{point:i,c1:h},e>d+1&&k._isSamePoint(l[d+1]._p1,a)&&(b?j.r2=l[d+1]._p4:j.c2=l[d+1]._p2,m[d+1]=!0),n.push(j));return n},fm.prototype.toHtShape=function(){var a=this,b=a._curves,c=[],d=[],e={x:1/0,y:1/0};return b.forEach(function(b){var f=b._p1,g=b._p2,h=b._p3,i=b._p4;return a._isCloseEnough(f,e)||(c.push(1),d.push(f.clone())),e=i,a._isCloseEnough(f,g)&&a._isCloseEnough(h,i)?(c.push(2),void d.push(i.clone())):(c.push(4),void d.push(g.clone(),h.clone(),i.clone()))}),{segments:c,points:d}};var gm=Hl.Math.CubicBezier=function(a,b,c,d){var e=this;e._id=Hl.Math.CubicBezier._globalId++,e._p1=a,e._p2=b,e._p3=c,e._p4=d};gm._globalId=1,gm.prototype={},gm.prototype.constructor=gm,gm.prototype.toString=function(){return this._id},gm.prototype.intersectRect=function(a,b,c){var d=b/2,e=c/2,f=a.x,g=a.y,h=Hl.Math.Vector2,i=new h(-d+f,-e+g),j=new h(d+f,e+g),k=new h(j.x,i.y),l=new h(i.x,j.y),m=this,n=m.intersectLine(i,k),o=m.intersectLine(k,j),p=m.intersectLine(j,l),q=m.intersectLine(l,i),r=n.concat(o).concat(p).concat(q);return r},gm.prototype.intersectLine=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p=this,q=a.clone().min(b),r=a.clone().max(b);f=p._p1,g=p._p2,h=p._p3,i=p._p4,c=f.clone().multiplyScalar(-1),d=g.clone().multiplyScalar(3),e=h.clone().multiplyScalar(-3),m=c.add(d).add(e).add(i),c=f.clone().multiplyScalar(3),d=g.clone().multiplyScalar(-6),e=h.clone().multiplyScalar(3),l=c.add(d).add(e),c=f.clone().multiplyScalar(-3),d=g.clone().multiplyScalar(3),k=c.add(d),j=f.clone(),o=new Hl.Math.Vector2(a.y-b.y,b.x-a.x),n=a.x*b.y-b.x*a.y;for(var s=p.getRoots(o.dot(m),o.dot(l),o.dot(k),o.dot(j)+n),t=new Array,u=0,v=s.length;v>u;u++){var w=s[u];if(!(0>w||w>1)){var x=f.clone().lerp(g,w),y=g.clone().lerp(h,w),z=h.clone().lerp(i,w),A=x.lerp(y,w),B=y.lerp(z,w),C=A.lerp(B,w);C.t=w,a.x==b.x?q.y<=C.y&&C.y<=r.y&&t.push(C):a.y==b.y?q.x<=C.x&&C.x<=r.x&&t.push(C):C.x>=q.x&&C.y>=q.y&&C.x<=r.x&&C.y<=r.y&&t.push(C)}}return t},gm.prototype.solveTForPoint=function(a){var b,d,e,f,g=this;b=g._p1.x-a.x,d=g._p2.x-a.x,e=g._p3.x-a.x,f=g._p4.x-a.x;for(var h=g.getRoots(f-3*e+3*d-b,3*e-6*d+3*b,3*d-3*b,b),i=c,j=1/0,k=0,l=h.length;l>k;k++){var m=h[k];if(!(0>m||m>1)){var n=g._p1.clone().lerp(g._p2,m),o=g._p2.clone().lerp(g._p3,m),p=g._p3.clone().lerp(g._p4,m),q=n.lerp(o,m),r=o.lerp(p,m),s=q.lerp(r,m);s.t=m;var t=Math.abs(s.y-a.y);j>t&&(j=t,i=s)}}return i},gm.prototype.getPointAt=function(a){var b=this,c=b._p1,d=b._p2,e=b._p3,f=b._p4,g=c.clone().lerp(d,a),h=d.clone().lerp(e,a),i=e.clone().lerp(f,a),j=g.lerp(h,a),k=h.lerp(i,a);return j.lerp(k,a)},gm.prototype.getRoots=function(a,b,c,d){var e,f,g,h,i,j=new Array;if(Math.abs(a)<1e-6){var e=b,f=c/e,g=d/e,h=f*f-4*g;if(h>0){var i=Math.sqrt(h);j.push(.5*(-f+i)),j.push(.5*(-f-i))}else 0==h&&j.push(.5*-f)}b/=a,c/=a,d/=a,e=(3*c-b*b)/3,f=(2*b*b*b-9*c*b+27*d)/27;var k=b/3,l=f*f/4+e*e*e/27,m=f/2;if(Math.abs(l)<=1e-6&&(l=0),l>0){var n,o,i=Math.sqrt(l);n=-m+i,o=n>=0?Math.pow(n,1/3):-Math.pow(-n,1/3),n=-m-i,n>=0?o+=Math.pow(n,1/3):o-=Math.pow(-n,1/3),j.push(o-k)}else if(0>l){var p=Math.sqrt(-e/3),q=Math.atan2(Math.sqrt(-l),-m)/3,r=Math.cos(q),s=Math.sin(q),t=Math.sqrt(3);j.push(2*p*r-k),j.push(-p*(r+t*s)-k),j.push(-p*(r-t*s)-k)}else{var n;n=m>=0?-Math.pow(m,1/3):Math.pow(-m,1/3),j.push(2*n-k),j.push(-n-k)}return j},gm.prototype._70I=function(){var a=this;return a._p1.distanceToSquared(a._p2)<1e-10&&a._p3.distanceToSquared(a._p4)<1e-10},gm.prototype.insertKnot=function(a){var b=this,c=b._p1,d=b._p2,e=b._p3,f=b._p4,g=c.clone().lerp(d,a),h=d.clone().lerp(e,a),i=e.clone().lerp(f,a),j=g.clone().lerp(h,a),k=h.clone().lerp(i,a),l=j.clone().lerp(k,a);return b._70I()?(c.clone().lerp(f,a),[new Hl.Math.CubicBezier(c,c.clone(),l.clone(),l),new Hl.Math.CubicBezier(l,l.clone(),f.clone(),f)]):[new Hl.Math.CubicBezier(c,g,j,l),new Hl.Math.CubicBezier(l,k,i,f)]};var ll=j.Default.getInternal().ui().EdgeUI,hm={_47O:function(a){var b=this,c=hm.getBackups()._47O;Hl.inEdit(b.gv)||c.call(b,a)}};Hl.Inject.registAsModule(hm,ll);var kl=j.Default.getInternal().ui().NodeUI,im={_47O:function(a){var b=this,c=im.getBackups()._47O;Hl.inEdit(b.gv)||c.call(b,a)},getSelectWidth:function(){var a=this,b=a.gv,c=a._data;if(b.isEditable(c)&&Hl.inEdit(b))return 0;var d=im.getBackup("getSelectWidth");return d.call(a)}};Hl.Inject.registAsModule(im,kl);var jm=j.graph.GraphView,km={_editPointSize:function(){var a=j.Default.isTouchable,b=Hl.getStyle("pointSize");return b[a?0:1]}(),isPointEditable:function(a){var b=this;if(Hl.inEdit(b))return b._pointEditableFunc?b._pointEditableFunc(a):!0;var c=km.getBackup("isPointEditable");c.call(b,a)},isEditable:function(a){var b,c=this,d=km.getBackup("isEditable");if(b=a instanceof Hl.Group?!0:d.call(c,a),!Hl.inEdit(c))return b;if(!(a instanceof j.Edge))return b;if(!a.s("2d.editable"))return!1;var e=c.getEditableFunc();return e?e(a):!0},_42:function(a,b){var c=this,d=km.getBackups()._42;if(d.call(c,a,b),Hl.inEdit(c)){var e=c.getEditInteractor();e.drawImpl()}}};Hl.Inject.registAsModule(km,jm);var pl=j.Default.getInternal().ui().ShapeUI,lm={_47O:function(a){var b=this,c=lm.getBackups()._47O;Hl.inEdit(b.gv)||c.call(b,a)}};Hl.Inject.registAsModule(lm,pl);var Bl=j.graph.DefaultInteractor,mm={handle_mousewheel:function(a){var b=this,c=mm.getBackup("handle_mousewheel");Hl.inEdit(b.gv)||c.call(b,a)}};Hl.Inject.registAsModule(mm,Bl);var Dl=j.graph.MoveInteractor,nm={_calcShift:function(a,b){var c=this,d=nm.getBackup("_calcShift"),e=c.gv;if(!Hl.inEdit(e))return d.call(c,a,b);var f=e.getEditInteractor(),g=f.getSubModule("Move").calcShift(a,b,c);return g||d.call(c,a,b)},clear:function(a){var b=this,c=nm.getBackup("clear");c.call(b,a);var d=b.gv;if(Hl.inEdit(d)){var e=d.getEditInteractor();e.getSubModule("Move").clear(a)}}};Hl.Inject.registAsModule(nm,Dl);var Ol=Hl.Rect=function(a){this.catalog="Rect",this._interactor=a};Ol.prototype={},Ol.prototype.constructor=Ol,Ol.prototype.gatherInfo=function(a,b){var c=this;if(1===b.length){var d=b[0];return d instanceof j.Shape&&d._70I()?c.gatherLine(a,d):Nd(d,a)?!1:c.gatherSingleTarget(a,d)}return b.length>1?c.gatherMultiTargets(a,b):!1},Ol.prototype.gatherSingleTarget=function(a,b){if(b.getCorners){var c,d=this,e=d.info;d.target=b,c=d.screenInfo={};var f=b.getCorners();e.LT=new Hl.Math.Vector2(f[0]),e.LB=new Hl.Math.Vector2(f[1]),e.RB=new Hl.Math.Vector2(f[2]),e.RT=new Hl.Math.Vector2(f[3]),e.T=e.LT.clone().add(e.RT).divideScalar(2),e.B=e.LB.clone().add(e.RB).divideScalar(2),e.L=e.LT.clone().add(e.LB).divideScalar(2),e.R=e.RT.clone().add(e.RB).divideScalar(2);for(var g in e)c[g]=Hl.toScreenPosition(a,e[g]);var h=d._interactor,i=h.getStyle("checkSize"),j=function(a,b,c){var d=b.clone().sub(a).setLength(-i),e=c.clone().sub(a).setLength(-i),f=d.add(e).add(a);return f};return c.rotLT=j(c.LT,c.RT,c.LB),c.rotLB=j(c.LB,c.LT,c.RB),c.rotRB=j(c.RB,c.LB,c.RT),c.rotRT=j(c.RT,c.LT,c.RB),c.rotT=c.rotLT.clone().add(c.rotRT).divideScalar(2),c.rotB=c.rotLB.clone().add(c.rotRB).divideScalar(2),c.rotL=c.rotLT.clone().add(c.rotLB).divideScalar(2),c.rotR=c.rotRT.clone().add(c.rotRB).divideScalar(2),c.rotation=b.getRotation(),d.gatherConnectInfo(),!0}},Ol.prototype.gatherConnectInfo=function(){var a=this,b=a.target,c=a._interactor,d=a.screenInfo,e=c.gv;if(e.isConnectActionVisible(b)&&c.getStyle("connectGuideVisible")){var f;b.s&&(f=b.s("connectGuideShift")),f||(f=c.getStyle("connectGuideShift"));var g=b.getAnchor(),h=b.getSize(),i=b.toGlobal({x:h.width*(f[0]-g.x),y:h.height*(f[1]-g.y)});i=Hl.toScreenPosition(e,i),d.P1?i.add(d.P2.clone().sub(d.P1).setLength(f[2])):(i.add(d.RT.clone().sub(d.LT).setLength(f[2])),i.add(d.LB.clone().sub(d.LT).setLength(f[3]))),d.connect=i}},Ol.prototype.gatherMultiTargets=function(a,b){var c=Hl.Group.findOrCreateGroup(b);if(!c)return!1;var d=this;return d.editing&&"rotate"!==d.editing.mode||c.calcInfo(),d.gatherSingleTarget(a,c)},Ol.prototype.gatherLine=function(a,b){this.target=b;var c=this.screenInfo={},d=b.getPoints(),e=Hl.getDataMatrix(b);return c.P1=Hl.toScreenPosition(a,e.apply(d.get(0))),c.P2=Hl.toScreenPosition(a,e.apply(d.get(1))),this.gatherConnectInfo(),!0},Ol.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],Ol.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],Ol.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],Ol.prototype.check=function(a,b,c){if(j.Default.isLeftButton(b)){var d=this;if(d.editing=null,d.tipInfo=null,d.screenInfo){var e=d.target,f=a.isEditable(e),g=d.screenInfo;if(f&&g.connect){var h=d._checkConnect(c);if(h)return h}if(g.P1)return d._checkLine(c);var i,k,l,m=null,n=d._interactor,o=n.getStyle("checkSize");if(f&&a.isRectEditable(e))for(k=0;k<Hl.Rect.ResizeKeys.length;k++)if(l=Hl.Rect.ResizeKeys[k],Hl.checkHit(c,g[l],o)){m=l,i="resize";break}if(!m&&f&&a.isRotationEditable(e)&&!n.getStyle("rotateAsClock")){var p=n.getStyle("rotateCheckSize");for(k=0;k<Hl.Rect.RotateKeys.length;k++)if(l=Hl.Rect.RotateKeys[k],Hl.checkHit(c,g[l],p)){m=l,i="rotate";break}}if(!m)return void n.setCursor("default");if("rotate"===i){var q,r=a.lp(b);if(e instanceof Hl.Group){var s=n.getStyle("groupRotateModeKey");"string"==typeof s&&(s=[s]);for(var t=!1,u=0,v=s.length;v>u;u++)if(b[s[u]]){t=!0;break}var w=n.getStyle("groupRotateModeDefault");q=t?"batch"===w?"block":"batch":w}var x="batch"===q?e.getAnchor2():e.getPosition(),y=Math.atan2(r.y-x.y,r.x-x.x);n._setRotateCursor(y),d.editing={mode:i,key:m,pos:x,flipY:e.getScale().y<0,rotation:e.getRotation(),hitRot:y},q&&(d.editing.groupRotateMode=q)}else{var z=Hl.Rect.ResizeKeys.indexOf(m),A=Hl.Rect.ResizeDirection[z],B=Math.cos(e.getRotation()),C=Math.sin(e.getRotation()),D=A.x*Math.sign(e.getScale().x),E=A.y*Math.sign(e.getScale().y),F=Math.atan2(-C*D-B*E,B*D-C*E),G=(Math.round(F/(Math.PI/4))+8)%8,H=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][G];this._interactor.setCursor(H);var I=e.getWidth(),J=e.getHeight(),K=e.getAnchor();d.editing={mode:i,key:m,rect:{x:-I*K.x,y:-J*K.y,width:I,height:J},anchor:K,matrix:e.getMatrix()}}return m}}},Ol.prototype._checkLine=function(a){var b,c=this,d=(c.screenInfo,c._interactor.getStyle("checkSize"));if(Hl.checkHit(a,c.screenInfo.P1,d))b="P1";else{if(!Hl.checkHit(a,c.screenInfo.P2,d))return void this._interactor.setCursor("default");b="P2"}return c.editing={mode:"line",key:b},b},Ol.prototype._checkConnect=function(a){var b=this,c=b.screenInfo,d=b._interactor,e=d.getStyle("connectGuideIntersectSize"),f=c.connect,g=a.x,h=f.x;if(h>g&&e>h-g&&Math.abs(f.y-a.y)<e||g>=h&&Hl.checkHit(a,f,e)){var i="connect",j=l.getConnectAction(d.gv);if(b.editing={mode:i},j&&j["delete"])if(b.target instanceof Hl.Group){var k=!0;d.gv.sm().getSelection().each(function(a){j["delete"].visible.call(null,d.gv,a)||(k=!1)}),b.editing.hasDeleteAction=k}else j["delete"].visible.call(null,d.gv,b.target)&&(b.editing.hasDeleteAction=!0);return d.setCursor("default"),i}},Ol.prototype._fireEditEvent=function(a,b){var c=this._interactor,d=this.editing;if(d){var e=d.mode;e="rotate"===e?"Rotation":"connect"===e?"Connection":e[0].toUpperCase()+e.slice(1),c.fi({kind:a+"Edit"+e,event:b})}},Ol.prototype.startEdit=function(a,b){a.startDragging(b);var c=this;c._interactor.fi({kind:"prepareEdit",event:b});var d=c.editing,e=c.target;if(d){if(c._fireEditEvent("begin",b),"rotate"===d.mode)return void(d.groupRotateMode&&e.beginRotate(d));if("connect"!==d.mode)("line"===d.mode||e&&0===e.getRotation())&&(c._inSmartGuide=!0,c._interactor.rectGuide.gatherRects());else if(d.hasDeleteAction){var f=a.gv,g=c._interactor.getStyle("connectGuideGarbageShift");d.garbageInfo={x:f.getWidth()*g[0]+g[2],y:f.getHeight()*g[1]+g[3],size:c._interactor.getStyle("connectGuideGarbageIntersectsize")},a._42()}}},Ol.prototype._46O=function(a){var b,d,e=this,f=e.editing,g=e.target;if(f){if("connect"===f.mode&&!f.canceled&&!f.deleted)try{f.garbageInfo&&f.garbageInfo.hover?l.doDeleteConnectionAction(e._interactor.gv,g):l.doConnectAction(e._interactor.gv,g,f.target)}catch(h){console.error(h)}d=f.freezeFlag,b=e.editing.groupRotateMode,e._fireEditEvent("end",a),e.editing=null}e.tipInfo=null,e._inSmartGuide&&(e._interactor.rectGuide.clear(),e._inSmartGuide=!1),b&&g&&g.endRotate(),g instanceof j.Block&&(d===c?delete g._freezeSyncFromChildren:g._freezeSyncFromChildren=d,g.updateFromChildren())},Ol.prototype.handleNormalStateDelete=function(){var a=this,b=a.editing;if(b&&"connect"===b.mode&&!b.canceled&&!b.deleted){if(b.garbageInfo){try{l.doDeleteConnectionAction(a._interactor.gv,a.target)}catch(c){console.error(c)}b.garbageInfo=null}return b.cursorPos=null,b.targetCorners=null,b.deleted=!0,a._interactor._42(),!0}},Ol.prototype.handleNormalStateKeyDown=function(a){var b=this,c=b.editing;return!c||"connect"!==c.mode||c.canceled||c.deleted?void 0:j.Default.isEsc(a)?(c.cursorPos=null,c.targetCorners=null,c.canceled=!0,b._interactor._42(),!0):void 0},Ol.prototype.handleEdit=function(a,b){var c=this,d=c.editing;if(d){var e,f,g,h,i,k=c.target,l=d.key,m=d.mode,n=a.lp(b),o=c._interactor;if("connect"===m){if(d.canceled)return;if(d.deleted)return;d.cursorPos=o._getLogicalPoint(b);var p=d.garbageInfo;return p&&Hl.checkHit(d.cursorPos,p,p.size)?(p.hover=!0,d.target=null,d.targetCorners=null):(p&&(p.hover=!1),d.target=a.getDataAt(n,function(b){return a.isSelectable(b)&&Kd(b)?!0:!1})||null,d.targetCorners=Hl.getTargetCornersOnScreen(a,d.target)),void o._42()}if("rotate"===m){var q,r,s=d.pos,t=Math.atan2(n.y-s.y,n.x-s.x);
if(d.groupRotateMode?r=t-d.hitRot:(q=t-d.hitRot,r=d.rotation+q),r%=2*Math.PI,0>r&&(r+=2*Math.PI),!j.Default.isCtrlDown(b)){var u,v;Rh(b)?(u=o.getStyle("shiftRotateRound"),v=u/2):(u=o.getStyle("rotateRound"),v=o.getStyle("rotateSensitivity")),r=Hl.roundTo(r,u,v)}d.groupRotateMode?(q=r-(d.lastRotation||0),0!==q&&(k.addRotation(q,d.groupRotateMode),d.lastRotation=r)):k.setRotation(r),o._setRotateCursor(t),r>Math.PI&&(r-=2*Math.PI);var w=r/Math.PI*180;w=w.toFixed(2),e=""+w+""}else if("resize"===m){var x=d.rect;g=x.x,h=x.y;var y,z=x.width,A=x.height,B=d.anchor,C=d.matrix,D=k.s&&k.s("keepAspectRatio")||o.getStyle("keepAspectRatio");Rh(b)&&(D=!D);var E=c._unionPointMode1,F=c._unionPointMode2;if(c._inSmartGuide&&!j.Default.isCtrlDown(b)&&!D){var G;"L"===l||"R"===l?G="x":("T"===l||"B"===l)&&(G="y"),c._adsorbedToClosest(n,G),i=!0}y=C.tfi(n);var I;"LT"===l?(x=E(y,{x:g+z,y:h+A},z,A,D),I=9):"T"===l?(x=F({x:g,y:y.y},{x:g+z,y:h+A},z,A,D,"v"),I=1):"RT"===l?(x=E(y,{x:g,y:h+A},z,A,D),I=33):"L"===l?(x=F({x:y.x,y:h},{x:g+z,y:h+A},z,A,D,"h"),I=8):"R"===l?(x=F({x:g,y:h},{x:y.x,y:h+A},z,A,D,"h"),I=32):"LB"===l?(x=E(y,{x:g+z,y:h},z,A,D),I=12):"B"===l?(x=F({x:g,y:h},{x:g+z,y:y.y},z,A,D,"v"),I=4):"RB"===l&&(x=E(y,{x:g,y:h},z,A,D),I=36);var K=C.tf(x.x+x.width*B.x,x.y+x.height*B.y);k instanceof j.Block&&(d.hasOwnProperty("freezeFlag")||(d.freezeFlag=k._freezeSyncFromChildren,k._freezeSyncFromChildren=!0)),k.setPosition(K),k.setSize(x.width,x.height),i&&(f=k.getRect(),o.rectGuide.gatherLines({node:k,x:f.x,y:f.y,w:f.width,h:f.height},G,I)),e=""+Math.round(x.width)+" * "+Math.round(x.height)}else if("line"===m){if(Rh(b)){var L=k.getPoints(),M="P1"===l?L.get(1):L.get(0),N={x:n.x-M.x,y:n.y-M.y},O=o.getStyle("shiftLineRotateRound"),P=c._shiftDirList;if(!P||c._shiftRotateRound!==O){c._shiftRotateRound=O,c._shiftDirList=P=[];for(var Q=0;Q<Math.PI;Q+=O)P.push({x:J(Q),y:H(Q)})}for(var R,S=0,T=0,U=P.length;U>T;T++){var V=P[T],W=V.x*N.x+V.y*N.y;Math.abs(W)>Math.abs(S)&&(S=W,R=V)}n={x:M.x+R.x*S,y:M.y+R.y*S},o.rectGuide.clear()}else c._inSmartGuide&&!j.Default.isCtrlDown(b)&&(c._adsorbedToClosest(n),i=!0);var X=Hl.getDataMatrix(k).applyInverse(n);k.setPoint("P1"===l?0:1,X,!0);var Y=k.getPoints(),Z=Y.get(0),$=Y.get(1);g=Z.x-$.x,h=Z.y-$.y,e=" "+Math.round(Math.sqrt(g*g+h*h))+" ",i&&(f=k.getRect(),o.rectGuide.gatherLines({node:k,x:f.x,y:f.y,w:f.width,h:f.height}))}if(e){var _=j.Default.getLogicalPoint(b,o._canvas);_.x+=Hl.Icons.TipShiftX,_.y+=Hl.Icons.TipShiftY,c.tipInfo={helperPos:_,text:e,size:e.length}}c._fireEditEvent("between",b)}},Ol.prototype._unionPointMode1=function(a,b,c,d,e){if(e&&c&&d){var f=a.x-b.x,g=a.y-b.y;Math.abs(f*d)<Math.abs(g*c)?(g=Math.sign(g)*Math.abs(f*d/c),a.y=b.y+g):(f=Math.sign(f)*Math.abs(g*c/d),a.x=b.x+f)}return j.Default.unionPoint(a,b)},Ol.prototype._unionPointMode2=function(a,b,c,d,e,f){var g=j.Default.unionPoint(a,b);if(e&&c&&d){var h;"v"===f?(h=g.x+g.width/2,g.width=c*g.height/d,g.x=h-g.width/2):(h=g.y+g.height/2,g.height=d*g.width/c,g.y=h-g.height/2)}return g},Ol.prototype._adsorbedToClosest=function(a,b){var c=this,d=c._interactor,e=d.rectGuide.findClosest(a,b),f=d.gridGuide.findClosest(a,b),g=1/0,h=1/0;e&&(isFinite(e.x)&&(g=e.x),isFinite(e.y)&&(h=e.y)),f&&(isFinite(f.x)&&Math.abs(f.x)<Math.abs(g)&&(g=f.x),isFinite(f.y)&&Math.abs(f.y)<Math.abs(h)&&(h=f.y)),isFinite(g)&&(a.x+=g),isFinite(h)&&(a.y+=h)},Ol.prototype._42=function(a,b,c){var d=this;d.info={},d.screenInfo=null;var e=d._interactor;if(!e.editDetail&&d.gatherInfo(b,c)){var f=d.editing,g=f?f.groupRotateMode:null,h=d.screenInfo;if("block"!==g){if(h.P1?Hl.Icons.DrawIcon(e,a,Hl.Icons.Line,h):Hl.Icons.DrawIcon(e,a,Hl.Icons.Rect,h),h.connect&&(Hl.Icons.DrawIcon(e,a,Hl.Icons.ConnectGuide,{rotation:h.rotation,connect:h.connect,cursorPos:f?f.cursorPos:null}),f)){if(f.targetCorners){for(var i={x:1/0,y:1/0},j={x:-(1/0),y:-(1/0)},k=0,l=f.targetCorners.length;l>k;k+=2)i.x=Math.min(i.x,f.targetCorners[k]),j.x=Math.max(j.x,f.targetCorners[k]),i.y=Math.min(i.y,f.targetCorners[k+1]),j.y=Math.max(j.y,f.targetCorners[k+1]);Hl.Icons.DrawIcon(e,a,Hl.Icons.HoverDataRect,{min:i,max:j,color:e.getStyle("hoverGuideColor")||e.getStyle("baseColor")})}f.garbageInfo&&Hl.Icons.DrawIcon(e,a,Hl.Icons.ConnectGuideGarbage,f.garbageInfo)}d.tipInfo&&Hl.Icons.DrawIcon(e,a,Hl.Icons.TipHelper,d.tipInfo)}d.target instanceof Hl.Group&&d.target._42(e,a,b)}};var om=Hl.Anchor=function(a){this.catalog="Anchor",this._interactor=a};om.prototype={},om.prototype.constructor=om,om.prototype.gatherInfo=function(a,b){var c=this;if(1===b.length){var d=b[0];if(!d.getAnchor)return;if(d instanceof j.Shape&&d._70I())return;if(Nd(d,a))return;return c.gatherSingleTarget(a,b[0])}return b.length>1?c.gatherMultiTargets(a,b):!1},om.prototype.gatherSingleTarget=function(a,b){var c=this;return c.info.POS=b.getPosition(),c.screenInfo.POS=Hl.toScreenPosition(a,c.info.POS),c.target=b,!0},om.prototype.gatherMultiTargets=function(a,b){var c=this,d=Hl.Group.findOrCreateGroup(b);return d?(c.screenInfo.POS=Hl.toScreenPosition(a,d.getAnchor2()),c.target=d,!0):!1},om.prototype.isVisible=function(){var a=this,b=a._interactor;if(b.getStyle("anchorVisible")===!1)return!1;var c=a.target;if(c){if(this.editing)return!0;var d=c.getAnchor(),e=b.getStyle("anchorOutsideVisibleThreshold");if(d.x<-e||d.x>1+e||d.y<-e||d.y>1+e)return!0;var f=c.getSize(),g=c.getScale(),h=Math.min(Math.abs(f.width*g.x),Math.abs(f.height*g.y));if(h*b.gv._zoom<b.getStyle("anchorHideThreshold"))return!1}return!0},om.prototype.check=function(a,b,c){if(j.Default.isLeftButton(b)){var d=this,e=d._interactor;if(d.isVisible()&&e.getStyle("anchorMovable")!==!1){d.editing=null,d.tipInfo=null;var f=d.target;if(f&&a.isAnchorEditable(f)&&a.isEditable(f)){var g;if(d.screenInfo&&(g=d.screenInfo.POS)&&Hl.checkHit(c,new Hl.Math.Vector2(g),e.getStyle("checkSize"))){if(f instanceof Hl.Group)return d.editing={},!0;var h=f.getWidth(),i=f.getHeight(),k=f.getAnchor();return d.editing={rect:{x:-h*k.x,y:-i*k.y,width:h,height:i},anchor:k,matrix:f.getMatrix()},!0}}}}},om.prototype.startEdit=function(a,b){a.startDragging(b),a.fi({kind:"beginEditAnchor",event:b})},om.prototype._46O=function(a){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditAnchor",event:a})),b.tipInfo=null},om.prototype.handleEdit=function(a,b){var c=this,d=c.target;if(d){var e=c.editing;if(e){var f=a.lp(b),g=c._interactor;if(d instanceof Hl.Group)return d.setAnchor2(f),void g._42();var h=e.matrix,i=h.tfi(f),k=e.rect,l=(i.x-k.x)/k.width,m=(i.y-k.y)/k.height;if(!j.Default.isCtrlDown(b)){var n=g.getStyle("anchorRound"),o=g.getStyle("anchorSensitivity");l=Hl.roundTo(l,n,o),m=Hl.roundTo(m,n,o)}d.setAnchor(l,m,!0);var p=j.Default.getLogicalPoint(b,g._canvas);p.x+=Hl.Icons.TipShiftX,p.y+=Hl.Icons.TipShiftY;var q=""+l.toFixed(2)+", "+m.toFixed(2);c.tipInfo={helperPos:p,text:q,size:q.length},g.fi({kind:"betweenEditAnchor",event:b})}}},om.prototype._42=function(a,b,c){var d=this;d.info={},d.screenInfo={};var e=d._interactor;e.editDetail||d.gatherInfo(b,c)&&d.isVisible()&&(Hl.Icons.DrawIcon(e,a,Hl.Icons.Anchor,d.screenInfo),d.tipInfo&&Hl.Icons.DrawIcon(e,a,Hl.Icons.TipHelper,d.tipInfo))};var pm=Hl.MoveDummy=function(a){this.catalog="MoveDummy",this._interactor=a};pm.prototype={},pm.prototype.constructor=pm,pm.prototype.gatherInfo=function(a,b){var c=this,d=this._interactor.getSubModule("Rect");if(d){var e=d.screenInfo;if(e){var f=c._interactor,g=c.getMovableTarget(d.target);if(g){var h=f.getStyle("moveDummyThreshold");if(h!==!1){var i=e.LT||e.P1,j=e.RT||e.P2,k=e.LB||i;if(i){var l=e.P1,m=Math.min(i.distanceTo(k),i.distanceTo(j));if(!(h!==!0&&m>h)){var n=f.getStyle("moveDummyPosition"),o=j.clone().sub(i),p=k.clone().sub(i),q=n[2],r=n[3];if(l){var s=f.getStyle("moveDummyLineExtraShift");s&&(q+=s[0],r+=s[1])}var t=i.clone().add(o.clone().multiplyScalar(n[0])).add(o.setLength(q)).add(p.clone().multiplyScalar(n[1])).add(p.setLength(r));return c.screenInfo.pos=t,c.screenInfo.size=f.getStyle("moveDummySensitivity"),!0}}}}}}},pm.prototype.getMovableTarget=function(a){var b=this._interactor.gv;if(Kd(a)){if(b.isMovable(a))return a}else if(a instanceof Hl.Group)for(var c=a._entities,d=c.length-1;d>=0;d--){var e=c[d];if(Kd(e)&&b.isMovable(e))return e}return null},pm.prototype.getMoveInteractor=function(){for(var a,b,c,d=this._interactor.gv,e=d.getInteractors(),a=0,b=e.length;b>a;a++)if(c=e.get(a),c instanceof Dl)return c},pm.prototype.startEdit=function(a,b){a.startDragging(b);var c=this.getMoveInteractor();if(c){var d=this.selectedTarget,e=a.gv;e._moving=1,c._data=d,e.handleMouseDown&&e.handleMouseDown(b,d)}},pm.prototype._46O=function(a){var b=this,c=b.getMoveInteractor();c&&(c.handleWindowMouseUp(a),b.selectedTarget=null)},pm.prototype.handleEdit=function(a,b){var c=this.getMoveInteractor();c&&c.handleWindowMouseMove(b)},pm.prototype.check=function(a,b,c){if(this.selectedTarget=null,j.Default.isLeftButton(b)&&!a._scrolling&&!hf()){var d=this;if(d.screenInfo){var e=d.screenInfo.pos;if(e&&!(c.distanceTo(e)>d.screenInfo.size)){var f=d._interactor;return d.selectedTarget=d.getMovableTarget(f.getSubModule("Rect").target),f.setCursor("default"),!0}}}},pm.prototype._42=function(a,b,c){var d=this;d.screenInfo={};var e=d._interactor;e.editDetail||d.gatherInfo(b,c)&&(!e.editing||d.selectedTarget)&&Hl.Icons.DrawIcon(e,a,Hl.Icons.MoveDummy,d.screenInfo)};var qm=Hl.RotateX=function(a){this.catalog="RotateX",this._interactor=a};qm.prototype={},qm.prototype.constructor=qm,qm.prototype.gatherInfo=function(a,b){var c=this;if(1===b.length){var d=b[0];return d instanceof j.Shape&&d._70I()||Nd(d,a)?!1:c.gatherSingleTarget(a,d)}return b.length>1?c.gatherMultiTargets(a,b):!1},qm.prototype.gatherSingleTarget=function(){var a=new j.Math.Vector2,b=new j.Math.Vector2,c=new j.Math.Vector2,d=new j.Math.Vector2,e=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};return function(f,g){if(g.getCorners){var h=this,i=g.getCorners(),j=15,k=g.getPosition();a.copy(i[0]),c.copy(i[1]),d.copy(i[3]),b.copy(a).add(d).divideScalar(2).add(a.sub(c).setLength(j/f.getZoom()));var l=Math.max(e(k,i[0]),e(k,i[1]),e(k,i[2]),e(k,i[3]));return h.info.POS=b.clone(),h.screenInfo.POS=Hl.toScreenPosition(f,h.info.POS),h.screenInfo.LEN=Math.sqrt(l)*f.getZoom()+j,h.screenInfo.CENTER=Hl.toScreenPosition(f,k),h.target=g,!0}}}(),qm.prototype.gatherMultiTargets=function(a,b){var c=this,d=Hl.Group.findOrCreateGroup(b);if(!d)return!1;var c=this;return c.gatherSingleTarget(a,d)},qm.prototype.isVisible=function(){var a=this._interactor;if(!a.getStyle("rotateAsClock"))return!1;var b=this.target;if(!b)return!0;var c=a.gv;return c.isEditable(b)&&c.isRotationEditable(b)?!0:!1},qm.prototype.check=function(a,b,c){var d=this,e=d._checkImpl(a,b,c);return(e||d._clockPainted)&&d._interactor._42(),e},qm.prototype._checkImpl=function(a,b,c){if(j.Default.isLeftButton(b)){var d=this;d.editing=null,d.tipInfo=null;var e;if(d.screenInfo&&(e=d.screenInfo.POS)&&d.isVisible()){var f=d._interactor;if(Hl.checkHit(c,e,f.getStyle("checkSize"))){var g=d.target,h=a.lp(b),i=g.getPosition(),k=Math.atan2(h.y-i.y,h.x-i.x);return f._setRotateCursor(k),d.editing={pos:i,rotation:g.getRotation(),hitRot:k,groupRotateMode:"block",screenInfo:{CENTER:d.screenInfo.CENTER,LEN:d.screenInfo.LEN}},!0}}}},qm.prototype.startEdit=function(a,b){a.startDragging(b),a.fi({kind:"beginEditRotation",event:b}),this.target instanceof Hl.Group&&this.target.beginRotate(this.editing)},qm.prototype._46O=function(a){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditRotation",event:a})),b.target instanceof Hl.Group&&b.target.endRotate(),b.tipInfo=null},qm.prototype.handleEdit=function(a,b){var c=this,d=c.editing;if(d){var e,f,g=c.target,h=a.lp(b),i=c._interactor,k=d.pos,l=Math.atan2(h.y-k.y,h.x-k.x),m=g instanceof Hl.Group;if(m?f=l-d.hitRot:(e=l-d.hitRot,f=d.rotation+e),f%=2*Math.PI,0>f&&(f+=2*Math.PI),!j.Default.isCtrlDown(b)){var n,o;Rh(b)?(n=i.getStyle("shiftRotateRound"),o=n/2):(n=i.getStyle("rotateRound"),o=i.getStyle("rotateSensitivity")),f=Hl.roundTo(f,n,o)}m?(e=f-(d.lastRotation||0),0!==e&&(g.addRotation(e,d.groupRotateMode),d.lastRotation=f)):g.setRotation(f),i._setRotateCursor(l),f>Math.PI&&(f-=2*Math.PI);var p=f/Math.PI*180,q=""+p.toFixed(2)+"",r=j.Default.getLogicalPoint(b,i._canvas);r.x+=Hl.Icons.TipShiftX,r.y+=Hl.Icons.TipShiftY,c.tipInfo={helperPos:r,text:q,size:q.length},i.fi({kind:"betweenEditRotation",event:b})}},qm.prototype._42=function(a,b,c){var d=this;d._clockPainted=!1,d.info={},d.screenInfo={};var e=d._interactor;e.editDetail||d.gatherInfo(b,c)&&d.isVisible()&&(Hl.Icons.DrawIcon(e,a,Hl.Icons.RoundPoint,d.screenInfo.POS),d.tipInfo&&Hl.Icons.DrawIcon(e,a,Hl.Icons.TipHelper,d.tipInfo),d.editing&&d.drawClock(a))},qm.prototype.drawClock=function(a){a.save();var b=this;b._clockPainted=!0;var c=b.editing||{},d=c.screenInfo||b.screenInfo,e=d.LEN,f=e+8,g=e+18;a.save(),a.translate(d.CENTER.x,d.CENTER.y),a.beginPath(),a.strokeStyle="rgb(150, 150, 150)";for(var h,i,j,k,l,m=0;360>m;m++)h=m*Math.PI/180,m%5===0&&(i=H(h)*e,j=J(h)*e,k=H(h)*f,l=J(h)*f,a.moveTo(i,j),a.lineTo(k,l)),m%45===0&&(i=H(h)*e,j=J(h)*e,k=H(h)*g,l=J(h)*g,a.moveTo(i,j),a.lineTo(k,l));a.stroke(),a.rotate(-O);var n=c.lastRotation||b.target.getRotation();a.beginPath(),a.fillStyle="rgba(255, 0, 0, 0.1)",a.strokeStyle="rgb(157, 157, 157)",a.moveTo(0,0),a.arc(0,0,g,0,n,!1),a.fill(),a.beginPath(),a.moveTo(0+g,0),a.arc(0,0,g,0,n,!1),a.stroke(),a.restore()};var fm=Hl.Curve=function(a){this.catalog="Curve",this._interactor=a};fm.prototype={},fm.prototype.constructor=fm,b.defineProperties(fm.prototype,{activing:{get:function(){return this._activing},set:function(a){var b=this;if(a)b._activing=new Hl.CurveActiving(this,a);else{var c=b._activing;c&&c.dispose(),b._activing=null}}}}),fm.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},fm.prototype.setUp=function(){var a=this,b=a._interactor;b&&b.gv.mp(a._onGraphviewPropertyChanged,a)},fm.prototype._onGraphviewPropertyChanged=function(a){("zoom"===a.property||"translateX"===a.property||"translateY"===a.property)&&this._handleDataChanged()},fm.prototype.tearDown=function(){var a=this,b=a._interactor;b&&b.gv.ump(a._onGraphviewPropertyChanged,a)},fm.prototype.canEnterEditDetailMode=function(){var a=this,b=a._interactor,c=b._getValidSelection();if(1===c.length){var d=c[0],e=d instanceof j.Edge;if(d instanceof j.Shape||e){if(e){var f=d.s("edge.type");if(f&&"points"!==f)return}var g=b.gv;if(g.isPointEditable(d)&&g.isEditable(d))return a.target=d,!0}}},fm.prototype.canQuitEditDetailMode=function(a){var b=this,c=b._interactor._getLogicalPoint(a);return b._checkEditRealPoint(c)?void 0:b._interactor.gv.getDataAt(a)!==b.target?!0:void 0},fm.prototype.preHandleScroll=function(a){var b=this.editing;return b&&b.inEdit?!0:void 0},fm.prototype.getCurrentSelectintStatus=function(){var a=this;if(a.activing&&!a.activing.selections){if(a.activing.status!=c)return a.activing.status;var b=function(b){var c=a.activing.status;a.activing.status=b,a._interactor.fp("shapePointStatus",c,b)},d=Hl.Curve.PointType,e=a.activing.point,f=a.activing.pairs;if(!f||1!==f.length)return b(d.Mirrored);var g=f[0],h=g.c1&&g.c1.isNearEnough(e),i=g.c2&&g.c2.isNearEnough(e);if(!g.c1||!g.c2)return b(h||i?d.Straight:d.Disconnected);if(h&&i)return b(d.Straight);if(h||i)return b(d.Asymmetric);var j=g.c1.clone().sub(e),k=g.c2.clone().sub(e);return b(Math.abs(j.x*k.y-j.y*k.x)>1e-5||j.x*k.x>0?d.Disconnected:Math.abs(j.length()-k.length())>1e-5?d.Asymmetric:d.Mirrored)}},fm.prototype.handle_keydown=function(a){var b=this;if(b._interactor.editDetail){var c=Hl.Curve.PointType;"1"===a.key?b._setCurrentSelectionStatus(c.Straight):"2"===a.key?b._setCurrentSelectionStatus(c.Mirrored):"3"===a.key?b._setCurrentSelectionStatus(c.Disconnected):"4"===a.key&&b._setCurrentSelectionStatus(c.Asymmetric)}},fm.prototype.setCurrentSelectionStatus=function(a){var b=this,c=b._interactor;if(c){var d=c.gv;d.dm().beginTransaction(),this._setCurrentSelectionStatus(a),d.dm().endTransaction()}},fm.prototype._setCurrentSelectionStatus=function(a){var b=this,c=b.activing;if(c){var d=b.getCurrentSelectintStatus();if(null!==d&&d!==a){c.status=a;var e=b.activing.point,f=b.activing.pairs;if(f&&1===f.length){var g=f[0],h=b.screenInfo.curve,i=Hl.Curve.PointType,j=function(){b._writeToHt(),b._interactor.fp("shapePointStatus",d,a)};if(a===i.Straight)return h.moveCtrlPoint(g,e,"c1"),h.moveCtrlPoint(g,e,"c2"),void j();if(d===i.Straight){var k=h.findPairs(e,!0),l=k[0],m=l.r1||e,n=l.r2||e,o=n.clone().sub(m).multiplyScalar(.25);return h.moveCtrlPoint(g,e.clone().sub(o),"c1"),h.moveCtrlPoint(g,e.clone().add(o),"c2"),void j()}var p=g.c1,q=g.c2;if(p&&q){if(a===i.Mirrored)return h.moveCtrlPoint(g,e.clone().multiplyScalar(2).sub(q),"c1"),void j();if(a===i.Asymmetric&&d===i.Disconnected){var r=p.clone().sub(e).length(),o=e.clone().sub(q).setLength(r).add(e);return h.moveCtrlPoint(g,o,"c1"),void j()}}c._firePointChange(),b._interactor.fp("shapePointStatus",d,a)}}}},fm.prototype._handleDataChanged=function(){var a="points,segments,shape,position,rotation,scale".split(",");return function(b){var c=this;if(c.screenInfo&&c.target){if(b&&a.indexOf(b.property)<0)return;var d=c._interactor;c.gatherSingleTarget(d.gv,c.target,!0),c.check(d.gv,null,new Hl.Math.Vector2(d._lastClientPoint)),d._42()}}}(),fm.prototype.gatherSingleTarget=function(a,b,c){var d,e,f=this;f.screenInfo&&f.screenInfo.curve&&(e=f.screenInfo.curve._curves);var g=f.editing;d=g?f.screenInfo:f.screenInfo={};var h,i,k=b instanceof j.Edge;k?(h=b.s("edge.segments"),i=b.s("edge.points")||new j.List):(h=b._58O,i=b._59O),d.S=h;var l,m=d.P=[],n=Hl.getDataMatrix(b);if(b instanceof j.Polyline&&(l=b.getElevation()||0,d.E=[]),i.each(function(b){d.E&&d.E.push(b.e||l),b=n.apply(b);var c=Hl.toScreenPosition(a,b);m.push(c.x,c.y)}),k){var o=m.length,p=Hl.toScreenPosition(a,b._lastSourcePoint||(o?{x:m[0],y:m[1]}:{x:0,y:0})),q=Hl.toScreenPosition(a,b._lastTargetPoint||(o?{x:m[o-2],y:m[o-1]}:{x:0,y:0}));m.splice(0,0,p.x,p.y),m.push(q.x,q.y)}if(!d.S||!d.S.size()){d.S=new j.List,d.S.add(1);for(var r=0;r<m.length/2-1;r++)d.S.add(2)}if((!g||c)&&f.convertToCubicBezier(e),f.activing&&(c||!f.editing||"realPoint"===f.editing.type)){var s=d.curve.findPairs(f.activing.point);f.activing.pairs=s}k&&"points"!==b.s("edge.type")&&f._writeToHt()},fm.prototype._convertToNewPoint=function(a,b,c,d){var e,f,g;for(e=0,f=b.length;f>e;e++){if(g=b[e],g._p1.isNearEnough(a)&&(!d||d.indexOf(g._p1)<0))return g._p1;if(g._p4.isNearEnough(a)&&(!d||d.indexOf(g._p4)<0))return g._p4}if(c)for(e=0,f=Math.min(c.length,f);f>e;e++){if(g=c[e],g._p1===a&&(!d||d.indexOf(b[e]._p1)<0))return b[e]._p1;if(g._p4===a&&(!d||d.indexOf(b[e]._p4)<0))return b[e]._p4}},fm.prototype.convertToCubicBezier=function(a){var b,c,d=this,e=new Hl.Math.Curve,f=d.screenInfo;if(e.createFromHtShape(f.P,f.S,f.E),f.curve=e,d.activing){var g=e._curves;b=d.activing.point,c=d._convertToNewPoint(b,g,a);var h=[];if(c&&(d.activing.point=c,h.push(c)),d.activing.selections){var i=-1,j=d.activing.selections;j.forEach(function(b){i++,c=d._convertToNewPoint(b,g,a,h),c&&(j[i]=c,h.push(c))})}}},fm.prototype.check=function(a,b,c){if(!b||Nh(b)||Oh(b)){var d=this;if(d._interactor.setCursor("default"),d.editing=null,d.highlight=null,d.tipInfo=null,d.edgeEditResult=null,d.screenInfo){if(hf()||Oh(b))return d._interactor._42(),!0;if(d._checkEditCtrlPoint(c))return d._interactor._42(),!0;if(d._checkEditRealPoint(c))return d._interactor._42(),!0;if(d._checkEditElevation(c))return d._interactor._42(),!0;var e=d.screenInfo.curve,f=e.checkPoint(c,d._interactor.getStyle("curveIntersectSize"));if(f){var g=d.highlight={};g.type="insertKnot",g.bezier=f.bezier,g.point=f.intersection}return d._interactor._42(),!0}}},fm.prototype._checkEditRealPoint=function(a){var b,c,d,e,f,g,h=this,i=h.screenInfo.curve._curves,j=h._interactor.getStyle("curvePointIntersectSize"),k=1/0;for(j*=j,d=0,e=i.length;e>d;d++)b=i[d],f=b._p1,g=a.distanceToSquared(f),k>g&&(k=g,c=f),f=b._p4,g=a.distanceToSquared(f),k>g&&(k=g,c=f);if(k>j)return!1;var l=h.highlight={};return l.type="changeRealPoint",l.point=c,h.editing={type:"realPoint",point:c,shiftGuide:{point:c.clone(),dir:"x",limit:0}},h._interactor.setCursor("crosshair"),!0},fm.prototype._checkEditElevation=function(a){var b=this;if(!b._interactor.getStyle("curveElevationVisible"))return!1;var c=b.activing;if(!c)return!1;var d=c.getCurrentEditingPoint();if(!d)return!1;var e=b._interactor,f=e.getStyle("curveElevationGuideShift"),g=e.getStyle("curveElevationIntersectSize"),h=a.distanceToSquared({x:d.x+f[0],y:d.y+f[1]});if(!(h>g*g)){var i=b.highlight={};i.type="elevation";var j=new Hl.Math.Vector2(a.x,a.y,d.e);return b.editing={type:"elevation",startPoint:j},b._interactor.setCursor("crosshair"),!0}},fm.prototype._checkEditCtrlPoint=function(a){var b=this;if(b.activing&&!b.activing.selections){var c=b.getCurrentSelectintStatus();if(c!==Hl.Curve.PointType.Straight){var d=b.activing.pairs;if(d){var e=b._interactor.getStyle("curvePointIntersectSize");e*=e;var f,g,h,i,j,k,l,m,n,o=1/0;for(l=0,n=d.length;n>l;l++)for(i=d[l],m=0;2>m;m++)j=0===m?"c1":"c2",i[j]&&(k=a.distanceToSquared(i[j]),o>k&&(o=k,f=i,g=l,h=j));if(o>e)return!1;b.activing.hlpair=f,b.activing.hltype=h;var p=b.highlight={};return p.type="changeCtrlPoint",p.point=f[h],b.editing={type:"ctrlPoint",pair:f,pairId:g,ctrlType:h,direction:f[h].clone().sub(b.activing.point).normalize()},b._interactor.setCursor("crosshair"),!0}}}},fm.prototype.startEdit=function(a,b){a.startDragging(b);var c=this;c.highlight&&"insertKnot"===c.highlight.type&&(c.insertKnot(),c.gatherSingleTarget(c._interactor.gv,c.target),c.activing=null,c._checkEditRealPoint(c._interactor._getLogicalPoint(b)));var d=c._activing;if(d){var e=c.editing?c.editing.type:null;"ctrlPoint"===e?d.editingCtrl={pairId:c.editing.pairId,type:d.hltype}:"realPoint"===e&&(d.editingCtrl=!1)}var f=c.highlight,g=j.Default.isCtrlDown(b);if(!f||hf()||Oh(b)){var h=c._interactor.gv;if(!h.setFocus(b)||h._scrolling)return;return void(g?c._multiSelect={startPoint:h.lp(b)}:h.isPannable()&&(Nh(b)||Oh(b))&&(c._pan={tx:h.tx(),ty:h.ty()},a.fi({kind:"beginPan",event:b})))}if("changeRealPoint"===f.type){var i,k=c.activing?c.activing.point:null,l=c.activing?c.activing.selections:null;if(g&&c.activing)k===f.point?(l?(c.activing={point:l[0]},l.length>1&&(l.splice(0,1),c.activing.selections=l)):c.activing=null,c.editing=null):l&&(i=l.indexOf(f.point))>=0?(l.length>1?l.splice(i,1):delete c.activing.selections,c.editing=null):l?(l.push(k),c.activing={point:f.point,selections:l}):c.activing={point:f.point,selections:[k]};else if(l)k===f.point||((i=l.indexOf(f.point))>=0?(l.splice(i,1,k),c.activing={point:f.point,selections:l}):c.activing={point:f.point});else{var m;k===f.point&&(m=c.activing.status),c.activing={point:f.point},m&&(c.activing.status=m)}a.fi({kind:"beginEditPoint",event:b})}},fm.prototype.insertKnot=function(){var a=this,b=a.highlight,c=a.screenInfo.curve;c.insertKnot(b.bezier,b.point.t),a._writeToHt()},fm.prototype._writeToHt=function(){var a,b,d,e,f=this,g=f.screenInfo.curve,h=g.toHtShape(),i=h.points,k=[],l=h.segments,m=f._interactor.gv,n=f.target,o=n instanceof j.Edge,p=Hl.getDataMatrix(n).invert();e=n instanceof j.Polyline,e&&(d=n.getElevation());for(var q=0,r=i.length;r>q;q++)a=i[q],b=Hl.toWorldPosition(m,a),b=p.apply(b),a.e!=c&&a.e!==d&&(b.e=a.e),k.push(b);if(n._writing=!0,o){n.s("edge.type","points"),n.setStyle("edge.segments",l),n.setStyle("edge.points",k.slice(1,k.length-1)),n.setStyle("edge.source.offset.x",0),n.setStyle("edge.source.offset.y",0),n.setStyle("edge.target.offset.x",0),n.setStyle("edge.target.offset.y",0);var s=f._nextChangeEdgeHost;delete f._nextChangeEdgeHost,s&&("source"===s.type?n.setSource(s.host):n.setTarget(s.host)),f._writeEdgeHostAnchor("source",k[0]),f._writeEdgeHostAnchor("target",k[k.length-1])}else k.length?(n.setSegments(l),n.setPoints(k,!0)):n.removeFromDataModel();delete n._writing},fm.prototype._writeEdgeHostAnchor=function(a,b){var d=this,e=d.target,f=d._calcHostAnchor(e,a,b);f.index!==c?(e.setStyle("edge."+a+".index",f.index),e.setStyle("edge."+a+".percent",c),e.setStyle("edge."+a+".anchor.x",c),e.setStyle("edge."+a+".anchor.y",c)):f.percent!==c?(e.setStyle("edge."+a+".percent",f.percent),e.setStyle("edge."+a+".index",c),e.setStyle("edge."+a+".anchor.x",c),e.setStyle("edge."+a+".anchor.y",c)):(e.s("edge."+a+".anchor.x",f.x),e.s("edge."+a+".anchor.y",f.y),f.offsetX||f.offsetY?(e.s("edge."+a+".offset.x",f.offsetX),e.s("edge."+a+".offset.y",f.offsetY)):(e.s("edge."+a+".offset.x",0),e.s("edge."+a+".offset.y",0)))},fm.prototype._calcHostAnchor=function(a,b,c,d){d||(d="source"===b?a.getSource():a.getTarget());var e=this._interactor.gv,f=e.calculateAttachPoint(d,c);if(f)return f.info;if(Ld(d)){var g=e.calculateEdgePosition(d,c);return g}var h=d.getRotation(),i=d.getAnchor();Nd(d,e)&&(h=0);var j=d.getScale();if(h||j.x<0||j.y<0){var k=d.getMatrix(),l=k.tfi(c),m=d.getSize();return{x:l.x/m.width+i.x,y:l.y/m.height+i.y}}var n=hj(e,d),o={x:(c.x-n.x)/n.width,y:(c.y-n.y)/n.height};return o},fm.prototype._handlePanning=function(a){var b=this,c=b._pan;if(c){c.started=!0;var d=b._interactor,e=d.gv,f=d._lastClientPoint,g=Th(a),h=Dj(e,g,f);e.setTranslate(c.tx+h.x,c.ty+h.y),b.gatherSingleTarget(d.gv,b.target),d._42(),d.fi({kind:"betweenPan",event:a})}},fm.prototype.handleEdit=function(a,b){var d=this,e=d.editing;if(d._pan)return void d._handlePanning(b);if(d._multiSelect)return d._multiSelect.endPoint=a.lp(b),void d._interactor.redraw();if(e){e.inEdit=!0;var f,g,h,i=d._interactor._getLogicalPoint(b),k=j.Default.isCtrlDown(b),l=j.Default.isShiftDown(b),m=e.type,n=d.activing;if(d._guideInfo=null,"ctrlPoint"===m&&l){var o=d.editing.direction.clone();f=n.point;var p=o.dot(i.clone().sub(f));i=o.setLength(p).add(f)}else if("ctrlPoint"===m||"realPoint"===m){var o;if("realPoint"===m&&l){var q=d.editing.shiftGuide;g=q.point;var r=Math.abs(i.x-g.x),s=Math.abs(i.y-g.y);r>s&&r>q.limit&&"y"===q.dir&&(q.dir="x"),s>r&&s>q.limit&&"x"===q.dir&&(q.dir="y"),o=q.dir,"x"===o?(i.y=g.y,q.limit=Math.max(q.limit,r)):"y"===o&&(i.x=g.x,q.limit=Math.max(q.limit,s))}var t=d._isEditEdgeSourceTarget();if(t){var u=d._editEdgeSourceTarget(t,i,k);u&&(d.edgeEditResult=u,h=u.tipText)}else if(!k){var v=d._guidingToEdit(i,o),w="realPoint"===m?d._interactor.gridGuide.findClosest(i,o,!0):null,x=1/0,y=1/0;w&&(w.x&&(x=w.x),w.y&&(y=w.y));var z=!1;v&&(v.xList&&(Math.abs(v.x)<=Math.abs(x)?(z=!0,x=v.x):delete v.xList),v.yList&&(Math.abs(v.y)<=Math.abs(y)?(z=!0,y=v.y):delete v.yList),z&&(d._guideInfo=v)),isFinite(x)&&(i.x+=x),isFinite(y)&&(i.y+=y),z&&(v.v=i)}}var A=d.screenInfo.curve;if("realPoint"===e.type){f=e.point,f.e!==c&&(i.e=f.e),A.moveRealPoint(f,i),e.point=i,d.highlight.point=i;var B=n.status,C=n.selections;if(d.activing={point:i,status:B},C){var D=i.clone().sub(f),E=0;C.forEach(function(a){var b=a.clone().add(D);A.moveRealPoint(a,b),C[E++]=b}),d.activing.selections=C}}else if("ctrlPoint"===e.type){var F=n.pairs,G=F[e.pairId];A.moveCtrlPoint(G,i,e.ctrlType);var H=n.status,I=Hl.Curve.PointType;if((H===I.Mirrored||H===I.Asymmetric)&&G.c1&&G.c2){var f=new Hl.Math.Vector2(n.point),J="c1"===e.ctrlType?"c2":"c1";if(H===Hl.Curve.PointType.Mirrored)A.moveCtrlPoint(G,f.clone().multiplyScalar(2).sub(i),J);else if(H===I.Asymmetric){var p=G[J].clone().sub(f).length(),K=f.clone().sub(G[e.ctrlType]).setLength(p).add(f);isNaN(K.x)||A.moveCtrlPoint(G,K,J)}}n._firePointChange()}else if("elevation"===e.type){g=e.startPoint;var L=g.e+(g.y-i.y)/a._zoom;d._setCurrentPointImpl("e",L),n._firePointChange(),h="E: "+Hl.toFixed(L)}var M=j.Default.getLogicalPoint(b,d._interactor._canvas);if(M.x+=Hl.Icons.TipShiftX,M.y+=Hl.Icons.TipShiftY,!h){var N=Hl.toWorldPosition(a,i);h=""+Hl.toFixed(N.x)+", "+Hl.toFixed(N.y)}d.tipInfo={helperPos:M,text:h,size:h.length},d._writeToHt(),d._interactor.fi({kind:"betweenEditPoint",event:b})}},fm.prototype._setCurrentPointImpl=function(a,b){var d=this,e=d._activing;if(!e)return!1;var f=d.target;if(!f)return!1;var g=e.getCurrentEditingPoint();if(!g)return!1;var h=e.editingCtrl;if(!h)var i=g.clone();if("e"===a)g.e=b;else{var j;if("x"===a||"y"===a){var k=e._lastFirePoint;j="x"===a?{x:b,y:k?k.y:0}:{x:k?k.x:0,y:b}}else"object"==typeof a?(j=a,a.e!==c&&(g.e=a.e)):(j={x:arguments[0],y:arguments[1]},arguments[2]!==c&&(g.e=arguments[2]));var l=Hl.getDataMatrix(f);j=Hl.toScreenPosition(d._interactor.gv,l.apply(j)),g.x=j.x,g.y=j.y}if(!h){var m=i.multiplyScalar(-1).add(g);g.e&&i.e&&(m.e=g.e-i.e),d.screenInfo.curve.moveCtrlDueToRealPointMovement(g,m)}return!0},fm.prototype.setCurrentPoint=function(a,b){return this._setCurrentPointImpl(a,b)?(this._writeToHt(),!0):!1},fm.prototype._isEditEdgeSourceTarget=function(){var a=this,b=a.target;if(!(b instanceof j.Edge))return!1;var c=a.editing.point,d=a.screenInfo.curve._curves;return c===d[0]._p1?"source":c===d[d.length-1]._p4?"target":!1},fm.prototype._editEdgeSourceTarget=function(a,b,d){var e,f=this,g=f.target;if(e="source"===a?g.getSource():g.getTarget()){var h,i=f._interactor.gv,j=Hl.toWorldPosition(i,b),k=f._calcHostAnchor(g,a,j,e);if(h=k.index!==c||k.percent!==c?k.distance*i.getZoom()>f._interactor.getStyle("edgeHostEdgeMaxDistance"):f._interactor.getStyle("edgeHostDetectPerFrame")?!0:k.x<0||k.x>1||k.y<0||k.y>1?!0:!1){var l=i.getDataAt(j,function(b){return i.isSelectable(b)&&g.canSetSourceTarget(b,a)?!0:!1});if(l){var m=f._calcHostAnchor(g,a,j,l);e=l,f._nextChangeEdgeHost={type:a,host:l},k=m}}var n,o,p;if(d||k.x===c)(k.percent!==c||k.index!==c)&&(o=k.point);else{var q=f._interactor.getStyle("anchorRound"),r=f._interactor.getStyle("anchorSensitivity");n=i.calculateAttachPoint(e,j),n?k=n.info:(k.x=Hl.roundTo(k.x,q,r),k.y=Hl.roundTo(k.y,q,r)),o=Aj(i,e,0,k.offsetX||0,k.offsetY||0,k.x,k.y)}o&&(p=Hl.toScreenPosition(i,o),b.x=p.x,b.y=p.y),f._edgeHostGuideInfo={corners:Hl.getTargetCornersOnScreen(i,e),attach:n?n.index:-1,host:e};var s;return k.percent!==c?s="percent: "+k.percent.toFixed(2):k.index!==c?s="index: "+k.index:(s=""+k.x.toFixed(2)+", "+k.y.toFixed(2),(k.offsetX||k.offsetY)&&(s+=" offset: "+k.offsetX.toFixed(2)+", "+k.offsetY.toFixed(2))),{host:e,anchor:k,tipText:s}}},fm.prototype._guidingToEdit=function(a,b){var c,d,e=this;if(c=e.screenInfo.curve){d=c._curves;var f,g,h,i,j,k,l,m,n=1/0,o=1/0,p=[];for(e.editing&&"realPoint"===e.editing.type&&(m=e.editing.point),j=0,k=2*d.length;k>j;j++)l=d[Math.floor(j/2)][j%2?"_p4":"_p1"],p.indexOf(l)>=0||(p.push(l),m&&m===l||(h=l.x-a.x,i=l.y-a.y,Math.abs(h)<Math.abs(n)?(n=h,f=[l]):h===n&&f.push(l),Math.abs(i)<Math.abs(o)?(o=i,g=[l]):i===o&&g.push(l)));var q=e._interactor.getStyle("smartGuideThreshold");if((Math.abs(n)>q||"y"===b)&&(f=null),(Math.abs(o)>q||"x"===b)&&(g=null),f||g){var r=!1,s={};if(f&&(r=!0,s.xList=f,s.x=n),g&&(r=!0,s.yList=g,s.y=o),r)return s}}},fm.prototype._46O=function(a){var b=this;b.editing&&(b.editing=null,b._interactor.fi({kind:"endEditPoint",event:a})),b._guideInfo=null,b._edgeHostGuideInfo=null,b._pan&&(b._pan=null,b._interactor.fi({kind:"endPan",event:a})),b._multiSelect&&(b._handleMultiSelect(b._multiSelect),b._multiSelect=null),b.tipInfo=null,b.edgeEditResult=null},fm.prototype._handleMultiSelect=function(a){if(a.startPoint&&a.endPoint){var b,d,e,f,g,h=this,i=h._interactor,k=i.gv,l=Hl.toScreenPosition(k,a.startPoint),m=Hl.toScreenPosition(k,a.endPoint),n=j.Default.unionPoint(l,m),o=h.screenInfo.curve._curves,p=[],q=function(a){a.x>=n.x&&a.y>=n.y&&a.x<=n.x+n.width&&a.y<=n.y+n.height&&p.indexOf(a)<0&&p.push(a)};for(b=0,d=o.length;d>b;b++)g=o[b],q(g._p1),q(g._p4);if(p.length){var r=h.activing||{},s=r.selections||[];for(r.point&&s.push(r.point),b=0,d=s.length;d>b;b++)e=s[b],f=p.indexOf(e),f>=0?p[f]=c:p.push(e);var t=p;for(p=[],b=0,d=t.length;d>b;b++)t[b]&&p.push(t[b]);d=p.length,0===d?h.activing=null:1===d?h.activing={point:p[0]}:(e=p[d-1],h.activing={point:e,selections:p.splice(0,d-1)}),i.redraw()}}},fm.prototype._canDeletePoint=function(a,b){var c=this.target;if(!(c instanceof j.Edge))return!0;var d=a._curves[0],e=a._curves[a._curves.length-1];return d._p1===b||e._p4===b?!1:!0},fm.prototype.handleDelete=function(){var a=this;if(a.activing&&a.screenInfo){
var b=j.Default.isShiftDown(),c=a.screenInfo.curve;a._canDeletePoint(c,a.activing.point)&&c.deleteRealPoint(a.activing.point,b),a.activing.selections&&a.activing.selections.forEach(function(d){a._canDeletePoint(c,d)&&c.deleteRealPoint(d,b)}),a.activing=null,delete a.editing,delete a.tipInfo,delete a.edgeEditResult,delete a._pan,delete a._multiSelect,a._writeToHt(),a._interactor.fp("deleteShapePoint",!1,!0)}},fm.prototype.handleDoubleClick=function(a){var b=this,c=b._interactor._getLogicalPoint(a);if(b.screenInfo&&b._checkEditRealPoint(c)){var d=b.getCurrentSelectintStatus(),e=Hl.Curve.PointType;return d=d===e.Mirrored?e.Straight:e.Mirrored,b._setCurrentSelectionStatus(d),b._interactor._42(),!0}},fm.prototype._drawHighlight=function(a){var b=this,c=b.highlight;if(c){var d=c.bezier,e=b._interactor;d&&Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeHighlightCurve,[d._p1.x,d._p1.y,d._p2.x,d._p2.y,d._p3.x,d._p3.y,d._p4.x,d._p4.y]);var f=c.point;f&&"insertKnot"===c.type&&Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeHighlighPoint,f)}},fm.prototype._drawGuide=function(a){var b=this,c=b._guideInfo;if(c){var d,e,f,g,h=c.v;for(d=0;2>d;d++)if(g=0===d?c.xList:c.yList)for(e=0,f=g.length;f>e;e++)Hl.Icons.DrawIcon(b._interactor,a,Hl.Icons.ShapeGuideLine,[h.x,h.y,g[e].x,g[e].y])}},fm.prototype._drawCurrentPoint=function(a){var b=this;if(b.activing){var c=b.activing,d=b.getCurrentSelectintStatus(),e=b._interactor;if(d!==Hl.Curve.PointType.Straight){var f=c.pairs,g=(c.hlpair,c.hltype,c.selections),h=c.editingCtrl;if(f&&!g){var i,j,k;for(j=0,k=f.length;k>j;j++)i=f[j],h&&j===h.pairId&&i[h.type]?Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeActivingCtrl,{point:i.point,c1:i.c1,c2:i.c2,hl:h.type}):Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeActivingCtrl,i)}}Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeHighlighRealPoint,b.activing.point),g&&g.forEach(function(b){Hl.Icons.DrawIcon(e,a,Hl.Icons.ShapeHighlighRealPoint,b)})}},fm.prototype.clear=function(){var a=this;a.editing=null,a._guideInfo=null,a.activing=null,a.highlight=null},fm.prototype._42=function(b){var c=this;c.info={},c.editing||(c.screenInfo=null);var d=c._interactor;if(!d.editDetail)return void c.clear();var e=d.gv;if(!c.target||!e.isSelected(c.target)||!e.isVisible(c.target))return d.editDetail=!1,void c.clear();if(c.gatherSingleTarget(e,c.target),Hl.Icons.DrawIcon(d,b,Hl.Icons.ShapeBgCurve,c.screenInfo),c._drawHighlight(b),c._drawCurrentPoint(b),c._getRealPoint().forEach(function(a){Hl.Icons.DrawIcon(d,b,Hl.Icons.ShapePoint,a)}),c._drawGuide(b),c.tipInfo&&Hl.Icons.DrawIcon(d,b,Hl.Icons.TipHelper,c.tipInfo),c._edgeHostGuideInfo){Hl.Icons.DrawIcon(d,b,Hl.Icons.NodeHoverGuide,c._edgeHostGuideInfo.corners);var f=c._edgeHostGuideInfo.host;if(f){var g=e.getAttachPoints(f);if(g&&g.length)for(var h=0,i=g.length;i>h;h++){var k=g[h],l=Aj(e,f,0,k.offsetX||0,k.offsetY||0,k.x,k.y);l=Hl.toScreenPosition(e,l),l.isAttach=c._edgeHostGuideInfo.attach===h,Hl.Icons.DrawIcon(d,b,Hl.Icons.AttachPoint,l)}}}if(c._interactor.getStyle("curveElevationVisible")&&c.target instanceof j.Polyline&&c.activing){var m=c.activing.getCurrentEditingPoint();m&&Hl.Icons.DrawIcon(d,b,Hl.Icons.EdgeElevationGuide,m)}if(c.edgeEditResult&&c._drawEdgeHostHighlight(b,c.edgeEditResult.host,c.edgeEditResult.anchor),c._multiSelect&&c._multiSelect.endPoint){var n=j.Default.unionPoint(Hl.toScreenPosition(e,c._multiSelect.startPoint),Hl.toScreenPosition(e,c._multiSelect.endPoint));n.color=e.getRectSelectBorderColor(),b.save(),b.setTransform(1,0,0,1,0,0);var o=a.devicePixelRatio,p=n.borderWidth=Math.round(o);p/=2,n.x=Math.round(n.x*o)+p,n.y=Math.round(n.y*o)+p,n.width=Math.round(n.width*o),n.height=Math.round(n.height*o),Hl.Icons.DrawIcon(d,b,Hl.Icons.SimpleRect,n),b.restore()}},fm.prototype._drawEdgeHostHighlight=function(a,b,c){this.drawEdgeHostHighlight(a,b,c),this._interactor.redraw()},fm.prototype.drawEdgeHostHighlight=function(a,b,d){if(Ld(b)){var e,f,g,h,i=this,j=i._interactor,k=j.gv,l=k.getDataUI(b),m=Sj(l),n=[];for(g=0,h=m.points.length;h>g;g++)f=Hl.toScreenPosition(k,m.points.get(g)),n.push(f.x,f.y);m.segments&&(e=m.segments.toArray());var o=j.getStyle("edgeHostHighlighPeriod"),p=j.getStyle("edgeHostEdgeHighlighColor");Hl.Icons.DrawIcon(j,a,Hl.Icons.ShapeBgCurve,{P:n,S:e,color:p,dynamicVisible:d.index===c,dynamicPeriod:o}),p=j.getStyle("edgeHostPointHighlighColor");var q=Yj(l);for(g=0,h=q.length;h>g;g++){var r=q[g],s=Hl.toScreenPosition(k,r);Hl.Icons.DrawIcon(j,a,Hl.Icons.ShapePoint,{point:{x:s.x,y:s.y},color:p,size:12,dynamicVisible:g===d.index,dynamicPeriod:o})}}},fm.prototype._getRealPoint=function(){var a,b=this.screenInfo,c=b.P,d=b.S,e=-1,f=[],g=-1,h=d.length;return d.each(function(b){g++;var i=1;if(3===b)i=2;else if(4===b)i=3;else if(5===b)return;e+=i,a=g+1>=h?!0:1===d.get(g+1)?!0:!1,f.push({point:{x:c[2*e],y:c[2*e+1]},segmentIndex:g,pointIndex:e,isEnd:a})}),f},fm.prototype.getEditingPointsInfo=function(a){var b=this,c=b.activing;if(!c)return!1;var d=c.point;if(!d)return!1;var e=this._getRealPoint(),f=[{screen:d}];c.selections&&c.selections.forEach(function(a){f.push({screen:a})});var g,h,i=e.length;return f.forEach(function(a){for(g=0;i>g;g++)if(h=e[g],a.screen.isNearEnough(h.point)){a.segmentIndex=h.segmentIndex,a.pointIndex=h.pointIndex,a.point=b.target.getPoints().get(h.pointIndex);break}}),a&&f.sort(function(a,b){return a.segmentIndex-b.segmentIndex}),f};var rm=Hl.MoveHelper=function(a){var b=this;b.catalog="Move",b._interactor=a};rm.prototype={},rm.prototype.constructor=rm,rm.prototype.calcShift=function(a,b,c){var d,e,f=this,g=f._interactor.gv,h=g.lp(b);if("beginMove"===a&&f._gatherGridInfo(c._lastLogicalPoint||h),d=f._target){var i=d.downPosition;if(i){var k=f._interactor.getStyle("moveSensitivity")/g._zoom;if(i.distanceTo(h)<k)return{x:0,y:0};delete d.downPosition}var l;e=j.Default.isShiftDown(b),e&&(h=f._dealShiftDown(h),l=d.shiftGuide.dir);var m,n=d.rawPos={x:d.pos.x+h.x-d.lp.x,y:d.pos.y+h.y-d.lp.y};if(j.Default.isCtrlDown(b)){if(m=f._calcShiftByAddon(),f._target.node instanceof Hl.Group){var o=f._target.node;o._position.x+=m.x,o._position.y+=m.y}return m}for(var p,q=d.x+n.x,r=d.y+n.y,s={x:q,y:r},t={x:q+d.w/2,y:r+d.h/2},u={x:q+d.w,y:r+d.h},v=f._interactor.rectGuide,w=f._interactor.gridGuide,x=[v.findClosest(s,l),v.findClosest(t,l),v.findClosest(u,l),w.findClosest(s,l),w.findClosest(t,l),w.findClosest(u,l)],y=1/0,z=1/0,A=0,B=x.length;B>A;A++)p=x[A],p&&(q=p.x,r=p.y,isFinite(q)&&Math.abs(q)<Math.abs(y)&&(y=q),isFinite(r)&&Math.abs(r)<Math.abs(z)&&(z=r));if(isFinite(y)||(y=0),isFinite(z)||(z=0),m=f._calcShiftByAddon(y,z),f._target.node instanceof Hl.Group){var o=f._target.node;o._position.x+=m.x,o._position.y+=m.y}var C=d.node;if(!Nd(C,g)){var D=n.x+y,E=n.y+z;f._interactor.rectGuide.gatherLines({node:C,x:d.x+D,y:d.y+E,w:d.w,h:d.h},l)}return m}},rm.prototype._calcShiftByAddon=function(a,b){var c=this._target,d=c.rawPos,e=c.node.getPosition();return a=a||0,b=b||0,{x:d.x-e.x+a,y:d.y-e.y+b}},rm.prototype._dealShiftDown=function(a){var b=this,c=b._target.shiftGuide,d=b._target.lp,e=Math.abs(a.x-d.x),f=Math.abs(a.y-d.y);e>f&&e>c.limit&&"y"===c.dir&&(c.dir="x"),f>e&&f>c.limit&&"x"===c.dir&&(c.dir="y");var g=c.dir;return"x"===g?(a.y=d.y,c.limit=Math.max(c.limit,e)):"y"===g&&(a.x=d.x,c.limit=Math.max(c.limit,f)),a},rm.prototype._gatherGridInfo=function(a){var b,c=this,d=c._interactor,e=d._getValidSelection();if(e.length){if(1===e.length){if(b=e[0],!b.getRect)return void(c._target=null)}else if(b=Hl.Group.findOrCreateGroup(e),!b)return void(c._target=null)}else{var e=d.gv.sm().getSelection();if(e.length&&(b=e.get(0),!b.getRect))return void(c._target=null)}var f=b.getPosition(),g=b.getRect();c._target={node:b,x:g.x-f.x,y:g.y-f.y,w:g.width,h:g.height,lp:{x:a.x,y:a.y},pos:{x:f.x,y:f.y},shiftGuide:{dir:"x",limit:0},downPosition:new Hl.Math.Vector2(a)},d.rectGuide.gatherRects()},rm.prototype.clear=function(){var a=this;a._interactor.rectGuide.clear(),a._interactor._42()};var sm="directional",tm="point",um="spot",vm="light.color",wm={},xm=function(a,b){Cd(b)&&$c.test(b)?zo(a,b):Fd(b)&&b.modelType?Ao(a,b):Tc[a]=b},ym=function(a){if(Fd(a))return a.modelType?a.uuid?Tc[a.uuid]:(a.uuid=j.Math.generateUUID(),Ao(a.uuid,a),c):a;var b=Tc[a];return a&&b===c&&$c.test(a)&&(wo&&wo[a]||zo(a,a)),b},zm=function(a,b){a.frameStack?a.frameStack.push(b):a.frameStack=[b],a.bindFramebuffer(a.FRAMEBUFFER,b)},Am=function(a){var b=a.frameStack;if(b){if(b.pop(),b.length)return void a.bindFramebuffer(a.FRAMEBUFFER,b[b.length-1]);a.frameStack=null}a.bindFramebuffer(a.FRAMEBUFFER,null)};Td(l,{graph3dViewAttributes:i,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:M/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:eg,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:M/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:xm,getShape3dModel:ym,createMatrix:function(a,b){Hd(a)||(a=[a]);for(var c=a.length-1;c>=0;c--){var d=a[c];b=Fi(d.mat,d.s3,d.r3,d.rotationMode,d.t3,b)}return b},transformVec:function(a,b){return yi(a,b)},glBindFrame:zm,glUnbindFrame:Am,createBoxModel:function(){return{vs:Fo,ns:Io,uv:Ho,is:Go}},createRoundRectModel:function(a,b){return Uo.roundRect(a,b)},createStarModel:function(a,b){return Uo.star(a,b)},createRectModel:function(a,b){return Uo.rect(a,b)},createTriangleModel:function(a,b){return Uo.triangle(a,b)},createRightTriangleModel:function(a,b){return Uo.rightTriangle(a,b)},createParallelogramModel:function(a,b){return Uo.parallelogram(a,b)},createTrapezoidModel:function(a,b){return Uo.trapezoid(a,b)},createSmoothSphereModel:function(a,b,c,d,e,f,g){return _j(new Lk(a,b,c,d,e,f,g))},createSphereModel:function(a,b,c,d,e,f){return a?Mo(a,b,c,d,e,f):l.createSmoothSphereModel()},createSmoothConeModel:function(a,b,c,d,e){return Ro(a,b,c,d,e)},createConeModel:function(a,b,c,d,e,f){return a?So(a,b,c,d,e,f):Ro(f)},createSmoothCylinderModel:function(a,b,c,d,e,f,g,h){return _j(new Kk(a,b,c,d,e,f,g,h))},createCylinderModel:function(a,b,c,d,e,f,g){return a?Qo(a,b,c,d,e,f,g):Po(f,g)},createSmoothTorusModel:function(a,b,c,d,e,f){return _j(new Mk(a,b,c,d,e,f))},createTorusModel:function(a,b,c,d,e,f,g){return a?Oo(a,b,c,d,e,f,g):No(f,g)},createExtrusionModel:function(a,b,c,d,e,f,g,h){return To(a,b,c,d,e,f,g,h)},createSmoothRingModel:function(a,b,c,d,e,f){for(var g=[],h=0;h<a.length-1;h+=2)g.push({x:a[h],y:a[h+1]});for(a=Af(g,b,c)[0],g=[],h=0;h<a.length;h++){var i=a[h];g.push(new fk(i.x,0,i.y))}return _j(new Qk(g,f,d,e))},createTextGeometry:function(a,b){return _j(new Rk(a,b))},loadFontFace:function(a,b){l.xhrLoad(a,function(a){if(!a)return b();var c;try{c=JSON.parse(a)}catch(d){c=JSON.parse(a.substring(65,a.length-2))}Ak.loadFace(c),b&&b(c.familyName.toLowerCase())},b?null:{sync:!0})},createRingModel:function(a,b,c,d,e,f,g,h,j,k){for(var m=[],n=0;n<a.length-1;n+=2)m.push({x:a[n],y:a[n+1]});f=f||l.shapeSide,g=g||0,h=h||f;var o,p,q,r,s,t,u,v,w,x,n,y,z,A,B,C,D,E,F=[],G=[],I=j?[]:i,K=j?[]:i,L=k?[]:i,M=k?[]:i,N=d?[]:i,O=d?[]:i,P=e?[]:i,Q=e?[]:i,a=Af(m,b,c),R=je(a),S=0,T=2*Math.PI/f;return a.forEach(function(a){if(q=a.length,q>1){if(r=a[0],d)for(t=r.x,v=r.y,n=g;h>n;n++)y=n+1,z=n*T,A=y*T,B=H(z),C=J(z),D=H(A),E=J(A),N.push(B*t,v,-C*t,D*t,v,-E*t,0,v,0),O.push(.5-.5*B,.5-.5*C,.5-.5*D,.5-.5*E,.5,.5);for(x=0;q>x;x++){for(s=a[x],t=r.x,u=s.x,v=r.y,w=s.y,o=S/R,S+=Vh(r,s),p=S/R,n=g;h>n;n++)y=n+1,z=n*T,A=y*T,B=H(z),C=J(z),D=H(A),E=J(A),F.push(B*u,w,-C*u,D*u,w,-E*u,B*t,v,-C*t,D*u,w,-E*u,D*t,v,-E*t,B*t,v,-C*t),G.push(n/f,p,y/f,p,n/f,o,y/f,p,y/f,o,n/f,o),j&&n===g&&(I.push(0,v,0,0,w,0,B*u,w,-C*u,B*u,w,-C*u,B*t,v,-C*t,0,v,0),K.push(0,.5-v,0,.5-w,2*u,.5-w,2*u,.5-w,2*t,.5-v,0,.5-v)),k&&y===h&&(L.push(0,v,0,D*u,w,-E*u,0,w,0,D*u,w,-E*u,0,v,0,D*t,v,-E*t),M.push(1,.5-v,1-2*u,.5-w,1,.5-w,1-2*u,.5-w,1,.5-v,1-2*t,.5-v));r=s}if(e)for(t=r.x,v=r.y,n=g;h>n;n++)y=n+1,z=n*T,A=y*T,B=H(z),C=J(z),D=H(A),E=J(A),P.push(D*t,v,-E*t,B*t,v,-C*t,0,v,0),Q.push(.5-.5*D,.5+.5*E,.5-.5*B,.5+.5*C,.5,.5)}}),{vs:F,uv:G,bottom_vs:P,bottom_uv:Q,top_vs:N,top_uv:O,from_vs:I,from_uv:K,to_vs:L,to_uv:M}}},!0),Td(m,{"3d.move.mode":c,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":c,"edge.gradient.color":c,"edge.source.t3":c,"edge.target.t3":c,"light.type":tm,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":M/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":rg,"wf.short":!1,"wf.mat":c,"wf.geometry":!1,"wf.loadQuadWireframe":!1,"wf.combineTriangle":!0,batch:c,"transparent.mask":!1,brightness:c,"select.brightness":.7,"repeat.uv.length":c,alphaTest:.4,renderTextureSamples:4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":ma,"label.t3":c,"label.r3":c,"label.texture.scale":2,"label.rotationMode":Wk,"label.light":!1,"label.blend":c,"label.reverse.flip":!1,"label.reverse.color":cg,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":ma,"label2.t3":c,"label2.r3":c,"label2.texture.scale":2,"label2.rotationMode":Wk,"label2.light":!1,"label2.blend":c,"label2.reverse.flip":!1,"label2.reverse.color":cg,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":ma,"note.t3":c,"note.r3":c,"note.texture.scale":2,"note.rotationMode":Wk,"note.light":!1,"note.blend":c,"note.reverse.flip":!1,"note.reverse.color":cg,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":ma,"note2.t3":c,"note2.r3":c,"note2.texture.scale":2,"note2.rotationMode":Wk,"note2.light":!1,"note2.blend":c,"note2.reverse.flip":!1,"note2.reverse.color":cg,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:c,"shape3d.color":pg,"shape3d.top.color":c,"shape3d.bottom.color":c,"shape3d.from.color":c,"shape3d.to.color":c,"shape3d.image":c,"shape3d.top.image":c,"shape3d.bottom.image":c,"shape3d.from.image":c,"shape3d.to.image":c,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":c,"shape3d.side.to":c,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":c,"shape3d.opacity":c,"shape3d.reverse.flip":!1,"shape3d.reverse.color":cg,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":c,"shape3d.uv.scale":c,"shape3d.top.uv.offset":c,"shape3d.top.uv.scale":c,"shape3d.bottom.uv.offset":c,"shape3d.bottom.uv.scale":c,"shape3d.from.uv.offset":c,"shape3d.from.uv.scale":c,"shape3d.to.uv.offset":c,"shape3d.to.uv.scale":c,"shape3d.top.cap":c,"shape3d.bottom.cap":c,"shape3d.start.angle":0,"shape3d.sweep.angle":N,"shape3d.point.epsilon":1e-6,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":c,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":pg,"all.image":c,"all.blend":c,"all.opacity":c,"all.reverse.flip":!1,"all.reverse.color":cg,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":c,"all.uv.offset":c,"all.uv.scale":c,"all.discard.selectable":!0,mat:c,"left.mat":c,"right.mat":c,"top.mat":c,"bottom.mat":c,"front.mat":c,"back.mat":c},!0);var Bm,Cm=!1,Dm=[0,0,0,0],Em={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:oa,2:pa,3:qa,4:ra,5:ma,6:na}},Fm=function(a,b,c,d){if(b.getFaceVisible(a,c)){Kn(b,Ei(a,b.getFaceMat(a,c)||b.getMat(a)));var e=b._26I;b.getFaceReverseCull(a,c)?e.enable(e.CULL_FACE):e.disable(e.CULL_FACE),Fn(e,b._prg.uFixPickReverseColor,Em[c]),vn(e),zn(e,d,6),wn(e),In(b)}},Gm=function(a){return a instanceof Hp},Hm=function(a){return[a.x,a.e||0,a.y]},Im=function(a,b,c){for(var b=rf(b),d=b[0],e=b[1],f=b[2];c--;)a.push(d,e,f)},Jm=function(a,b,c){for(var b=rf(b),d=b[0],e=b[1],f=b[2],g=b[3];c--;)a.push(d,e,f,g)},Km=function(a,b,c){if(b)for(var d,e,f,g=b[0],h=b[1],i=b[2],j=b[4],k=b[5],l=b[6],m=b[8],n=b[9],o=b[10],p=b[12],q=b[13],r=b[14],s=c.length,t=0,t=0;s>t;t+=3)d=c[t],e=c[t+1],f=c[t+2],a.push(g*d+j*e+m*f+p,h*d+k*e+n*f+q,i*d+l*e+o*f+r);else Rd(a,c)},Lm=function(a,b){var c=b.s("light.intensity"),d=rf(b.s(vm)),e=d[0],f=d[1],g=d[2];1!==c&&(e*=c,f*=c,g*=c),a.push(e,f,g,b.s("light.disabled")?1:0)},Mm=function(a,b,c){Fn(b,c.uHeadlightRange,a._headlightRange);var d=a._headlightIntensity,e=rf(a._headlightColor);1!==d&&(e=[e[0]*d,e[1]*d,e[2]*d]),Fn(b,c.uHeadlightColor,[e[0],e[1],e[2],a._headlightDisabled?1:0]);var f=a._59O,g=a._spots,h=a._dirs;if(f.length){var i=[],j=[],k=[];f.forEach(function(b){Lm(i,b),Rd(j,a._transformPointToViewSpace(b.p3())),k.push(b.s("light.range"))}),b.uniform4fv(c.uPointColor,i),b.uniform1fv(c.uPointRange,k),b.uniform3fv(c.uPointPosition,j)}if(g.length){var l=[],m=[],n=[],o=[],p=[],q=[];g.forEach(function(b){Lm(l,b),Rd(m,a._transformPointToViewSpace(b.p3())),Rd(p,a._transformDirectionToViewSpace(b.p3(),b.s("light.center"))),n.push(b.s("light.range")),o.push(H(b.s("light.angle")/2)),q.push(b.s("light.exponent"))}),b.uniform4fv(c.uSpotColor,l),b.uniform1fv(c.uSpotRange,n),b.uniform1fv(c.uSpotAngle,o),b.uniform1fv(c.uSpotExponent,q),b.uniform3fv(c.uSpotPosition,m),b.uniform3fv(c.uSpotDirection,p)}if(h.length){var r=[],s=[];h.forEach(function(b){Lm(r,b),Rd(s,a._transformDirectionToViewSpace(b.p3()))}),b.uniform4fv(c.uDirColor,r),b.uniform3fv(c.uDirDirection,s)}},Nm=function(a){return a>0&&0===(a-1&a)},Om=function(a){return a=E(0,F(M,a)),a=E(ni,F(M-ni,a))},Pm=function(){return.05+R()/2},Qm=function(a,b,c,d){var e,f=a.getEye();return a.isOrtho()?(e=qi(a.getCenter(),f),e[0]+=d[0],e[1]+=d[1],e[2]+=d[2]):e=f,Rm(b,c,d,e)},Rm=function(a,b,c,d){var e=si(a,b),f=qi(d,c,!0),g=si(f,b);if(G(g)<ni)return i;var h=(e-si(c,b))/g;return[c[0]+f[0]*h,c[1]+f[1]*h,c[2]+f[2]*h]},Sm=function(a,b){return{x:2*a.x-b.x,y:2*a.y-b.y}},Tm=function(a,b,c,d){var e,f;if(!a)return e=Q(b.y-c.y,c.x-b.x),{x:b.x+d*J(e),y:b.y+d*H(e)};if(!c)return e=Q(a.y-b.y,b.x-a.x),{x:b.x+d*J(e),y:b.y+d*H(e)};var g=qi([a.x,a.y,0],[b.x,b.y,0],!0),h=qi([c.x,c.y,0],[b.x,b.y,0],!0),i=-(g[0]+h[0])/2,j=-(g[1]+h[1])/2,k=D(i*i+j*j);if(ni>k)return e=Q(a.y-b.y,b.x-a.x),{x:b.x+d*J(e),y:b.y+d*H(e)};var l=a.x-b.x,m=a.y-b.y,n=c.x-b.x,o=c.y-b.y,p=D(l*l+m*m),q=D(n*n+o*o);e=I(si(g,h))/2,f=g[1]*h[0]-g[0]*h[1]>0?-1:1,i/=k,j/=k;var r=d/J(e),s=E(p,q)/H(e);k=Math.min(r,s);var t={x:b.x+f*k*i,y:b.y+f*k*j};return c.b&&r>q/H(e)&&(t.adjust=!0),t},Um=function(a){var b=a[1],c=a[2],d=a[3],e=a[6],f=a[7],g=a[11];a[1]=a[4],a[2]=a[8],a[3]=a[12],a[4]=b,a[6]=a[9],a[7]=a[13],a[8]=c,a[9]=e,a[11]=a[14],a[12]=d,a[13]=f,a[14]=g},Vm=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],j=a[7],k=a[8],l=a[9],m=a[10],n=a[11],o=a[12],p=a[13],q=a[14],r=a[15],s=b*g-c*f,t=b*h-d*f,u=b*j-e*f,v=c*h-d*g,w=c*j-e*g,x=d*j-e*h,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(g*D-h*C+j*B)*E,a[1]=(d*C-c*D-e*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(h*A-f*D-j*z)*E,a[5]=(b*D-d*A+e*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(f*C-g*A+j*y)*E,a[9]=(c*A-b*C-e*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(g*z-f*B-h*y)*E,a[13]=(b*B-c*z+d*y)*E,a[14]=(p*t-o*v-q*s)*E,void(a[15]=(k*v-l*t+m*s)*E)):i},Wm=function(a,b){if(b){var c=b[0],d=b[1],e=b[2];a[12]=a[0]*c+a[4]*d+a[8]*e+a[12],a[13]=a[1]*c+a[5]*d+a[9]*e+a[13],a[14]=a[2]*c+a[6]*d+a[10]*e+a[14],a[15]=a[3]*c+a[7]*d+a[11]*e+a[15]}},Xm=function(a,b){if(b){var c=b[0],d=b[1],e=b[2];a[0]=a[0]*c,a[1]=a[1]*c,a[2]=a[2]*c,a[3]=a[3]*c,a[4]=a[4]*d,a[5]=a[5]*d,a[6]=a[6]*d,a[7]=a[7]*d,a[8]=a[8]*e,a[9]=a[9]*e,a[10]=a[10]*e,a[11]=a[11]*e}},Ym=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},Zm=function(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o=b[0],p=b[1],q=b[2],r=d[0],s=d[1],t=d[2],u=c[0],v=c[1],w=c[2];return G(o-u)<ni&&G(p-v)<ni&&G(q-w)<ni?xi(a):(k=o-u,l=p-v,m=q-w,n=1/D(k*k+l*l+m*m),k*=n,l*=n,m*=n,e=s*m-t*l,f=t*k-r*m,g=r*l-s*k,n=D(e*e+f*f+g*g),n?(n=1/n,e*=n,f*=n,g*=n):(e=0,f=0,g=0),h=l*g-m*f,i=m*e-k*g,j=k*f-l*e,n=D(h*h+i*i+j*j),n?(n=1/n,h*=n,i*=n,j*=n):(h=0,i=0,j=0),a[0]=e,a[1]=h,a[2]=k,a[3]=0,a[4]=f,a[5]=i,a[6]=l,a[7]=0,a[8]=g,a[9]=j,a[10]=m,a[11]=0,a[12]=-(e*o+f*p+g*q),a[13]=-(h*o+i*p+j*q),a[14]=-(k*o+l*p+m*q),a[15]=1,a)},$m=function(a,b,c,d,e){var f=1/P(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},_m=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},an=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,h=g?1/g:0;return a[0]=-c*h,a[1]=-d*h,a[2]=-e*h,a[3]=f*h,a},bn=function(a,b){var c=b[0]+b[5]+b[10],d=0;return c>0?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d),a},cn=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},dn=function(a,b){if(a.vr.enable){var c=a.vr.getViewMatrix(b);if(c)return c}return Zm(b?b:ti(),a._eye,a._center,a._up)},en=function(a,b){if(a.vr.enable){var c=a.vr.getProjectMatrix();if(c)return c}if(!b&&a._computedProjectMatrix)return vi(a._computedProjectMatrix);var d=a.getAspect(),e=a._near,f=a._far,g=ti();if(a._ortho){var h=a._orthoWidth/2,i=h/d;_m(g,-h,h,-i,i,e,f)}else $m(g,a._fovy,d,e,f);return g},fn=function(a,b){if(!a)return i;var c=0,d=1,e=2,f=[],g=0,h=a.length,j=h/3;if(b){for(;h>g;g++)f[g]=0;for(g=0;g<b.length;g+=3){var k=[],l=[],m=[];k[c]=a[3*b[g+1]+c]-a[3*b[g]+c],k[d]=a[3*b[g+1]+d]-a[3*b[g]+d],k[e]=a[3*b[g+1]+e]-a[3*b[g]+e],l[c]=a[3*b[g+2]+c]-a[3*b[g+1]+c],l[d]=a[3*b[g+2]+d]-a[3*b[g+1]+d],l[e]=a[3*b[g+2]+e]-a[3*b[g+1]+e],m[c]=k[d]*l[e]-k[e]*l[d],m[d]=k[e]*l[c]-k[c]*l[e],m[e]=k[c]*l[d]-k[d]*l[c];for(var n=0;3>n;n++)f[3*b[g+n]+c]+=m[c],f[3*b[g+n]+d]+=m[d],f[3*b[g+n]+e]+=m[e]}}else for(g=0;j>g;g+=3){var k=[],l=[],m=[];k[c]=a[3*(g+1)+c]-a[3*g+c],k[d]=a[3*(g+1)+d]-a[3*g+d],k[e]=a[3*(g+1)+e]-a[3*g+e],l[c]=a[3*(g+2)+c]-a[3*(g+1)+c],l[d]=a[3*(g+2)+d]-a[3*(g+1)+d],l[e]=a[3*(g+2)+e]-a[3*(g+1)+e],m[c]=k[d]*l[e]-k[e]*l[d],m[d]=k[e]*l[c]-k[c]*l[e],m[e]=k[c]*l[d]-k[d]*l[c];for(var n=0;3>n;n++)f[3*(g+n)+c]=m[c],f[3*(g+n)+d]=m[d],f[3*(g+n)+e]=m[e]}for(g=0;h>g;g+=3){var o=[];o[c]=f[g+c],o[d]=f[g+d],o[e]=f[g+e];var p=D(o[c]*o[c]+o[d]*o[d]+o[e]*o[e]);0===p&&(p=ni),o[c]=o[c]/p,o[d]=o[d]/p,o[e]=o[e]/p,f[g+c]=o[c],f[g+d]=o[d],f[g+e]=o[e]}return new pi(f)},gn=function(a,b,c,d){if(c||(c=a.createTexture()),b){var e=a.TEXTURE_2D,f=a.REPEAT,g=a.CLAMP_TO_EDGE,h=a.TEXTURE_MIN_FILTER;d!==a.NEAREST&&(d=a.LINEAR),mn(a,c),a.texImage2D(e,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,b),nn(a,a.TEXTURE_MAG_FILTER,d);var j=b.naturalWidth||b.width,k=b.naturalHeight||b.height;Nm(j)&&Nm(k)&&!b.clampToEdge?(nn(a,a.TEXTURE_WRAP_S,f),nn(a,a.TEXTURE_WRAP_T,f),nn(a,h,a.LINEAR_MIPMAP_LINEAR),a.generateMipmap(e)):(nn(a,a.TEXTURE_WRAP_S,g),nn(a,a.TEXTURE_WRAP_T,g),nn(a,h,d)),mn(a,i)}return c},hn=function(a,b){var c=new Uint8Array(4);return b=b||a.createTexture(),mn(a,b),nn(a,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,1,1,0,a.RGBA,a.UNSIGNED_BYTE,c),b},jn=function(a){a._26I&&a._prg&&(a._26I.deleteProgram(a._prg),a._prg=i)},kn=function(a,b,c,d){var e=a.createShader(c);return a.shaderSource(e,d),a.compileShader(e),a.attachShader(b,e),e},ln=function(a){return a.createBuffer()},mn=function(a,b){a.bindTexture(a.TEXTURE_2D,b)},nn=function(a,b,c){a.texParameteri(a.TEXTURE_2D,b,c)},on=function(a,b){a.enable(a.POLYGON_OFFSET_FILL),a.polygonOffset(b[0],b[1])},pn=function(a){a.disable(a.POLYGON_OFFSET_FILL)},qn=function(a,b){if(b){var b=rf(b);a.clearColor(b[0],b[1],b[2],b[3])}},rn=function(a,b){Fn(a,b.uFix,!0),Hn(a,b.aNormal)},sn=function(a,b){Fn(a,b.uFix,!1),Gn(a,b.aNormal)},tn=function(a,b,c,d,e,f,g,h){a._picking||(c?(Fn(a,b.uBlend,!0),Fn(a,b.uBlendColor,c)):Fn(a,b.uBlend,!1),Fn(a,b.uLight,d==i?!0:d),Dd(e)&&1!==e&&Fn(a,b.uPartOpacity,e),Fn(a,b.uReverseFlip,f==i?!1:f),Fn(a,b.uFixPickReverseColor,g||cg)),h?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE)},un=function(a,b){a._picking||Fn(a,b.uPartOpacity,1)},vn=function(){var a=[0,0,1,1];return function(b,c,d,e,f,g,h,i,j){return d?(Fn(b,c.uTexture,!0),Fn(b,c.uDiscardSelectable,Ed(e)?e:!0),Gn(b,c.aUv),Bn(b,f,g,c.aUv,2),j?(Fn(b,c.uBlendTexture,!0),b.activeTexture(b.TEXTURE1),mn(b,j),b.uniform1i(c.uBlendSampler,1)):(Fn(b,c.uBlendTexture,!1),b.activeTexture(b.TEXTURE1),mn(b,b._emptyBlendTexture)),b.activeTexture(b.TEXTURE0),mn(b,d),b.uniform1i(c.uSampler,0),h?(a[0]=h[0],a[1]=h[1]):(a[0]=0,a[1]=0),i?(a[2]=i[0],a[3]=i[1]):(a[2]=1,a[3]=1),void Fn(b,c.uOffsetScale,a)):(b.activeTexture(b.TEXTURE0),mn(b,b._emptyTexture),b.activeTexture(b.TEXTURE1),void mn(b,b._emptyBlendTexture))}}(),wn=function(a,b,c){a.activeTexture(a.TEXTURE0),mn(a,i),a.activeTexture(a.TEXTURE1),mn(a,i),c&&(Hn(a,b.aUv),Fn(a,b.uTexture,!1),Fn(a,b.uBlendTexture,!1))},xn=function(a,b,c,d,e,f){!c||da||fa||a.lineWidth(c),d&&!a._picking&&Fn(a,b.uFixPickReverseColor,d),e&&Bn(a,e,f,b.aPosition)},yn=function(a,b,c,d){Bm&&(d=a[Bm]),a.drawArrays(d==i?a.TRIANGLES:d,b,c);var e=a._renderInfo;e&&(e.calls++,e.vertices+=c,(d==i||d===a.TRIANGLES)&&(e.faces+=c/3),d===a.LINES&&(e.lines+=c/2))},zn=function(a,b,c,d){Bm&&(d=a[Bm]),a.drawElements(d==i?a.TRIANGLES:d,c,a.UNSIGNED_SHORT,b==i?0:2*b);var e=a._renderInfo;e&&(e.calls++,e.vertices+=c,(d==i||d===a.TRIANGLES)&&(e.faces+=c/3),d===a.LINES&&(e.lines+=c/2))},An=function(a,b,c,d,e){var f=a.ARRAY_BUFFER;a.bindBuffer(f,b),c&&a.bufferData(f,c,a.STATIC_DRAW),d!=i&&a.vertexAttribPointer(d,e?e:3,a.FLOAT,!1,0,0)},Bn=function(a,b,c,d,e){return c?(En(a,a.ARRAY_BUFFER,b,c),void(d!=i&&a.vertexAttribPointer(d,e?e:3,a.FLOAT,!1,0,0))):An(a,b,c,d,e)},Cn=function(a,b,c){var d=a.ELEMENT_ARRAY_BUFFER;a.bindBuffer(d,b),c&&a.bufferData(d,c,a.STATIC_DRAW)},Dn=function(a,b,c){En(a,a.ELEMENT_ARRAY_BUFFER,b,c)},En=function(a,b,c,d){var e=d._bufId;e||(e=d._bufId=j.Math.generateIncreasingID());var c,f=a._bufPool;(c=f[e])&&c._buf?a.bindBuffer(b,c._buf):(c=f[e]={_buf:ln(a)},a.bindBuffer(b,c._buf),a.bufferData(b,d,a.STATIC_DRAW)),c._fid=a._renderInfo.frame},Fn=function(a,b,c){if(c!=i&&b!=i){c=rf(c);var d=c.length;3===d?a.uniform3fv(b,c):4===d?a.uniform4fv(b,c):16===d?a.uniformMatrix4fv(b,!1,c):Ed(c)?a.uniform1i(b,c?1:0):2===d?a.uniform2fv(b,c):a.uniform1f(b,c)}},Gn=function(a,b){b!=i&&b>=0&&a.enableVertexAttribArray(b)},Hn=function(a,b){b!=i&&b>=0&&a.disableVertexAttribArray(b)},In=function(a,b){var c=a.getGL(),d=a._prg;a._7O=a._8O.pop(),b&&(Fn(c,d.uMVMatrix,a._7O),a._6O=b,Fn(c,d.uNMatrix,b))},Jn=function(a,b){return b||(b=ti()),wi(b,a),Vm(b),Um(b),b},Kn=function(a,b){var c=a.getGL(),d=a._prg,e=a._7O;b&&(a._8O.push(vi(e)),Fn(c,d.uMMatrix,b),Ym(e,e,b),a._7O=e),Fn(c,d.uMVMatrix,e),Fn(c,d.uNMatrix,Jn(e,a._6O))},Ln=function(a,b,c,d,e,f){if(c){if(d){var g=c.value++,h=2147483648|g,i=[(h>>16&255)/255,(h>>8&255)/255,(255&h)/255,(h>>24&255)/255];c[g]={data:e,part:f}}else i=Dm;return Fn(a,b.uFixPickReverseColor,i),i}},Mn=function(){var a={center:function(a,b,c,d,e){var f=-b[1]/2,g={x:-b[0]/2,y:f,width:b[0],height:b[1]},h=bg(a,g,c);return[h.x+d,-h.y-e,Pm()]},front:function(a,b,c,d,e){var f=-b[1]/2,g={x:-b[0]/2,y:f,width:b[0],height:b[1]},h=bg(a,g,c);return[h.x+d,-h.y-e,b[2]/2+Pm()]},back:function(a,b,c,d,e){var f=-b[0]/2,g=-b[1]/2,h={x:f,y:g,width:b[0],height:b[1]},i=bg(a,h,c);return[-i.x-d,-i.y-e,-b[2]/2-Pm()]},left:function(a,b,c,d,e){var f=-b[1]/2,g={x:-b[2]/2,y:f,width:b[2],height:b[1]},h=bg(a,g,c);return[-b[0]/2-Pm(),-h.y-e,h.x+d]},right:function(a,b,c,d,e){var f=-b[2]/2,g=-b[1]/2,h={x:f,y:g,width:b[2],height:b[1]},i=bg(a,h,c);return[b[0]/2+Pm(),-i.y-e,-i.x-d]},top:function(a,b,c,d,e){var f={x:-b[0]/2,y:-b[2]/2,width:b[0],height:b[2]},g=bg(a,f,c);return[g.x+d,b[1]/2+Pm(),g.y+e]},bottom:function(a,b,c,d,e){var f=-b[2]/2,g={x:-b[0]/2,y:f,width:b[0],height:b[2]},h=bg(a,g,c);return[h.x+d,-b[1]/2-Pm(),-h.y-e]}};return function(b,c,d,e,f,g){return a[e](b,c,d,f||0,g||0)}}(),Nn=function(a,b,c,d,e,f,g,h,i,j){if(e&&(b[0]+=e[0],b[1]+=e[1],b[2]+=e[2]),Wm(a,c),h){var k=ti();if(Xk(k,i,j),yi(b,k),Wm(a,b),a.auto=h,a.pos=yi([0,0,0],a),f){var l=a.mat2=ti();Xk(l,f,g)}}else Xk(a,i,j),Wm(a,b),d===oa?Ci(a,-O):d===pa?Ci(a,O):d===qa?Bi(a,-O):d===ra?Bi(a,O):d===na&&Ci(a,M),Xk(a,f,g);return a},On=function(a,b){var c=b.auto,d=b.mat2,e=a.gv;if(c){var f,g=ti(),h=[0,0,0,0];f="string"==typeof c?[c.indexOf("x")<0?e._eye[0]:e._center[0],c.indexOf("y")<0?e._eye[1]:e._center[1],c.indexOf("z")<0?e._eye[2]:e._center[2]]:e._eye,bn(h,Zm(ti(),f,e._center,e._up)),cn(g,an(h,h),b.pos),d&&Ym(g,g,d),Kn(e,g)}else Kn(e,b)},Pn=function(a,b,c,d,e){var f=a.s,g=a.gv,h=g.getGL(),i=g._prg,j=g._buffer,k=g._1O;gn(h,nf,k),On(a,c),tn(h,i,f(b+".blend"),f(b+".light"),f(b+".opacity"),f(b+".reverse.flip"),f(b+".reverse.color"),f(b+".reverse.cull")),vn(h,i,k,e,j.uv,Co),Bn(h,j.vs,d,i.aPosition),Bn(h,j.ns,Do,i.aNormal),Dn(h,j.is,Eo),zn(h,0,Eo.length),wn(h,i,k),un(h,i),In(g)},Qn=function(a,b,c){var d=a.gv,e=a.data,f=a[b]={blend:d.getBodyColor(e)||d.getFaceBlend(e,b),light:d.getFaceLight(e,b),color:d.getFaceColor(e,b),opacity:d.getFaceOpacity(e,b),transparent:d.getFaceTransparent(e,b),reverseFlip:d.getFaceReverseFlip(e,b),reverseColor:d.getFaceReverseColor(e,b),reverseCull:d.getFaceReverseCull(e,b),texture:d.getFaceImage(e,b),blendTexture:d.getFaceBlendImage(e,b),discardSelectable:d.getFaceDiscardSelectable(e,b)};if("csg"!==b){f.uv=d.getFaceUv(e,b)||c&&c[b+"Uv"],f.uvScale=d.getFaceUvScale(e,b)||c&&c[b+"UvScale"],f.uvOffset=d.getFaceUvOffset(e,b)||c&&c[b+"UvOffset"];var g=d.getFaceMat(e,b);g&&(f.mat=Ei(e,g))}return f},Rn=function(a,b,c,d,e){if(d){if(!e(d.transparent))return;var f=a.data,g=a.gv,h=g._buffer,i=g.getTexture(d.texture,f),j=g.getTexture(d.blendTexture,f);vn(b,c,i,d.discardSelectable,h.uv,d.tuv,d.uvOffset,d.uvScale,j),tn(b,c,d.blend,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),Fn(b,c.uDiffuse,d.color||m["color.empty"]),
Bn(b,h.vs,d.vs,c.aPosition),Bn(b,h.ns,d.ns,c.aNormal),yn(b,0,d.vs.length/3),un(b,c),wn(b,c,i)}},Sn=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=[d-b,e-c],s=a?a.length:0;for(i=0;s>i;i++){for(j=2,g=a[i],k=g[0],l=g[1];j+1<g.length;){if(m=g[j],n=g[j+1],h=ce(b,c,d,e,k,l,m,n,!0)){o=[m-k,n-l],p=Vh(o),o[0]/=p,o[1]/=p,p=si(r,o),p=p>0?f:-f,q=[o[0]*p,o[1]*p];break}k=m,l=n,j+=2}if(q)break}if(q)for(d=b+q[0],e=c+q[1],i=0;s>i;i++)for(j=2,g=a[i],k=g[0],l=g[1];j+1<g.length;){if(m=g[j],n=g[j+1],h=ce(b,c,d,e,k,l,m,n,!0))return[0,0];k=m,l=n,j+=2}return q?q:[d-b,e-c]},Tn=j.graph3d={},Un=function(a,b,c){ki(g+".graph3d."+a,b,c)},Vn="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",Wn="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw!gjeof$!<*yfusfWw.)f{jmbnspo!>!F!4dfw!ftmf$!<*2!-1!-1)4dfw!>!F!4dfw!DJIQBSHPIUSP!gfegj$!<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Td(l,{setBatchInfo:function(a,b){Sc[a]=b},getBatchInfo:function(a){return Sc[a]}},!0);var Xn=[1,1,1],Yn=[1,0,0,0,0,1,0,1,1,1,1,0],Zn=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],$n=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],_n=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ao=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],bo=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],co=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],eo=function(a,b){fo(a,b,"_batchModelMap","_batchIndexMap"),go(a,b,"_wireframeModelMap","_wireframeIndexMap"),go(a,b,"_polylineModelMap","_polylineIndexMap"),go(a,b,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),go(a,b,"_polylineModelMapSwap","_polylineIndexMapSwap")},fo=function(a,b,c,d){if(!b)return a[c]={},void(a[d]={});var e=b._id,f=a[d],g=f[e];if(g){var h=a[c],i=g.batch,j=h[i],k=j.ds,l=g.index;if(j.invalidate=!0,delete f[e],k.splice(l,1),Yd(k))return void delete h[i];for(var m=g.begin,n=g.size,o=3*m,p=3*n,q=4*m,r=4*n,s=j.vs,t=j.ps,u=j.uv,v=j.cs,w=j.bs,x=j.rs,y=j.ns,z=j.ls;l<k.length;l++)g=f[k[l]._id],g.index--,g.begin-=n;s.splice(o,p),t.splice(q,r),u&&u.splice(2*m,2*n),v&&v.splice(q,r),w&&w.splice(o,p),x&&x.splice(m,n),y&&y.splice(o,p),z&&z.splice(m,n)}},go=fo,ho=function(a,b,c,d){if(!d)return i;var e=b[d];if(!e){var f=Sc[d]||cd,g=f.image?[]:i;e=b[d]={vs:[],ns:[],uv:g,cs:g?i:f.color?i:[],bs:f.blend?[]:i,ps:[],rs:f.brightness?[]:i,ds:[]}}return e.invalidate=!0,a[c._id]={index:e.ds.length,begin:e.vs.length/3,batch:d},e.ds.push(c),e},io=function(a,b){return b!=i&&1!==b?[a[0]*b,a[1]*b,a[2]*b,a[3]]:a},jo=function(){var a;return function(b,d,e){var f=b.getData3dUI(d),g=f.shapeModel;g||(g=bp(f));var h,i=d.s("wf.combineTriangle");if(e.geometry){if(!g&&(d instanceof j.Node&&!(d instanceof j.Shape)?(a||(a={vs:Fo,is:Go,uv:Ho}),g=a):g=[f.left,f.front,f.right,f.back,f.top,f.bottom],!g))return c;if(i?(i=0|Math.min(3,Math.max(1,isNaN(i)?1:i)),h=bk[i-1](g)):h=ck(g),!h||0===h.length)return}else h=e["short"]?Lo:Ko;var k=b.getBrightness(d),l=rf(e.color||"white"),m=l[3]<1,n=Math.ceil(e.width)||1,o=(m?"T":"O")+n,p=b._wireframeIndexMap,q=b._wireframeModelMap,r=q[o];r||(r=q[o]={vs:[],cs:[],ps:[],ds:[],T:m,W:n}),r.invalidate=!0;var s=r.vs,t=r.cs,u=r.ds,v=p[d._id]={index:u.length,begin:s.length/3,batch:o};u.push(d);var w=f.mat;if(!w){w=Ei(d,e.mat);var x=f._calcAnchorMat(d);x&&Ym(w,w,x)}Km(s,w,h);var y=v.size=s.length/3-v.begin;Jm(t,io(l,k),y)}}(),ko=function(a,b,c,d,e,f,g,h,j){var k=a.getBrightness(b);k==i&&(k=1);var l=io(rf(d),k),m=l[3]<1;f=Math.ceil(f)||1;var n=(m?"T":"O")+f;if(g){var o=g[0],p=(g[1]||o)+o;n+="-"+o+"-"+p,j&&(n+="-"+qf(j)+"-"+k,j=io(rf(j),k))}var q=a._polylineIndexMap,r=a._polylineModelMap,s=r[n];s||(s=r[n]={vs:[],cs:[],ps:[],ds:[],ls:g?[]:i,T:m,W:f},g&&(s.D=o,s.G=p,s.A=j)),s.invalidate=!0;var t,u=s.vs,v=s.cs,w=s.ds,x=s.ls,y=q[b._id]={index:w.length,begin:u.length/3,batch:n};w.push(b),Rd(u,c);var z,A=y.size=u.length/3-y.begin,B=c.length,C=0,D=[];if(g||e)for(t=0;B>t;t+=6)z=Vh([c[t],c[t+1],c[t+2]],[c[t+3],c[t+4],c[t+5]]),D.push(z),C+=z;if(C&&e){var E,F=io(rf(e),k),G=[F[0]-l[0],F[1]-l[1],F[2]-l[2],F[3]-l[3]],H=0;for(t=0;B>t;t+=6)E=H/C,Jm(v,[l[0]+G[0]*E,l[1]+G[1]*E,l[2]+G[2]*E,l[3]+G[3]*E],1),H+=D[t/6],E=H/C,Jm(v,[l[0]+G[0]*E,l[1]+G[1]*E,l[2]+G[2]*E,l[3]+G[3]*E],1)}else Jm(v,l,A);if(g)for(H=h||0,t=0;B>t;t+=6)x.push(H),H+=D[t/6],x.push(H)},lo=function(a,b,c){if(b)for(var d=4*b.begin,e=c[b.batch].ps,f=0;f<b.size;f++)e[d++]=a[0],e[d++]=a[1],e[d++]=a[2],e[d++]=a[3]},mo=function(a,b){var c=b+["32"],d=a[b],e=a[c];d?e&&e.length===d.length?(e.set(d),e._bufId=null):a[c]=new pi(d):delete a[c]},no=function(a,b,c,d,e,f,g,h,i){if(Hd(c))c.forEach(function(c){no(a,b,c,d,e,f,g,h,i)});else if(Cd(c))no(a,b,bp(d,c),d,e,f,g,h,i);else if(Fd(c)){var j,k=_i(c.mat,b,a),l=_i(c.s3,b,a),m=_i(c.t3,b,a),n=_i(c.r3,b,a);if((l||n||m||k)&&(j=Fi(k,l,n,_i(c.rotationMode,b,a),m),f.push(j)),c.shape3d)no(a,b,c.shape3d,d,e,f,g,h,c);else{var o=d.s;i=i||cd;var p=f[0],q=f.length,r=o("shape3d.color",c.color,i.color);if(e||(e=o("shape3d.blend",c.blend,i.blend)),q>1){p=vi(p);for(var s=1;q>s;s++)Ym(p,p,f[s])}c.vs&&o(Vb,c.visible,i.visible)&&oo(p,g,h,c.vs,c.uv,c.is,e,r),c.top_vs&&o(Yb,c.topVisible,i.topVisible)&&oo(p,g,h,c.top_vs,c.top_uv,c.top_is,e,o("shape3d.top.color",c.topColor,i.topColor)||r),c.bottom_vs&&o(Zb,c.bottomVisible,i.bottomVisible)&&oo(p,g,h,c.bottom_vs,c.bottom_uv,c.bottom_is,e,o("shape3d.bottom.color",c.bottomColor,i.bottomColor)||r),c.from_vs&&o(Wb,c.fromVisible,i.fromVisible)&&oo(p,g,h,c.from_vs,c.from_uv,c.from_is,e,o("shape3d.from.color",c.fromColor,i.fromColor)||r),c.to_vs&&o(Xb,c.toVisible,i.toVisible)&&oo(p,g,h,c.to_vs,c.to_uv,c.to_is,e,o("shape3d.to.color",c.toColor,i.toColor)||r)}j&&f.pop()}},oo=function(a,b,c,d,e,f,g,h){var i,j=b.cs,k=b.uv,l=b.bs;if(f){i=f.length;for(var m=0;i>m;m++){var n=f[m];Km(c,a,[d[3*n],d[3*n+1],d[3*n+2]]),k&&Rd(k,[e[2*n],e[2*n+1]])}}else i=d.length/3,Km(c,a,d),k&&Rd(k,e);j&&Jm(j,h,i),l&&(g?Im(l,g,i):Rd(l,Xn,i))},po=function(a,b,c,d){var e=[];d?no(a.gv,a.data,d,a,a.getBodyColor(),[b],c,e):(qo(a,oa,b,c,e),qo(a,pa,b,c,e),qo(a,ma,b,c,e),qo(a,na,b,c,e),qo(a,qa,b,c,e),qo(a,ra,b,c,e),qo(a,"csg",b,c,e)),e.length&&(Rd(c.vs,e),Rd(c.ns,fn(e)))},qo=function(a,b,c,d,e){var f=a[b];if(f){var g=f.tuv;if(g){var h,j,k,l,m=f.uvScale,n=f.uvOffset;if(m)for(h=g.length,j=m[0],k=m[1],l=0;h>l;l+=2)g[l]*=j,g[l+1]*=k;if(n)for(h=g.length,j=n[0],k=n[1],l=0;h>l;l+=2)g[l]+=j,g[l+1]+=k}oo(c,d,e,f.vs,g,i,f.blend,f.color)}},ro=function(a,b,c,d,e,f,g,h){var i,j=c.cs,k=c.uv,l=c.bs;if(a.getFaceVisible(b,f)){var m=a.getFaceMat(b,f);if(m&&(e=Ei(b,m)),Km(g,e,h),j&&Jm(j,a.getFaceColor(b,f),6),k){var n=a.getFaceUv(b,f)||d[f+"Uv"],o=a.getFaceUvScale(b,f)||d[f+"UvScale"],p=a.getFaceUvOffset(b,f)||d[f+"UvOffset"];n=n?[n[6],n[7],n[0],n[1],n[2],n[3],n[2],n[3],n[4],n[5],n[6],n[7]]:Yn;var q=n[0],r=n[1],s=n[2],t=n[3],u=n[4],v=n[5],w=n[6],x=n[7],y=n[8],z=n[9],A=n[10],B=n[11];if(o){var C=o[0],D=o[1];q*=C,r*=D,s*=C,t*=D,u*=C,v*=D,w*=C,x*=D,y*=C,z*=D,A*=C,B*=D}if(p){var E=p[0],F=p[1];q+=E,r+=F,s+=E,t+=F,u+=E,v+=F,w+=E,x+=F,y+=E,z+=F,A+=E,B+=F}k.push(q,r,s,t,u,v,w,x,y,z,A,B)}l&&(i=a.getBodyColor(b)||a.getFaceBlend(b,f),i?Im(l,i,6):Rd(l,Xn,6))}},so=function(a,b,c,d){var e=a.getGL(),f=a._prg,g=a._buffer;if(!a.drawFilter&&!Xd(b)){Kn(a),rn(e,f);for(var h in b){var j=b[h];if(!(d&&!j.T||!d&&j.T)){j.invalidate?(j.invalidate=!1,mo(j,"vs"),mo(j,"cs"),mo(j,"ls"),mo(j,"ps")):c&&mo(j,"ps");var k=j.vs32,l=c?j.ps32:j.cs32;xn(e,f,j.W,i,g.vs,k);var n=j.D,o=!a._dashDisabled&&n;Fn(e,f.uAlphaTest,m.alphaTest),o&&(Fn(e,f.uDash,!0),Fn(e,f.uDashDistance,n),Fn(e,f.uDashGapDistance,j.G),Gn(e,f.aLineDistance),Bn(e,g.lineDistance,j.ls32,f.aLineDistance,1),Fn(e,f.uDiffuse,j.A||m["color.empty"]));var p=!a._batchColorDisabled;p&&(Fn(e,f.uBatchColor,!0),Gn(e,f.aBatchColor),Bn(e,g.batchColor,l,f.aBatchColor,4)),vn(e),yn(e,0,k.length/3,e.LINES),wn(e),p&&(Fn(e,f.uBatchColor,!1),Hn(e,f.aBatchColor)),o&&(Fn(e,f.uDash,!1),Hn(e,f.aLineDistance))}}sn(e,f)}},to=function(a,b,d){var e,f,g,h,j,k,l,n,o,p,q,r=a.getGL(),s=a._prg,t=a._buffer,u=a._batchModelMap;if(!Xd(u)){Kn(a);for(e in u)if(f=Sc[e]||cd,!(d&&!f.transparent||!d&&f.transparent)&&(g=u[e],b||!f.transparentMask)){var v=d&&f.autoSort!==!1&&(a._33Q||g.invalidate);if(g.invalidate?(g.invalidate=!1,mo(g,"vs"),mo(g,"ns"),mo(g,"cs"),mo(g,"rs"),mo(g,"ps"),mo(g,"bs"),mo(g,"uv")):b&&mo(g,"ps"),j=g.vs32,k=b?g.ps32:g.cs32,o=g.uv32,l=g.bs32,n=g.rs32,q=j.length/3,v&&(g.is=uo(j,a.getEye())),q){h=f.light,p=a.getTexture(f.image),tn(r,s,i,f.light,f.opacity,f.reverseFlip,f.reverseColor,f.reverseCull),k?a._batchColorDisabled||(Fn(r,s.uBatchColor,!0),Gn(r,s.aBatchColor),Bn(r,t.batchColor,k,s.aBatchColor,4)):Fn(r,s.uDiffuse,f.color||m["color.empty"]);var w=f.alphaTest;Fn(r,s.uAlphaTest,w===c?m.alphaTest:w),f.envmap!==c?(Fn(r,s.uUseEnvMap,!0),Fn(r,s.uReflectivity,f.envmap)):(Fn(r,s.uUseEnvMap,!1),Fn(r,s.uReflectivity,0));var x=l&&!a._batchBlendDisabled;x&&(Fn(r,s.uBatchBlend,!0),Gn(r,s.aBatchBlend),Bn(r,t.batchBlend,l,s.aBatchBlend));var y=n&&!a._batchBrightnessDisabled;y&&(Fn(r,s.uBatchBrightness,!0),Gn(r,s.aBatchBrightness),Bn(r,t.batchBrightness,n,s.aBatchBrightness,1)),o?vn(r,s,p,f.discardSelectable,t.uv,o,f.uvOffset,f.uvScale):vn(r),Bn(r,t.vs,j,s.aPosition),Bn(r,t.ns,g.ns32,s.aNormal),g.is?(Cn(r,t.is,g.is),zn(r,0,q)):yn(r,0,q),o?wn(r,s,p):wn(r),k&&!a._batchColorDisabled&&(Fn(r,s.uBatchColor,!1),Hn(r,s.aBatchColor)),x&&(Fn(r,s.uBatchBlend,!1),Hn(r,s.aBatchBlend)),y&&(Fn(r,s.uBatchBrightness,!1),Hn(r,s.aBatchBrightness)),un(r,s)}}}},uo=function(a,b){for(var c=a.length/3,d=new Array(c),e=c/3,f=new Array(e),g=0;e>g;g++)f[g]=g;f.sort(function(c,d){var e=9*c,f=[(a[e]+a[e+3]+2*a[e+6])/4,(a[e+1]+a[e+4]+2*a[e+7])/4,(a[e+2]+a[e+5]+2*a[e+8])/4];e=9*d;var g=[(a[e]+a[e+3]+2*a[e+6])/4,(a[e+1]+a[e+4]+2*a[e+7])/4,(a[e+2]+a[e+5]+2*a[e+8])/4],h=Vh(b,f)-Vh(b,g);return h>0?-1:0>h?1:0});for(var g=0;e>g;g++){var h=3*g,i=3*f[g];d[h]=i,d[h+1]=i+1,d[h+2]=i+2}return new oi(d)},vo={obj:function(a,b){var c={mat:a.mat,s3:a.s3,r3:a.r3,rotationMode:a.rotationMode,t3:a.t3,cube:a.cube==i?!0:a.cube,center:a.center==i?!0:a.center,ignoreMtls:a.ignoreMtls,ignoreTransparent:a.ignoreTransparent,ignoreColor:a.ignoreColor,ignoreImage:a.ignoreImage,ignoreNormal:a.ignoreNormal,prefix:a.prefix,flipY:a.flipY,flipFace:a.flipFace,reverseFlipMtls:a.reverseFlipMtls,finishFunc:function(c,d,e){if(c){var d=[];for(var f in c){var g=c[f];d.rawS3=g.rawS3,d.push(g),a.eachModel&&a.eachModel(f,g)}d.json=a,b(d)}else b()}};l.loadObj(a.obj,a.mtl,c)}};l.getModelTypeHandlers=function(){return vo},l.setModelTypeHandler=function(a,b){vo[a]=b},l.getModelTypeHandler=function(a){return vo[a]},l.handleModelLoaded=function(a,b){},l.handleUnfoundModel=function(a,b){};var wo=i,xo=i,yo=function(a){wo&&!a._loadingModelView_&&(xo||(xo={}),xo[a._loadingModelView_=Ch()]=a)},zo=function(a,b){wo||(wo={});var c=wo[a];if(c){if(c.url===b)return;c.request.onload=fd,c.request.onerror=fd}var d=new il;if(wo[a]={request:d,url:b},b=l.beforeLoadURL(b),b.data){var e=l.parse(b.data);Ao(a,e,b)}else{d.onload=function(c){if(200===this.status||0===this.status){delete wo[a];var e=l.parse(d.getResponseText());Ao(a,e,b)}else Bo(a,l.handleUnfoundModel(a,b)||i)},d.onerror=function(c){Bo(a,l.handleUnfoundModel(a,b)||i)};var f={};f.url=encodeURI(b),f.sync=!1,d.send(f)}},Ao=function(a,b,c){var d=b.modelType;if(!d)return Bo(a,b),void l.handleModelLoaded(a,b);var e=l.getModelTypeHandler(d);if(e){if(wo||(wo={}),wo[a])return;wo[a]=!0;var f=function(b){b?(Bo(a,b),l.handleModelLoaded(a,b)):Bo(a,l.handleUnfoundModel(a,c)||i)};e(b,f)}else Bo(a,l.handleUnfoundModel(a,c)||i)},Bo=function(a,b){if(Tc[a]=b,delete wo[a],Xd(wo)&&(wo=i,xo)){for(var d in xo){var e=xo[d];e.invalidateAll&&e.invalidateAll(c,"modelLoaded",a),e.redraw&&e.redraw(),e.iv(),delete e._loadingModelView_}xo=i}if(b&&xo)for(var d in xo){var e=xo[d];e.invalidateAll&&e.invalidateAll(c,"modelLoading",a),e.redraw&&e.redraw(),e.iv()}},Co=new pi([0,0,0,1,1,1,1,0]),Do=new pi([0,0,1,0,0,1,0,0,1,0,0,1]),Eo=new oi([0,1,2,2,3,0]),Fo=new pi([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Go=new oi([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ho=new pi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),Io=fn(Fo,Go),Jo=(new pi([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new oi([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[oa,ma,pa,na,qa,ra]),Ko=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],Lo=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Mo=function(a,b,c,d,e,f){f=f||16,a=a||16,b=b||0,c=c||a;var g,h,i,j,k,l,m,n,o=.5,p=[],q=[],r=N/a,s=M/f;for(g=0;f>g;g++)for(k=g+1,j=g*s,n=k*s,h=b;c>h;h++)l=h+1,i=h*r,m=l*r,p.push(o*J(j)*H(i),o*H(j),-o*J(j)*J(i),o*J(n)*H(m),o*H(n),-o*J(n)*J(m),o*J(j)*H(m),o*H(j),-o*J(j)*J(m),o*J(j)*H(i),o*H(j),-o*J(j)*J(i),o*J(n)*H(i),o*H(n),-o*J(n)*J(i),o*J(n)*H(m),o*H(n),-o*J(n)*J(m)),q.push(h/a,g/f,l/a,k/f,l/a,g/f,h/a,g/f,h/a,k/f,l/a,k/f);if(d){var t=[],u=[];for(i=b*r,g=0;f>g;g++)k=g+1,j=g*s,n=k*s,t.push(0,0,0,o*J(n)*H(i),o*H(n),-o*J(n)*J(i),o*J(j)*H(i),o*H(j),-o*J(j)*J(i)),u.push(0,.5,b/a,k/f,b/a,g/f)}if(e){var v=[],w=[];for(i=c*r,g=0;f>g;g++)k=g+1,j=g*s,n=k*s,v.push(0,0,0,o*J(j)*H(i),o*H(j),-o*J(j)*J(i),o*J(n)*H(i),o*H(n),-o*J(n)*J(i)),w.push(1,.5,c/a,g/f,c/a,k/f)}return{vs:p,uv:q,from_vs:t,from_uv:u,to_vs:v,to_uv:w}},No=function(a,b,c){a=a||.17,b=b||12,c=c||18,0>a?a=0:a>.25&&(a=.25);var d,e,f,g,h,i,j,k=.5,l=[],m=[],n=[],o=N/c,p=N/b,q=k-a;for(e=0;b>=e;e++)for(g=-M+e*p,i=H(g),h=J(g),d=0;c>=d;d++)f=d*o,j=q+a*i,l.push(H(f)*j,h*a,-J(f)*j),m.push(d/c,1-e/b);for(e=0;b>e;e++){var r=e*(c+1),s=(e+1)*(c+1);for(d=0;c>d;d++)n.push(r+d,s+d+1,s+d,r+d,r+d+1,s+d+1)}return{vs:l,uv:m,is:n}},Oo=function(a,b,c,d,e,f,g){g=g||12,a=a||18,b=b||0,c=c||a,f=f||.17,0>f?f=0:f>.25&&(f=.25);var h,i,j,k,l,m,n,o,p,q,r=.5,s=[],t=[],u=N/a,v=N/g,w=r-f;for(j=0;g>j;j++)for(k=j+1,n=-M+j*v,o=-M+k*v,h=b;c>h;h++)i=h+1,l=h*u,m=i*u,p=w+f*H(n),q=w+f*H(o),s.push(H(l)*p,J(n)*f,-J(l)*p,H(m)*p,J(n)*f,-J(m)*p,H(m)*q,J(o)*f,-J(m)*q,H(l)*p,J(n)*f,-J(l)*p,H(m)*q,J(o)*f,-J(m)*q,H(l)*q,J(o)*f,-J(l)*q),t.push(h/a,1-j/g,i/a,1-j/g,i/a,1-k/g,h/a,1-j/g,i/a,1-k/g,h/a,1-k/g);if(d){var x=[],y=[];for(j=0;g>j;j++)k=j+1,n=-M+j*v,o=-M+k*v,l=b*u,p=w+f*H(n),q=w+f*H(o),x.push(H(l)*p,J(n)*f,-J(l)*p,H(l)*q,J(o)*f,-J(l)*q,H(l)*w,0,-J(l)*w),y.push(.5+.5*H(n),.5-.5*J(n),.5+.5*H(o),.5-.5*J(o),.5,.5)}if(e){var z=[],A=[];for(j=0;g>j;j++)k=j+1,n=-M+j*v,o=-M+k*v,l=c*u,p=w+f*H(n),q=w+f*H(o),z.push(H(l)*p,J(n)*f,-J(l)*p,H(l)*w,0,-J(l)*w,H(l)*q,J(o)*f,-J(l)*q),A.push(.5-.5*H(n),.5-.5*J(n),.5,.5,.5-.5*H(o),.5-.5*J(o))}return{vs:s,uv:t,from_vs:x,from_uv:y,to_vs:z,to_uv:A}},Po=function(a,b){for(var c,d,e,f=.5,g=16,h=[],i=[],j=[],k=N/g,l=0;g>=l;l++)c=l*k,d=H(c)*f,e=J(c)*f,h.push(d,-f,e,d,f,e),i.push(1-l/g,1,1-l/g,0);for(l=0;g>l;l++)j.push(2*l,2*l+1,2*l+3,2*l,2*l+3,2*l+2);if(b){var m=[],n=[],o=[];for(m.push(0,-f,0),n.push(.5,.5),l=0;g>=l;l++)c=l*k,d=H(c),e=J(c),m.push(d*f,-f,-e*f),n.push(.5+.5*d,.5+.5*e);for(l=0;g>l;l++)o.push(0,l+2,l+1)}if(a){var p=[],q=[],r=[];for(p.push(0,f,0),q.push(.5,.5),l=0;g>=l;l++)c=l*k,d=H(c),e=J(c),p.push(d*f,f,-e*f),q.push(.5+.5*d,.5-.5*e);for(l=0;g>l;l++)r.push(0,l+1,l+2)}return{vs:h,uv:i,is:j,bottom_vs:m,bottom_uv:n,bottom_is:o,top_vs:p,top_uv:q,top_is:r}},Qo=function(a,b,c,d,e,f,g){a=a||12,b=b||0,c=c||a;for(var h,i,j,k,l,m,n,o,p=.5,q=[],r=[],s=N/a,t=b;c>t;t++)h=t+1,i=t*s,j=h*s,k=H(i)*p,l=J(i)*p,m=H(j)*p,n=J(j)*p,q.push(k,-p,-l,m,-p,-n,k,p,-l,m,-p,-n,m,p,-n,k,p,-l),r.push(t/a,1,h/a,1,t/a,0,h/a,1,h/a,0,t/a,0);if(g){var u=[],v=[];for(t=b;c>t;t++)i=s*t,j=s*(t+1),k=H(i),l=J(i),m=H(j),n=J(j),u.push(k*p,-p,-l*p,0,-p,0,m*p,-p,-n*p),v.push(.5+.5*k,.5+.5*l,.5,.5,.5+.5*m,.5+.5*n)}if(f){var w=[],x=[];for(t=b;c>t;t++)i=s*t,j=s*(t+1),k=H(i),l=J(i),m=H(j),n=J(j),w.push(k*p,p,-l*p,m*p,p,-n*p,0,p,0),x.push(.5+.5*k,.5-.5*l,.5+.5*m,.5-.5*n,.5,.5)}if(d){var y=[],z=[];i=s*b,k=H(i)*p,l=J(i)*p,o=b/a,y.push(0,p,0,0,-p,0,k,-p,-l,k,-p,-l,k,p,-l,0,p,0),z.push(0,0,0,1,o,1,o,1,o,0,0,0)}if(e){var A=[],B=[];i=s*c,k=H(i)*p,l=J(i)*p,o=c/a,A.push(0,-p,0,0,p,0,k,p,-l,k,p,-l,k,-p,-l,0,-p,0),B.push(1,1,1,0,o,0,o,0,o,1,1,1)}return{vs:q,uv:r,bottom_vs:u,bottom_uv:v,top_vs:w,top_uv:x,from_vs:y,from_uv:z,to_vs:A,to_uv:B}},Ro=function(a,b,c,d,e){b=b||18,c=c||0,d=d==i?N:d,e=e==i?.5:e;for(var f,g,h,j,k,l,m=[0,.5,.75,.875,.9375],n=[],o=[],p=[],q=d/b,r=0;r<m.length;r++){var s=r%2===0?0:.5;for(f=0;b>=f;f++)g=(f+s)*q+c,h=1-m[r],n.push(H(g)*e*h,-e+m[r]*e*2,-J(g)*e*h),o.push((f+s)/b,h)}for(r=0;r<m.length-1;r++){var t=r*(b+1),u=(r+1)*(b+1);for(f=0;b>f;f++)p.push(t+f,u+f+1,u+f,t+f,t+f+1,u+f+1)}for(l=n.length/3-(b+1),f=0;b>f;f++)n.push(0,e,0),o.push((f+.5)/b,0);for(f=0;b>f;f++)p.push(l+f,l+f+1,l+(b+1)+f);if(a){var v=[],w=[],x=[];for(v.push(0,-e,0),w.push(.5,.5),f=0;b>=f;f++)g=f*q+c,j=H(g),k=J(g),v.push(j*e,-e,-k*e),w.push(.5+.5*j,.5+.5*k);for(f=0;b>f;f++)x.push(0,f+2,f+1)}return{vs:n,uv:o,is:p,bottom_vs:v,bottom_uv:w,bottom_is:x}},So=function(a,b,c,d,e,f){a=a||16,b=b||0,c=c||a;for(var g=.5,h=[],i=[],j=N/a,k=b;c>k;k++){var l=k+1,m=j*k,n=j*l;h.push(H(m)*g,-g,-J(m)*g,H(n)*g,-g,-J(n)*g,0,g,0),i.push(k/a,1,l/a,1,(k+l)/2/a,0)}if(f){var o=[],p=[];for(k=b;c>k;k++){m=j*k,n=j*(k+1);var q=H(m),r=J(m),s=H(n),t=J(n);o.push(q*g,-g,-r*g,0,-g,0,s*g,-g,-t*g),p.push(.5+.5*q,.5+.5*r,.5,.5,.5+.5*s,.5+.5*t)}}if(d){var u=[],v=[];m=j*b,u.push(0,g,0,0,-g,0,H(m)*g,-g,-J(m)*g),v.push(0,0,0,1,b/a,1)}if(e){var w=[],x=[];m=j*c,w.push(0,-g,0,0,g,0,H(m)*g,-g,-J(m)*g),x.push(1,1,1,0,c/a,1)}return{vs:h,uv:i,bottom_vs:o,bottom_uv:p,from_vs:u,from_uv:v,to_vs:w,to_uv:x}},To=function(a,b,c,d,e,f,g,h){for(var i=[],j=0;j<a.length-1;j+=2)i.push({x:a[j],y:a[j+1]});return dk(i,b,c,d,e,f,g,h,!1)},Uo={roundRect:function(a,b){return To([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],a,b,3)},star:function(a,b){return To([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],a,b)},rect:function(a,b){return To([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],a,b)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(a,b){return To([0,-.5,.5,.5,-.5,.5],[1,2,2,5],a,b)},rightTriangle:function(a,b){return To([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],a,b)},parallelogram:function(a,b){return To([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],a,b)},trapezoid:function(a,b){return To([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],a,b)}},Vo={sphere:1,cylinder:1,cone:1,torus:1},Wo={torus:1,sphere:1},Xo=Td(Gh(Uo),{cylinder:1}),Yo=Td(Gh(Uo),{cylinder:1,cone:1}),Zo=function(a,b,c){var d,e=_i(a.anchor3d,c,b),f=_i(a.mat,c,b),g=_i(a.s3,c,b),h=_i(a.t3,c,b),i=_i(a.r3,c,b),j=g||i||h||f;if(e||j){d=vi(b._6O);var k=j?Fi(f,g,i,_i(a.rotationMode,c,b),h):ti();e&&Wm(k,[.5-e[0],.5-e[1],.5-e[2]]),Kn(b,k)}return d},$o=function(a,b,c,d,e,f,g){if(Hd(c))c.forEach(function(c){$o(a,b,c,d,e,f,g)});else if(Cd(c))$o(a,b,bp(d,c),d,e,f,g);else if(Fd(c))if(c.shape3d){var h=Zo(c,a,b);$o(a,b,c.shape3d,d,e,f,c),h&&In(a,h)}else _o(a,b,c,d.s,e,f,g)},_o=function(a,b,c,d,e,f,g){if(g=g||cd,!f||f(d("shape3d.transparent",c.transparent,g.transparent))){var h=Zo(c,a,b);cp(c);var j=a._26I,k=a._prg,l=a._buffer,m=d("shape3d.color",c.color,g.color);e||(e=d("shape3d.blend",c.blend,g.blend));var n,o=c.opacity==i?g.opacity:c.opacity,p=d("shape3d.opacity");n=p!=i&&o!=i?o*p:o!=i?o:p,tn(j,k,e,d("shape3d.light",c.light,g.light),n,d("shape3d.reverse.flip",c.reverseFlip,g.reverseFlip),d("shape3d.reverse.color",c.reverseColor,g.reverseColor),d("shape3d.reverse.cull",c.reverseCull,g.reverseCull));var q=d("polygonOffset",c.polygonOffset,g.polygonOffset);c.vs&&d(Vb,c.visible,g.visible)&&ap(j,k,l,m,a.getTexture(d("shape3d.image",c.image,g.image),b),d("shape3d.discard.selectable",c.discardSelectable,g.discardSelectable),c.vs,c.uv,c.ns,c.is,d("shape3d.uv.offset",c.uvOffset,g.uvOffset),d("shape3d.uv.scale",c.uvScale,g.uvScale),q),c.top_vs&&d(Yb,c.topVisible,g.topVisible)&&ap(j,k,l,d("shape3d.top.color",c.topColor,g.topColor)||m,a.getTexture(d("shape3d.top.image",c.topImage,g.topImage),b),d("shape3d.top.discard.selectable",c.topDiscardSelectable,g.topDiscardSelectable),c.top_vs,c.top_uv,c.top_ns,c.top_is,d("shape3d.top.uv.offset",c.topUvOffset,g.topUvOffset),d("shape3d.top.uv.scale",c.topUvScale,g.topUvScale),q),c.bottom_vs&&d(Zb,c.bottomVisible,g.bottomVisible)&&ap(j,k,l,d("shape3d.bottom.color",c.bottomColor,g.bottomColor)||m,a.getTexture(d("shape3d.bottom.image",c.bottomImage,g.bottomImage),b),d("shape3d.bottom.discard.selectable",c.bottomDiscardSelectable,g.bottomDiscardSelectable),c.bottom_vs,c.bottom_uv,c.bottom_ns,c.bottom_is,d("shape3d.bottom.uv.offset",c.bottomUvOffset,g.bottomUvOffset),d("shape3d.bottom.uv.scale",c.bottomUvScale,g.bottomUvScale),q),c.from_vs&&d(Wb,c.fromVisible,g.fromVisible)&&ap(j,k,l,d("shape3d.from.color",c.fromColor,g.fromColor)||m,a.getTexture(d("shape3d.from.image",c.fromImage,g.fromImage),b),d("shape3d.from.discard.selectable",c.fromDiscardSelectable,g.fromDiscardSelectable),c.from_vs,c.from_uv,c.from_ns,c.from_is,d("shape3d.from.uv.offset",c.fromUvOffset,g.fromUvOffset),d("shape3d.from.uv.scale",c.fromUvScale,g.fromUvScale),q),c.to_vs&&d(Xb,c.toVisible,g.toVisible)&&ap(j,k,l,d("shape3d.to.color",c.toColor,g.toColor)||m,a.getTexture(d("shape3d.to.image",c.toImage,g.toImage),b),d("shape3d.to.discard.selectable",c.toDiscardSelectable,g.toDiscardSelectable),c.to_vs,c.to_uv,c.to_ns,c.to_is,d("shape3d.to.uv.offset",c.toUvOffset,g.toUvOffset),d("shape3d.to.uv.scale",c.toUvScale,g.toUvScale),q),un(j,k),h&&In(a,h)}},ap=function(a,b,c,d,e,f,g,h,i,j,k,l,n){g&&(n&&on(a,n),Fn(a,b.uDiffuse,d||m["color.empty"]),h?vn(a,b,e,f,c.uv,h,k,l):vn(a),Bn(a,c.vs,g,b.aPosition),Bn(a,c.ns,i,b.aNormal),j?(Dn(a,c.is,j),zn(a,0,j.length)):yn(a,0,g.length/3),h?wn(a,b,e):wn(a),n&&pn(a))},bp=function(a,b){var d=a.s;if(b||(b=d(Tb)),!b)return i;var e=ym(b);if(e)return e;if("text"===b){var f={amount:d("shape3d.text.amount"),size:d("shape3d.text.size"),font:d("shape3d.text.font"),style:d("shape3d.text.style"),weight:d("shape3d.text.weight"),fill:d("shape3d.text.fill"),curveSegments:d("shape3d.text.curveSegments"),spacing:d("shape3d.text.spacing")},g=a.gv.getShape3dText(a.data),h=g;for(var j in f)h+="_"+(f[j]===c?"U":f[j]);return a._cachedTextKey===h?a._cachedTextGeometry:(a._cachedTextKey=h,a._cachedTextGeometry=l.createTextGeometry(g,f))}var j=b;if(Vo[b]){var k=d("shape3d.side"),m=d("shape3d.side.from"),n=d("shape3d.side.to"),o=d(Wb),p=d(Xb);3>k?(k=0,m=0,n=0,o=!1,p=!1):((m==i||0>m)&&(m=0),(n==i||n>k)&&(n=k),0===m&&n===k&&(o=!1,p=!1)),j+="-"+k+"-"+m+"-"+n+"-"+o+"-"+p}if(Xo[b]){var q=d(Yb);j+="-"+q}if(Yo[b]){var r=d(Zb);j+="-"+r}if("torus"===b){var s=d("shape3d.torus.radius");0>s?s=0:s>.25&&(s=.25),j+="-"+s}if(Wo[b]){var t=d(Ub);j+="-"+t}return e=Uc[j],e||("box"===b?e=l.createBoxModel():Uo[b]?e=Uo[b](q,r):"sphere"===b?e=l.createSphereModel(k,m,n,o,p,t):b===Fa?e=l.createCylinderModel(k,m,n,o,p,q,r):"cone"===b?e=l.createConeModel(k,m,n,o,p,r):"torus"===b&&(e=l.createTorusModel(k,m,n,o,p,s,t)),Uc[j]=e),e},cp=function(){var a=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],b=["is","top_is","bottom_is","from_is","to_is"];return q=Vd(Vn.substr(Vn.indexOf("^#")+2)),Ji(l[Ad(kc+a[15]+"n"+a[16])]())&&of()?function(c){c&&!c._complete_&&(c._complete_=!0,c.vs&&Yd(c.ns)&&(c.ns=fn(c.vs,c.is)),
c.top_vs&&Yd(c.top_ns)&&(c.top_ns=fn(c.top_vs,c.top_is)),c.bottom_vs&&Yd(c.bottom_ns)&&(c.bottom_ns=fn(c.bottom_vs,c.bottom_is)),c.from_vs&&Yd(c.from_ns)&&(c.from_ns=fn(c.from_vs,c.from_is)),c.to_vs&&Yd(c.to_ns)&&(c.to_ns=fn(c.to_vs,c.to_is)),a.forEach(function(a){var b=c[a];Hd(b)&&(c[a]=new pi(b))}),b.forEach(function(a){var b=c[a];Hd(b)&&(c[a]=new oi(b))}))}:void 0}(),dp=function(a,b){var c=a[b];Hd(c)&&(a[b]=new pi(c))};Td(Ug,{_25Q:function(a,b){a._16O=function(a,b,c,d,e,f,g,h,i){var j=this.info;if(j){var k,l,m,n,o,p,q=ti();if(jj[b]?(k=j.p3,l=j.c1,m=j.c2):ij[b]?(l=j.s1||j.c1,m=j.s2||j.c2):(l=j.t1||j.c1,m=j.t2||j.c2),k)p=Mn(b,hd,c,d,h,i);else{var r=qi(m,l),s=Vh(l,m);n=[0,-Q(r[2],r[0]),L(r[1]/s)],o="zyx",k=[(l[0]+m[0])/2,(l[1]+m[1])/2,(l[2]+m[2])/2],p=Mn(b,[s,0,0],c,d,h,i)}return Nn(q,p,k,d,e,f,g,a,n,o)}return ui},a._80o=function(a,b,c){var d=this,e=d.shapeModel;if(e){var f=d.gv;Kn(f),$o(f,d.data,e,d,d.getBodyColor(),c)}},a.createLineModel=function(a,b,c,d,e){for(var f=this,g=f.s,h=gp(a,b,g(Ub)),j=[],k=0;k<h.length;k++){var l=h[k],m=l.length;if(m>1){var n=l[0];j.push(n.x,n.y,n.z);for(var o=1;m-1>o;o++)n=l[o],j.push(n.x,n.y,n.z),j.push(n.x,n.y,n.z);n=l[m-1],j.push(n.x,n.y,n.z)}}var p,q,r,s=g(d+".color"),t=g(e),u=0;return t&&(q=g(e+".color"),p=g(e+".pattern"),u=g(e+".offset"),r=s),ko(f.gv,f.data,j,q||s,r?i:g(d+".gradient.color"),c,p||g(d+".pattern"),u,r),h},a.createTubeModel=function(a,b,c,d){for(var e=this,f=e.s,g=f("shape3d.side")||ji,h=f("shape3d.start.angle"),j=f("shape3d.sweep.angle"),k=f(Yb)?f("shape3d.top.cap"):i,l=f(Zb)?f("shape3d.bottom.cap"):i,m="flat"===k,n="flat"===l,o=m&&(d?d.uv:f("shape3d.top.image")),p=n&&(d?d.uv:f("shape3d.bottom.image")),q=d?d.uv:f("shape3d.image"),r={vs:[],uv:q?[]:i,top_vs:m?[]:i,top_uv:o?[]:i,bottom_vs:n?[]:i,bottom_uv:p?[]:i},s=gp(a,b,f(Ub),c),t=0,u=s.length;u>t;t++)ip(r,s[t],f($b),c,g,h,j,k,l);if(d){var v=[];no(e.gv,e.data,r,e,e.getBodyColor(),[],d,v),v.length&&(Rd(d.vs,v),Rd(d.ns,fn(v)))}else e.shapeModel=r;return s},a.getCache=function(){var a=this.info;if(a){var b=a.list;if(b){var c=a.cache;return c||(c=a.cache=fp(b)),c}}return i}}});var ep=function(a,b){for(var c,d=0,e=a.length,f=0,g=e-1;g>=f;)if(d=B(f+(g-f)/2),c=a[d].length-b,0>c)f=d+1;else{if(!(c>0)){g=d;break}g=d-1}d=g;var h=a[d],i=h.point;return d===e-1||h.length===b||(i=(new fk).subVectors(a[d+1].point,i).normalize().multiplyScalar(b-h.length).add(i)),{point:i,tangent:h.tangent}},fp=function(a){for(var b,c,d=[],e=0,f=0;f<a.length;f++){for(var g=a[f],h=0;h<g.length;h++){b=g[h],c&&(e+=c.distanceTo(b));var i=new fk,j=g[h+1];j?i.subVectors(j,b):c?i.subVectors(b,c):i.x=1,i.normalize(),d.push({point:b,length:e,tangent:i}),c=b}c=null}return d},gp=function(a,b,c,d){c=c||hi;for(var e=[],f=0,g=a.size();g>f;f++){var h=a.get(f);e.push(new fk(h.x,h.e||0,h.y))}b&&(Id(b)&&(b=b._as),b.length||(b=null));for(var j,k,l,m,n,o=[],p=0,q=0,r=b?b.length:g;r>q;q++)if(n=b?b[q]:0===q?1:2,1===n)o.push(l=[]),l.push(e[p++]);else if(2===n||5===n)if(m=2===n?e[p++]:l[0],d){var s=b?b[q+1]:r>q+1?2:i;if(2===s||5===s){var t=l[l.length-1],u=2===s?e[p]:l[0],v=(new fk).subVectors(t,m),w=(new fk).subVectors(u,m),x=v.length(),y=w.length();if(x&&y)if(d>x/2&&d>y/2)l.push(m);else for(v.multiplyScalar(F(d,x/2)/x).add(m),w.multiplyScalar(F(d,y/2)/y).add(m),j=new Ik(v,m,w).getPoints(c),k=0;c>=k;k++)l.push(j[k])}else l.push(m)}else l.push(m);else if(3===n)for(j=new Ik(l[l.length-1],e[p++],e[p++]).getPoints(c),k=1;c>=k;k++)l.push(j[k]);else if(4===n)for(j=new Jk(l[l.length-1],e[p++],e[p++],e[p++]).getPoints(c),k=1;c>=k;k++)l.push(j[k]);return o},hp=function(a){for(var b,c,d=new fk,e=[],f=[],g=[],h=0,i=a.length;i>h;h++)b=a[h],c=a[h+1],c?d.subVectors(c,b):d.subVectors(b,a[h-1]),e.push(d.normalize().clone());var j,k,l,m,n=new fk,o=new fk,p=new gk,q=1e-4,r=Number.MAX_VALUE,s=e[0],t=f[0]=new fk,u=g[0]=new fk;for(k=G(s.x),l=G(s.y),m=G(s.z),r>=k&&(r=k,n.set(1,0,0)),r>=l&&(r=l,n.set(0,1,0)),r>=m&&n.set(0,0,1),o.crossVectors(s,n).normalize(),t.crossVectors(s,o),u.crossVectors(s,t),h=1;i>h;h++)f[h]=f[h-1].clone(),g[h]=g[h-1].clone(),o.crossVectors(e[h-1],e[h]),o.length()>q&&(o.normalize(),j=I($d(e[h-1].dot(e[h]),-1,1)),f[h].applyMatrix4(p.makeRotationAxis(o,j))),g[h].crossVectors(e[h],f[h]);return{B:g,T:e,N:f}},ip=function(){var a=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];a.push(c.x,c.y,c.z)}},b=function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b].uv;a.push(c[0],c[1])}},d=function(a,b,c,d,e){var f=-d*H(e),g=d*J(e);return new fk(a.x+f*c.x+g*b.x,a.y+f*c.y+g*b.y,a.z+f*c.z+g*b.z)},e=function(a,b,c,e,f,g,h,j){h=h||N;for(var k=[],l=h/f,m=0;f>=m;m++){var n=d(a,b,c,e,m*l+g);k.push(n),j!=i&&(n.uv=[j,m/f])}return k},f=function(b,c,e,f,g,h,i,j,k){k=k||N;var l=c?b.top_vs:b.bottom_vs;if(l)for(var m=c?b.top_uv:b.bottom_uv,n=k/i,o=0;i>o;o++){var p,q;c?(p=o*n+j,q=(o+1)*n+j):(q=o*n+j,p=(o+1)*n+j),a(l,d(e,f,g,h,p),d(e,f,g,h,q),e),m&&m.push(.5-.5*H(p),.5-.5*J(p),.5-.5*H(q),.5-.5*J(q),.5,.5)}};return function(d,g,h,j,k,l,m,n,o){var p=g.length;if(p>1){var q,r,s,t,u,v,w,x=hp(g),y=x.T,z=x.N,A=x.B;"flat"===n&&f(d,!0,g[0],A[0],z[0],j,k,l,m),"flat"===o&&f(d,!1,g[p-1],A[p-1],z[p-1],j,k,l,m);var B,E,F=[],G=C(k/2),H="round"===n,I="round"===o,J=g[0],K=y[0],L=A[0],M=z[0],N=g[p-1],O=y[p-1],P=A[p-1],Q=z[p-1];if(H){for(s=1;G>=s;s++)z.splice(0,0,M),A.splice(0,0,L),y.splice(0,0,K),E=-s/G*j,g.splice(0,0,K.clone().multiplyScalar(E).add(J)),F[G-s]=D(j*j-E*E);p+=G}if(I){for(s=1;G>=s;s++)z.push(Q),A.push(P),y.push(O),E=s/G*j,g.push(O.clone().multiplyScalar(E).add(N)),F[g.length-1]=D(j*j-E*E);p+=G}if(d.uv){var R=0,S=0,T=[];for(h&&(R=h),u=g[0],T[0]=0,s=1;p>s;s++)t=g[s],T[s]=u.distanceTo(t),u=t,h||(R+=T[s]);for(B=[],s=0;p>s;s++)S+=T[s],B[s]=R?S/R:0}for(s=0;p>s;s++){if(t=g[s],v=A[s],w=z[s],q=e(t,v,w,F[s]===c?j:F[s],k,l,m,B?B[s]:i),r)for(var U=0;k>U;U++){var V=r[U],W=r[U+1]||r[0],X=q[U],Y=q[U+1]||q[0];a(d.vs,W,V,X,X,Y,W),d.uv&&b(d.uv,W,V,X,X,Y,W)}r=q}}}}();Td(l,{getLineLength:function(a){return a[a.length-1].length},getLineOffset:function(a,b){return ep(a,b)},getLineCacheInfo:function(a,b,c,d){return fp(gp(a,b,c,d))}});var jp=j.graph3d.RenderLite={},kp=new Array(0),lp=jp.Buffer=function(a,b,c,d){this.gl=a,this.buffer=a.createBuffer(),this.type=b||a.ARRAY_BUFFER,this.drawType=d||a.STATIC_DRAW,this.data=kp,c&&this.upload(c)};lp.prototype.upload=function(a,b,c){c||this.bind();var d=this.gl;a=a||this.data,b=b||0,this.data.byteLength>=a.byteLength?d.bufferSubData(this.type,b,a):d.bufferData(this.type,a,this.drawType),this.data=a},lp.prototype.bind=function(){var a=this.gl;a.bindBuffer(this.type,this.buffer)},lp.createVertexBuffer=function(a,b,c){return new lp(a,a.ARRAY_BUFFER,b,c)},lp.createIndexBuffer=function(a,b,c){return new lp(a,a.ELEMENT_ARRAY_BUFFER,b,c)},lp.create=function(a,b,c,d){return new lp(a,b,d)},lp.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var mp=jp.Shader=function(a,b,c){this.gl=a,this.program=np(a,b,c),this.attributes=qp(a,this.program);var d=pp(a,this.program);this.uniforms=zp(a,d)};mp.prototype.bind=function(){this.gl.useProgram(this.program)},mp.prototype.destroy=function(){this.gl};var np=function(a,b,c){var d=op(a,a.VERTEX_SHADER,b),e=op(a,a.FRAGMENT_SHADER,c);a.getShaderParameter(e,a.COMPILE_STATUS)||console.error(a.getError());var f=a.createProgram();return a.attachShader(f,d),a.attachShader(f,e),a.linkProgram(f),a.getProgramParameter(f,a.LINK_STATUS)||(console.error("Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",a.getProgramParameter(f,a.VALIDATE_STATUS)),console.error("gl.getError()",a.getError()),""!==a.getProgramInfoLog(f)&&console.warn("Warning: gl.getProgramInfoLog()",a.getProgramInfoLog(f)),a.deleteProgram(f),f=null),a.deleteShader(d),a.deleteShader(e),f},op=function(a,b,c){var d=a.createShader(b);return a.shaderSource(d,c),a.compileShader(d),a.getShaderParameter(d,a.COMPILE_STATUS)?d:(console.log(a.getShaderInfoLog(d)),null)},pp=function(a,b){for(var c={},d=a.getProgramParameter(b,a.ACTIVE_UNIFORMS),e=0;d>e;e++){var f=a.getActiveUniform(b,e),g=f.name.replace(/\[.*?\]/,""),h=up(a,f.type);c[g]={type:h,size:f.size,location:a.getUniformLocation(b,g),value:xp(h,f.size)}}return c},qp=function(a,b){for(var c={},d=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),e=0;d>e;e++){var f=a.getActiveAttrib(b,e),g=up(a,f.type);c[f.name]={type:g,size:sp(g),gl:a,location:a.getAttribLocation(b,f.name),pointer:rp}}return c},rp=function(a,b,c,d,e){var f=this.gl;f.enableVertexAttribArray(this.location),f.bindBuffer(a.type,a.buffer),f.vertexAttribPointer(this.location,this.size,b||f.FLOAT,c||!1,d||0,e||0)},sp=function(a){return tp[a]},tp={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},up=function(a,c){if(!vp){var d=b.keys(wp);vp={};for(var e=0;e<d.length;++e){var f=d[e];vp[a[f]]=wp[f]}}return vp[c]},vp=null,wp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},xp=function(a,b){switch(a){case"float":return 0;case"vec2":return new Float32Array(2*b);case"vec3":return new Float32Array(3*b);case"vec4":return new Float32Array(4*b);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*b);case"ivec3":return new Int32Array(3*b);case"ivec4":return new Int32Array(4*b);case"bool":return!1;case"bvec2":return yp(2*b);case"bvec3":return yp(3*b);case"bvec4":return yp(4*b);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},yp=function(a){for(var b=new Array(a),c=0;c<b.length;c++)b[c]=!1;return b},zp=function(a,c){var d={data:{}};d.gl=a;for(var e=b.keys(c),f=0;f<e.length;f++){var g=e[f],h=g.split("."),i=h[h.length-1],j=Cp(h,d),k=c[g];j.data[i]=k,j.gl=a,b.defineProperty(j,i,{get:Ap(i),set:Bp(i,k)})}return d},Ap=function(a){var b=Dp.replace("%%",a);return new Function(b)},Bp=function(a,b){var c,d=Ep.replace(/%%/g,a);return c=1===b.size?Fp[b.type]:Gp[b.type],c&&(d+="\nthis.gl."+c+";"),new Function("value",d)},Cp=function(a,b){for(var c=b,d=0;d<a.length-1;d++){var e=c[a[d]]||{data:{}};c[a[d]]=e,c=e}return c},Dp=["return this.data.%%.value;"].join("\n"),Ep=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),Fp={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Gp={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},Hp=j.Light=function(){Wd(Hp,this),this.s(vm,m[vm]),this.s(Tb,"sphere"),this.s3(20,20,20)};li("Light",Sk,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(a,b,c){Hp.superClass.onStyleChanged.apply(this,arguments),a===vm&&this.s("shape3d.color",c)}});var Ip=Tn.Graph3dView=function(a,b){var c=this;c._webGLVersion=1,c._attributes=b||l.graph3dViewAttributes,c._25I={},c._view=pe(1,c);var d=c._canvas=re(c._view);x(d,"webglcontextlost",function(a){a.preventDefault(),jn(c),c._26I&&c._doBufferGC(c._26I,!0),c._26I=i,c._1o.texture=i,c._35O=!0}),x(d,"webglcontextrestored",function(a){c._35O=!1,c.iv()}),c._batchIndexMap={},c._batchModelMap={},c._wireframeIndexMap={},c._wireframeModelMap={},c._wireframeIndexMapSwap={},c._wireframeModelMapSwap={},c._polylineIndexMap={},c._polylineIndexMap={},c._polylineIndexMapSwap={},c._polylineIndexMapSwap={},c._8O=[],c._7O=ti(),c._6O=ti(),c._1o=new Pp(c),c._30O=new Up(c),c._31O=new Qp(c),c._32O=new Rp(c),c._raycaster=new dq(c),c._highlightHelper=new Sp(c),c._postProcessing=new mq(c),c._cameras=[],c._cameraId=0,c.vr=new jq(c),c._33Q=!0,c._eye=Gh(l.graph3dViewEye),c._center=Gh(l.graph3dViewCenter),c._up=Gh(l.graph3dViewUp),c._lightChanged=!1,c._59O=[],c._spots=[],c._dirs=[],c._frameId=0,c.overlappingBox=new hl(c),c.dm(a?a:new fj),c._coreInteractor=new Al(this),c.setInteractors([new Np(c)])},Jp={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1,ortho:1},Kp=function(a,b,c,d){a.clearColor(0,0,0,0),a.clearDepth(1),a.enable(a.DEPTH_TEST),a.depthFunc(a.LEQUAL),a.disable(a.CULL_FACE),a.enable(a.BLEND),a.blendFuncSeparate(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA,a.ONE,a.ONE_MINUS_SRC_ALPHA),a.useProgram(c),Fn(a,c.uBrightness,1),Fn(a,c.uOpacity,1),Fn(a,c.uPartOpacity,1),Fn(a,c.uPick,d._picking),Fn(a,c.uTexture,!1),Fn(a,c.uBlendTexture,!1),Fn(a,c.uAlphaTest,m.alphaTest),Fn(a,c.uTransparent,!1),Fn(a,c.uFix,!1),Fn(a,c.uBatchColor,!1),Fn(a,c.uBatchBlend,!1),Fn(a,c.uBatchBrightness,!1),Fn(a,c.uReflectivity,d._envmapReflectivity),Fn(a,c.uCameraPosition,b.getEye()),Fn(a,c.uPMatrix,d._projectMatrix),Fn(a,c.uViewMatrix,d._viewMatrix),b.bindEnvMap(a),d._picking||(Mm(b,a,c),b._fogDisabled||(Fn(a,c.uFogColor,b._fogColor),Fn(a,c.uFogNear,b._fogNear),Fn(a,c.uFogFar,b._fogFar))),Gn(a,c.aPosition),Gn(a,c.aNormal),Hn(a,c.aUv),Hn(a,c.aBatchColor),Hn(a,c.aBatchBlend),Hn(a,c.aBatchBrightness),Hn(a,c.aLineDistance),a.depthMask(!0)},Lp=0;Un("Graph3dView",b,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",pb,rb,"firstPersonMode",Bb,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",ta,sa,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:l.graph3dViewEditHelperDisabled,_devicePixelRatio:c,_boundaries:c,_moveStep:l.graph3dViewMoveStep,_rotateStep:l.graph3dViewRotateStep,_pannable:l.graph3dViewPannable,_rotatable:l.graph3dViewRotatable,_walkable:l.graph3dViewWalkable,_resettable:l.graph3dViewResettable,_zoomable:l.graph3dViewZoomable,_firstPersonMode:l.graph3dViewFirstPersonMode,_mouseRoamable:l.graph3dViewMouseRoamable,_gridVisible:l.graph3dViewGridVisible,_gridSize:l.graph3dViewGridSize,_gridGap:l.graph3dViewGridGap,_gridColor:l.graph3dViewGridColor,_originAxisVisible:l.graph3dViewOriginAxisVisible,_centerAxisVisible:l.graph3dViewCenterAxisVisible,_axisXColor:l.graph3dViewAxisXColor,_axisYColor:l.graph3dViewAxisYColor,_axisZColor:l.graph3dViewAxisZColor,_ortho:l.graph3dViewOrtho,_orthoWidth:l.graph3dViewOrthoWidth,_fovy:l.graph3dViewFovy,_near:l.graph3dViewNear,_far:l.graph3dViewFar,_headlightColor:l.graph3dViewHeadlightColor,_headlightIntensity:l.graph3dViewHeadlightIntensity,_headlightRange:l.graph3dViewHeadlightRange,_headlightDisabled:l.graph3dViewHeadlightDisabled,_rectSelectable:l.graph3dViewRectSelectable,_rectSelectBackground:l.graph3dViewRectSelectBackground,_editSizeColor:l.graph3dViewEditSizeColor,_autoMakeVisible:Yg,_fogDisabled:l.graph3dViewFogDisabled,_fogColor:l.graph3dViewFogColor,_fogNear:l.graph3dViewFogNear,_fogFar:l.graph3dViewFogFar,_dashDisabled:l.graph3dViewDashDisabled,_batchColorDisabled:l.graph3dViewBatchColorDisabled,_batchBlendDisabled:l.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:l.graph3dViewBatchBrightnessDisabled,addCamera:function(a){var c=b.freeze({id:this._cameraId++,priority:a.priority||0,ignoreInPick:!!a.ignoreInPick,useDefaultProgram:!!a.useDefaultProgram,render:a.render});this._cameras.push(c),this._cameras.sort(function(a,b){return a.priority!==b.priority?a.priority-b.priority:a.id-b.id})},setEye:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]);var d=this._eye;d[0]=a,d[1]=b,d[2]=c,this.fp(ta,i,d)},setCenter:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]);var d=this._center;d[0]=a,d[1]=b,d[2]=c,this.fp(sa,i,d)},setUp:function(a,b,c){1===arguments.length&&(b=a[1],c=a[2],a=a[0]);var d=this._up;d[0]=a,d[1]=b,d[2]=c,this.fp("up",i,d)},getDevicePixelRatio:function(){return this._devicePixelRatio||Xg},isTransparentMask:function(a){return a.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var a=this,b=a._aspect;return b?b:(b=a.getWidth()/a.getHeight(),b||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(a){var b=this,c=b._dataModel,d=b._selectionModel;c!==a&&(c&&(c.ump(b.handleDataModelPropertyChange,b),c.umm(b.handleDataModelChange,b),c.umd(b.handleDataPropertyChange,b),d||c.sm().ums(b.handleSelectionChange,b)),b._dataModel=a,a.mp(b.handleDataModelPropertyChange,b),a.mm(b.handleDataModelChange,b),a.md(b.handleDataPropertyChange,b),d?d._21I(a):a.sm().ms(b.handleSelectionChange,b),b._postProcessing.handleDataModleChange(c,a),b.invalidateAll(!0),b.invalidateLight(),b.fp(Qb,c,a),b._canvas.style.background=a.getBackground()||"")},handleDataModelPropertyChange:function(a){if("background"===a.property){var b=this._canvas.style.background,c=a.newValue||"";this._canvas.style.background=c,this.fp("canvasBackground",b,c)}else"envmap"===a.property&&this.iv()},handleDataPropertyChange:function(a){var b=a.data;this.invalidateData(b),Gm(b)&&"s:light.type"===a.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(a){var b=this,c=a.property;b.iv(),b._18Q=i,"eye"===c?b._33Q=!0:"devicePixelRatio"===c?b._42(i,b.getDevicePixelRatio()):Jp[c]&&jn(b)},_5O:function(a){var b=a._22Q();return b?new b(this,a):i},getData3dUI:function(a){var b=this._25I[a._id];return b===c&&(b=this._5O(a),this._25I[a._id]=b),b},invalidateAll:function(a){var b=this;if(a){for(var c in b._25I){var d=b._25I[c];d&&d.dispose()}b._25I={},b.iv(),eo(b)}else eo(b),b.dm().each(function(a){b.invalidateData(a)})},invalidateSelection:function(){var a=this;a.sm().each(function(b){a.invalidateData(b)})},invalidateData:function(a){var b=this,c=b.getData3dUI(a);c&&(c.iv(),b.iv()),eo(b,a)},getShape3dText:function(a){return a.getStyle("shape3d.text")||this.getLabel(a)},invalidateBatch:function(a){var b=this,d=b._batchModelMap,e=d[a],f=[],g={};if(e){e.ds.forEach(function(a){var c=b.getData3dUI(a);c&&c.iv(),delete b._batchIndexMap[a._id],f.push(a._id)}),delete d[a];for(var h,i,j,k,l,m,n,o,p,q=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],r=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],s=0;s<q.length;s++){var t=b[q[s]],u=b[r[s]];for(g={},o=0;o<f.length;o++){var v=u[f[o]];if(v){delete u[f[o]],p=v.batch,h=t[p];var w=v.begin,x=v.size,y=3*w,z=3*x,A=4*w,B=4*x;for(i=h.ds,j=h.vs,k=h.cs,l=h.ps,m=h.ls,n=v.index,h.invalidate=!0,i[n]=c,n=y;y+z>n;n++)j[n]=c;for(n=A;A+B>n;n++)k[n]=c;for(n=A;A+B>n;n++)l[n]=c;if(m)for(n=y;y+z>n;n++)m[n]=c;g[p]=!0}}for(p in g){h=t[p],i=h.ds,j=h.vs,k=h.cs,l=h.ps,m=h.ls;var C=[];for(n=0;n<i.length;n++)i[n]!==c&&C.push(i[n]);if(0===C.length)delete t[p];else{for(h.ds=C,C=[],n=0;n<j.length;n++)j[n]!==c&&C.push(j[n]);for(h.vs=C,C=[],n=0;n<k.length;n++)k[n]!==c&&C.push(k[n]);for(h.cs=C,C=[],n=0;n<l.length;n++)l[n]!==c&&C.push(l[n]);if(h.ps=C,m){for(C=[],n=0;n<m.length;n++)m[n]!==c&&C.push(m[n]);h.ls=C}}}}b.iv()}},handleDataModelChange:function(a){var b=this,c=a.kind,d=a.data;if("add"===c)b.invalidateData(d),Ld(d)&&d.getEdgeGroup()&&d.getEdgeGroup().eachSiblingEdge(b.invalidateData,b),Gm(d)&&b.invalidateLight();else if(c===Ja){var e=d._id,f=b._25I[e];f&&(f.dispose(),delete b._25I[e],b.iv()),d===b._currentSubGraph&&b.setCurrentSubGraph(i),eo(b,d),Gm(d)&&b.invalidateLight()}else c===Ka&&(b.invalidateAll(!0),b.setCurrentSubGraph(i),eo(b),b.invalidateLight())},toCanvas:function(a,b,c){var d=this,e=d.getGL();if(d.validate(),a){var f=e.getParameter(e.COLOR_CLEAR_VALUE);qn(e,a)}d._42(i,1);var g=d.getWidth(),h=d.getHeight(),j=new Uint8Array(g*h*4),k=re(),m=k.getContext("2d");e.readPixels(0,0,g,h,e.RGBA,e.UNSIGNED_BYTE,j),ue(k,g,h,1);for(var n=m.getImageData(0,0,g,h),o=n.data,p=0;p<o.length;p+=4){var q=p/4,r=B(q/g),s=q-r*g;q=4*((h-1-r)*g+s),o[q]=j[p],o[q+1]=j[p+1],o[q+2]=j[p+2],o[q+3]=j[p+3]}if(m.putImageData(n,0,0),a&&qn(e,f),d._42(i,d.getDevicePixelRatio()),b&&c){var t=re(),u=t.getContext("2d");return b=b,c=c,ue(t,b,c,1),l.drawImage(u,k,0,0,b,c),t}return k},toDataURL:function(a,b){var c=this,d=c.getGL();if(c.validate(),a){var e=d.getParameter(d.COLOR_CLEAR_VALUE);qn(d,a)}c._42(i,1);var f=c._canvas.toDataURL(b||"image/png",1);return a&&qn(d,e),c._42(i,c.getDevicePixelRatio()),f},getGL:function(){var a=this._26I;if(a)return this.acquireProgram(),a;var b=this,c=b._canvas,d=b._attributes;try{a=c.getContext("webgl2",d)||c.getContext("experimental-webgl2",d),a&&(b._webGLVersion=2,b._26I=a)}catch(g){}if(!a)try{a=c.getContext("webgl",d)||c.getContext("experimental-webgl",d)}catch(g){throw new Error("WebGL not supported")}if(!a)throw new Error("WebGL not supported");b._26I=a,b._glExtensions=new e(a),b._glCapabilities=new f(a,b._glExtensions),b._2O={},a._compiledShader={},a._emptyTexture=hn(a),a._emptyBlendTexture=hn(a),a._bufPool={},a._id=++Lp,b._buffer={vs:ln(a),ns:ln(a),is:ln(a),uv:ln(a),batchColor:ln(a),batchBlend:ln(a),batchBrightness:ln(a),lineDistance:ln(a)},b._1O=gn(a);var h=b._cube={vs:ln(a),ns:ln(a),is:ln(a),uv:ln(a)};return An(a,h.vs,Fo),An(a,h.ns,Io),An(a,h.uv,Ho),Cn(a,h.is,Go),b.acquireProgram(),a},getEnvmap:function(){return this._glCapabilities&&this._glCapabilities.maxVertexTextures<16?null:this.dm().getEnvmap()},acquireProgram:function(){var a=this,b=a._26I;if(b){var c=j.Default.getImage(a.getEnvmap())?!0:!1,d=a._prg&&a._prg.envMapFlag?!0:!1;if(!a._prg||c!==d){var e=a._prg=b.createProgram();if(!e)return i;e.envMapFlag=c;var f=a._dirs.length,g=a._spots.length,h=a._59O.length,k=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];f&&k.push("uDirColor","uDirDirection"),g&&k.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),h&&k.push("uPointColor","uPointRange","uPointPosition"),qn(b,[0,0,0,0]),b.clearDepth(1),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.enable(b.BLEND),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),Cm||(Vn=Vd(Vn.substring(0,Vn.indexOf("^#"))),Wn=Vd(Wn),Cm=!0);var l=["#define MAX_DIR "+f,"#define MAX_SPOT "+g,"#define MAX_POINT "+h,a._fogDisabled?"":"#define FOG",a._dashDisabled?"":"#define DASH",c?"#define USE_ENVMAP":"",a.isOrtho()?"#define ORTHOGRAPHIC":"",a._batchColorDisabled?"":"#define BATCHCOLOR",a._batchBlendDisabled?"":"#define BATCHBLEND",a._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),m=kn(b,e,b.VERTEX_SHADER,Vn.replace("PREFIX",l));b.getShaderParameter(m,b.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",b.getShaderInfoLog(m));var n=kn(b,e,b.FRAGMENT_SHADER,Wn.replace("PREFIX",l));b.getShaderParameter(n,b.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",b.getShaderInfoLog(n)),da?k.push("aPosition"):(e.aPosition=0,b.bindAttribLocation(e,0,"aPosition")),b.linkProgram(e),k.forEach(function(a){e[a]=/^u/.test(a)?b.getUniformLocation(e,a):b.getAttribLocation(e,a)}),b.useProgram(e),b.deleteShader(m),b.deleteShader(n)}}},getBrightness:function(a){var b=a.s("brightness"),c=this.isSelected(a)?a.s("select.brightness"):i;return b==i?c:c==i?b:b*c},setHighlightMode:function(a){var b;b="selection"===a?Sp.Mode.Selection:"mouseover"===a?Sp.Mode.MouseOver:Sp.Mode.Disable,this._highlightHelper.mode=b},getHighlightMode:function(){var a=this._highlightHelper.mode;return a===Sp.Mode.Selection?"selection":a===Sp.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(a){var b=this,c=b._prg,d=5,e=b.getEnvmap(),f=j.Default.getImage(e);if(f){if(e!==b._lastEnvMap){b._envMapTexture&&a.deleteTexture(b._envMapTexture);var g=b._envMapTexture=a.createTexture();a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_CUBE_MAP,g),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,f),a.bindTexture(a.TEXTURE_CUBE_MAP,null),b._lastEnvMap=e}a.activeTexture(a.TEXTURE0+d),a.bindTexture(a.TEXTURE_CUBE_MAP,b._envMapTexture),a.uniform1i(c.uEnvMap,d)}},getWireframe:function(a){var b=a.s("wf.visible"),c=a.s("wf.width");return b===!0||c>0&&"selected"===b&&this.isSelected(a)?{color:a.s("wf.color"),width:c,"short":a.s("wf.short"),mat:a.s("wf.mat")}:void 0},_transformPointToViewSpace:function(a){var b=[a[0],a[1],a[2]];return yi(b,this._viewMatrix),b},_transformDirectionToViewSpace:function(a,b){var c=[a[0],a[1],a[2]];yi(c,this._viewMatrix);var d=b?[b[0],b[1],b[2]]:[0,0,0];yi(d,this._viewMatrix);var e=d[0]-c[0],f=d[1]-c[1],g=d[2]-c[2],h=Math.sqrt(e*e+f*f+g*g);return h?[e/h,f/h,g/h]:[e,f,g]},getWireframeGeometry:function(a){return a.s("wf.geometry")?{color:a.s("wf.color"),width:a.s("wf.width"),mat:a.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(a){return a.s("body.color")},getMat:function(a){return a.getMat?a.getMat():a.s("mat")},getFaceMat:function(a,b){return a.getFaceMat?a.getFaceMat(b):a.s(b+".mat")},getFaceBlend:function(a,b){return a.s(b+".blend")||a.s("all.blend")},getFaceColor:function(a,b){return a.s(b+".color")||a.s("all.color")},getFaceImage:function(a,b){return a.s(b+".image")||a.s("all.image")},getFaceBlendImage:function(a,b){return a.s(b+".blend.image")||a.s("all.blend.image")},getFaceDiscardSelectable:function(a,b){var c=a.s(b+".discard.selectable");return c==i?a.s("all.discard.selectable"):c},getFaceUv:function(a,b){return a.s(b+".uv")||a.s("all.uv")},getFaceUvOffset:function(a,b){return a.s(b+".uv.offset")||a.s("all.uv.offset")},getFaceUvScale:function(a,b){return a.s(b+".uv.scale")||a.s("all.uv.scale")},getFaceLight:function(a,b){var c=a.s(b+".light");return c==i?a.s("all.light"):c},getFaceVisible:function(a,b){var c=a.s(b+".visible");return c==i?a.s("all.visible"):c},getFaceOpacity:function(a,b){var c=a.s(b+".opacity");return c==i?a.s("all.opacity"):c},getFaceTransparent:function(a,b){var c=a.s(b+".transparent");return c==i?a.s("all.transparent"):c},getFaceReverseColor:function(a,b){return a.s(b+".reverse.color")||a.s("all.reverse.color")},getFaceReverseFlip:function(a,b){var c=a.s(b+".reverse.flip");return c==i?a.s("all.reverse.flip"):c},getFaceReverseCull:function(a,b){var c=a.s(b+".reverse.cull");return c==i?a.s("all.reverse.cull"):c},getTextureMap:function(){return this._2O},deleteTexture:function(a){var b=this,c=b._2O[a];c&&(delete b._2O[a],b.getGL().deleteTexture(c))},invalidateShape3dCachedImage:function(a){var b=this.getData3dUI(a);b.invalidateCachedTexture(this.getGL())},isInteractive:function(a){return a.s("interactive")},getTexture:function(a,b){if(!a)return i;var c=this,d=c.getGL(),e=c._2O[a];if(!e){var f=yh(a);if(!f)return d._emptyTexture;if(f.uuid||(f.uuid=j.Math.generateUUID()),f.tagName){if(f.dynamic)return gn(d,f,c._1O);e=c._2O[a]=gn(d,f)}else{var g,h=b&&b.s("shape3d.image.cache")&&!c.isInteractive(b),k=c.vr.isPresenting();if(k&&(b._textureUpdateFrame===d._renderInfo.frame?h=!0:b._textureUpdateFrame=d._renderInfo.frame),h&&(g=c.getData3dUI(b),e=g.getCachedTexture()),!e){var m=d._renderInfo.textureCache;if(h){if(m.time>l.graph3dMaxVectorCacheTime)return c.redraw(),d._emptyTexture;if(!zh(f,b))return d._emptyTexture}var n,o=b&&b.s("shape3d.fixSizeOnScreen"),p=o?d.NEAREST:d.LINEAR;o||b&&b.s("shape3d.vector.dynamic")&&(g||(g=c.getData3dUI(b)),o=g.getVectorDynamicSize(),o&&(n=c.getDevicePixelRatio(),o[0]*=n,o[1]*=n));var q,r,s,t=b&&b.s("shape3d.texture.scale")||1,u=_i(f,b,c);if(u){var v=b.s("shape3d");"billboard"===v?s=b.getTall()/b.getWidth():"plane"===v&&(s=b.getHeight()/b.getWidth())}var w=Zi(f,b);if(o?(n||(n=c.getDevicePixelRatio()),q=o[0]>0?o[0]:t*w*n,r=o[1]>0?o[1]:t*(s?$i(f,b,c,Math.min(4096,w*s)):$i(f,b))*n):(q=t*w,r=t*(s?$i(f,b,c,Math.min(4096,w*s)):$i(f,b))),q>=1&&r>=1){var x=0;h&&(x=Date.now());var y=pf(q,r);if(!g&&b&&(g=c.getData3dUI(b)),g&&g.interactiveInfo){var z=a;"object"==typeof z&&(z=z.uuid||(z.uuid=j.Math.generateUUID()));var A=g.interactiveInfo[z]={};y.interactiveInfo=A.bodyInfo={compInfos:[],matrix:new Gg,rect:{x:0,y:0,width:q,height:r}}}aj(y,f,0,0,q,r,b,c),y.interactiveInfo&&(y.interactiveInfo=null),y.restore(),m.count++,m.pixels+=q*r,h||k?(e=gn(d,nf,null,p),g.setCachedTexture(e),m.time+=Date.now()-x,nf=null):e=gn(d,nf,c._1O,p)}}}}return e},redraw:function(){this.iv()},validateImpl:function(){var a=this;if(a._lightChanged){a._lightChanged=!1;var b=[],c=[],d=[];a.dm().each(function(a){if(Gm(a)){var e=a.s("light.type");e===tm?b.push(a):e===um?c.push(a):e===sm&&d.push(a)}}),(b.length!==a._59O.length||c.length!==a._spots.length||d.length!==a._dirs.length)&&jn(a),a._59O=b,a._spots=c,a._dirs=d}a._42(),a._1o.iv()},getRenderInfo:function(){var a=this.getGL();return a?a._renderInfo:void 0},getDebugTip:function(){var a=this,b=a.getRenderInfo();if(b){var c=a.getGL()._validBufCount||0,d="Draw Calls: "+b.calls+"<br/>Vertices: "+b.vertices+"<br/>Faces: "+b.faces+"<br/>Lines: "+b.lines+"<br/>Buffer Count: "+c;a.vr.isPresenting()&&(d+="<br/>VR fps: "+a.vr.getFps());var e=b.textureCache.count;if(d+="<br/>2D Dynamic Textures: "+b.textureCache.count,e>0){var f,g=b.textureCache.pixels;f=g>1e6?Math.round(g/1e6)+"M":g>1e3?Math.round(g/1e3)+"K":Math.round(g),d+="<br/>2D Dynamic pixels: "+f}return d}},_42:function(a,b){var c=this;if(!c._35O&&(!Pc||Kc(Pc))){var d,e;a&&(a instanceof Sk?e=a:d=a);var f=c._canvas,g=c.getGL(),h=c._prg;if(g){var k=c.getWidth(),l=c.getHeight();if(k&&l){b?a||ue(f,k,l,b):(b=c.getDevicePixelRatio(),a||k===f.clientWidth&&l===f.clientHeight||(ue(f,k,l,b),k&&Math.abs(g.drawingBufferWidth-k*b)>1&&(c.setDevicePixelRatio(b=g.drawingBufferWidth/k),ue(f,k,l,b)))),g.clear(g.COLOR_BUFFER_BIT),c.drawFilter||(g._renderInfo={
calls:0,vertices:0,faces:0,lines:0,frame:a?c._frameId:++c._frameId,textureCache:{time:0,count:0,pixels:0}});var m,n=this._cameras,o=0,p=n.length,q=!1,r=j.Default.cameraPriority.skybox,s=j.Default.cameraPriority.main,t=j.Default.cameraPriority.top,u=k*b,v=l*b,w=function(){c.overlappingBox.clear(),c._81O=i,g.clear(g.DEPTH_BUFFER_BIT),g._picking=!!a;var b={_picking:!!a,_envmapReflectivity:c._envmapReflectivity||.5,_projectMatrix:c._projectMatrix=en(c),_viewMatrix:dn(c,c._7O)};if(c._viewMatrix=vi(c._7O),e){Kp(g,c,h,b);var f=g.getParameter(g.COLOR_CLEAR_VALUE);g.clearColor(0,0,0,0),g.disable(g.BLEND),Hn(g,h.aNormal),An(g,c._cube.vs,i,h.aPosition),Cn(g,c._cube.is),Fm(e,c,oa,0),Fm(e,c,ma,6),Fm(e,c,pa,12),Fm(e,c,na,18),Fm(e,c,qa,24),Fm(e,c,ra,30),Gn(g,h.aNormal),qn(g,f)}else if(d){for(d.value=2;p>o;o++)if(m=n[o],!m.ignoreInPick){if(m.priority>=s)break;m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c,d)}Kp(g,c,h,b);var f=g.getParameter(g.COLOR_CLEAR_VALUE);for(g.clearColor(0,0,0,0),g.disable(g.BLEND),c._95I(g,h,d),to(c,d),so(c,c._polylineModelMap,d),so(c,c._wireframeModelMap,d),Fn(g,h.uTransparent,!0),c._95I(g,h,d,!0),to(c,d,!0),so(c,c._polylineModelMap,d,!0),so(c,c._wireframeModelMap,d,!0),Fn(g,h.uTransparent,!1);p>o;o++)if(m=n[o],!m.ignoreInPick){if(m.priority>=t)break;m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c,d),q=!0}for(q&&(Kp(g,c,h,b),q=!1),g.clear(g.DEPTH_BUFFER_BIT),c._swapLineMap(),c._95I(g,h,d,!1,!0),so(c,c._polylineModelMap,d),so(c,c._wireframeModelMap,d),c._swapLineMap(),c._swapLineMap(),c._95I(g,h,d,!1,!0),so(c,c._polylineModelMap,d),so(c,c._wireframeModelMap,d),Fn(g,h.uTransparent,!0),c._95I(g,h,d,!0,!0),so(c,c._polylineModelMap,d,!0),so(c,c._wireframeModelMap,d,!0),Fn(g,h.uTransparent,!1),c._swapLineMap(),g.disable(g.DEPTH_TEST),c.drawFilter||c._30O._42(g,h,d),g.enable(g.DEPTH_TEST);p>o;o++)m=n[o],m.ignoreInPick||(m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c,d));qn(g,f)}else{for(;p>o&&(m=n[o],!(m.priority>=r));o++)m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c);for(Kp(g,c,h,b),g.disable(g.BLEND),c.drawSky(g,h),c.drawReflectors(g,u,v,w,a)&&(b._projectMatrix=c._projectMatrix=en(c),b._viewMatrix=dn(c,c._7O),c._viewMatrix=vi(c._7O),Kp(g,c,h,b));p>o&&(m=n[o],!(m.priority>=s));o++)m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c),q=!0;for(q&&(Kp(g,c,h,b),q=!1),c._31O._42(g,h),c._95I(g,h),to(c),so(c,c._polylineModelMap),so(c,c._wireframeModelMap),g.enable(g.BLEND),g.depthMask(!1),Fn(g,h.uTransparent,!0),c._95I(g,h,i,!0),to(c,i,!0),so(c,c._polylineModelMap,i,!0),so(c,c._wireframeModelMap,i,!0),g.depthMask(!0),Fn(g,h.uTransparent,!1);p>o&&(m=n[o],!(m.priority>=t));o++)m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c),q=!0;for(q&&(Kp(g,c,h,b),q=!1),g.clear(g.DEPTH_BUFFER_BIT),c._swapLineMap(),g.disable(g.BLEND),c._95I(g,h,i,!1,!0),so(c,c._polylineModelMap),so(c,c._wireframeModelMap),g.enable(g.BLEND),Fn(g,h.uTransparent,!0),g.depthMask(!1),c._95I(g,h,i,!0,!0),so(c,c._polylineModelMap,i,!0),so(c,c._wireframeModelMap,i,!0),g.depthMask(!0),Fn(g,h.uTransparent,!1),c._swapLineMap(),g.disable(g.DEPTH_TEST),g.disable(g.BLEND),c._32O._42(g,h),c._30O._42(g,h),c._highlightHelper._42(g,h),g.enable(g.DEPTH_TEST);p>o;o++)m=n[o],m.useDefaultProgram&&Kp(g,c,h,b),m.render(g,c)}An(g,i),Cn(g,i)},x=!1,y=c.vr;y.enable&&y._42(g,u,v,w)&&(x=!0);var z=c.envRenderer;z&&z.enable&&z._42(g,u,v,w)&&(x=!0);var A=c._postProcessing;A._42(g,u,v,w,a)&&(x=!0),x||(c.setViewport(g,0,0,k*b,l*b),w()),c._33Q=!1,c.drawFilter||c.countFrame(),c._doBufferGC(g)}}}},drawReflectors:function(a,b,c,d,e){var f,g,h,i=this,j=i._dataModel.getReflectors(),k=!1;for(f in j)g=j[f],i.isVisible(g)&&(h=i.getData3dUI(g),h&&h.drawReflector(a,b,c,d,e)&&(k=!0));return k},enablePostProcessing:function(a,b){return this._postProcessing.enableModule(a,b)},getPostProcessingModule:function(a){return this._postProcessing.getModule(a)},setViewport:function(a,b,c,d,e){this._viewport=[b,c,d,e],a.viewport(b,c,d,e)},getViewport:function(a){return this._viewport},setBufferGCInterval:function(a){this._bufferGCInterval=a},_doBufferGC:function(a,b){var c,d,e=a._bufPool,f=0,g=0,h=a._renderInfo.frame,i=this._bufferGCInterval||10;for(c in e)f++,d=e[c],d&&(b||h-d._fid>i?(a.deleteBuffer(d._buf),d._buf=null,e[c]=null):g++);if(f/2>g&&f>128){var j={};for(c in e)e[c]&&(j[c]=e[c]);a._bufPool=j}a._validBufCount=g},_swapLineMap:function(){var a=this;aa=a._polylineModelMap,a._polylineModelMap=a._polylineModelMapSwap,a._polylineModelMapSwap=aa,aa=a._wireframeModelMap,a._wireframeModelMap=a._wireframeModelMapSwap,a._wireframeModelMapSwap=aa,aa=a._polylineIndexMap,a._polylineIndexMap=a._polylineIndexMapSwap,a._polylineIndexMapSwap=aa,aa=a._wireframeIndexMap,a._wireframeIndexMap=a._wireframeIndexMapSwap,a._wireframeIndexMapSwap=aa},_updateSkyBox:function(a){if(this._skyBox&&a){var b=a.property,c=!1,d=this._skyBox;if("eye"===b||"forceUpdate"===b){var e=this._eye;d.p3(e[0],e[1],e[2]),c=!0}if("near"===b||"far"===b||"forceUpdate"===b){var f=this._near,g=this._far,h=d.getFinalScale3d();if(h[0]/=2,h[1]/=2,h[2]/=2,h[0]<=f||h[0]>=g||h[1]<=f||h[1]>=g||h[2]<=f||h[2]>=g){var i=2*f*g/(f+g),j=Math.min(h[0],h[1],h[2]),k=i/j,l=d.getScale3d();d.setScale3d(l[0]*k,l[1]*k,l[2]*k),c=!0}}c&&this.invalidateData(d)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(a){var b=this._skyBox;b&&(this._skyBoxStyleMap&&b.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&b.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&b.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=a,this.ump(this._updateSkyBox,this),a&&(a.dm()&&a.dm().remove(a),this._skyBoxStyleMap=j.Default.clone(a.getStyleMap()),this._skyBoxAnchor3d=a.getAnchor3d(),a.setAnchor3d(.5,.5,.5),this._skyBoxP3=a.p3().slice(0),a.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",b,a)},drawSky:function(a,b,c){var d=this,e=d._skyBox;if(e){var f=d._headlightIntensity,g=rf(d._headlightColor),b=d._prg;1!==f&&(g=[g[0]*f,g[1]*f,g[2]*f]),Fn(a,b.uHeadlightColor,[g[0],g[1],g[2],1]);var h=d.getData3dUI(e);if(h){var i,j=d.isOrtho(),k=j||this._computedProjectMatrix;k&&(i=d._projectMatrix,j&&(d._ortho=!1),Fn(a,b.uPMatrix,d._projectMatrix=en(d,!0)));var l=e.p3(),m=this._eye;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2])&&(e._position.x=m[0],e._54O=m[1],e._position.y=m[2]),h._42(a,b,c,function(){return!0}),k&&(j&&(d._ortho=!0),Fn(a,b.uPMatrix,d._projectMatrix=i))}a.clear(a.DEPTH_BUFFER_BIT),Fn(a,b.uHeadlightColor,[g[0],g[1],g[2],d._headlightDisabled?1:0])}},_95I:function(a,b,c,d,e){function f(d){if(!!d.s("shape3d.alwaysOnTop")==!!e&&g.isVisible(d)&&(!T||U)){if(!c&&g.isTransparentMask(d))return;var f=g.getData3dUI(d);f&&f._42(a,b,c,h)}}var g=this,h=function(a){return d?a:!a};g.sky&&a.clear(a.DEPTH_BUFFER_BIT);var i=g.drawFilter;i?g.dm().each(function(a){i(a)||f(a)}):g.dm().each(function(a){f(a)})},getLogicalPoint:function(a){return ci(a,this._canvas)},isRectOverlapping:function(a){var b=this.getData3dUI(a);return b._rectOverlapping},getHitFaceInfo:function(a){a.target&&(a=this.lp(a));var b=this.getDataInfoAt(a);if(b){var c=this._1o.face(b.data,yd(a.x,a.y));if(c)return{data:b.data,face:c}}return i},unproject:function(a,b){var c=this,d=c.getWidth(),e=c.getHeight(),f=a.target?c.lp(a):a,g=f.x-d/2,h=f.y-e/2,i=g/d*2,j=-1*h/e*2;b=b||0;var k=ti(),l=en(c),m=dn(c);Ym(k,l,m),Vm(k);var n=zi([i,j,b,1],k);return[n[0]/n[3],n[1]/n[3],n[2]/n[3]]},getDataAt:function(a){var b=this.getDataInfoAt(a);return b?b.data:i},getDataInfoAt:function(a,b){return a.target&&(a=this.lp(a)),this._1o.get(yd(a.x,a.y,b),!0)},getDatasInRect:function(a){return this._1o.get(a)},setEditable:function(a){var b=this,c=b._editable;b._editable=a,this.fp(Gb,c,a)},isEditable:function(a){var b=this;return b._editable&&Kd(a)&&a.s("3d.editable")?b._editableFunc?b._editableFunc(a):!0:!1},isSelectable:function(a){return a.s("3d.selectable")&&this.sm().isSelectable(a)},isMovable:function(a){var b=this;return Ld(a)&&a.getStyle(hb)!==Ta?!1:a.s("3d.movable")?b._movableFunc?b._movableFunc(a):!0:!1},isSizeEditable:function(a){return Kd(a)?this._sizeEditableFunc?this._sizeEditableFunc(a):!0:!1},isRotationEditable:function(a){return Kd(a)&&a.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(a):!0:!1},handleDelete:function(a){this._editable&&this.removeSelection()},zoomIn:function(a){this.setZoom(qh,a)},zoomOut:function(a){this.setZoom(1/qh,a)},setZoom:function(a,b){if(1!==a){var c=this;if(c._ortho)return void c.setOrthoZoom(a,b);c._14o&&c._14o.stop(!0);var d=1/a,e=c._eye,f=c._center,g=f[0]+(e[0]-f[0])*d-e[0],h=f[1]+(e[1]-f[1])*d-e[1],j=f[2]+(e[2]-f[2])*d-e[2];if(!(Vh(e,f)<c._moveStep&&1>d)){if(b=Sd(b)){var k=Gh(e);return b.action=function(a){c.fi({kind:c._zooming?"betweenZoom":"beginZoom"}),c._zooming=1,e[0]=k[0]+g*a,e[1]=k[1]+h*a,e[2]=k[2]+j*a,c.fp(ta,i,e)},b._37o=function(){delete c._14o,delete c._zooming,c.fi({kind:"endZoom"}),c.onZoomEnded()},c._14o=Ih(b)}e[0]+=g,e[1]+=h,e[2]+=j,c.fp(ta,i,e)}}},setOrthoZoom:function(a,b){if(1!==a){var c=this;c._14o&&c._14o.stop(!0);var d=c._orthoWidth,e=d/a-d;if(!(d<c._moveStep&&a>1))return(b=Sd(b))?(b.action=function(a){c.fi({kind:c._zooming?"betweenZoom":"beginZoom"}),c._zooming=1,c.setOrthoWidth(d+e*a)},b._37o=function(){delete c._14o,delete c._zooming,c.fi({kind:"endZoom"}),c.onZoomEnded()},c._14o=Ih(b)):void c.setOrthoWidth(d/a)}},getPositionInfo:function(a){var b=this,c=b._eye,d=b._center,e=b.getAspect(),f=a?si(qi(d,c,!0),qi(a,c)):Vh(c,d);if(b._ortho){var g=b._orthoWidth;return{length:f,height:g/e,width:g}}var h=P(b._fovy/2)*f*2;return{length:f,height:h,width:h*e}},getCenterInfo:function(){var a=this;return a._81O||(a._81O=a.getPositionInfo()),Gh(a._81O)},rotate:function(a,b,c,d){var e=this;if(a||b){d==i&&(d=e._firstPersonMode),e._88O&&e._88O.stop(!0);var f=e._center,g=e._eye,h=e.getCenterInfo().length,j=d?f:g,k=d?g:f,l=qi(j,k),m=Q(l[0],l[2]),n=Q(D(l[0]*l[0]+l[2]*l[2]),l[1]),o=d?sa:ta;return d&&(b=-b),(c=Sd(c))?(c.action=function(c){e.fi({kind:e._rotating?"betweenRotate":"beginRotate"}),e._rotating=1;var d=m+a*c,f=n+b*c;f=Om(f),l[0]=h*J(f)*J(d),l[1]=h*H(f),l[2]=h*J(f)*H(d),j[0]=k[0]+l[0],j[1]=k[1]+l[1],j[2]=k[2]+l[2],e.fp(o,i,j)},c._37o=function(){delete e._88O,delete e._rotating,e.fi({kind:"endRotate"}),e.onRotateEnded()},e._88O=Ih(c)):(m+=a,n+=b,n=Om(n),l[0]=h*J(n)*J(m),l[1]=h*H(n),l[2]=h*J(n)*H(m),j[0]=k[0]+l[0],j[1]=k[1]+l[1],j[2]=k[2]+l[2],void e.fp(o,i,j))}},pan:function(a,b,c,d){if(a||b){var e=this;d==i&&(d=e._firstPersonMode),e._89O&&e._89O.stop(!0);var f=dn(e),g=[f[0]*a,f[4]*a,f[8]*a],h=[f[1]*b,f[5]*b,f[9]*b],j=g[0]+h[0],k=g[1]+h[1],l=g[2]+h[2],m=e._center,n=e._eye;if(d){var o=Sn(e.getBoundaries(),n[0],n[2],n[0]+j,n[2]+l,D(j*j+l*l));j=o[0],l=o[1]}if(c=Sd(c)){var p=Gh(n),q=Gh(m);return c.action=function(a){e.fi({kind:e._panning?"betweenPan":"beginPan"}),e._panning=1,m[0]=q[0]+j*a,m[1]=q[1]+k*a,m[2]=q[2]+l*a,n[0]=p[0]+j*a,n[1]=p[1]+k*a,n[2]=p[2]+l*a,e.fp(ta,i,n),e.fp(sa,i,m)},c._37o=function(){delete e._89O,delete e._panning,e.fi({kind:"endPan"}),e.onPanEnded()},e._89O=Ih(c)}m[0]+=j,m[1]+=k,m[2]+=l,n[0]+=j,n[1]+=k,n[2]+=l,e.fp(ta,i,n),e.fp(sa,i,m)}},walk:function(a,b,c){if(a){var d=this;c==i&&(c=d._firstPersonMode),d._90O&&d._90O.stop(!0);var e=d._center,f=d._eye,g=qi(e,f,!0);if(c){var h=Sn(d.getBoundaries(),f[0],f[2],f[0]+g[0]*a,f[2]+g[2]*a,G(a));if(a=Vh(h),!a)return;g=[h[0]/a,0,h[1]/a]}if(b=Sd(b)){var j=Gh(f),k=Gh(e);return b.action=function(b){d.fi({kind:d._walking?"betweenWalk":"beginWalk"}),d._walking=1;var c=a*b;f[0]=j[0]+g[0]*c,f[1]=j[1]+g[1]*c,f[2]=j[2]+g[2]*c,e[0]=k[0]+g[0]*c,e[1]=k[1]+g[1]*c,e[2]=k[2]+g[2]*c,d.fp(ta,i,f),d.fp(sa,i,e)},b._37o=function(){delete d._90O,delete d._walking,d.fi({kind:"endWalk"}),d.onWalkEnded()},d._90O=Ih(b)}f[0]+=g[0]*a,f[1]+=g[1]*a,f[2]+=g[2]*a,e[0]+=g[0]*a,e[1]+=g[1]*a,e[2]+=g[2]*a,d.fp(ta,i,f),d.fp(sa,i,e)}},handleScroll:function(a,b){a.preventDefault();var c=this,d=c._moveStep,e=c.getDataInfoAt(a);if(e){var f=e.data;if(f&&c.isInteractive(f)){var g=c.intersectObject(a,f);if(g){var h=g.part,i=yh(f.s(h+".image")||f.s("shape3d."+h+".image")||f.s("all.image")||f.s("shape3d.image"));if(i&&_i(i.scrollable,f,c))return}}}c.isFirstPersonMode()?c.isPannable()&&c.pan(0,b>0?d:-d):c.isZoomable()&&c.setZoom(0>b?1/rh:rh)},handlePinch:function(a,b){this.isZoomable()&&this.setZoom(b>a?1/sh:sh)},reset:function(){this.setCenter(l.graph3dViewCenter),this.setEye(l.graph3dViewEye),this.setUp(l.graph3dViewUp)},moveSelection:function(a,b,c){var d=this;d.dm().beginTransaction(),Yf(this.sm().toSelection(this.isMovable,this),a,b,c),d.dm().endTransaction()},getMoveMode:function(a,b){var c=b.s("3d.move.mode");if(c)return c;var d="88",e="89",f="90";return Rh(a)||Vc[d]&&Vc[e]&&Vc[f]?"xyz":Vc[d]&&Vc[e]?"xy":Vc[d]&&Vc[f]?"xz":Vc[e]&&Vc[f]?"yz":Vc[d]?"x":Vc[e]?"y":Vc[f]?"z":"xz"},handleTick:function(){var a=this,b=!1,c=a._moveStep,d=c,e=!1,f=!0,g=a._rotateStep*(f?-1:1);if(a.isWalkable()||(d=0),a.isPannable()||(c=0),a.isRotatable()||(g=0),a._32Q){var h=(qd()-a._32Q)/50;d*=h,c*=h,g*=h}a._31Q&&(Eh(a._31Q),delete a._31Q,delete a._32Q),_e()&&(b=!0,a.pan(-c,0,e,f)),bf()&&(b=!0,a.pan(c,0,e,f)),cf()&&(b=!0,Rh()?a.pan(0,c,e,f):a.walk(d,e,f)),af()&&(b=!0,Rh()?a.pan(0,-c,e,f):a.walk(-d,e,f)),df()&&(b=!0,a.rotate(-g,0,e,f)),ff()&&(b=!0,a.rotate(g,0,e,f)),ef()&&(b=!0,a.rotate(0,-g/2,e,f)),gf()&&(b=!0,a.rotate(0,g/2,e,f)),b&&(a._32Q=qd(),a._31Q=Dh(a.handleTick,a))},handleKeyDown:function(a){var b=this;!Sh(a)&&lf[a.keyCode]?b.handleTick():We(a)?b.selectAll():Xe(a)?b.handleDelete(a):hf(a)&&this.isResettable()&&b.reset()},checkDoubleClickOnNote:function(a,b,c){var d=this;if(c===Za){if(b.s("note.toggleable"))return b.s(db,!b.s(db)),d.fi({kind:"toggleNote",event:a,data:b,part:c}),!0}else if(c===$a&&b.s("note2.toggleable"))return b.s(eb,!b.s(eb)),d.fi({kind:"toggleNote2",event:a,data:b,part:c}),!0;return!1},checkDoubleClickOnRotation:function(a,b,c){return c===Yp?(b.setRotationX(0),!0):c===Zp?(b.setRotationY(0),!0):c===$p?(b.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(a){var b=this;if(b.isOrtho())return b.getWidth()/b.getOrthoWidth();var c=b.getCenter(),d=b.getHeight(),e=b.getEye(),f=[c[0]-e[0],c[1]-e[1],c[2]-e[2]],g=[a[0]-e[0],a[1]-e[1],a[2]-e[2]],h=Math.sqrt(f[0]*f[0]+f[1]*f[1]+f[2]*f[2]),i=1/Math.tan(b.getFovy()/2);return d*h*i/(g[0]*f[0]+g[1]*f[1]+g[2]*f[2])},inViewSpace:function(a){var b,c=this,d=c._transformPointToViewSpace(a),e=c.getAspect(),f=c.getNear(),g=c.getFar();return-d[2]<f||-d[2]>g?!1:c.isOrtho()?(b=c.getOrthoWidth()/2,Math.abs(d[0])<=b&&Math.abs(d[1]*e)<=b):(b=Math.sqrt(d[0]*d[0]+d[1]*d[1]+d[2]*d[2])*Math.tan(c.getFovy()/2),Math.abs(d[1]<=b)&&Math.abs(d[0])<=b*e)},getPVMatrix:function(){var a=this,b=a.getWidth()/2,c=a.getHeight()/2,d=a._18Q;return d&&d._wh===b/c||(d=en(a),a._18Q=Ym(d,d,dn(a)),a._18Q._wh=b/c),d},getFrustum:function(){var a=new Rg,b=new Qg,c=new Array(16);return function(){for(var d=this.getPVMatrix(),e=!1,f=0;16>f;f++)d[f]!==c[f]&&(e=!0,c[f]=d[f]);return e&&b.setFromMatrix(a.fromArray(d)),b}}(),toViewPosition:function(a){var b=this,c=b.getWidth()/2,d=b.getHeight()/2,e=b.getPVMatrix();return a=zi([a[0],a[1],a[2],1],e),{x:c+c*a[0]/a[3],y:d-d*a[1]/a[3],z:a[2]/a[3]}},getHitPosition:function(a,b,c){var d=this,e=d.getWidth(),f=d.getHeight(),g=a.target?d.lp(a):a,h=g.x-e/2,i=g.y-f/2,j=d.getCenterInfo(),k=dn(d);b=b?b:[0,0,0],c=c?c:[0,1,0],h=h/e*j.width,i=-1*i/f*j.height;var l=[k[0]*h,k[4]*h,k[8]*h],m=[k[1]*i,k[5]*i,k[9]*i],n=[l[0]+m[0],l[1]+m[1],l[2]+m[2]],o=d.getCenter(),p=Qm(d,b,c,[n[0]+o[0],n[1]+o[1],n[2]+o[2]]);return p?p:[0,0,0]},intersectObject:function(a,b){return this._raycaster.intersectObject(a,b)},intersectObjects:function(a,b,c){return this._raycaster.intersectObjects(a,b,c)},getLineLength:function(a){this.validate();var b=this.getData3dUI(a);if(b&&b.getCache){var c=b.getCache();if(c)return c[c.length-1].length}return 0},getLineOffset:function(a,b){var c=this.getData3dUI(a);if(c&&c.getCache){var d=c.getCache();if(d){var e=ep(d,b),f=a.r3();if(0===f[0]&&0===f[1]&&0===f[2])return e;var g=new Kg(a.p3()),h=new Kg(e.point).sub(g),j=new Kg(e.tangent).add(h),k=(new Ig).setFromEuler(new Tg(f,a.getRotationMode(),!0));return h.applyQuaternion(k),j.applyQuaternion(k),{point:h.add(g),tangent:j.sub(h).normalize()}}}return i},isLabelVisible:function(a){return!0},isNoteVisible:function(a){return!0},moveCamera:function(a,b,c){var d=this,e=d.getEye();e=[e[0],e[1],e[2]];var f=d.getCenter();if(f=[f[0],f[1],f[2]],a||(a=e),b||(b=f),d._flyAnim&&d._flyAnim.stop(!0),c=Sd(c),!c)return d.setEye(a[0],a[1],a[2]),d.setCenter(b[0],b[1],b[2]),delete d._flyAnim,!0;var g=[a[0]-e[0],a[1]-e[1],a[2]-e[2]],h=[b[0]-f[0],b[1]-f[1],b[2]-f[2]];return c.action=function(a){d.setCenter(f[0]+h[0]*a,f[1]+h[1]*a,f[2]+h[2]*a),d.setEye(e[0]+g[0]*a,e[1]+g[1]*a,e[2]+g[2]*a)},c._37o=function(){delete d._flyAnim},d._flyAnim=Ih(c)},flyTo:function(){function a(a,b,c){if(c instanceof j.Node){g.fromArray(Ei(c,b.getMat(c)));var d=c.getAnchor3d();a.push((new Kg).set(0-d.x,0-d.y,0-d.z).applyMatrix4(g)),a.push((new Kg).set(0-d.x,0-d.y,1-d.z).applyMatrix4(g)),a.push((new Kg).set(0-d.x,1-d.y,0-d.z).applyMatrix4(g)),a.push((new Kg).set(0-d.x,1-d.y,1-d.z).applyMatrix4(g)),a.push((new Kg).set(1-d.x,0-d.y,0-d.z).applyMatrix4(g)),a.push((new Kg).set(1-d.x,0-d.y,1-d.z).applyMatrix4(g)),a.push((new Kg).set(1-d.x,1-d.y,0-d.z).applyMatrix4(g)),a.push((new Kg).set(1-d.x,1-d.y,1-d.z).applyMatrix4(g))}}var b=new Kg,d=new Kg,e=new Kg,f=new Kg,g=new Rg,h=new j.Math.Quaternion,i=new Tg;return function(g,k,l){var m=this;if(l!==c)k={animation:k,ratio:l};else{var n=typeof k;("boolean"===n||"object"===n&&k.duration)&&(k={animation:k})}k=k||{},b.fromArray(m.getEye()),d.fromArray(m.getCenter());var o,p,q=[],r=k.center,s=k.distance===c;if(r&&e.fromArray(r),g instanceof j.Node)r||e.fromArray(g.p3()),s&&(a(q,m,g),o=q.length);else{if(g||(g=m.dm().getDatas()),!g.length)return;if((s||!r)&&(q=[],g.forEach(function(b){a(q,m,b)}),o=q.length,!o))return;if(!r){for(e.set(0,0,0),p=0;o>p;p++)e.add(q[p]);e.multiplyScalar(1/o)}}if(m.setCenter(e.x,e.y,e.z),f.subVectors(b,d),k.direction||k.worldDirection){!k.worldDirection&&g instanceof j.Node?h.setFromEuler(i.set(g.r3(),g.getRotationMode(),!0)):h.set(0,0,0,1);var t=f.length();f.fromArray(k.worldDirection||k.direction).applyQuaternion(h).setLength(t)}var u=0;if(s){var v,w,x,l=k.ratio||.8,y=k.xRatio||l,z=k.yRatio||l;if(m.isOrtho()){var A=-(1/0);for(m._eye[0]=f.x+e.x,m._eye[1]=f.y+e.y,m._eye[2]=f.z+e.z,v=en(m),Ym(v,v,dn(m)),p=0;o>p;p++)x=q[p],w=zi([x.x,x.y,x.z,1],v),A=Math.max(A,Math.max(Math.abs(w[0])/y,Math.abs(w[1])/z));u=m.getOrthoWidth()*A,f.add(e)}else{for(var B,C,D=m.getNear(),E=10;E--;){for(m._eye[0]=f.x+e.x,m._eye[1]=f.y+e.y,m._eye[2]=f.z+e.z,v=en(m),Ym(v,v,dn(m)),B=!0,C=-(1/0),p=0;o>p;p++){if(x=q[p],w=zi([x.x,x.y,x.z,1],v),w[3]<D&&E){f.multiplyScalar(2),B=!1;break}C=Math.max(C,Math.max(Math.abs(w[0])/y,Math.abs(w[1])/z)-w[3])}if(B)break}f.setLength(C+f.length()).add(e)}}else f.setLength(k.distance).add(e);m._flyAnim&&m._flyAnim.stop(!0);var F=Sd(k.animation);if(F){m.setEye(b.x,b.y,b.z),m.setCenter(d.x,d.y,d.z);var G=(new Kg).subVectors(f,b),H=(new Kg).subVectors(e,d);if(u)var I=m.getOrthoWidth();var J=new Kg,K=new Kg,L=F.action,M=F._37o;return F.action=function(a,c){J.copy(b).addScaledVector(G,a),K.copy(d).addScaledVector(H,a),m.setCenter(K.x,K.y,K.z),m.setEye(J.x,J.y,J.z),u&&m.setOrthoWidth((u-I)*a+I),L&&L(a,c)},F._37o=function(){delete m._flyAnim,M&&M()},{lastEye:b,lastCenter:d,eye:f,center:e,orthoWidth:u,animation:m._flyAnim=Ih(F)}}return m.setEye(f.x,f.y,f.z),u&&m.setOrthoWidth(u),delete m._flyAnim,{lastEye:b,lastCenter:d,eye:f,center:e,orthoWidth:u}}}(),getBoundingBox:function(){function a(a,c,d){b.fromArray(Ei(d,c.getMat(d)));var e=d.getAnchor3d();a.push((new Kg).set(0-e.x,0-e.y,0-e.z).applyMatrix4(b)),a.push((new Kg).set(0-e.x,0-e.y,1-e.z).applyMatrix4(b)),a.push((new Kg).set(0-e.x,1-e.y,0-e.z).applyMatrix4(b)),a.push((new Kg).set(0-e.x,1-e.y,1-e.z).applyMatrix4(b)),a.push((new Kg).set(1-e.x,0-e.y,0-e.z).applyMatrix4(b)),a.push((new Kg).set(1-e.x,0-e.y,1-e.z).applyMatrix4(b)),a.push((new Kg).set(1-e.x,1-e.y,0-e.z).applyMatrix4(b)),a.push((new Kg).set(1-e.x,1-e.y,1-e.z).applyMatrix4(b))}var b=new Rg;return function(b){if(b=b||this.sm().getSelection(),b instanceof j.Node&&(b=[b]),0===b.length)return i;var c=[];b.forEach(function(b){a(c,this,b)},this);var d=[1/0,1/0,1/0],e=[-(1/0),-(1/0),-(1/0)];return c.forEach(function(a){d[0]=Math.min(a.x,d[0]),d[1]=Math.min(a.y,d[1]),d[2]=Math.min(a.z,d[2]),e[0]=Math.max(a.x,e[0]),e[1]=Math.max(a.y,e[1]),e[2]=Math.max(a.z,e[2])}),{min:d,max:e}}}()}),Tn.RenderEnv=function(a){this.gv=a,this.enable=!1},b.defineProperties(Tn.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(a){this._debugOn=a,this.capture&&this.capture()}}}),b.assign(Tn.RenderEnv.prototype,{renderEnvToCube:function(a,b,c,d){var e=this,f=e.gv;if(!a||!b||!c)return e.enable=!1,void(e._42=null);e.enable=!0;var g=Math.floor(d/a*b),h=f.getGL(),i=e._renderTargets;i?i.length<c&&(i=e._renderTargets=i.concat(new Array(c-i.length))):i=e._renderTargets=new Array(c);for(var j=0;c>j;j++)i[j]?i[j].setSize(h,d,g):i[j]=new Tn.RenderTarget(f,h,d,g);var k=!1;e.capture=function(){k=!0,f._42(),k=!1};var l=new Kg,m=new Kg,n=new Kg,o=new Kg,p=(new Kg).setY(0),q=2*Math.PI/c,r=a/2/Math.tan(Math.PI/c),s=2*Math.atan2(b/2,r),t=a/b;e._42=function(a,b,d,g){var h=e._debugOn;if(!k&&!h)return!1;l.copy(f.getEye()),o.copy(f.getCenter()).sub(l);var j=Math.atan2(o.z,o.x),u=f.getNear(),v=f.getFovy(),w=f.getAspect();m.copy(f.getCenter());for(var x,y=0;c>y;y++)if(x=i[y],p.setZ(Math.cos(j)).setX(Math.sin(j)).multiplyScalar(r),j-=q,n.addVectors(l,p),f.setNear(r),f.setCenter([n.x,n.y,n.z]),f.setFovy(s),f.setAspect(t),h){var z=Math.round(b/c);a.viewport(z*y,0,z,d),g()}else zm(a,x.frame),a.viewport(0,0,x.width,x.height),a.clear(a.COLOR_BUFFER_BIT),g(),Am(a),x.assureTexture();return f.setNear(u),f.setCenter([m.x,m.y,m.z]),f.setFovy(v),f.setAspect(w),!0},e.capture()},getTextureInfo:function(a){var b=this._renderTargets;if(!b)return null;var c=this._renderTargets[a];return c?{index:a,texture:c.texture,textureName:c.uuid}:null}}),b.assign(Tn.Graph3dView.prototype,{renderEnvToCube:function(a,b,c,d){var e=this;e.envRenderer||(e.envRenderer=new Tn.RenderEnv(e)),e.envRenderer.renderEnvToCube(a,b,c,d)}}),Tn.RenderTarget=function(a,b,c,d,e){var f=this;e=e||{},e.samples=Math.min(a._glCapabilities.maxSamples,e.samples&&e.samples>1&&2===a._webGLVersion?e.samples:0),f.options=e,f.uuid=j.Math.generateUUID(),f.gv=a,f.init(a,b,e),f.setSize(b,c,d)},b.assign(Tn.RenderTarget.prototype,{bind:function(a){zm(a,this.options.samples?this._MSAAFbo:this.frame)},unbind:function(a){Am(a),this.options.samples&&(a.bindFramebuffer(a.READ_FRAMEBUFFER,this._MSAAFbo),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,this.frame),a.blitFramebuffer(0,0,this.width,this.height,0,0,this.width,this.height,a.COLOR_BUFFER_BIT,a.NEAREST),a.bindFramebuffer(a.READ_FRAMEBUFFER,null),a.bindFramebuffer(a.DRAW_FRAMEBUFFER,null))},init:function(a,b,c){var d=this,e=d.texture=b.createTexture();b.activeTexture(b.TEXTURE0),b.bindTexture(b.TEXTURE_2D,e),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE);var f=c.samples,g=f?b.NEAREST:b.LINEAR;b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,c.minFilter||g),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,c.magFilter||g),b.bindTexture(b.TEXTURE_2D,null),d.render=b.createRenderbuffer(),d.frame=b.createFramebuffer(),f&&(d._MSAAFbo=b.createFramebuffer(),d._MSAARbO=b.createRenderbuffer()),a._2O[d.uuid]=e},assureTexture:function(){var a=this,b=a.uuid,c=a.gv._2O;c[b]||(c[b]=a.texture)},setSize:function(a,b,c){var d=this;if(b&&c&&(d.width!==b||d.height!==c)){var e=a.RGBA,f=a.TEXTURE_2D,g=a.RENDERBUFFER,h=a.FRAMEBUFFER,j=d.options.samples;mn(a,d.texture),a.texImage2D(f,0,e,b,c,0,e,a.UNSIGNED_BYTE,i),a.bindRenderbuffer(g,d.render),j?a.renderbufferStorageMultisample(g,j,a.DEPTH_COMPONENT16,b,c):a.renderbufferStorage(g,a.DEPTH_COMPONENT16,b,c),zm(a,d.frame),a.framebufferTexture2D(h,a.COLOR_ATTACHMENT0,f,d.texture,0),j||a.framebufferRenderbuffer(h,a.DEPTH_ATTACHMENT,g,d.render),Am(a),j&&(a.bindRenderbuffer(a.RENDERBUFFER,d._MSAARbO),a.renderbufferStorageMultisample(a.RENDERBUFFER,j,a.RGBA8,b,c),zm(a,d._MSAAFbo),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.RENDERBUFFER,d._MSAARbO),a.framebufferRenderbuffer(h,a.DEPTH_ATTACHMENT,g,d.render),Am(a)),mn(a,i),a.bindRenderbuffer(g,i),d.width=b,d.height=c}},toCanvas:function(){var a=this,b=a.gv.getGL();zm(b,a.frame);var c=a.width,d=a.height,e=new Uint8Array(c*d*4);b.readPixels(0,0,c,d,b.RGBA,b.UNSIGNED_BYTE,e),Am(b);var f=h.createElement("canvas");f.width=c,f.height=d;var g=f.getContext("2d"),i=g.createImageData(c,d);return i.data.set(e),g.putImageData(i,0,0),f}});var Mp=Tn.Interactor=function(a){this.gv=a};Un("Interactor",b,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Np=Tn.DefaultInteractor=function(a){Wd(Np,this,[a])};Un("DefaultInteractor",Mp,{handle_contextmenu:function(a){wh(a)},handle_mousewheel:function(a){this.gv.handleScroll(a,a.wheelDelta/40)},handle_DOMMouseScroll:function(a){2===a.axis&&this.gv.handleScroll(a,-a.detail)},handle_keydown:function(a){this.gv.handleKeyDown(a)},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){wh(a);var b=this,c=b.gv,d=Nh(a),e=c.getDataInfoAt(a),f=e?e.data:i,g=e?e.part:i,h=c.sm(),j=Ue(a),k=Ph(a);c.setFocus(a)&&(b._62O=i,b._57I=i,f?Sh(a)?h.co(f)?h.rs(f):h.as(f):h.co(f)||h.ss(f):d&&(Sh(a)?c.isRectSelectable()&&(b._62O=ob):b._57I=Th(a)),b._31Q&&(Eh(b._31Q),delete b._31Q,delete b._32Q),b._62O||(c.isFirstPersonMode()&&(Rh(a)||Oh(a)||k>2?b._62O="pan":c.isMouseRoamable()||ia?(b._62O="roaming",b.foward=j&&Nh(a),b._32Q=qd(),b._31Q=Dh(b.tick,b)):d||(b._62O="roaming")),b._62O||(d&&j&&cq[g]?(b._62O=g,b.p3=f.p3()):d&&j&&Kd(f)&&c.isSelected(f)?c.isMovable(f)?(b._62O="move",b.p3=f.p3(),b.movedata=f):c._39Q(f)&&(b._62O="none"):ia&&(k>2?b._62O="pan":2===k&&(b.dist=Tf(a),b._62O="pinch")))),b.point=c.lp(a),ei(b,a),Qh(a)?c.handleDoubleClick(a,f,g):c.handleClick(a,f,g))},tick:function(){var a=this,b=a.gv,c=b._moveStep;a.point&&b.isWalkable()&&(a._32Q&&(c*=(qd()-a._32Q)/50),b.walk(a.foward?c:-c),a._32Q=qd(),a._31Q=Dh(a.tick,a))},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){var b=this._57I;b&&(Vh(b,Th(a))<=1&&this.gv.sm().cs(),this._57I=i)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b,c,d=this,e=d.gv,f=d._62O,g=d.point,h=e.dm(),i=e.lp(a),j=i.x-g.x,k=i.y-g.y,l=e.getWidth(),m=e.getHeight();if(l&&m){var n=-N*j/l,o=-N*k/m;if("roaming"===f)d.rotate(a,n/2,o/2);else if(f===Yp||f===Zp||f===$p)e._86O||h.beginTransaction(),e.fi({kind:e._86O?"betweenEditRotation":"beginEditRotation",event:a}),e._86O=1,e.sm().each(function(a){if(Kd(a)&&e.isRotationEditable(a)){var b=G(n)>G(o)?n:o;f===Yp?a.setRotationX(a.getRotationX()+b):f===Zp?a.setRotationY(a.getRotationY()+b):f===$p&&a.setRotationZ(a.getRotationZ()+b)}});else if("move"===f||cq[f]){f===_p||f===aq||f===bq?(e._87O||h.beginTransaction(),e.fi({kind:e._87O?"betweenEditScale":"beginEditScale",event:a}),e._87O=1):(e._moving||h.beginTransaction(),e.fi({kind:e._moving?"betweenMove":"beginMove",event:a}),e._moving=1);var p,q=d.p3,r=e.getPositionInfo(q),s=dn(e);p=f===Vp?"x":f===Wp?"y":f===Xp?"z":f===_p?"sx":f===aq?"sy":f===bq?"sz":e.getMoveMode(a,d.movedata),j=j/l*r.width,k=-1*k/m*r.height;var t,u,v=[s[0]*j,s[4]*j,s[8]*j],w=[s[1]*k,s[5]*k,s[9]*k],x=v[0]+w[0],y=v[1]+w[1],z=v[2]+w[2],A=[q[0]+x,q[1]+y,q[2]+z],B=qi(e.getEye(),A,!0);if("xyz"===p?(t=A,e.moveSelection(x,y,z)):"xz"===p?(t=Qm(e,q,[0,1,0],A),t&&e.moveSelection(t[0]-q[0],0,t[2]-q[2])):"xy"===p?(t=Qm(e,q,[0,0,1],A),t&&e.moveSelection(t[0]-q[0],t[1]-q[1],0)):"yz"===p?(t=Qm(e,q,[1,0,0],A),t&&e.moveSelection(0,t[1]-q[1],t[2]-q[2])):"x"===p||"sx"===p?(B[0]=0,t=Qm(e,q,B,A),t&&(u=t[0]-q[0],"x"===p?e.moveSelection(u,0,0):e.sm().each(function(d){Kd(d)&&e.isSizeEditable(d)&&(b=d.getScaleX()+u/100,c=b/d.getScaleX(),d.setScaleX(b),Rh(a)&&(d.setScaleY(d.getScaleY()*c),d.setScaleTall(d.getScaleTall()*c)))}))):"y"===p||"sy"===p?(B[1]=0,t=Qm(e,q,B,A),t&&(u=t[1]-q[1],"y"===p?e.moveSelection(0,u,0):e.sm().each(function(d){Kd(d)&&e.isSizeEditable(d)&&(b=d.getScaleTall()+u/100,c=b/d.getScaleTall(),d.setScaleTall(b),Rh(a)&&(d.setScaleY(d.getScaleY()*c),d.setScaleX(d.getScaleX()*c)))}))):("z"===p||"sz"===p)&&(B[2]=0,t=Qm(e,q,B,A),t&&(u=t[2]-q[2],"z"===p?e.moveSelection(0,0,u):e.sm().each(function(d){Kd(d)&&e.isSizeEditable(d)&&(b=d.getScaleY()+u/100,c=b/d.getScaleY(),d.setScaleY(b),Rh(a)&&(d.setScaleX(d.getScaleX()*c),d.setScaleTall(d.getScaleTall()*c)))}))),!t)return;d.p3=t}else if(f===ob){var C=d.div;C||(C=d.div=qe(),ve(d.getView(),C),C.op=g,C.style.background=e.getRectSelectBackground()),e.fi({kind:e._rectSelecting?"betweenRectSelect":"beginRectSelect",event:a}),e._rectSelecting=1,C.rect=Wh(C.op,i),Le(C,C.rect)}else if("pinch"===f&&2===Ph(a)){e.fi({kind:e._pinching?"betweenPinch":"beginPinch",event:a}),e._pinching=1;var u=Tf(a);e.handlePinch(u,d.dist),d.dist=u}else"pan"===f||Rh(a)||Oh(a)?d.pan(a,j,k):"none"===f||e.isFirstPersonMode()||d.rotate(a,n,o);d.point=i}},pan:function(a,b,c){var d=this.gv;if(d.isPannable()){var e=d.getWidth(),f=d.getHeight();if(!e||!f)return;var g=d.getCenterInfo(),h=b/e*g.width,i=-1*c/f*g.height;d.fi({kind:d._panning?"betweenPan":"beginPan",event:a}),d._panning=1,d.pan(-h,-i)}},rotate:function(a,b,c){var d=this.gv;d.isRotatable()&&(d.fi({kind:d._rotating?"betweenRotate":"beginRotate",event:a}),d._rotating=1,d.rotate(b,c))},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b.gv,d=c.dm(),e=b.div;if(e){var f=c.getDatasInRect(e.rect);if(!f.isEmpty()){var g=c.sm(),h=g.toSelection();f.each(function(a){g.co(a)?h.remove(a):h.add(a)}),g.ss(h)}fi(e)}c._moving&&(delete c._moving,c.fi({kind:"endMove",event:a}),c.onMoveEnded(),d.endTransaction()),c._panning&&(delete c._panning,c.fi({kind:"endPan",event:a}),c.onPanEnded()),c._rotating&&(delete c._rotating,c.fi({kind:"endRotate",event:a}),c.onRotateEnded()),c._86O&&(delete c._86O,c.fi({kind:"endEditRotation",event:a}),d.endTransaction()),c._87O&&(delete c._87O,c.fi({kind:"endEditScale",event:a}),d.endTransaction()),c._pinching&&(delete c._pinching,c.fi({kind:"endPinch",event:a}),c.onPinchEnded()),c._rectSelecting&&(delete c._rectSelecting,c.fi({kind:"endRectSelect",event:a}),c.onRectSelectEnded()),c._walking&&(delete c._walking,c.fi({kind:"endWalk",event:a}),c.onWalkEnded()),b.dist=b.point=b._62O=b.p3=b.movedata=b.div=b._57I=b._32Q=b._31Q=b.foward=i}});var Op=Tn.MapInteractor=function(a){Wd(Op,this,[a]),this._minPhi=0,this._maxPhi=5*M/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Un("MapInteractor",Mp,{handle_contextmenu:function(a){wh(a)},handle_mousewheel:function(a){this.gv.handleScroll(a,a.wheelDelta/40)},handle_DOMMouseScroll:function(a){2===a.axis&&this.gv.handleScroll(a,-a.detail)},handle_keydown:function(a){this.gv.handleKeyDown(a)},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){wh(a);var b=this,c=b.gv;if(c.setFocus(a)){var d=(c.lp(a),c.getDataInfoAt(a)),e=d?d.data:i,f=d?d.part:i;if(!e||!c._39Q(e)){var g=b.editing={point:c.lp(a)};ia?g.touch=!0:(g.touch=!1,g.clickLeft=Nh(a),Oh(a)?g.pan=!0:g.pan="left"===this.panButton===g.clickLeft),ei(b,a)}Qh(a)?c.handleDoubleClick(a,e,f):c.handleClick(a,e,f);
}},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.gv,d=b.editing;if(d){var e=c.lp(a),f=d.point,g=e.x-f.x,h=e.y-f.y;if(!d.moved){if(Math.abs(g)<b.threshold&&Math.abs(h)<b.threshold&&!(a.touches&&a.touches.length>1))return;d.moved=!0}if(d.point=e,d.touch){var j=a.touches.length;if(2!==j)b.pan(a,g,h);else{if(1>=j)return;var k=a.touches,l={x:k[0].clientX,y:k[0].clientY},m={x:k[1].clientX,y:k[1].clientY},n={x:m.x-l.x,y:m.y-l.y},o=d.lastCenter,p=Math.atan2(n.y,n.x),q=d.theta,r=0;q==i?q=d.theta=p:(r=p-q,d.thetaStarted||Math.abs(r)>b.touchRotateThreshold?(d.thetaStarted=!0,d.theta=p):r=0);var s=M*(l.y+m.y)/2/c.getHeight(),t=d.phi,u=0;t==i?t=d.phi=s:(u=s-t,d.phiStarted||Math.abs(u)>b.touchRotateThreshold?(d.phiStarted=!0,d.phi=s):u=0);var v,w=Math.sqrt(n.x*n.x+n.y*n.y),x=d.vlen;if(x){var y=l.x-o.x,z=l.y-o.y,A=m.x-o.x,B=m.y-o.y,C=Math.sqrt(y*y+z*z),D=Math.sqrt(A*A+B*B),E=x/2,F=b._sign2(C-E),G=b._sign2(D-E);0>F*G||0===F&&0===G?(v=1,d.vlen=w):(v||(v=w/x),d.scaleStarted||Math.abs(v-1)>b.touchScaleThreshold?(d.vlen=w,d.scaleStarted=!0):v=1)}else x=d.vlen=w,v=1;1!==v&&c.setZoom(v),(u||r)&&b.rotate(a,r,-u),d.lastCenter={x:(m.x+l.x)/2,y:(m.y+l.y)/2}}}else if(d.pan)b.pan(a,g,h);else{var H=c.getWidth(),I=c.getHeight();if(!H||!I)return;var J=-N*g/H,K=-N*h/I;b.rotate(a,J,K)}}},_sign2:function(a){return Math.abs(a)<this._touchScaleCheckAccuracy?0:a>0?1:-1},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b.editing;if(b.editing=null,c){var d=b.gv;if(!c.moved&&c.clickLeft){var e=d.getDataAt(a);e?d.sm().setSelection([e]):d.sm().clearSelection()}else d._panning=null,d._rotating=null,d.fi({kind:c.pan?"endPan":"endRotate",event:a})}},pan:function(a,b,c){var d=this,e=d.gv;if(e.isPannable()){var f=e.getWidth(),g=e.getHeight();if(f&&g){var h=e.getCenterInfo(),j=-b/f*h.width,k=1*c/g*h.height;e.fi({kind:e._panning?"betweenPan":"beginPan",event:a}),e._panning=1;var l=d.keepHorizon,m=d.editing.touch;if((m&&a.touches&&a.touches.length>1||!m&&Rh(a))&&(l=!l),!l)return e.pan(j,k);if(j||k){var n=dn(e),o=[n[0]*j,n[4]*j,n[8]*j],p=[n[1],0,n[9]],q=Math.sqrt(p[0]*p[0]+p[2]*p[2]);q&&(p=[p[0]/q*k,0,p[2]/q*k]);var r=o[0]+p[0],s=o[1]+p[1],t=o[2]+p[2],u=e._center,v=e._eye;u[0]+=r,u[1]+=s,u[2]+=t,v[0]+=r,v[1]+=s,v[2]+=t,e.fp(ta,i,v),e.fp(sa,i,u)}}}},rotate:function(a,b,c){var d=this,e=d.gv;if(e.isRotatable()){var f=e._center,g=e._eye,h=qi(g,f),i=Q(D(h[0]*h[0]+h[2]*h[2]),h[1]),j=i+c;j=Math.max(d.minPhi,Math.min(d.maxPhi,j)),c=j-i,e.fi({kind:e._rotating?"betweenRotate":"beginRotate",event:a}),e._rotating=1,e.rotate(b,c)}}}),b.defineProperties(Op.prototype,{panButton:{get:function(){return this._panButton},set:function(a){this._panButton=a}},minPhi:{get:function(){return this._minPhi},set:function(a){this._minPhi=a}},maxPhi:{get:function(){return this._maxPhi},set:function(a){this._maxPhi=a}},keepHorizon:{get:function(){return this._keepHorizon},set:function(a){this._keepHorizon=a}},threshold:{get:function(){return this._threshold},set:function(a){this._threshold=a}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(a){this._touchScaleThreshold=a}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(a){this._touchRotateThreshold=a}}});var Pp=function(a){this.gv=a};ki(Pp,b,{_iv:!0,iv:function(){this._iv=!0},face:function(a,b){var c=this,d=c.gv.getGL();if(!d||!Kd(a))return i;var e=b.x,f=b.width,g=b.height,h=c.height-b.y-g,j=B(f/2),k=new Uint8Array(f*g*4),l=0;for(c.iv(),c.validate(a),zm(d,c.frame),d.readPixels(e,h,f,g,d.RGBA,d.UNSIGNED_BYTE,k),Am(d),c.iv();j>=l;l++)for(var m=j-l,n=j+l,o=m;n>=o;o++)for(var p=m;n>=p;p++)if(o===m||o===n||p===m||p===n){var q=Em.m[k[4*(o*f+p)]];if(q)return q}},get:function(a,b){this.validate();var c=this,d=c.gv.getGL();if(!d)return i;var e,f,g=a.x,h=a.width,j=a.height,k=c.height-a.y-j,l=B(h/2),m=new Uint8Array(h*j*4),n=0,o=m.length,p=b?i:new bj,q=b?i:{};if(zm(d,c.frame),d.readPixels(g,k,h,j,d.RGBA,d.UNSIGNED_BYTE,m),Am(d),b){for(;l>=n;n++)for(var r=l-n,s=l+n,t=r;s>=t;t++)for(var u=r;s>=u;u++)if((t===r||t===s||u===r||u===s)&&(e=c.info(m,4*(t*h+u))))return e}else for(;o>n;n+=4)e=c.info(m,n),e&&(f=e.data,q[f._id]||(p.add(f),q[f._id]=f));return p},info:function(a,b){return this.colorMap[(a[b]<<16)+(a[b+1]<<8)+a[b+2]+((127&a[b+3])<<24)]},validate:function(a){var b=this,c=b.gv,d=c.getGL();if(d){var e=c.getWidth(),f=c.getHeight(),g=d.RGBA,h=d.TEXTURE_2D,j=d.RENDERBUFFER,k=d.FRAMEBUFFER;b.texture||(b.texture=gn(d),b.render=d.createRenderbuffer(),b.frame=d.createFramebuffer()),(b.width!==e||b.height!==f)&&(mn(d,b.texture),d.texImage2D(h,0,g,e,f,0,g,d.UNSIGNED_BYTE,i),nn(d,d.TEXTURE_MIN_FILTER,d.LINEAR),d.bindRenderbuffer(j,b.render),d.renderbufferStorage(j,d.DEPTH_COMPONENT16,e,f),zm(d,b.frame),d.framebufferTexture2D(k,d.COLOR_ATTACHMENT0,h,b.texture,0),d.framebufferRenderbuffer(k,d.DEPTH_ATTACHMENT,j,b.render),mn(d,i),d.bindRenderbuffer(j,i),Am(d),b.width=e,b.height=f),b._iv&&(b._iv=!1,zm(d,b.frame),c._42(a||(b.colorMap={}),1),Am(d))}}});var Qp=function(a){this.gv=a};ki(Qp,b,{gap:0,size:0,_42:function(a,b){var c=this,d=c.gv,e=d._gridGap,f=d._gridSize;if(d._gridVisible){if(c.gap!==e||c.size!==f){for(var g=[],h=d._gridSize/2,j=e*h,k=0;2*h+1>k;k++){var l=6*k,m=6*(2*h+1)+l;g[l]=-j,g[l+1]=0,g[l+2]=-j+k*e,g[l+3]=j,g[l+4]=0,g[l+5]=-j+k*e,g[m]=-j+k*e,g[m+1]=0,g[m+2]=-j,g[m+3]=-j+k*e,g[m+4]=0,g[m+5]=j}c.vs=new pi(g),c.gap=e,c.size=f}Kn(d),rn(a,b),vn(a),xn(a,b,1,d._gridColor,d._buffer.vs,c.vs),yn(a,0,c.vs.length/3,a.LINES),wn(a),sn(a,b)}else c.vs=c.gap=c.size=i}});var Rp=function(a){this.gv=a};ki(Rp,b,{_42:function(a,b){var c=this.gv,d=c._buffer.vs,e=c._axisXColor,f=c._axisYColor,g=c._axisZColor,h=c._originAxisVisible,j=c._centerAxisVisible;if(h||j){var k=da?a.TRIANGLES:a.TRIANGLE_FAN,l=a.LINES;if(Kn(c),rn(a,b),vn(a),h){var m=c.getCenterInfo(),n=F(m.width,m.height)/5,o=.8*n,p=.05*n;xn(a,b,1.5,e,d,new pi([0,0,0,n,0,0,o,p,0,o,0,p,o,-p,0,o,0,-p,o,p,0,0,0,0,0,n,0,p,o,0,0,o,p,-p,o,0,0,o,-p,p,o,0,0,0,0,0,0,n,p,0,o,0,p,o,-p,0,o,0,-p,o,p,0,o])),yn(a,0,2,l),yn(a,1,6,k),xn(a,b,i,f),yn(a,7,2,l),yn(a,8,6,k),xn(a,b,i,g),yn(a,14,2,l),yn(a,15,6,k)}if(j){var q=c._center,r=q[0],s=q[1],t=q[2],m=c.getPositionInfo(q);n=F(m.width,m.height)/20,xn(a,b,1.5,e,d,new pi([r,s,t,r+n,s,t,r,s,t,r,s+n,t,r,s,t,r,s,t+n])),yn(a,0,2,l),xn(a,b,i,f),yn(a,2,2,l),xn(a,b,i,g),yn(a,4,2,l)}wn(a),sn(a,b)}}});var Sp=function(a){this.gv=a,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Sp.Mode.Disable};Sp.Mode={Disable:0,Selection:1,MouseOver:2},ki(Sp,b,{onMouseOver:function(a){l.preventDefault(a);var b=this.gv.getDataAt(a);b!==this.mouseOverData&&(this.mouseOverData=b,this.gv.iv())},setFetchTargetFunc:function(a){this.fetchTargetFunc=a},_42:function(a,b){var c,d=this,e=d._mode;if(e!==Sp.Mode.Disable&&(e===Sp.Mode.Selection?c=d.gv.sm().getSelection().toArray(function(a){return a.s("highlight.visible")}):e===Sp.Mode.MouseOver&&d.mouseOverData&&d.mouseOverData.s("highlight.visible")&&(c=[d.mouseOverData]),d.fetchTargetFunc&&(c=d.fetchTargetFunc(c)),c&&c.length)){var f=d.gv,g=f.vr.isPresenting(),h=f.getWidth();if(g){var i=f.getWidth;h/=2,f.getWidth=function(){return h};var j=f.getViewport()}var k,l=f.getDevicePixelRatio(),n=h*l,o=f.getHeight()*l;(k=d._renderTarget)?k.setSize(a,n,o):d._renderTarget=k=new Tn.RenderTarget(f,a,n,o),zm(a,k.frame),f.drawFilter=function(a){return c.indexOf(a)<0?!0:void 0},f._42({}),f.drawFilter=null,Am(a),g&&(f.getWidth=i,f.setViewport(a,j[0],j[1],j[2],j[3]));var p=a._compiledShader.highlight;if(p||(p=a._compiledShader.highlight=new jp.Shader(a,Tp.vs,Tp.fs)),p.bind(),a.enable(a.BLEND),a.activeTexture(a.TEXTURE0+0),a.bindTexture(a.TEXTURE_2D,k.texture),p.uniforms.image=0,p.uniforms.textureSize=[n,o],p.uniforms.edgeWidth=m["highlight.width"],d.highlightColor!==m["highlight.color"]){var q=qf(d.highlightColor=m["highlight.color"]);d.highlightColorData=[q[0]/255,q[1]/255,q[2]/255,q[3]/255]}p.uniforms.edgeColor=d.highlightColorData,d.ibuffer?(d.ibuffer.upload(),d.vbuffer.upload()):(d.ibuffer=jp.Buffer.createIndexBuffer(a,new Uint16Array([0,2,1,1,2,3])),d.vbuffer=jp.Buffer.createVertexBuffer(a,new Float32Array([0,0,1,0,0,1,1,1]))),p.attributes.pos.pointer(d.vbuffer),a.drawElements(a.TRIANGLES,6,a.UNSIGNED_SHORT,0),a.disable(a.BLEND),a.bindTexture(a.TEXTURE_2D,null),a.useProgram(b)}}}),b.defineProperties(Sp.prototype,{mode:{get:function(){return this._mode},set:function(a){var b=this._mode;a!==b&&(this._mode=a,a===Sp.Mode.MouseOver?x(this.gv.getView(),"mousemove",this.onMouseOver):b===Sp.Mode.MouseOver&&y(this.gv.getView(),"mousemove",this.onMouseOver))}}});var Tp={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Up=function(a){this.gv=a},Vp="edit_tx",Wp="edit_ty",Xp="edit_tz",Yp="edit_rx",Zp="edit_ry",$p="edit_rz",_p="edit_sx",aq="edit_sy",bq="edit_sz",cq={};cq[Vp]=1,cq[Wp]=1,cq[Xp]=1,cq[Yp]=1,cq[Zp]=1,cq[$p]=1,cq[_p]=1,cq[aq]=1,cq[bq]=1,ki(Up,b,{_42:function(a,b,c){var d=this,e=d.gv,f=e.sm().ld();if(f&&e.isEditable(f)&&!e.isEditHelperDisabled()&&Kd(f)&&(!e.isFirstPersonMode()||!e.isMouseRoamable()&&!ia)){Kn(e);var g,h,i=e.isMovable(f),j=e.isRotationEditable(f),k=e.isSizeEditable(f),l=e._axisXColor,m=e._axisYColor,n=e._axisZColor,o=e._editSizeColor,p=f.p3(),q=Vh(e.getEye(),p)/10,r=q/(c?5:10),s=.7*q,t=.4*s,u=p[0],v=p[1],w=p[2];g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],i&&d._17O(a,b,f,c,Vp,l,g,[u,v-r,w,u+s,v-r,w,u+s,v,w,u+s,v,w,u,v,w,u,v-r,w,u,v-r,w+r,u+s,v-r,w+r,u+s,v-r,w,u+s,v-r,w,u,v-r,w,u,v-r,w+r]),h=u+s,k&&d._17O(a,b,f,c,_p,o,g,[h,v-r,w,h+t,v-r,w,h+t,v,w,h+t,v,w,h,v,w,h,v-r,w,h,v-r,w+r,h+t,v-r,w+r,h+t,v-r,w,h+t,v-r,w,h,v-r,w,h,v-r,w+r]),h+=t,j&&d._17O(a,b,f,c,Yp,l,g,[h,v-r,w,h+t,v-r,w,h+t,v,w,h+t,v,w,h,v,w,h,v-r,w,h,v-r,w+r,h+t,v-r,w+r,h+t,v-r,w,h+t,v-r,w,h,v-r,w,h,v-r,w+r]),g=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],i&&d._17O(a,b,f,c,Wp,m,g,[u,v,w,u,v+s,w,u-r,v+s,w,u-r,v+s,w,u-r,v,w,u,v,w,u,v,w,u,v,w-r,u,v+s,w-r,u,v+s,w-r,u,v+s,w,u,v,w]),h=v+s,k&&d._17O(a,b,f,c,aq,o,g,[u,h,w,u,h+t,w,u-r,h+t,w,u-r,h+t,w,u-r,h,w,u,h,w,u,h,w,u,h,w-r,u,h+t,w-r,u,h+t,w-r,u,h+t,w,u,h,w]),h+=t,j&&d._17O(a,b,f,c,Zp,m,g,[u,h,w,u,h+t,w,u-r,h+t,w,u-r,h+t,w,u-r,h,w,u,h,w,u,h,w,u,h,w-r,u,h+t,w-r,u,h+t,w-r,u,h+t,w,u,h,w]),g=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],i&&d._17O(a,b,f,c,Xp,n,g,[u,v,w,u,v,w+s,u,v-r,w+s,u,v-r,w+s,u,v-r,w,u,v,w,u,v-r,w,u-r,v-r,w,u-r,v-r,w+s,u-r,v-r,w+s,u,v-r,w+s,u,v-r,w]),h=w+s,k&&d._17O(a,b,f,c,bq,o,g,[u,v,h,u,v,h+t,u,v-r,h+t,u,v-r,h+t,u,v-r,h,u,v,h,u,v-r,h,u-r,v-r,h,u-r,v-r,h+t,u-r,v-r,h+t,u,v-r,h+t,u,v-r,h]),h+=t,j&&d._17O(a,b,f,c,$p,n,g,[u,v,h,u,v,h+t,u,v-r,h+t,u,v-r,h+t,u,v-r,h,u,v,h,u,v-r,h,u-r,v-r,h,u-r,v-r,h+t,u-r,v-r,h+t,u,v-r,h+t,u,v-r,h])}},_17O:function(a,b,c,d,e,f,g,h){var j=this.gv._buffer;Ln(a,b,d,!0,c,e),tn(a,b,i,!0,i,!0,i,!1),Fn(a,b.uDiffuse,f),An(a,j.vs,new pi(h),b.aPosition),An(a,j.ns,new pi(g),b.aNormal),vn(a),yn(a,0,12),wn(a),un(a,b)}});var dq=j.Raycaster=function(a){this.gv=a,this.maxTriangleTest=1/0,this.backfaceCulling=!0};li("Raycaster",b,{intersect:function(a){var b=this,c=b.gv,d=c.getDataAt(a);return d?b.intersectObject(a,d):null},intersectObjects:function(a,b,c){var d,e,f,g,h=this,i=1/0,j=a.origin||(new Kg).fromArray(h.gv.getEye()),k=h.maxTriangleTest,l=[];return b.forEach(function(a){c&&c(a)===!1||a.s("intersect")!==!1&&l.push(a)}),l.sort(function(a,b){return j.distanceToSquared2(a.p3())-j.distanceToSquared2(b.p3())}),h.countTriangles=0,l.forEach(function(b){h.countTriangles>k||(d=h.intersectObject(a,b),d&&(e=j.distanceToSquared(d.world),i>e&&(f=b,g=d,i=e)))}),h.countTriangles=0,{data:f,intersect:g}},intersectObject:function(a,b){if(a instanceof Ng)return this._intersectObjectImpl(a,b);var c=this,d=c.gv,e=d.unproject(a),f=new Kg,g=d.getEye(),h=new Kg;if(d.isOrtho()){var i=new Kg(g);h.copy(d.getCenter()).sub(i).normalize();var k=f.copy(e).sub(i).dot(h);f.copy(h).setLength(-k).add(i.copy(e))}else f.copy(g),h.copy(e).sub(f).normalize();var l=new j.Math.Ray(f,h);return c._intersectObjectImpl(l,b)},_intersectObjectImpl:function(a,b){function c(){var a=new Kg;return a.subVectors(p,o),t.subVectors(n,o),a.cross(t).normalize(),a}function d(a,b,c,d,e,f,g){return Sg.barycoordFromPoint(a,b,c,d,v),e.multiplyScalar(v.x),f.multiplyScalar(v.y),g.multiplyScalar(v.z),e.add(f).add(g),e.clone()}var e=new Rg,f=new Rg,g=new Ng,h=new Kg,i=new Kg,k=new Kg,l=new Kg,m=new Kg,n=new Kg,o=new Kg,p=new Kg,q=new Lg,r=new Lg,s=new Lg,t=new Kg,u={vs:Fo,is:Go,uv:Ho},v=new Kg;return function(a,b){var t=this.gv.getData3dUI(b),v=b.mat||t.mat;if(v){e.fromArray(v),f.getInverse(e),g.copy(a).applyMatrix4(f);var w,x,y="body",z=t.shapeModel;if(z||(z=bp(t)),z||(b instanceof j.Node&&!(b instanceof j.Shape)?(w=!0,z=u):(x=!0,z=[t.left,t.front,t.right,t.back,t.top,t.bottom])),!z)return console.log("Can not find shape model."),null;Hd(z)||(z=[z]);var A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q=1/0,R=["","top_","bottom_"],S=!1,T=this.backfaceCulling;for(A=0,B=z.length;B>A;A++)if(M=z[A])for(C=0,D=R.length;D>C;C++)if(N=R[C],G=M[N+"vs"],H=M[N+"is"],I=M[N+"uv"]||M[N+"tuv"],G){if(O=M[N+"boundingBox"]){var K=g.intersectBox(O);if(!K)continue;if(g.origin.distanceTo(K)>Q)continue;P=!1}else M[N+"boundingBox"]=O=new j.Math.Box3,P=!0;for(E=0,F=H?H.length:G.length/3;F>E;E+=3)this.countTriangles++,H?(i.fromArray(G,3*H[E]),k.fromArray(G,3*H[E+1]),l.fromArray(G,3*H[E+2])):(i.fromArray(G,3*E),k.fromArray(G,3*(E+1)),l.fromArray(G,3*(E+2))),P&&(O.expandByPoint(i),O.expandByPoint(k),O.expandByPoint(l)),J=g.intersectTriangle(i,k,l,T,h),J&&(L=g.origin.distanceTo(J),Q>L&&(Q=L,m.copy(J),n.copy(i),o.copy(k),p.copy(l),""!==N?y=N.slice(0,-1):w?y=Jo[Math.floor(E/6)]:x&&(y=Jo[A]),I&&(S=!0,H?(q.fromArray(I,2*H[E]),r.fromArray(I,2*H[E+1]),s.fromArray(I,2*H[E+2])):(q.fromArray(I,2*E),r.fromArray(I,2*(E+1)),s.fromArray(I,2*(E+2))))))}if(!isFinite(Q))return null;var U,V=m.clone().applyMatrix4(e);S&&(U=d(m,n,o,p,q,r,s));var W=c(n,o,p),X=c(n.applyMatrix4(e),o.applyMatrix4(e),p.applyMatrix4(e)),Y=g.direction.dot(W);return Y>0&&(W.multiplyScalar(-1),X.multiplyScalar(-1)),{world:V,local:m.clone(),worldNormal:X,normal:W,uv:U,part:y}}}}()});var eq=function(a,b){this.gv=a,this.s=function(c,d,e){return d==i&&(d=e),d==i?b.getStyle(c):_i(d,b,a)},this.data=b};ki(eq,b,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(a,b,c,d){var e=this,f=e.data;if(!(f instanceof $k)){var g,h,j,k,l,m,n,o=e.gv,p=f._id,q=e.s("shape3d.alwaysOnTop")?null:e.s("batch"),r=o._batchIndexMap,s=o._batchModelMap,t=o.isSelectable(f),u=o.getBrightness(f),v=u!=i&&1!==u;if(e.needValidate(a)){if(j=ho(r,s,f,q),e.validate(j,q?Sc[q]||cd:i),j&&(k=r[p],l=k.size=j.vs.length/3-k.begin,n=j.rs))for(u=v?u:1,m=0;l>m;m++)n.push(u);if(Kd(f)){var w=o.getWireframeGeometry(f);if(w)jo(o,f,w);else{var x=o.getWireframe(f);x&&jo(o,f,x)}}e.labelInfo=e.label2Info=e.noteInfo=e.note2Info=e._38o=i,e._24O(Xa,"getLabel"),e._24O(Ya,"getLabel2"),e._26O(Za,"getNote"),e._26O($a,"getNote2"),e._15O(),e.interactiveInfo=o.isInteractive(f)?{}:i,e._iv=!1}v&&Fn(a,b.uBrightness,u),Fn(a,b.uAlphaTest,e.s("alphaTest")),Fn(a,b.uUseEnvMap,f.s("envmap")?!0:!1),Fn(a,b.uReflectivity,f.s("envmap")||.01),h=Ln(a,b,c,t,f,Wa),h&&(lo(h,r[p],s),lo(h,o._polylineIndexMap[p],o._polylineModelMap),lo(h,o._wireframeIndexMap[p],o._wireframeModelMap)),r[p]||e._80o(a,b,d),o.isLabelVisible(f)&&((g=e.labelInfo)&&(Ln(a,b,c,t,f,Xa),e._28O(g,Xa,d)),(g=e.label2Info)&&(Ln(a,b,c,t,f,Ya),e._28O(g,Ya,d))),o.isNoteVisible(f)&&((g=e.noteInfo)&&(Ln(a,b,c,t,f,Za),e._29O(g,Za,d)),(g=e.note2Info)&&(Ln(a,b,c,t,f,$a),e._29O(g,$a,d))),(g=e._38o)&&e._99O(a,b,g,c,t,d),v&&Fn(a,b.uBrightness,1)}},needValidate:function(a){return this._iv},validate:function(a,b){},_16O:function(a,b,c,d,e,f,g,h,i){return ui},_80o:function(a,b,c){},dispose:function(){},_calcAnchorMat:function(a){if(a.hasOwnProperty("_anchor")||a.hasOwnProperty("_anchorElevation")){var b=a.getAnchor3d(),c={x:b.x-.5,y:b.y-.5,z:b.z-.5},d=ti();return Wm(d,[-c.x,-c.y,-c.z]),d}},getBodyColor:function(a){var b=this.data,c=this.gv.getBodyColor(b);return c?c:a?b.getStyle(a):i},_24O:function(a,b){var c=this,d=c.data,e=c.gv,f=c.s,g=e[b](d);if(g!=i){var h=f(a+".scale"),j=f(a+".max"),k=c[a+"Info"]={label:g,textureScale:f(a+".texture.scale"),color:e[b+"Color"](d),font:f(a+".font"),align:f(a+".align"),background:e[b+"Background"](d)},l=k.rect=we(k,g);j>0&&j<l.width&&(k.labelWidth=l.width,l.width=j),l.x=l.y=0,l.width*=h,l.height*=h,k.mat=c._16O(f(a+".autorotate"),f(a+".position"),l,f(a+".face"),f(a+".t3"),f(a+".r3"),f(a+".rotationMode"));var m=l.width/2,n=l.height/2;k.vs=new pi([-m,n,0,-m,-n,0,m,-n,0,m,n,0]),l.width/=h,l.height/=h}},_26O:function(a,b){var c=this,d=c.data,e=c.gv,f=c.s,g=e[b](d);if(g!=i){var h=f(a+".scale"),j=this[a+"Info"]={note:g,textureScale:f(a+".texture.scale"),expanded:f(a+".expanded"),font:f(a+".font"),color:f(a+".color"),align:f(a+".align"),borderWidth:f(a+".border.width"),borderColor:f(a+".border.color"),background:e[b+"Background"](d)};if(j.expanded){var k=f(a+".max"),l=we(j,g);l.width+=6,l.height+=2,k>0&&k<l.width&&(j.labelWidth=l.width,l.width=k);var m={x:-l.width/2,y:-8-l.height,width:l.width,height:l.height+8}}else m={x:-6,y:-18,width:12,height:18};j.mat=c._16O(f(a+".autorotate"),f(a+".position"),i,f(a+".face"),f(a+".t3"),f(a+".r3"),f(a+".rotationMode")),j.rect=m,1!==h&&(m=Gh(m),m.x*=h,m.height*=h,m.y=-m.height,m.width*=h);var n=m.x,o=m.y,p=m.width,q=m.height;j.vs=new pi([n,-o,0,n,-o-q,0,n+p,-o-q,0,n+p,-o,0])}},_28O:function(a,b,c){if(c(this.s(b+".transparent"))){var d=a.rect,e=a.textureScale,f=d.width*e,g=d.height*e;if(f>=1&&g>=1){var h=pf(f,g);1!==e&&(h.translate(h,d.x,d.y),h.scale(e,e),h.translate(h,-d.x,-d.y)),Ej(h,a),h.restore(),Pn(this,b,a.mat,a.vs,!0)}}},_29O:function(a,b,c){if(c(this.s(b+".transparent"))){var d=a.rect,e=a.textureScale,f=d.x,g=d.y,h=d.width*e,i=d.height*e;if(h>=1&&i>=1){d.x=d.y=0;var j=pf(h,i);1!==e&&j.scale(e,e),Fj(j,a),j.restore(),d.x=f,d.y=g,Pn(this,b,a.mat,a.vs,!1)}}},_99O:function(a,b,c,d,e,f){if(c){var g=this,h=g.gv,j=g.data,k=h._buffer,l=h._1O,m=c.icons;for(var n in m){var o=m[n],p=c.rects[n];if(p&&f(_i(o.transparent,j,h))){Ln(a,b,d,e,j,n);var q=_i(o.shape3d,j,h),r=q?[q]:_i(o.names,j,h),s=r?r.length:0,t=_i(o.textureScale,j,h)||1,u=_i(o.light,j,h);u==i&&(u=q?!0:!1),tn(a,b,_i(o.blend,j,h),u,_i(o.opacity,j,h),_i(o.reverseFlip,j,h),_i(o.reverseColor,j,h),_i(o.reverseCull,j,h));for(var v=0;s>v;v++){var w=r[v],x=p[v];if(On(g,x.mat),q)$o(h,j,bp(g,q),g);else{var y=yh(w);if(y){var z=x.width*t,A=x.height*t;if(z>=1&&A>=1){var B=pf(z,A);Bh(B,y,_i(o.stretch,j,h),0,0,z,A,j,h),B.restore(),gn(a,nf,l),vn(a,b,l,_i(o.discardSelectable,j,h),k.uv,Co),An(a,k.vs,x.vs,b.aPosition),Bn(a,k.ns,Do,b.aNormal),Dn(a,k.is,Eo),zn(a,0,Eo.length),wn(a,b,l)}}}In(h)}un(a,b)}}}}});var fq=function(a,b){Wd(fq,this,[a,b])};ki(fq,eq,{_16O:function(a,b,c,d,e,f,g,h,i){var j=this.data,k=j.getFinalScale3d(),l=Mn(b,k,c,d,h,i);if(j.hasOwnProperty("_anchor")||j.hasOwnProperty("_anchorElevation")){var m=j.getAnchor3d();l[0]-=(m.x-.5)*k[0],l[1]-=(m.y-.5)*k[1],l[2]-=(m.z-.5)*k[2]}return Nn(ti(),l,j.p3(),d,e,f,g,a,j.getFinalRotation3d(),j.getRotationMode())},clear:function(){var a=this;a.faceMat=a.mat=a.shapeModel=a.left=a.right=a.front=a.back=a.top=a.bottom=a.csg=i},needValidate:function(a){if(this._iv)return this._validateFrameId=a._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var b=a._renderInfo.frame;if(this._validateFrameId!==b)return this._validateFrameId=b,!0}return!1},validate:function(a,b){var c=this,d=c.gv,e=c.data,f=c.shapeName=c.s(Tb),g=bp(c,f);c._updateAutoRotation(),c._updateFixSize2d(),c._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(go(d,e,"_wireframeModelMap","_wireframeIndexMap"),go(d,e,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var h=Ei(e,d.getMat(e),g?c.s("shape3d.scaleable"):!0),i=c._calcAnchorMat(e);if(i&&Ym(h,h,i),e.mat=h,c.clear(),g||!f)if(a){var j=[];g?no(d,e,g,c,c.getBodyColor(),[h],a,j):(ro(d,e,a,b,h,oa,j,Zn),ro(d,e,a,b,h,pa,j,$n),ro(d,e,a,b,h,qa,j,_n),ro(d,e,a,b,h,ra,j,ao),ro(d,e,a,b,h,ma,j,bo),ro(d,e,a,b,h,na,j,co)),j.length&&(Rd(a.vs,j),Rd(a.ns,fn(j)))}else c.mat=h,(c.shapeModel=g)||(c._cubeUvs=null,c.vf(oa,0),c.vf(pa,16),c.vf(ma,8),c.vf(na,24),c.vf(qa,32),c.vf(ra,40))},_updateAutoRotation:function(){var a=new Tg,b=new Rg,c=new Kg,d=new Kg,e=new Kg;return function(){var f=this,g=f.data,h=f.s("shape3d.autorotate");if(!h)return void(g._dynamicRotation&&delete g._dynamicRotation);var i=f.gv;e.copy(f.s("shape3d.autorotate.up")||i._up);var j;j="string"==typeof h?[h.indexOf("x")<0?i._eye[0]:i._center[0],h.indexOf("y")<0?i._eye[1]:i._center[1],h.indexOf("z")<0?i._eye[2]:i._center[2]]:i._eye;var k=i._center,l=g.p3();c.copy(l),d.set(j[0]-k[0],j[1]-k[1],j[2]-k[2]).add(c),b.lookAt(d,c,e),a.set(0,0,0,g.getRotationMode(),!0).setFromRotationMatrix(b);var m=g._dynamicRotation;m&&Math.abs(m[0]-a.x)<1e-5&&Math.abs(m[1]-a.y)<1e-5&&Math.abs(m[2]-a.z)<1e-5||(g._dynamicRotation=[a.x,a.y,a.z])}}(),_updateFixSize2d:function(){var a=this,b=a.data,c=a.s("shape3d.fixSizeOnScreen");if(!c)return void(b._dynamicScale3d&&delete b._dynamicScale3d);var d=a.gv,e=Ei(b,d.getMat(b)),f=yi([0,0,0],e),g=d.toViewPosition(f);if(!isNaN(g.x)&&!isNaN(g.y)){var h=yi([1,0,0],e),i=d.toViewPosition(h),j=yi([0,1,0],e),k=d.toViewPosition(j),l=i.x-g.x,m=k.y-g.y;if(l&&m){var n,o,p=b._dynamicScale3d||[1,1,1],q=yh(b.s("shape3d.image"));if(c[0]>0&&(n=c[0]),c[1]>0&&(o=c[1]),!n||!o){var r=c>0?c:1;n||(n=q?Zi(q,b)*r:20),o||(o=q?$i(q,b)*r:20)}var s=Math.abs(l/n),t=Math.abs(m/o);Math.abs(s-1)<.001&&Math.abs(t-1)<.001||(b._dynamicScale3d=[p[0]/s,p[1]/t,p[2]])}}},_updateOverlapping:function(){var a=this,b=a.s("hide.overlapping.group");if(!b)return void(a._rectOverlapping&&(a._rectOverlapping=c));var d,e,f,g=a.gv,h=a.data,i=Ei(h,g.getMat(h)),j=1/0,k=1/0,l=-(1/0),m=-(1/0),n=h.getAnchor3d(),o=n.x,p=n.y,q=n.z;for(d=0;8>d;d++){if(e=yi([(d>>2)-o,(d>>1&1)-p,(1&d)-q],i),f=g.toViewPosition(e),isNaN(f.x)||isNaN(f.y))return;j=Math.min(j,f.x),l=Math.max(l,f.x),k=Math.min(k,f.y),m=Math.max(m,f.y)}var r={x:j,y:k,w:l-j,h:m-k};a._rectOverlapping=g.overlappingBox.isOverlapping(b,r)},getVectorDynamicSize:function(){var a,b=this,c=b.s("shape3d"),d=b.data;if("billboard"===c||"plane"===c||(a=d._currentCubeElementId)!=i){var e,f,g=b.gv,h=Ei(d,g.getMat(d)),j=d.getAnchor3d(),k=.5-j.x,l=.5-j.y,m=.5-j.z,n=b.s("shape3d.vector.dynamic.maxsize"),o=function(a,b){a[0]+=k,a[1]+=l,a[2]+=m,b[0]+=k,b[1]+=l,b[2]+=m;var c=g.toViewPosition(yi(a,h)),d=g.toViewPosition(yi(b,h)),e=c.x-d.x,f=c.y-d.y;return Math.min(n,Math.sqrt(e*e+f*f))};if("billboard"===c)e=o([-.5,0,0],[.5,0,0]),f=o([0,-.5,0],[0,.5,0]);else if("plane"===c)e=o([-.5,0,0],[.5,0,0]),f=o([0,0,-.5],[0,0,.5]);else if(d._currentCubeElementId!=i){var p=3*Go[a+1],q=3*Go[a],r=3*Go[a+2];e=o([Fo[p],Fo[p+1],Fo[p+2]],[Fo[r],Fo[r+1],Fo[r+2]]),f=o([Fo[p],Fo[p+1],Fo[p+2]],[Fo[q],Fo[q+1],Fo[q+2]])}return[e,f]}},getCachedTexture:function(){var a=this,b=a.data,c=b._currentCubeElementId;return c!=i?a._cubeCachedImage?a._cubeCachedImage[c]:null:a._shape3dCachedImage},setCachedTexture:function(a){var b=this,c=b.data,d=c._currentCubeElementId;d!=i?(b._cubeCachedImage||(b._cubeCachedImage={}),b._cubeCachedImage[d]=a):b._shape3dCachedImage=a},invalidateCachedTexture:function(a){var b,c,d,e=this;if((d=e._shape3dCachedImage)&&(a.deleteTexture(d),e._shape3dCachedImage=null),c=e._cubeCachedImage){for(b in c)a.deleteTexture(c[b]);e._cubeCachedImage=null}},vf:function(a,b){var c=this;if(c.gv.getFaceVisible(c.data,a)){var d=Qn(c,a);d.mat&&(c.faceMat=!0);var e=d.uv;if(e){var f=c._cubeUvs;f||(f=c._cubeUvs=new pi([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var g=0;8>g;g++)f[b+g]=e[g]}return d}},_billboardInView:function(){var a=[-.5,-.5,0,-.5,.5,0,.5,-.5,0,.5,.5,0],b=[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,.5],c=new Og,d=new Kg,e=new Rg;return function(f){var g=this;if(!g.mat)return!0;var h=g.gv.getFrustum(),i="billboard"===f?a:b;c.makeEmpty(),e.fromArray(g.mat);for(var j=0,k=i.length;k>j;j+=3)c.expandByPoint(d.fromArray(i,j).applyMatrix4(e));return h.intersectsBox(c)}}(),_80o:function(a,b,c){var d=this;if(d._rectOverlapping)return!0;var e=d.shapeModel;if(e||!d.shapeName){var f=d.s("shape3d");if(("billboard"===f||"plane"===f)&&!d._billboardInView(f))return!0;var g=d.gv,h=d.data,j=g._cube;Kn(g,d.mat),d.s("shape3d.reflector")&&!a._picking||(e?$o(g,h,e,d,d.getBodyColor(),c):(An(a,j.vs,i,b.aPosition),An(a,j.ns,i,b.aNormal),Cn(a,j.is),d._18O(a,b,d.left,0,c),d._18O(a,b,d.front,6,c),d._18O(a,b,d.right,12,c),d._18O(a,b,d.back,18,c),d._18O(a,b,d.top,24,c),d._18O(a,b,d.bottom,30,c))),In(g),d.faceMat&&(d._18O(a,b,d.left,0,c,!0),d._18O(a,b,d.front,6,c,!0),d._18O(a,b,d.right,12,c,!0),d._18O(a,b,d.back,18,c,!0),d._18O(a,b,d.top,24,c,!0),d._18O(a,b,d.bottom,30,c,!0))}},_18O:function(a,b,c,d,e,f){if(c){if(!e(c.transparent))return;if(f&&!c.mat||!f&&c.mat)return;var g=this.data.s("polygonOffset");g&&on(a,g),f&&Kn(this.gv,c.mat);var h=this,j=h.data;j._currentCubeElementId=d;var k=h.gv,l=k.getTexture(c.texture,j),n=c.uv,o=c.uvScale,p=c.uvOffset,q=c.discardSelectable;l?n?vn(a,b,l,q,k._buffer.uv,h._cubeUvs,p,o):vn(a,b,l,q,k._cube.uv,i,p,o):vn(a),tn(a,b,c.blend,c.light,c.opacity,c.reverseFlip,c.reverseColor,c.reverseCull),Fn(a,b.uDiffuse,c.color||m["color.empty"]),zn(a,d,6),un(a,b),wn(a,b,l),f&&In(k),g&&pn(a),j._currentCubeElementId=null}},drawReflector:function(){var a=new Kg,b=new Kg,d=new Tg,e=new Rg,f=new Kg,g=new Kg,h=new Kg,j=new Kg,k=new Rg,l=new Rg,m=new Mg,n=new Jg,o=new Jg,p=function(a,b,c){a[c]=b[0],a[c+1]=b[1],a[c+2]=b[2]},q=function(a,b){p(a,b.getEye(),0),p(a,b.getCenter(),3),p(a,b.getUp(),6)},r=function(a,b){b._eye=[a[0],a[1],a[2]],b._center=[a[3],a[4],a[5]],b._up=[a[6],a[7],a[8]],b._18Q=i;var c=b._skyBox;c&&(c.p3([a[0],a[1],a[2]]),b.getData3dUI(c).iv())};return function(p,s,t,u,v){var w=this;w._reflectorInfo=null;var x=w.data;if(x._reflecting)return!1;var y=w.gv;if(v)return!1;var z=w._reflectorRenderTarget;z?z.setSize(p,s,t):z=w._reflectorRenderTarget=new Tn.RenderTarget(y,p,s,t),a.copy(x.p3()),b.copy(y.getEye()),e.makeRotationFromEuler(d.set(x.r3(),x.getRotationMode(),!0));var A;if(!w._reflectNormal){var A=bp(w,w.s("shape3d"));if(!A)return!1;if(!A.ns&&A.length&&(A=A[0]),!A.ns||!A.vs)return!1;w._reflectNormal=[A.ns[0],A.ns[1],A.ns[2]],w._reflectorVbuffer=jp.Buffer.createVertexBuffer(p,new Float32Array(A.vs))}if(f.copy(w._reflectNormal),f.applyMatrix4(e),g.subVectors(a,b),g.dot(f)>0)return!1;g.reflect(f).negate(),g.add(a),h.copy(y.getCenter()).negate().add(a),h.reflect(f).negate(),h.add(a),j.copy(y.getUp()),j.reflect(f);var B=[0,0,0,0,0,0,0,0,0];q(B,y),y._eye=g.toArray(),y._center=h.toArray(),y._up=j.toArray(),y._18Q=i;var C=y._skyBox;C&&(C.p3(y._eye),y.getData3dUI(C).iv()),zm(p,z.frame),p.viewport(0,0,z.width,z.height),p.clearColor(0,0,0,1),p.clear(p.COLOR_BUFFER_BIT);var D=en(y),E=dn(y);m.setFromNormalAndCoplanarPoint(f,a),m.applyMatrix4(l.fromArray(E)),n.set(m.normal.x,m.normal.y,m.normal.z,m.constant),o.x=(Math.sign(n.x)+D[8])/D[0],o.y=(Math.sign(n.y)+D[9])/D[5],o.z=-1,o.w=(1+D[10])/D[14],n.multiplyScalar(2/n.dot(o));var F=x.s("shape3d.reflector.clip"),G=F===c?.003:F;D[2]=n.x,D[6]=n.y,D[10]=n.z+1-G,D[14]=n.w;var H=y._computedProjectMatrix;y._computedProjectMatrix=D,x._reflecting=!0,u(),y._computedProjectMatrix=H,k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(l.fromArray(y._projectMatrix)),k.multiply(l.fromArray(y._viewMatrix)),Am(p),r(B,y);var I=p._compiledShader.reflector;return I||(I=p._compiledShader.reflector=new jp.Shader(p,wm.Reflector.vs,wm.Reflector.fs)),I.bind(),p.activeTexture(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,z.texture),I.uniforms.tDiffuse=0,I.uniforms.color=rf(x.s("shape3d.reflector.color")||"rgb(128,128,128)"),I.uniforms.textureMatrix=k.toArray(),I.uniforms.modelMatrix=Ei(x),I.uniforms.viewMatrix=dn(y),I.uniforms.projectionMatrix=en(y),w._reflectorVbuffer.upload(),I.attributes.pos.pointer(w._reflectorVbuffer),p.drawArrays(p.TRIANGLES,0,6),x._reflecting=!1,p.useProgram(y._prg),!0}}()}),wm.Reflector={vs:["attribute vec3 pos;","uniform mat4 textureMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat4 projectionMatrix;","varying vec4 vUv;","void main() {","	vUv = textureMatrix * modelMatrix * vec4( pos, 1.0 );","	gl_Position = projectionMatrix * viewMatrix * modelMatrix * vec4( pos, 1.0 );","}"].join("\n"),fs:["precision highp float;","uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","	return( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","	return vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","	vec4 base = texture2DProj( tDiffuse, vUv );","   vec2 tUv = vUv.xy / vUv.w;","   if (tUv.x < .0 || tUv.y < .0 || tUv.x > 1. || tUv.y > 1.) discard;","	gl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var gq=function(a,b){Wd(gq,this,[a,b])};ki(gq,eq,{_25Q:1,validate:function(a,b){var c=this,d=c.gv,e=c.data,f=c.s,g=f("edge.width"),h=e._40I,j=e._41I;if(c.shapeModel=c.info=i,h&&j){var k,m,n,o,p,q,r,s,t,u,v=e.isLooped(),w=f(hb),x=l.getEdgeType(w);if(x){var y=x(e,Jj(c,d,e,v,w),d,c._19Q);if(!y.points||y.points.isEmpty())return;q=c.info={},r=y.segments,p=y.points,s=p.size();for(var z=h.getElevation(),A=j.getElevation(),B=0;s>B;B++){var C=p.get(B);C.e==i&&(C.e=z+(A-z)*B/(s-1))}t=Hm(p.get(0)),u=Hm(p.get(s-1));var D=s%2;0===D?(q.c1=Hm(p.get(s/2-1)),q.c2=Hm(p.get(s/2))):q.p3=Hm(p.get((s-D)/2)),q.s1=t,q.s2=Hm(p.get(1)),q.t1=Hm(p.get(s-2)),q.t2=u}else{p=new bj,q=c.info={};var E=f("edge.offset"),G=f("edge.center"),H=f("edge.source.t3"),I=f("edge.target.t3"),J=c._getEdge3dHostPoint(h,"source"),K=c._getEdge3dHostPoint(j,"target");if(H&&(J[0]+=H[0],J[1]+=H[1],J[2]+=H[2]),I&&(K[0]+=I[0],K[1]+=I[1],K[2]+=I[2]),w===Ta){r=f("edge.segments");var L=q.points=f(gb)||cj;if(s=L.size()){t=Hm(L.get(0)),u=Hm(L.get(s-1)),!G&&E&&(n=qi(t,J,!0),E=F(E,Vh(J,t)),J=[J[0]+n[0]*E,J[1]+n[1]*E,J[2]+n[2]*E],n=qi(K,u,!0),E=F(E,Vh(u,K)),K=[K[0]-n[0]*E,K[1]-n[1]*E,K[2]-n[2]*E]);var D=s%2;0===D?(k=Hm(L.get(s/2-1)),m=Hm(L.get(s/2))):q.p3=Hm(L.get((s-D)/2)),q.s1=J,q.s2=t,q.t1=u,q.t2=K}else!G&&E&&(n=qi(K,J,!0),o=Vh(J,K),E=Gj(E,o),J=[J[0]+n[0]*E,J[1]+n[1]*E,J[2]+n[2]*E],K=[K[0]-n[0]*E,K[1]-n[1]*E,K[2]-n[2]*E]),k=J,m=K;p.add({x:J[0],y:J[2],e:J[1]}),p.addAll(L),p.add({x:K[0],y:K[2],e:K[1]})}else{var M=Jj(c,d,e,v,w);if(c._19Q||(M=-M),v){var N=J[0],O=J[1],P=J[2],Q=h.getTall()/2+M;k=[N-M,O+Q,P],m=[N+M,O+Q,P],p.add({x:N-M,y:P,e:O}),p.add({x:N-M,y:P,e:O+Q}),p.add({x:N+M,y:P,
e:O+Q}),p.add({x:N+M,y:P,e:O})}else{n=qi(K,J,!0),o=Vh(J,K);var R={x:J[0],y:J[2]},S={x:K[0],y:K[2]},T=Tm(i,R,S,M),U=T.x-R.x,V=T.y-R.y;E=Gj(E,o),n[0]*=E,n[1]*=E,n[2]*=E,k=[J[0]+n[0]+U,J[1]+n[1],J[2]+n[2]+V],m=[K[0]-n[0]+U,K[1]-n[1],K[2]-n[2]+V],G?(p.add({x:J[0],y:J[2],e:J[1]}),p.add({x:k[0],y:k[2],e:k[1]}),p.add({x:m[0],y:m[2],e:m[1]}),p.add({x:K[0],y:K[2],e:K[1]})):(p.add({x:k[0],y:k[2],e:k[1]}),p.add({x:m[0],y:m[2],e:m[1]}))}}q.c1=k,q.c2=m}f(Tb)===Fa?q.list=c.createTubeModel(p,r,g/2,a):q.list=c.createLineModel(p,r,g,"edge","edge.dash")}},_getEdge3dHostPoint:function(a,b){if(!Kd(a))return a.p3();var d=this;b="edge."+b+".anchor.";var e=d.s(b+"x"),f=d.s(b+"elevation"),g=d.s(b+"y"),h=Ei(a,d.gv.getMat(a)),i=a.getAnchor3d();return yi([(e===c?.5:e)-i.x,(f===c?.5:f)-i.y,(g===c?.5:g)-i.z],h)}});var hq=function(a,b){Wd(hq,this,[a,b])};ki(hq,fq,{_80o:function(a,b,c){var d=this,e=d.gv,f=d.shapeModel;Kn(e,d.mat),f?$o(e,d.data,f,d,d.getBodyColor(),c):(Rn(d,a,b,d.left,c),Rn(d,a,b,d.front,c),Rn(d,a,b,d.right,c),Rn(d,a,b,d.back,c),Rn(d,a,b,d.top,c),Rn(d,a,b,d.bottom,c)),In(e)},validate:function(a,b){var c,d,e=this,f=e.s,g=e.data,h=g.p3(),j=g._thickness/2,k=g.isClosePath(),l=g.getPoints(),m=g.getSegments(),n=f(Ub),o=a&&a.uv;if(e.clear(),0>j)d=e.shapeModel=dk(l,m,f(Yb),f(Zb),n,f($b),g.getTall(),g.getShapeElevation(),k),f(Vb)?f("shape3d.image")||delete d.uv:(delete d.vs,delete d.ns,delete d.uv),f("shape3d.top.image")||delete d.top_uv,f("shape3d.bottom.image")||delete d.bottom_uv;else if(f(Tb)===Fa)c=Af(l,m,n,k),d=e.shapeModel={vs:[]},f("shape3d.image")&&(d.uv=[],d.sum=f($b)||je(c)||1,d.len=0),f(Yb)&&!k&&(d.top_vs=[],f("shape3d.top.image")&&(d.top_uv=[])),f(Zb)&&!k&&(d.bottom_vs=[],f("shape3d.bottom.image")&&(d.bottom_uv=[])),e._12O(c,j);else{var p,q,r,s,t,u,v,w,x,y;if(c=Af(l,m,n,k),t=e.vf(ma,o,!1,b),j&&(u=e.vf(na,o,!1,b),v=k?i:e.vf(oa,o,!1,b),w=k?i:e.vf(pa,o,!1,b),x=e.vf(qa,o,!1,b),y=e.vf(ra,o,!1,b)),j){for(var z=0,A=c.length;A>z;z++)c[z]=e._tryRemoveBezierPoints(c[z],j);e._12O(c,j)}else t&&c.forEach(function(a){if(s=a.length,s>0)for(p=a[0],r=1;s>r;r++)q=a[r],e.addV(t.vs,p,q),p=q});e._20Q(c),a||(t&&(t.ns=fn(t.vs),dp(t,"vs"),dp(t,lb)),j&&(u&&(u.ns=fn(u.vs),dp(u,"vs"),dp(u,lb)),v&&(v.ns=fn(v.vs),dp(v,"vs"),dp(v,lb)),w&&(w.ns=fn(w.vs),dp(w,"vs"),dp(w,lb)),x&&(x.ns=fn(x.vs),dp(x,"vs"),dp(x,lb)),y&&(y.ns=fn(y.vs),dp(y,"vs"),dp(y,lb))))}var B=e.mat=ti();Wm(B,h),Xk(B,g.getFinalRotation3d(),g.getRotationMode());var C=g.getScale3d(),D=g._dynamicScale3d;D&&(C[0]*=D[0],C[1]*=D[1],C[2]*=D[2]),Xm(B,C),Wm(B,ri(h)),a&&(po(e,B,a,d),e.clear())},_20Q:function(a){var b,c,d,e,f,g,h,j=this,k=j.front,l=j.back,m=j.top,n=j.bottom,o=k?k.tuv:i,p=l?l.tuv:i,q=m?m.tuv:i,r=n?n.tuv:i,s=0;(o||p||q||r)&&(b=j.s($b)||je(a)||1,a.forEach(function(a){if(c=a.length,c>0)for(g=a[0],d=1;c>d;d++)h=a[d],e=s/b,s+=Vh(g,h),f=s/b,j._14O(k,e,f),j._14O(l,1-f,1-e),j._14O(m,e,f),j._14O(n,e,f),g=h}))},_14O:function(a,b,c){if(a){var d=a.uv,e=a.tuv;if(e){if(d)var f=d[0]+(d[6]-d[0])*b,g=d[1]+(d[7]-d[1])*b,h=d[2]+(d[4]-d[2])*b,i=d[3]+(d[5]-d[3])*b,j=d[2]+(d[4]-d[2])*c,k=d[3]+(d[5]-d[3])*c,l=d[0]+(d[6]-d[0])*c,m=d[1]+(d[7]-d[1])*c;else f=b,g=0,h=b,i=1,j=c,k=1,l=c,m=0;e.push(h,i,j,k,l,m,l,m,f,g,h,i)}}},_13O:function(a){var b=a.uv,c=a.tuv;c&&(b?c.push(b[2],b[3],b[4],b[5],b[6],b[7],b[6],b[7],b[0],b[1],b[2],b[3]):c.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(a,b){var c=a.length;if(4>c)return a;var d,e,f,g,h,i,j=!1,k=function(b){return a[b]},l=function(b){return a[c-1-b]};for(h=0;1>=h;h++)for(i=h?l:k,e=i(0),f=i(1),d=2;c-1>d;d++)if(g=i(d),!g.remove)if(g.b){var m=Tm(e,f,g,b);m.adjust?(g.remove=!0,j=!0):(e=f,f=g)}else e=f,f=g;if(!j)return a;var n=[];for(d=0;c>d;d++)a[d].remove||n.push(a[d]);return n},_12O:function(a,b){var c,d,e,f,g,h=this.s("shape3d.point.epsilon"),j=this;a.forEach(function(a){if(g=a.length,g>0)for(c={p:a[0],n:!0},f=1;g>f;f++)d=a[f],e=g-1>f?a[f+1]:i,e&&Math.abs(d.x-e.x)<h&&Math.abs(d.y-e.y)<h||j.addPoint(c,d,e,b,a)})},addPoint:function(a,b,c,d,e){var f,g,h,j,k,l,m,n,o,p=this,q=a.p,r=a.f,s=a.b,t=p.s("shape3d.side")||ji,u=p.s("shape3d.start.angle"),v=p.s("shape3d.sweep.angle"),w=p.shapeModel,x=p.data.isClosePath();if(a.n&&(a.n=!1,r=x&&e.length>2?Tm(e[e.length-2],q,b,d):Tm(i,q,b,d),s=Sm(q,r),w?w.top_vs&&p._10O(s,r,t,u,v,w.top_vs,w.top_uv):(f=p.left)&&(p.addV(f.vs,s,r),p._13O(f))),g=c?Tm(q,b,c,d):x&&e.length>2?Tm(q,b,e[1],d):Tm(q,b,i,d),h=Sm(b,g),w){var y,z,A=w.vs,B=w.uv,C=w.sum;for(B&&(y=w.len/C,w.len+=Vh(q,b),z=w.len/C),l=p._9O(s,r,t,u,v),m=p._9O(h,g,t,u,v),n=0;t>n;n++)o=n+1,Rd(A,l[o]),Rd(A,m[n]),Rd(A,l[n]),Rd(A,m[n]),Rd(A,l[o]),Rd(A,m[o]),B&&(j=n/t,k=o/t,B.push(y,k,z,j,y,j,z,j,y,k,z,k));!c&&w.bottom_vs&&p._10O(h,g,t,u,v,w.bottom_vs,w.bottom_uv,!0)}else!c&&(f=p.right)&&(p.addV(f.vs,g,h),p._13O(f)),(f=p.front)&&p.addV(f.vs,r,g),(f=p.back)&&p.addV(f.vs,h,s),(f=p.top)&&p.addH(f.vs,r,g,h,s,!0),(f=p.bottom)&&p.addH(f.vs,s,h,g,r);a.p=b,a.f=g,a.b=h},_10O:function(a,b,c,d,e,f,g,h){var i,j,k=this,l=k.data,m=k._9O(a,b,c,d,e),n=(a.x+b.x)/2,o=(a.y+b.y)/2,p=l.getShapeElevation(),q=0;for(q=0;c>q;q++)h?(Rd(f,m[q]),Rd(f,m[q+1])):(Rd(f,m[q+1]),Rd(f,m[q])),Rd(f,[n,p,o]),g&&(h?(i=N*(q+1)/c+d,j=N*q/c+d):(i=N*q/c+d,j=N*(q+1)/c+d),g.push(.5-.5*H(j),.5-.5*J(j),.5-.5*H(i),.5-.5*J(i),.5,.5))},_9O:function(a,b,c,d,e){var f,g,h=this,i=h.data,j=[],k=(a.x+b.x)/2,l=(a.y+b.y)/2,m=i.getTall()/2,n=i.getShapeElevation(),o=0;for(e=e||N;c>=o;o++)f=e*o/c+d,g=H(f),j.push([k+(a.x-k)*g,n+m*J(f),l+(a.y-l)*g]);return j},addV:function(a,b,c){var d=b.x,e=b.y,f=c.x,g=c.y,h=this.data,i=h.getShapeElevation(),j=h.getTall()/2;a.push(d,i-j,e,f,i-j,g,f,i+j,g,f,i+j,g,d,i+j,e,d,i-j,e)},addH:function(a,b,c,d,e,f){var g=this.data,h=g.getTall()/2,i=g.getShapeElevation()+(f?h:-h);a.push(b.x,i,b.y,c.x,i,c.y,d.x,i,d.y,d.x,i,d.y,e.x,i,e.y,b.x,i,b.y)},vf:function(a,b,c,d){var e,f=this,g=f.gv.getFaceVisible(f.data,a);return(c||g)&&(e=Qn(f,a,d),e.vs=[],e.tuv=g&&(e.texture||b)?[]:i,e.visible=g),e}});var iq=function(a,b){Wd(iq,this,[a,b])};ki(iq,eq,{_25Q:1,validate:function(a,b){var c=this,d=c.data,e=c.s,f=d.getPoints(),g=f.size();if((!c.s("shape3d.geometry.cache")||!c.shapeModel)&&(c.shapeModel=c.info=i,g>1)){var h=c.info={},j=d.getSegments(),k=d.getThickness(),l=Hm(f.get(0)),m=Hm(f.get(g-1)),n=g%2;0===n?(h.c1=Hm(f.get(g/2-1)),h.c2=Hm(f.get(g/2))):h.p3=Hm(f.get((g-n)/2)),h.s1=l,h.s2=Hm(f.get(1)),h.t1=Hm(f.get(g-2)),h.t2=m,e(Tb)===Fa?h.list=c.createTubeModel(f,j,k/2,a):h.list=c.createLineModel(f,j,k,"shape.border","shape.dash")}var o=d.p3(),p=c.mat=ti();Wm(p,o),Xk(p,d.getFinalRotation3d(),d.getRotationMode());var q=d.getScale3d(),r=d._dynamicScale3d;r&&(q[0]*=r[0],q[1]*=r[1],q[2]*=r[2]),Xm(p,q),Wm(p,ri(o))},_80o:function(a,b,c){var d=this,e=d.shapeModel;if(e){var f=d.gv;Kn(f,d.mat),$o(f,d.data,e,d,d.getBodyColor(),c),In(f)}}});var jq=j.graph3d.VR=function(b){var c=this;c.gv=b,c._controllers=[],c["switch"]=new lq(c),c._enable=!1,c._defaultCallLater=j.Default.callLater,c._defaultCancelLater=Eh,"undefined"!=typeof a&&"VRFrameData"in a&&(c._frameData=new a.VRFrameData),c.measureOflength=1,c.eyesOffset=[0,0,0],c._orientation=new j.Math.Quaternion,c._lastHeadPose=[0,0,0],c._offsetToBeAdd=[0,0,0],c._fpsInfo={time:0,fps:0,frames:0}};ki(jq,b,{ms_fire:!0,_42:function(a,b,c,d){var e=this,f=e.gv;if(!f.drawFilter&&e._deviceInAction){var g=e._device;if(g){var h=e._measureOflength;g.depthNear=f.getNear()*h,g.depthFar=f.getFar()*h;var i=e._offsetToBeAdd;if(e.eyesOffset[0]+=i[0],e.eyesOffset[1]+=i[1],e.eyesOffset[2]+=i[2],i[0]=0,i[1]=0,i[2]=0,g.isPresenting===!1)return e._controllers.forEach(function(a){a&&a.update()}),f.iv(),!1;var k=e._frameData;g.getFrameData(k);var l=k.pose.position;if(l){var m=e.toViewPosition(l);f.setEye(m),e._orientation.fromArray(k.pose.orientation);var n=new j.Math.Vector3(0,0,-10*e._scaleFactor);n.applyQuaternion(e._orientation),f.setCenter([m[0]+n.x,m[1]+n.y,m[2]+n.z])}e._controllers.forEach(function(a){a&&a.update()}),f.setViewport(a,0,0,b/2,c),e._viewMatrix=e._copyViewMatrix(k.leftViewMatrix),e._projectMatrix=e._copyProjectMatrix(k.leftProjectionMatrix),d(),f.setViewport(a,b/2,0,b/2,c),e._viewMatrix=e._copyViewMatrix(k.rightViewMatrix),e._projectMatrix=e._copyProjectMatrix(k.rightProjectionMatrix),d(),e._lastViewMatrix=e._viewMatrix,e._lastProjectMatrix=e._projectMatrix,e._viewMatrix=null,e._projectMatrix=null,e.submitFrame();var o=Date.now(),p=e._fpsInfo;return o-p.time>1e3?(p.fps=Math.round(1e3*(p.frames+1)/(o-p.time)),p.time=o,p.frames=0):p.frames++,!0}}},onVRDisplayPresentChange:function(){var a=this.isPresenting();this._injectGraphView(a),this.fp("present",!a,a)},getOrientation:function(){return this._orientation},addController:function(a){a=a||0;var b=this,c=b.getController(a);return c?c:(c=new kq(b,a),b._controllers.push(c),c)},getController:function(a){a=a||0;for(var b=this._controllers,c=0,d=b.length;d>c;c++)if(b[c]&&b[c].id===a)return b[c];return null},removeController:function(a){a=a||0;for(var b=this._controllers,c=0,d=b.length;d>c;c++)if(b[c]&&b[c].id===a)return b.splice(c,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(a,b){var c=this,d=c._scaleFactor,e=c._eyesOffset,f=c._lastHeadPose;return f[0]=a[0]*d,f[1]=a[1]*d,f[2]=a[2]*d,b?(b[0]=f[0]+e[0],b[1]=f[1]+e[1],b[2]=f[2]+e[2],b):[f[0]+e[0],f[1]+e[1],f[2]+e[2]]},addEyesOffset:function(a,b,c){var d=this._offsetToBeAdd;d[0]+=a,d[1]+=b,d[2]+=c},_copyViewMatrix:function(a){var b=this.dup(a),c=this._scaleFactor;b[12]*=c,b[13]*=c,b[14]*=c;var d=this._eyesOffset;if(d&&(d[0]||d[1]||d[2])){var e=d[0],f=d[1],g=d[2];b[12]-=b[0]*e+b[4]*f+b[8]*g,b[13]-=b[1]*e+b[5]*f+b[9]*g,b[14]-=b[2]*e+b[6]*f+b[10]*g}return b},shutdown:function(){var a=this._device;a&&a.isPresenting&&a.exitPresent()},isPresenting:function(){var a=this._device;return a&&a.isPresenting},_copyProjectMatrix:function(a){var b=this.dup(a),c=this._scaleFactor;return b[14]*=c,b},dup:function(a,b){for(var c=a.length,d=b||new Array(c);c--;)d[c]=a[c];return d},getViewMatrix:function(a){var b=this._viewMatrix;return b?this.dup(b,a):void 0},getProjectMatrix:function(){var a=this._projectMatrix;return a?this.dup(a):void 0},submitFrame:function(){var a=this;if(a._enable&&a._deviceInAction){var b=a._device;b&&b.isPresenting&&(b.submitFrame(),a.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(a){var b=this.gv;return b.intersectObjects(a,b.dm().getDatas())},setDevice:function(a){var b=this;b._device=a},_injectGraphView:function(){var a,b,c;return function(d){var e=this.gv;if(!d)return void(a&&(e.getWidth=a,e.getHeight=b,e.getDevicePixelRatio=c));var f=this._device,g=f.getEyeParameters("left"),h=g.renderWidth,i=g.renderHeight;a=e.getWidth,b=e.getHeight,c=e.getDevicePixelRatio,e.getWidth=function(){return 2*h},e.getHeight=function(){return i},e.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(a){var b=this;if(!a)return Dh=j.Default.callLater=b._defaultCallLater,void(Eh=j.Default.cancelLater=b._defaultCancelLater);var b=this;Dh=j.Default.callLater=function(a,c,d,e){var f=b._device;return f&&f.isPresenting?e?Z(function(){Dh(a,c,d)},e):f.requestAnimationFrame(function(){b._deviceInAction=!0,a.apply(c,d),b._deviceInAction=!1}):b._defaultCallLater(a,c,d,e)},Eh=j.Default.cancelLater=function(a,c){var d=b._device;return d&&d.isPresenting?c?$(a):d.cancelAnimationFrame(a):b._defaultCancelLater(a,c)}}}),b.defineProperties(jq.prototype,{enable:{get:function(){return this._enable},set:function(a){var b=this;b._enable!==a&&(b._enable=a,a?(b["switch"].showButton(),b._injectCallLaterFunc(!0)):(b.shutdown(),b["switch"].hideButton(),b._injectCallLaterFunc(!1)),b.fp("enable",!a,a))}},measureOflength:{get:function(){return this._measureOflength},set:function(a){this._measureOflength=a;var b=this._scaleFactor=1/a;this._controllers.forEach(function(a){a&&a._setScaleFactor(b)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(a){this._eyesOffset=a}},controllerModel:{get:function(){return this._controllerModel},set:function(a){var b;"object"==typeof a?(b=a.mtl,a=a.obj):(b=a+".mtl",a+=".obj");var c=this,d=c._controllerModel;d&&d.obj===a&&d.mtl===b||(d=c._controllerModel={obj:a,mtl:b},l.loadObj(a,b,{finishFunc:function(a,b){c._controllerModel===d&&l.setShape3dModel("vrControllerModel",b)}}))}},interactive:{get:function(){return!!this._interactive},set:function(a){!!a!=!!this._interactive&&(this._interactive=a,a&&this.addController(0),this.gv.getCoreInteractor().enableVR(a))}}});var kq=function(a,b){function d(a){var b=navigator.getGamepads&&navigator.getGamepads();if(b)for(var c=0,d=0,e=b.length;e>c;c++){var f=b[c];if(f){var g=f.id;if("OpenVR Gamepad"===g||"OpenVR Controller"===g||0===g.indexOf("Oculus Touch")||0===g.indexOf("Spatial Controller")){if(d===a)return f;d++}}}}function e(a,b,c){return Math.abs(a[0]-b[0])<c&&Math.abs(a[1]-b[1])<c&&Math.abs(a[2]-b[2])<c?!0:!1}var f=this;f.vr=a,f.id=b;var g,h,i=[0,0],j=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],k=new Sk;k.s("shape3d","vrControllerModel"),k.isController=!0,k.s("intersect",!1),f.getGamepad=function(){return h},f.isButtonPressed=function(a){for(var b,c=0,d=j.length;d>c;c++)if(b=j[c],b.id===a)return b.pressed;return!1},f.getNode=function(){return k};var m=.003;f.setRotationEpsilon=function(a){m=a};var n=5e-4,o=n;f.setPositionEpsilon=function(a){n=a,o=a*f.vr._scaleFactor},f._setScaleFactor=function(a){k.s3(a,a,a),o=n*a},f._setScaleFactor(f.vr._scaleFactor);var p,q=new Ig,r=new Rg,s=[0,0,0],t=[0,0,0],u=new Tg,v=new Kg,w=new Ng;f.getRay=function(){return p?(w.origin.fromArray(s),w.direction.copy(v),p=!1,w):w},f.update=function(){if(g=h,h=d(b),g!=h&&console.log("gamepad changed",h),!h||h.pose===c)return h=null,void k.s("3d.visible",!1);if(l.getShape3dModel("vrControllerModel")){k.dm()||a.gv.dm().add(k),k.s("3d.visible",!0);var n=h.pose;if(null!==n){n.position&&(f.vr.toViewPosition(n.position,s),e(k.p3(),s,o)||(p=!0,k.p3(s))),n.orientation&&(q.fromArray(n.orientation),v.set(0,0,-1).applyQuaternion(q).normalize(),r.makeRotationFromQuaternion(q),u.set(0,0,0,k.getRotationMode(),!0).setFromRotationMatrix(r),t[0]=u.x,t[1]=u.y,t[2]=u.z,e(k.r3(),t,m)||(p=!0,k.r3(t))),p&&a.fp("gamepad.pose",null,{position:s,rotation:t,id:b});var w=h.axes;(i[0]!==w[0]||i[1]!==w[1])&&(i=[w[0],w[1]],a.fp("gamepad.axes",null,{id:b,axes:i}));var x,y,z,A,B=h.buttons;for(x=0,y=B.length;y>x;x++)if(z=B[x],A=z.pressed,A!==j[x].pressed){j[x].pressed=A;var C={id:b},D="state";C[D]=C._62O=A?"down":"up",a.fp("gamepad.button."+j[x].id,null,C)}}}}},lq=function(a){this.vr=a,this._button=null};ki(lq,b,{showButton:function(){var a=this.assureButton();if(!a.parentNode){var b=this.vr.gv,c=b.getView();b._79O?c.insertBefore(a,b._79O):c.appendChild(a)}},hideButton:function(){var a=this._button;a&&a.parentNode&&a.parentNode.removeChild(a)},assureButton:function(){var a=this._button;return a?a:this._button=this.createButton(this.vr.gv)},createButton:function(b){function c(a,b){a.textContent=b&&b.isPresenting?" VR ":" VR "}function d(a){g.style.display="",g.style.cursor="pointer",g.style.left="calc(50% - 50px)",g.style.width="100px",c(g,a),g.onmouseenter=function(){g.style.opacity="1.0"},g.onmouseleave=function(){g.style.opacity="0.5"},g.onclick=function(){a.isPresenting?a.exitPresent():a.requestPresent([{source:b.getCanvas()}])},b.vr.setDevice(a)}function e(){g.style.display="",g.style.cursor="auto",g.style.left="calc(50% - 75px)",g.style.width="150px",c(g,null),g.onmouseenter=null,g.onmouseleave=null,g.onclick=null,b.vr.setDevice(null)}function f(a){a.style.position="absolute",a.style.bottom="20px",a.style.padding="12px 6px",a.style.border="1px solid #fff",a.style.borderRadius="4px",a.style.color="#000",a.style.font="normal 13px sans-serif",a.style.textAlign="center",a.style.opacity="0.5",a.style.outline="none",a.style.zIndex="999"}if("getVRDisplays"in navigator){var g=this._button=h.createElement("button");return g.style.display="none",f(g),x(a,"vrdisplayconnect",function(a){d(a.display)}),x(a,"vrdisplaydisconnect",function(a){e()}),x(a,"vrdisplaypresentchange",function(a){c(g,a.display),b.vr.onVRDisplayPresentChange()}),navigator.getVRDisplays().then(function(a){a.length>0?d(a[0]):e()}),g}var i=h.createElement("a");return i.href="https://webvr.info",i.innerHTML=" webvr",i.style.left="calc(50% - 90px)",i.style.width="180px",i.style.textDecoration="none",f(i),i}}),b.defineProperties(lq.prototype,{});var mq=j.graph3d.PostProcessing=function(a){function c(){if(!d){var b=a.getGL();d=new Tn.RenderTarget(a,b,null,null,{samples:m.renderTextureSamples||1}),e=new jp.Shader(b,k.vs,k.fs),f=jp.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),g=jp.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}}var d,e,f,g,h=this,i={},j=!1;!function(){b.keys(mq).forEach(function(b){i[b]=new mq[b](a)})}(),h.getModule=function(a){return a?i[a]:h},h.getModuleList=function(){return b.keys(i)},h.handleDataModleChange=function(a,b){a&&(a.setPostProcessingData(h.serialize()),a.removeSerializeListener(h.onDataModelSerialize,h)),b&&(b.addSerializeListener(h.onDataModelSerialize,h),h.deserialize(b.getPostProcessingData()))},h.onDataModelSerialize=function(b){"serialize"===b.type?a.dm()._postProcessingData=h.serialize():"deserialize"===b.type&&h.deserialize(a.dm().getPostProcessingData())},h.serialize=function(){var a,b,c,d,e={};for(a in i)c=i[a],b=a.toLowerCase(),e[b]={enable:c.enable},d=c.serializeProperties,d&&d.forEach(function(a){e[b][a]=c[a]});return e},h.deserialize=function(a){if(a){var b,c,d,e,f;for(c in a)if(c&&(b=c[0].toUpperCase()+c.slice(1),d=i[b])){e=a[c],h.enableModule(b,e.enable);for(f in e)"enable"!==f&&(d[f]=e[f])}}else{var b,d;for(b in i)d=i[b],d.enable=!1,d.resetProperties&&d.resetProperties()}},h.decodeShader=function(a){var b,c,d,e="",f="";for(d=0;d<a.length;d++)b=a[d],"%"===b?b="'":"a"===b?b='"':"]"===b&&(b="\\"),c=String.fromCharCode(b.charCodeAt(0)-1),d%2?f+=c:e=c+e;return f+e},h.createShader=function(a,b,c){var d=b.indexOf("^#"),e=h.decodeShader(b.substr(0,d)),f=h.decodeShader(b.substr(d+2));if(c){var g=c(e,f);g&&g.vs&&(e=g.vs),g&&g.fs&&(f=g.fs)}return new jp.Shader(a,e,f)},h.enableModule=function(a,b){var d,e,f,g=a.split(",");for(d=0,e=g.length;e>d;d++)f=g[d].trim(),i[f]&&(i[f].enable=b);j=!1;for(f in i)if(i[f].enable){j=!0;break}j&&c()};var k={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};h._42=function(b,c,h,k,l){if(j&&!l){d.setSize(b,c,h),d.bind(b),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),a.setViewport(b,0,0,c,h),k(),d.unbind(b);for(var m=0,n=a._glCapabilities.maxAttributes;n>m;m++)b.disableVertexAttribArray(m);var o,p=d;for(o in i)p=i[o]._42(b,p)||p;return a.setViewport(b,0,0,c,h),b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),e.bind(),b.activeTexture(b.TEXTURE0+0),b.bindTexture(b.TEXTURE_2D,p.texture),e.uniforms.image=0,f.upload(),g.upload(),e.attributes.pos.pointer(g),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0),b.bindTexture(b.TEXTURE_2D,null),b.useProgram(a._prg),!0}}},nq=j.graph3d.PostProcessing.Bloom=function(a){function c(){var b=a.getGL();if(b)for(var c=a._postProcessing,d=0;u>d;d++)w[d]=c.createShader(b,nq._35Q,function(a,b){return{fs:b.replace(/DEFINE_VALUE/g,v[d]).replace("%OVERRIDE_ALPHA_DEFINE%",h?"#define OVERRIDE_ALPHA":"")}})}function d(){var b=a.getWidth(),d=a.getHeight();if(b&&d){r=[b,d],m=!0;var e,f=a.getGL(),g=Math.round(r[0]/2),h=Math.round(r[1]/2);for(n=new Tn.RenderTarget(a,f,g,h),e=0;u>e;e++)s.push(new Tn.RenderTarget(a,f,g,h)),t.push(new Tn.RenderTarget(a,f,g,h)),g=Math.round(g/2),h=Math.round(h/2);var k=a._postProcessing;o=k.createShader(f,nq._34Q),c(),p=k.createShader(f,nq._36Q,function(a,b){return{fs:b.replace(/NUM_MIPS/g,u)}}),q=k.createShader(f,nq.finalShader),i=jp.Buffer.createIndexBuffer(f,new Uint16Array([0,2,1,1,2,3])),j=jp.Buffer.createVertexBuffer(f,new Float32Array([0,0,1,0,0,1,1,1]))}}var e,f,g,h,i,j,k=this,l=!1,m=!1;this.serializeProperties="strength,threshold,radius,overrideAlpha".split(","),this.resetProperties=function(){e=1.5,f=.55,g=.4,h=!0},b.defineProperties(k,{enable:{get:function(){return l},set:function(a){!!l!=!!a&&(l=a,a&&!m&&d())}},strength:{get:function(){return e},set:function(a){e=a}},threshold:{get:function(){return f},set:function(a){f=a}},radius:{get:function(){return g},set:function(a){g=a}},overrideAlpha:{get:function(){return h},set:function(a){!!h!=!!a&&(h=a,m&&c())}}}),this.resetProperties();var n,o,p,q,r=[256,256],s=[],t=[],u=5,v=[3,5,7,9,11],w=[];k._42=function(b,c){function h(c,d,e,f){zm(b,d.frame),a.setViewport(b,0,0,d.width,d.height),f?f(b):b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),k!==c&&c.bind();var g=0;for(var h in e){var l=e[h];l instanceof WebGLTexture&&(b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,l),l=g,g++),c.uniforms[h]=l}for(k!==c&&(i.upload(),j.upload(),c.attributes.pos.pointer(j),k=c),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);g--;)b.activeTexture(b.TEXTURE0+g),b.bindTexture(b.TEXTURE_2D,null);Am(b)}if(l&&(m||(d(),m))){var k;h(o,n,{smoothWidth:.01,luminosityThreshold:f,tDiffuse:c.texture});var v,x=n,y=Math.round(r[0]/2),z=Math.round(r[1]/2);for(v=0;u>v;v++)h(w[v],s[v],{colorTexture:x.texture,direction:[1,0],texSize:[y,z]}),h(w[v],t[v],{colorTexture:s[v].texture,direction:[0,1],texSize:[y,z]}),y=Math.round(y/2),z=Math.round(z/2),x=t[v];return h(p,s[0],{blurTexture1:t[0].texture,blurTexture2:t[1].texture,blurTexture3:t[2].texture,blurTexture4:t[3].texture,blurTexture5:t[4].texture,bloomStrength:e,bloomRadius:g,bloomTintColor:[1,1,1]}),h(q,c,{image:s[0].texture},function(a){a.enable(a.BLEND),a.blendEquation(a.FUNC_ADD),a.blendFunc(a.SRC_ALPHA,a.ONE)}),b.blendEquationSeparate(b.FUNC_ADD,b.FUNC_ADD),b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA),c}}};nq._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",nq._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qsgfjdejotfj$po<!*ibj/hyijqQ!fgsmvpubyuf<u!w-bnsvzTjuoihh!jwffxd03n!vwTVfwt<vgvgojjeg)p5sdnf!wt!b>n!qsmpfmsp3DEh!bdspGm`pmshUffytumvfs$f<<*v1o/j2g!p-snnv!Twufidh3j!fuxf0ynTvjT{fft<vgvgojjeg)p5sdnf!ww!f>d!3s!pemjpsDfhdbusjGp`om<h$BeIfQgMjBo`fF!ELJFSSSOFFWMP`!SgBfEeJgVjT$!E~FG<JxO!F+`!W1B/M3V!F>,$!enfvgTjuoifh!jTfJxHN<Bx!!E+F!G*J3OfFm`qWnBbMtV!F,!&2PfWmFqSnSbJtE)F!`>B,M!QnIvBT`fEtFvGgJgOjFe&<gcmhpsb/u*!uhfbtvgtgtPjwbvo!Q.e!gw)Vjwo!!-gfmspvbuuy!fyU-s!pjmop!dg!m)pEb3uf!stvjuhynfbu*!!>|!3sffmuqvnsbot!!14/d4f:w9:<5c!h+s!/f*yuqf)t!g.g1P/w6v!!+,!!yw!V+w!!y-0f)s!vtujyhfnUbs!p+m!ptdj!h)nEb3*f*s0vtujyhfnub!<>!~2fwmpqjneb!tn!b4jdof)w*!<|y!w+f!df3{!jjTowwoTjj!{+f!!o>p!j2u/d1f!s0j!eu!f>y!Tujf{tfg<gPgwmvp!b3ud!fgwTj<h*nbbn!h>j!Tggm!p-byu))gTeJQHoNbBj*t<tvgbmhp!b>u!!xx!fujbhpimugTv<n*!j>)!uhbbpvmtgt!j>b!oyQ!eugb)p1m/g1-|!!g*T!j,h,n!bj*!<<TwVfJdE5B!Su`fMyFuOvSsFfLQ!j=y!!j>!!<u2f!y>u!vjs!fu3oEj)!!)dsppmgps<UnfvyTuuvishfj-f!xw!V+w!*c<hsw/fydj4Q!fesjvgugyvftuf!T>v!n",nq._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",nq.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var oq=j.graph3d.PostProcessing.Dof=function(a){function c(){n=!0;var b=a.getGL();d=new Tn.RenderTarget(a,b),e=a._postProcessing.createShader(b,oq._38Q),f=jp.Buffer.createIndexBuffer(b,new Uint16Array([0,2,1,1,2,3])),g=jp.Buffer.createVertexBuffer(b,new Float32Array([0,0,1,0,0,1,1,1]))}var d,e,f,g,h,i,j,k,l=this,m=!1,n=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},b.defineProperties(l,{enable:{get:function(){return m},set:function(a){!!m!=!!a&&(m=a,a&&!n&&c())}},image:{get:function(){return i},set:function(b){i!==b&&(i=b,h&&(a.getGL().deleteTexture(h),h=null),a.iv())}},maxblur:{get:function(){return j},set:function(b){j!==b&&(j=b,a.iv())}},aperture:{get:function(){return k},set:function(b){k!==b&&(k=b,a.iv())}}}),this.resetProperties(),l._42=function(b,i){function j(c,d,e,h){zm(b,d.frame),a.setViewport(b,0,0,d.width,d.height),h?h(b):b.clear(b.COLOR_BUFFER_BIT|b.DEPTH_BUFFER_BIT),k!==c&&c.bind();var i=0;for(var j in e){var l=e[j];l instanceof WebGLTexture&&(b.activeTexture(b.TEXTURE0+i),b.bindTexture(b.TEXTURE_2D,l),l=i,i++),c.uniforms[j]=l}for(k!==c&&(f.upload(),g.upload(),c.attributes.pos.pointer(g),k=c),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0);i--;)b.activeTexture(b.TEXTURE0+i),b.bindTexture(b.TEXTURE_2D,null);Am(b)}if(m){n||c();var k;if(!h){var l=yh(this.image);if(!l||!l.tagName)return i;h=gn(b,l)}var o=i.width,p=i.height;if(o&&p)return d.setSize(b,o,p),j(e,d,{tColor:i.texture,tDepth:h,aspect:o/p,aperture:this.aperture,maxblur:this.maxblur}),d}}};oq._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Td(l,{accordionViewExpandIcon:td(hg),accordionViewCollapseIcon:td(hg,!0),accordionViewLabelColor:fh,accordionViewLabelFont:gh,
accordionViewTitleBackground:gg,accordionViewSelectBackground:rg,accordionViewSelectWidth:3,accordionViewSeparatorColor:c,splitViewDividerSize:1,splitViewDividerBackground:gg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ca,rect:[2,2,12,12],background:hg}]},propertyViewLabelColor:eh,propertyViewLabelSelectColor:fh,propertyViewLabelFont:gh,propertyViewExpandIcon:td(jg),propertyViewCollapseIcon:td(jg,!0),propertyViewBackground:ig,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:ng,propertyViewColumnLineColor:ng,propertyViewSelectBackground:rg,listViewLabelColor:eh,listViewLabelSelectColor:fh,listViewLabelFont:gh,listViewRowLineVisible:!1,listViewRowLineColor:ng,listViewSelectBackground:rg,treeViewLabelColor:eh,treeViewLabelSelectColor:fh,treeViewLabelFont:gh,treeViewExpandIcon:td(mg),treeViewCollapseIcon:td(mg,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:ng,treeViewSelectBackground:rg,treeViewDoubleClickToToggle:!0,tableViewLabelColor:eh,tableViewLabelSelectColor:fh,tableViewLabelFont:gh,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:ng,tableViewColumnLineColor:ng,tableViewSelectBackground:rg,treeTableViewLabelColor:eh,treeTableViewLabelSelectColor:fh,treeTableViewLabelFont:gh,treeTableViewExpandIcon:td(mg),treeTableViewCollapseIcon:td(mg,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:ng,treeTableViewColumnLineColor:ng,treeTableViewSelectBackground:rg,tableHeaderLabelColor:eh,tableHeaderLabelFont:gh,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:lg,tableHeaderBackground:ig,tableHeaderMoveBackground:dg,tableHeaderInsertColor:rg,tableHeaderSortDescIcon:ud(jg,!0),tableHeaderSortAscIcon:ud(jg),tabViewTabGap:1,tabViewLabelColor:fh,tabViewLabelFont:gh,tabViewTabBackground:gg,tabViewSelectWidth:3,tabViewSelectBackground:rg,tabViewMoveBackground:dg,tabViewInsertColor:rg,toolbarLabelColor:eh,toolbarLabelSelectColor:fh,toolbarLabelFont:gh,toolbarBackground:ig,toolbarSelectBackground:rg,toolbarItemGap:8,toolbarSeparatorColor:kg},!0);var pq={translateX:1,sortColumn:1},qq={sortable:1,sortOrder:1,sortFunc:1},rq={focusData:1},sq={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},tq={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},uq=function(a,b){b.add(a),a.hasChildren()&&a.eachChild(function(a){uq(a,b)})},vq=function(a,b,c,d,e,f,g,h,j,k,m){var n,o=c.getValueType(k),p=c.getAlign(k);if(c.getEnumValues(k)){var q=c.toEnumLabel(b,k),r=hh||0,s=0,t=f,u=l.getTextSize(d,q).width;return n=yh(c.toEnumIcon(b,k)),n&&(s=f+hh/2,"center"===p?s+=(h-(r+u))/2:"right"===p&&(s=s+h-(r+u)),Ah(a,n,s,g+j/2,k,m),t=s+hh/2),void(q!=i&&(n?Lh(a,q,d,e,t,g,h-(t-f),j):Lh(a,q,d,e,f,g,h,j,p)))}return b=c.formatValue(b),b!=i?o===jc?void Df(a,f,g,h,j,b):o===ic||!o&&Ed(b)?(n=yh(b?Oa:Pa),void Ah(a,n,f+h/2,g+j/2,k,m)):void Lh(a,b,d,e,f,g,h,j,p):void 0},wq=function(a,b){var c=b.view,d=Ke(a),e=b.column||b.property;c.getDataModel().beginTransaction(),b.editor=a,a.info=b,c.setCurrentEditor(a),c.getView().insertBefore(d,c._79O),Le(a,b.editorRect),a.setFocus?a.setFocus():Je(a),a.commitValue=function(f,g){a._17Q&&(a=a._17Q),g||c.setValue(b.data,e,a.getValue?a.getValue():a.value),a.close&&a.close(),fi(d)},e.onEditorCreated&&e.onEditorCreated(b)},xq=function(a,b,c,d,e){var f=gi(a,c),g=b.value,j=b.view,k=e.getValueType(b.data);return f.onblur=f.onchange=function(a){j.endEditing()},"input"===a?(g=e.formatValue(g),g!=i&&(f.value=g),f.onkeydown=function(a){jf(a)?j.endEditing():kf(a)&&j.endEditing(!0)},(k===kc||k===lc)&&x(f,xc,l.numberListener)):a===ob&&d.forEach(function(a){var b=h.createElement("option");b.innerHTML=e.toEnumLabel(a),b.value=a,e.isEnumEqual(g,a)&&(b.selected=!0),ve(f,b)}),wq(f,b),f},yq=j.widget={},zq=function(a,b,c){ki(g+".widget."+a,b,c)};Td(Ug,{ms_value:function(a,b){a.getValue=function(a){var b=this.getItemById(a),c=b.element;return Cd(c)?c:c?c.getValue?c.getValue():c.value:b.selected},a.setValue=function(a,b){var c=this.getItemById(a);if(c){var d=c.element;d&&!Cd(d)?d.setValue?d.setValue(b):d.value=b:Ed(b)?(c.selected=b,this.iv()):(c.element=b,this.iv())}},a.v=function(a,b){var c=this;if(2===arguments.length)c.setValue(a,b);else{if(!Fd(a))return c.getValue(a);for(var d in a)c.setValue(d,a[d])}return c}},_46o:function(a,b){a._icon=i,a._accessType=i,a._valueType=i,a._editable=!1,a._batchEditable=!0,a._align=oa,a._nullable=!0,a._emptiable=!1,a.setParent=gd,a.formatValue=function(a){var b=this,c=b._valueType;return b.getEnumValues()?b.toEnumLabel(a):c===ic?!!a:a!=i&&c===kc?A(a):a},a.setEnum=function(a,b,c,d,e,f,g){var h=this;a&&!Hd(a)&&a.values&&(d=a.editable,c=a.icons,b=a.labels,e=a.strict,f=a.maxHeight,g=a.dropDownWidth,a=a.values),Id(a)&&(a=a._as),Id(b)&&(b=b._as),Id(c)&&(c=c._as),h._enumValues=a,h._enumLabels=b,h._enumIcons=c,h._enumEditable=d,h._enumStrict=e==i?!0:e,h._enumMaxHeight=f,h._enumDropDownWidth=g,a&&a.length&&Dd(a[0])&&(h._valueType=lc),h.fp("enum",!1,!0)},a.getEnumDropDownWidth=function(){return this._enumDropDownWidth},a.getEnumMaxHeight=function(){return this._enumMaxHeight},a.isEnumEditable=function(){return this._enumEditable},a.getEnumValues=function(){return this._enumValues},a.getEnumLabels=function(){return this._enumLabels},a.getEnumIcons=function(){return this._enumIcons},a.isEnumStrict=function(){return this._enumStrict},a.isEnumEqual=function(a,b){return this._enumStrict?a===b:a==b},a.toEnumLabel=function(a,b){var c=this,d=c.getEnumValues(b),e=c.getEnumLabels(b);if(d&&e)for(var f=0;f<d.length;f++)if(c.isEnumEqual(a,d[f]))return e[f];return a},a.toEnumIcon=function(a,b){var d=this,e=d.getEnumValues(b),f=d.getEnumIcons(b);if(e&&f)for(var g=0;g<e.length;g++)if(d.isEnumEqual(a,e[g]))return f[g];return c}},_45o:function(a,b){a._87o=function(a,b,c,d,e,f){if(a){var g=this,h=g._90I,i=qe(1);g._columnLineVisible&&(e-=1),g._rowLineVisible&&(f-=1),0>=e||0>=f||(g._90I||(h=g._90I={}),h[b]||(h[b]=new bj),Le(i,g.tx()+c,g.ty()+d,e,f),ve(i,a),g._view.insertBefore(i,g._79O),a.onParentAdded&&a.onParentAdded(i),h[b].add(i))}},a._76o=function(){var a=this,b=a._90I;if(b){for(var c in b)b[c].each(function(a){fi(a)});delete a._90I}},a._77o=function(a){var b=this;if(b._90I){var c=b._90I[a];c&&(c.each(function(a){fi(a)}),delete b._90I[a])}}},_47o:function(a,b){a.getValue=function(a,b){return b.getValue?b.getValue(a,b,this):de(a,b.getAccessType(),b.getName())},a.setValue=function(a,b,d){if(b.isEmptiable(a)||""!==d||(d=c),b.isNullable(a)||d!=i){var e=this,f=b.getName(a),g=b.getAccessType(a),h=b.getValueType(a);h===kc&&Cd(d)?d=V(d):h===lc&&Cd(d)?d=parseFloat(d):h===ic&&Cd(d)&&(d="true"===d),e._batchEditable&&b._batchEditable&&e.isSelected(a)?e.sm().each(function(a){b.setValue?b.setValue(a,b,d,e):ee(a,g,f,d)}):b.setValue?b.setValue(a,b,d,e):ee(a,g,f,d)}},a.setCurrentEditor=function(a){this.endEditing(),this._currentEditor=a,this.redraw()},a.isEditing=function(a,b){var c=this,d=c._currentEditor;if(!d)return!1;if(b){var e=d.info;return e?(e.column||e.property)===b&&e.data===a:!1}return!0},a.endEditing=function(a){var b=this,c=b._currentEditor;c&&(delete b._currentEditor,c.commitValue&&c.commitValue(c.info,a),b.redraw(),b.getDataModel().endTransaction())},a.beginEditing=function(a){this.endEditing();var b=this,c=a.column||a.property;if(c.beginEditing)c.beginEditing(a);else{var d=a.data,e=a.value,f=b.getSelectBackground(d),g=c.getEnumValues(d),h=c.getSlider(d),j=c.getColorPicker(d);if(h){var k=vh(yq.Slider,h);return k.setValue(e),k.getView().onblur=function(a){b.endEditing()},k.isInstant()&&(k.onValueChanged=function(){b.setValue(d,c,k.getValue())}),void wq(k,a)}if(j||c.getValueType(d)===jc){var l=vh(yq.ColorPicker,j);return l.setValue(e),l.onClosed=function(){b.endEditing()},l.isInstant()&&(l.onValueChanged=function(a,e){b.setValue(d,c,e)}),wq(l,a),void l.open()}if(g){if(yq.ComboBox){var m=new yq.ComboBox;m.setValue(e),m.setValues(g),m.setLabels(c.getEnumLabels(d)),m.setIcons(c.getEnumIcons(d)),m.setEditable(c.isEnumEditable(d)),m.setStrict(c.isEnumStrict(d)),m.setMaxHeight(c.getEnumMaxHeight(d)),m.setDropDownWidth(c.getEnumDropDownWidth(d)),m.onClosed=function(){b.endEditing()},wq(m,a),m.open()}else xq(ob,a,f,g,c);return}var n=c.getValueType(d);if(n===ic||Ed(e))return void b.setValue(d,c,!e);if(c.getItemEditor(d)){var o=Hh(c.getItemEditor(d)),p=new o(d,c,b,a),q=p.getView();return q._17Q=p,p.setValue(e),te(q),wq(q,a),void(p.editBeginning&&p.editBeginning())}xq("input",a,f,i,c)}}},_44o:function(a,b){a.init=function(a){var b=this,c=b.th=new Oq(a),d=b._view=pe(1,b);b.tv=b._tableView=a,ve(d,c.getView()),ve(d,a.getView()),c.mp(function(a){a.property===Ma&&b.iv()}),b.iv()},a.getTableView=function(){return this.tv},a.getTableHeader=function(){return this.th},a.getDataModel=function(){return this.tv.dm()},a.getColumnModel=function(){return this.tv.getColumnModel()},a.setColumns=function(a){this.tv.setColumns(a)},a.addColumns=function(a){this.tv.addColumns(a)},a.endEditing=function(){this.tv.endEditing()},a.validateImpl=function(){var a=this,b=a.th,c=Ae(b),d={x:0,y:0,width:a.getWidth(),height:c};Le(b,d),d.y=c,d.height=E(0,a.getHeight()-c),Le(a.tv,d)}},ms_vs:function(a,b){a._41o=function(){return this._29I.height<this._59I},a._43o=function(){var a=this;a._41o()&&(a._58I||(Z(function(){a._94O()},nh),a.iv()),a._58I=new Date)},a._94O=function(){var a=this;if(a._58I){var b=new Date;b.getTime()-a._58I.getTime()>=nh?(delete a._58I,a.iv()):Z(function(){a._94O()},nh)}},a._93I=function(){var a=this,b=a._27I;if(a._58I||!a._autoHideScrollBar){b||ve(a._79O,b=a._27I=qe());var c=a._29I,d=c.height,e=a._59I,f=a.getScrollBarSize(),g=c.width-f-2,h=d*(-a.ty()/e),i=d*(d/e),j=b.style;e>d?(oh>i&&(h=h+i/2-oh/2,0>h&&(h=0),h+oh>d&&(h=d-oh),i=oh),j.visibility=kb,j.background=a.getScrollBarColor(),j.borderRadius=f/2+za,Le(b,g,h,f,i)):j.visibility=jb}else b&&(b.style.visibility=jb)}},ms_hs:function(a,b){a._40o=function(){return this._29I.width<this._91I},a._42o=function(){var a=this;a._40o()&&(a._95O||(Z(function(){a._94I()},nh),a.iv()),a._95O=new Date)},a._94I=function(){var a=this;if(a._95O){var b=new Date;b.getTime()-a._95O.getTime()>=nh?(delete a._95O,a.iv()):Z(function(){a._94I()},nh)}},a._92I=function(){var a=this,b=a._28I;if(a._95O||!a._autoHideScrollBar){b||ve(a._79O,b=a._28I=qe());var c=a._29I,d=c.width,e=a._91I,f=a.getScrollBarSize(),g=c.height-f-2,h=d*(-a.tx()/e),i=d*(d/e),j=b.style;e>d?(oh>i&&(h=h+i/2-oh/2,0>h&&(h=0),h+oh>d&&(h=d-oh),i=oh),j.visibility=kb,j.background=a.getScrollBarColor(),j.borderRadius=f/2+za,Le(b,h,g,i,f)):j.visibility=jb}else b&&(b.style.visibility=jb)}}}),xh(Oa,rd(16,16,[{type:Da,rect:[1,1,14,14],background:rg},{type:Ba,rect:[1,1,14,14],width:1,color:og},{type:Ga,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),xh(Pa,rd(16,16,{type:Ba,rect:[1,1,14,14],width:1,color:og})),xh(Ra,rd(16,16,[{type:Ea,rect:[2,2,12,12],borderWidth:1,borderColor:og,background:"#FFF"},{type:Ea,rect:[4,4,8,8],background:rg}])),xh(Sa,rd(16,16,{type:Ea,rect:[2,2,12,12],borderWidth:1,borderColor:og})),Ug._15Q=function(a,b){a._29I=id,a._59I=0,a._91I=0,a._5o=function(a){var b=this;b._30I=new bj,b._rows=new bj,b._rowMap={},b._31I=0,b._14I=0,b._view=pe(1,b),b._canvas=re(b._view),ve(b._view,b._79O=qe()),b.dm(a?a:new fj)},a.getCheckIcon=function(a){var b=this.sm(),c=b.co(a);return yh(b.sg()?c?Ra:Sa:c?Oa:Pa)},a.checkData=function(a){var b=this.sm(),c=b.co(a);b.sg()&&c||(this._32o=1,c?b.rs(a):b.as(a),delete this._32o)},a.getDataAt=function(a){a.target&&(a=this.lp(a));var b=B(a.y/this._rowHeight),c=this._rows;return 0>b||b>=c.size()?i:c.get(b)},a.onDataDoubleClicked=function(a,b){},a.onDataClicked=function(a,b){},a.adjustTranslateX=function(a){return 0},a.adjustTranslateY=function(a){var b=this.getHeight()-this._59I;return b>a&&(a=b),a>0?0:A(a)},a.onPropertyChanged=function(a){var b=this,c=a.property;sq[c]?b.ivm():rq[c]||b.redraw(),c===Ob?b._42o():c===Pb&&b._43o()},a.getLabel=function(a){return a.toLabel()},a.getLabelFont=function(a){return this._labelFont},a.getLabelColor=function(a){var b=this;if(b.isCheckMode()){if(b._focusData===a)return b._labelSelectColor}else if(b.isSelected(a))return b._labelSelectColor;return b._labelColor},a.getStartRowIndex=function(){return this._31I},a.getEndRowIndex=function(){return this._14I},a.getRowDatas=function(){return this._rows},a.getRowIndex=function(a){return this._rowMap[a._id]},a.getRowSize=function(){return this._rows.size()},a.getViewRect=function(){return Gh(this._29I)},a.isVisible=function(a){return this._visibleFunc?this._visibleFunc(a):!0},a.getCurrentSortFunc=function(){return this._sortFunc},a.setDataModel=function(a){var b=this,c=b._dataModel,d=b._selectionModel;c!==a&&(c&&(c.umm(b.handleDataModelChange,b),c.umd(b.handleDataPropertyChange,b),c.umh(b.handleHierarchyChange,b),d||c.sm().ums(b.handleSelectionChange,b)),b._dataModel=a,a.mm(b.handleDataModelChange,b),a.md(b.handleDataPropertyChange,b),a.mh(b.handleHierarchyChange,b),d?d._21I(a):a.sm().ms(b.handleSelectionChange,b),b.fp("dataModel",c,a))},a.validateModel=function(){var a=this;a._rows.clear(),a._rowMap={},a.buildChildren(a._dataModel._roots);var b=a._rows=a._rows.toList(a.isVisible,a),c=0,d=a.getCurrentSortFunc(),e=b.size();for(d&&b.sort(d);e>c;c++)a._rowMap[b.get(c)._id]=c},a.buildChildren=function(a){var b=this;a.each(function(a){b._rows.add(a),b.buildChildren(a._children)})},a.handleDataModelChange=function(a){this.ivm()},a.handleDataPropertyChange=function(a){"parent"===a.property?this.ivm():this.invalidateData(a.data)},a.handleHierarchyChange=function(a){this.ivm()},a.handleSelectionChange=function(a){a.datas.each(this.invalidateData,this),this.onSelectionChanged(a)},a.onSelectionChanged=function(a){var b=this,c=b.sm();!b.isAutoMakeVisible()||1!==c.size()||"set"!==a.kind&&"append"!==a.kind||b._32o||b.makeVisible(c.ld())},a.handleBackgroundClick=function(a){Nh(a)&&!this.isCheckMode()&&this.sm().cs()},a.makeVisible=function(a){a&&(this._23I=a,this.iv())},a.scrollToIndex=function(a){var b=this,c=b._29I,d=c.height,e=b._rowHeight,f=e*a;a>=0&&a<b._rows.size()&&d>0&&(f+e>c.y+d?b.ty(-f+d-e):f<c.y&&b.ty(-f))},a.autoScroll=function(a,b){var c=this,d=c._rowHeight,e=d,f=d/4,g=c._29I,h=c.lp(a),i={x:c.tx(),y:c.ty()};return d>0&&g&&(h.x-g.x<e?c.translate(f,0):g.x+g.width-h.x<e&&c.translate(-f,0),h.y-g.y<e?c.translate(0,f):g.y+g.height-h.y<e&&c.translate(0,-f)),i.x=c.tx()-i.x,i.y=c.ty()-i.y,b&&(b.x+=i.x,b.y+=i.y),i},a.getTopRowOrderSelection=function(){var a=this.sm().getTopSelection(),b={},c=new bj;return a.each(function(a){b[a._id]=a}),this._rows.each(function(a){b[a._id]&&c.add(a)}),c},a.getRowOrderSelection=function(){var a=new bj;return this._rows.each(function(b){this.isSelected(b)&&a.add(b)},this),a},a.ivm=function(){this.invalidateModel()},a.invalidateModel=function(){var a=this;a._96I||(a._96I=1,a._32I=1,delete a._24I),a.iv()},a.redraw=function(){var a=this;a._32I||(a._32I=1,delete a._24I,a.iv())},a.invalidateData=function(a){var b=this;ea?b.redraw():b._32I||(b._24I||(b._24I={}),b._24I[a._id]=a,b.iv())},a.getFocusData=function(){return this._focusData},a.setFocusDataById=function(a){this.setFocusData(this.dm().getDataById(a))},a.setFocusData=function(a){var b=this,c=b._focusData;c!==a&&(b._focusData=a,b.fp("focusData",c,a),c&&b.invalidateData(c),a&&(b.invalidateData(a),b.isAutoMakeVisible()&&b.makeVisible(a)))},a.drawRowBackground=function(a,b,c,d,e,f,g){var h=this,i=h.isCheckMode();(b===h._focusData&&i||c&&!i)&&Df(a,d,e,f,g,h.getSelectBackground(b))},a.drawData=function(a,b,c){var d=this,e=d._rowHeight,f=e*c,g=d._29I,h=g.x,i=g.width;a.save(),a.beginPath(),a.rect(h,f,i,e),a.clip(),d._87o(d.drawRow(a,b,d.isSelected(b),h,f,i,e),c,h,f,i,e),a.restore(),d._rowLineVisible&&Df(a,h,f+e-1,i,1,d._rowLineColor)},a._12I=function(a){var b=this,c=b._31I,d=b._29I,e=d.x,f=d.y,g=d.width,h=d.height;for(a.beginPath(),a.rect(e,f,g,h),a.clip(),a.clearRect(e,f,g,h),b._76o(),b._93db(a);c<b._14I;c++)b.drawData(a,b._rows.get(c),c);b._92db(a)},a._13I=function(a){for(var b,c=this,d=c._rowHeight,e=c._29I,f=e.x,g=e.width,h=c._31I,i=c._30I;h<c._14I;h++)b=c._rows.get(h),c._24I[b._id]&&i.add({data:b,index:h});i.isEmpty()||(a.beginPath(),i.each(function(b){a.rect(f,b.index*d,g,d)}),a.clip(),i.each(function(b){a.clearRect(f,b.index*d,g,d)}),i.each(function(a){c._77o(a.index)}),c._93db(a),i.each(function(b){c.drawData(a,b.data,b.index)}),c._92db(a),i.clear())},a.preValidateModel=function(){this.endEditing&&this.endEditing()},a.validateImpl=function(){var a=this,b=a._canvas,c=a.getWidth(),d=a.getHeight(),e=a._rowHeight,f=a._32I;(c!==b.clientWidth||d!==b.clientHeight)&&(ue(b,c,d),f=1);var g=T&&!U;a._96I&&!g&&(a.preValidateModel(),a.validateModel());var h=a._29I,j={x:-a.tx(),y:-a.ty(),width:c,height:d},k=a._rows.size(),l=De(b),m=a._23I;f||Zd(j,h)||(f=1),a._29I=j,a._59I=k*e+a.getScrollBarSize(),a._31I=B(j.y/e),a._14I=C((j.y+j.height)/e),a._31I<0&&(a._31I=0),a._14I>k&&(a._14I=k),a._99I&&f&&a._99I(),Ee(l,a.tx(),a.ty(),1),f?a._12I(l):a._24I&&a._13I(l),a._93I(),a._92I(),l.restore(),a._32I=a._24I=a._96I=i,m&&(a.scrollToIndex(a.getRowIndex(m)),delete a._23I),a.tx(a.tx()),a.ty(a.ty())}},Ug._48o=function(a,b){a._rootVisible=!0,a._rootData=i,a._35o=function(){this._expandMap={},this._levelMap={}},a.validateModel=function(){var a=this,b=a._rootData;a._rows.clear(),a._levelMap={},a._rowMap={},a._currentLevel=0,b?a._rootVisible?a.isVisible(b)&&a.buildData(b):a.buildChildren(b):a.buildChildren(),delete a._currentLevel},a.buildData=function(a){var b=this,c=a._id,d=b._rows;b._rowMap[c]=d.size(),d.add(a),b._levelMap[c]=b._currentLevel,b.isExpanded(a)&&(b._currentLevel++,b.buildChildren(a),b._currentLevel--)},a.buildChildren=function(a){var b=this,c=a?a._children:b._dataModel._roots,d=b.getCurrentSortFunc();d&&b.isChildrenSortable(a)?c.toList(b.isVisible,b).sort(d).each(b.buildData,b):c.each(function(a){b.isVisible(a)&&b.buildData(a)})},a.getLevel=function(a){return this._levelMap[a._id]},a.getToggleIcon=function(a){var b=this,c=b._loader,d=b._collapseIcon;return c&&!c.isLoaded(a)?d:a.hasChildren()?b.isExpanded(a)?b._expandIcon:d:i},a.isCheckMode=function(){return this._checkMode!=i},a.isChildrenSortable=function(a){return!0},a.handleDataModelChange=function(a){var b=this;a.kind===Ja?delete b._expandMap[a.data._id]:a.kind===Ka&&(b._expandMap={}),b.ivm()},a.toggle=function(a){var b=this;b.isExpanded(a)?b.collapse(a):b.expand(a)},a.isExpanded=function(a){return 1===this._expandMap[a._id]},a.expand=function(a){var b=this,c=b._loader;b.isExpanded(a)||(c&&!c.isLoaded(a)&&c.load(a),b._expandMap[a._id]=1,b.ivm(),b.onExpanded(a))},a.onExpanded=function(a){},a.collapse=function(a){var b=this;b.isExpanded(a)&&(delete b._expandMap[a._id],b.ivm(),b.onCollapsed(a))},a.onCollapsed=function(a){},a.expandAll=function(a){if(a)this.expand(a),a.eachChild(function(a){this.expandAll(a)},this);else{var b=this;b._dataModel.each(function(a){a.hasChildren()&&(b._expandMap[a._id]=1)}),b.ivm()}},a.collapseAll=function(){this._expandMap={},this.ivm()},a.makeVisible=function(a){if(a){var b=this;if(!b._rootData||a.isDescendantOf(b._rootData)){for(var c=a._parent;c;)b.expand(c),c=c._parent;b._23I=a,b.iv()}}},a.checkData=function(a){var b,c=this,d=c._checkMode,e=c.sm(),f=e.co(a);if(!e.sg()||!f){if(c._32o=1,d===ja)f?e.rs(a):e.as(a);else if(d===Nb)b=new bj(a),b.addAll(a._children);else if("descendant"===d)b=new bj,uq(a,b);else if("all"===d&&(b=new bj,uq(a,b),!f))for(var g=a._parent;g;)b.add(g),g=g._parent;b&&(f?e.rs(b):e.as(b)),delete c._32o}},a._97I=function(a,b,c,d,e,f,g){var h=this,i=h._indent,j=h._levelMap[b._id],k=h.getIconWidth(b),l=yh(h.getToggleIcon(b));l?(d+=i*j,Ah(a,l,d+i/2,e+g/2,b,h),d+=i):d+=i*(j+1),h._checkMode&&(Ah(a,h.getCheckIcon(b),d+i/2,e+g/2,b,h),d+=i),h.drawIcon(a,b,d,e,k,g),h.drawLabel(a,b,d+k,e,g)}},Ug._14Q=function(a,b){a.getIcon=function(a){return a.getIcon()},a.getIconWidth=function(a){return this.getIcon(a)?this._indent:0},a.drawIcon=function(a,b,c,d,e,f){if(e){var g=this,h=g.getBodyColor(b),i=yh(g.getIcon(b),h);i&&(f-=g.isRowLineVisible()?1:0,Bh(a,i,bc,c,d,e,f,b,g,h),Kf(a,g.getBorderColor(b),c,d,e,f))}},a.drawLabel=function(a,b,c,d,e){var f=this;Lh(a,f.getLabel(b),f.getLabelFont(b),f.getLabelColor(b),c,d,0,e)}},Ug._50o=function(a,b){a._98I=function(){var a=this,b=a._39o=new fj;a._60I=new bj,b.mm(a._17o,a),b.md(a._18o,a),b.mh(a._19o,a)},a.setColumns=function(a){this._39o.clear(),this.addColumns(a)},a.addColumns=function(a){var b=this._39o;a.forEach(function(a){if(!(a instanceof Bq)){var c=Hh(a.className);a=vh(c?c:Bq,a)}b.add(a)})},a.onColumnClicked=function(a){},a.onCheckColumnClicked=function(a){},a._3Q=function(a){for(var b,c=0,d=this._60I,e=d.size();e>c;c++)if(b=d.get(c),b.column===a)return b;return i},a.getColumnAt=function(a){var b=this._4Q(a);return b?b.column:i},a._4Q=function(a){for(var b=this,c=a.target?b.lp(a).x:a.x,d=b._60I,e=0;e<d.size();e++){var f=d.get(e),g=f.startX;if(c>=g&&c<g+f.column.getWidth())return f}return i},a.getToolTip=function(a){var b=this,c=b.getDataAt(a),d=b.getColumnAt(a);return c&&d?d.getToolTip(c,b):i},a.adjustTranslateX=function(a){var b=this.getWidth()-this._91I;return b>a&&(a=b),a>0?0:A(a)},a._99I=function(){var a=this,b=a._29I,c=a._60I;c.clear(),a._91I=0,a._39o._roots.each(function(d){if(d.isVisible()){var e=a._91I+d.getWidth();a._91I<=b.x+b.width&&e>=b.x&&c.add({column:d,startX:a._91I}),a._91I=e}}),a._91I+=a.getScrollBarSize()},a.drawData=function(a,b,c){var d=this,e=d._rowHeight,f=e*c,g=d.isSelected(b),h=d._29I,i=h.x,j=h.width;d.drawRowBackground(a,b,g,i,f,j,e),d._60I.each(function(h){var i=h.column,j=h.startX,k=i.getWidth();k>0&&!d.isEditing(b,i)&&(a.save(),a.beginPath(),a.rect(j,f,k,e),a.clip(),d._87o(d.drawCell(a,b,g,i,j,f,k,e),c,j,f,k,e),d._columnLineVisible&&Df(a,j+k-1,f,1,e,d._columnLineColor),a.restore())}),d._rowLineVisible&&Df(a,i,f+e-1,j,1,d._rowLineColor)},a.drawCell=function(a,b,c,d,e,f,g,h){var i=this;if(d.drawCell)return d.drawCell(a,b,c,d,e,f,g,h,i);var j=i.getValue(b,d);vq(a,j,d,i.getLabelFont(b,d,j),i.getLabelColor(b,d,j),e,f,g,h,b,i)},a.getColumnModel=function(){return this._39o},a._17o=function(a){this.redraw()},a._18o=function(a){var b=this;a.data===b._sortColumn&&qq[a.property]?b.ivm():(b._42o(),b.redraw())},a._19o=function(a){this.redraw()},a.getCurrentSortFunc=function(){var a=this,b=a._sortColumn;if(b&&b.isSortable()){var c=b.getSortFunc(),d=Jb===b.getSortOrder()?1:-1;return c||(c=Fh),function(e,f){return c.call(a,a.getValue(e,b),a.getValue(f,b),e,f)*d}}return a._sortFunc},a.isCellEditable=function(a,b,c){return b.isEditable()&&this.isEditable()?b.isCellEditable?b.isCellEditable(a,b,c,this):!0:!1},a._37O=function(a,b){if(Nh(b))for(var c=this,d=c.lp(b),e=c._60I,f=c._rowHeight,g=c._29I,h=g.x,i=g.y,j=g.width,k=g.height,l=0;l<e.size();l++){var m=e.get(l),n=m.startX,o=m.column,p=o.getWidth();if(o!==c._31o&&o!==c._4o&&d.x>=n&&d.x<n+p&&c.isCellEditable(a,o,b)){var q={x:n,y:c.getRowIndex(a)*f,width:p,height:f},r={x:q.x+c.tx(),y:q.y+c.ty(),width:q.width,height:q.height},s=0,t=0;return q.x<h?s=q.x-h:q.x+q.width>h+j&&(s=q.x+q.width-h-j),s&&(c.tx(c.tx()-s),r.x-=s),q.y<i?t=q.y-i:q.y+f>i+k&&(t=q.y+f-i-k),t&&(c.ty(c.ty()-t),r.y-=t),void c.beginEditing({data:a,column:o,value:c.getValue(a,o),event:b,rect:q,editorRect:r,view:c})}}}},yq.BaseItemEditor=function(a,b,c,d){this._data=a,this._column=b,this._master=c,this._editInfo=d},zq("BaseItemEditor",b,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Aq=j.Tab=function(){Wd(Aq,this)};li("Tab",ej,{ms_ac:["view","closable","disabled","visible"],_icon:i,_closable:!1,_disabled:!1,_visible:!0,setParent:gd});var Bq=j.Column=function(){Wd(Bq,this)};li("Column",ej,{_46o:1,ms_ac:["accessType","valueType",kb,Gb,Hb,La,"align",jc,"sortOrder",Fb,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Jb,_sortFunc:i,_sortable:!0,_clickable:!0,setWidth:function(a){16>a&&(a=16);var b=this._width;this._width=a,this.fp(La,b,a)},getToolTip:function(a,b){return this.formatValue(b.getValue(a,this))}});var Cq=j.Property=function(){Wd(Cq,this)};li("Property",ej,{_46o:1,ms_ac:["accessType","valueType",Gb,Hb,"categoryName",jc,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:i,getToolTip:function(a,b,c){var d=this;return b?d.formatValue(c.getValue(a,d)):c.getPropertyName(d)}}),yq.AccordionView=function(){var a=this;a._20o={},a._21o=new bj,a._10o=i,a._9o=i,a._11o=i,a._view=pe(0,a),a.iv()},zq("AccordionView",b,{ms_v:1,ms_fire:1,ms_ac:[Cb,Db,"titleHeight",bb,ab,"titleBackground","selectWidth",qb,"orientation","separatorColor"],_expandIcon:l.accordionViewExpandIcon,_collapseIcon:l.accordionViewCollapseIcon,_titleHeight:kh,_labelColor:l.accordionViewLabelColor,_labelFont:l.accordionViewLabelFont,_titleBackground:l.accordionViewTitleBackground,_selectBackground:l.accordionViewSelectBackground,_selectWidth:l.accordionViewSelectWidth,_orientation:"v",_separatorColor:l.accordionViewSeparatorColor,onPropertyChanged:function(a){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(a,b,c,d){var e=this,f=qe();if(e._20o[a])throw a+" already exists";f.onmousedown=wh,f.style.cursor=oc,x(f,ia?uc:qc,function(a){wh(a)}),x(f,ia?wc:sc,function(b){wh(b),Nh(b)&&(e._10o===a?e.collapse():e.expand(a))}),ve(e._view,f),e._20o[a]={content:b,div:f,canvas:re(f),icon:d},e._21o.add(a),c&&e.expand(a),e.iv()},remove:function(a){var b=this,c=b._20o[a];c&&(fi(c.div),delete b._20o[a],b._21o.remove(a),b.iv())},clear:function(){var a=this;a._21o.toArray().forEach(a.remove,a),a._20o={},a._21o.clear(),a.iv()},isExpanded:function(a){return this._10o===a},expand:function(a){var b=this;b._20o[a]&&b._10o!==a&&(b._10o=a,b.onExpanded(a),b.iv())},onExpanded:function(a){},collapse:function(){var a=this;a._10o&&(a.onCollapsed(a._10o),delete a._10o,a.iv())},onCollapsed:function(a){},initCanvas:function(a,b,c){ue(a,b,c);var d=De(a);return Ee(d,0,0,1),d.clearRect(0,0,b,c),d},drawTitle:function(a,b,c,d,e){var f=this,g=yh(e.icon),h=f.isExpanded(b),i=f._titleHeight,j=f._titleBackground,k=f._selectWidth,l=f._separatorColor,m=yh(h?f._expandIcon:f._collapseIcon),n=k+4;Df(a,0,0,c,d,j),h&&k&&Df(a,0,0,k,d,f._selectBackground),(h||f._21o.get(f._21o.size()-1)!==b)&&Df(a,0,d-1,c,1,l?l:Jh(j)),g&&(Ah(a,g,n+Zi(g)/2,i/2),n+=Zi(g)+2),Lh(a,b,f.getLabelFont(b),f.getLabelColor(b),n,0,0,i),m&&Ah(a,m,c-Zi(m)/2-4,i/2)},validateImpl:function(){var a=this,b=a._view,c=0,d=0,e=a.getWidth(),f=a.getHeight(),g=a._titleHeight,h=a._21o.size()*g,i=a._11o,j=a._9o;delete a._11o,delete a._9o,a._21o.each(function(b){var i,j,k=a._20o[b],l=k.content,m=a._10o===b;vd(a)?(Le(k.div,c,0,g,f),i=a.initCanvas(k.canvas,g,f),Fe(i,0,f),Ge(i,-O),a.drawTitle(i,b,f,g,k),i.restore(),m?(j=E(0,e-h),l&&(a._11o=l,a._9o=Ke(l),Le(l,c+g,0,j,f)),c+=g+j):c+=g):(Le(k.div,0,d,e,g),i=a.initCanvas(k.canvas,e,g),a.drawTitle(i,b,e,g,k),i.restore(),m?(j=E(0,f-h),l&&(a._11o=l,a._9o=Ke(l),Le(l,0,d+g,e,j)),d+=g+j):d+=g)});var k=a._9o;i&&i!==a._11o&&i.endEditing&&i.endEditing(),k&&k!==j&&ve(b,k),j&&j!==k&&fi(j)}}),yq.SplitView=function(a,b,c,d){var e=this,f=e._dividerDiv=qe(),g=e._60O=re(),h=e._61O=re(),j=g.style,k=h.style;e._view=pe(1,e),ve(e._view,f),j.msTouchAction=pc,j.pointerEvents=pc,j.cursor=oc,k.msTouchAction=pc,k.pointerEvents=pc,k.cursor=oc,a&&e.setLeftView(a),b&&e.setRightView(b),c&&e.setOrientation(c),d!=i&&e.setPosition(d),e.setStatus(Ia),new Dq(e)},zq("SplitView",b,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:l.splitViewDividerSize,_dividerBackground:l.splitViewDividerBackground,_dragOpacity:l.splitViewDragOpacity,_toggleIcon:l.splitViewToggleIcon,onPropertyChanged:function(a){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(a,b){var c=this,d=c._position;isNaN(a)||(b||(0>a?c._82O=-1:a>1?c._82O=1:c._82O=0),c._position=a,c.fp(Lb,d,a))},getLeftView:function(){return this._leftView},setLeftView:function(a){var b=this,c=b._leftView,d=b._view;if(b._leftView!==a){if(c&&c!==b._rightView){var e=Ke(c);e.parentNode===d&&fi(e)}if(b._leftView=a,a){var f=Ke(a);f.parentNode!==d&&d.insertBefore(f,b._dividerDiv)}b.fp("leftView",c,a)}},getRightView:function(){return this._rightView},setRightView:function(a){var b=this,c=b._rightView,d=b._view;if(b._rightView!==a){if(c&&c!==b._leftView){var e=Ke(c);e.parentNode===d&&fi(e)}if(b._rightView=a,a){var f=Ke(a);f.parentNode!==d&&d.insertBefore(f,b._dividerDiv)}b.fp("rightView",c,a)}},validateImpl:function(){var a=this,b=a._draggable,c=a._position,d=a.getWidth(),e=a.getHeight(),f=a._dividerSize,g=a._dividerBackground,h=ia?18:8,i=a._dividerDiv,j=a._82O,k=a._60O,l=a._61O,m=a._toggleIcon,n=a._status,o=i.style,p=null,q=ia?20:4,r=m.comps[0];f>=h||0===f?a._coverDiv&&(fi(a._coverDiv),delete a._coverDiv):a._coverDiv||(a._coverDiv=qe(),da&&(a._coverDiv.style.background=dc),ve(i,a._coverDiv)),a._togglable?k.parentNode||(ve(i,k),ve(i,l)):(fi(k),fi(l));var s=a._coverDiv,t=a._leftView,u=a._rightView;if(vd(a)){if(f>d&&(f=d),n===Ia)if(1===j)var v=F(c,d),w=E(0,d-f-v);else-1===j?(w=F(-c,d),v=E(0,d-f-w)):(v=A((d-f)*c),w=E(0,d-f-v));else"cl"===n?(v=0,w=E(0,d-f)):"cr"===n&&(w=0,v=E(0,d-f));t&&Le(t,0,0,v,e),u&&Le(u,v+f,0,w,e),Le(i,v,0,f,e),a._22o=v,s&&(Le(s,f/2-h/2,0,h,e),s.style.cursor=b?mc:""),i.style.cursor=b?mc:"";var x=i.clientHeight/2,y=i.clientWidth;ue(k,y,y),Le(k,0,x-y-q,y,y),p=De(k),Ee(p,0,0,1),r.rotation=-O,aj(p,m,0,0,y,y),p.restore(),ue(l,y,y),Le(l,0,x+q,y,y),p=De(l),Ee(p,0,0,1),r.rotation=O,aj(p,m,0,0,y,y),p.restore()}else{if(f>e&&(f=e),n===Ia)if(1===j)var z=F(c,e),B=E(0,e-f-z);else-1===j?(B=F(-c,e),z=E(0,e-f-B)):(z=A((e-f)*c),B=E(0,e-f-z));else"cl"===n?(z=0,B=E(0,e-f)):"cr"===n&&(B=0,z=E(0,e-f));t&&Le(t,0,0,d,z),u&&Le(u,0,z+f,d,B),Le(i,0,z,d,f),a._22o=z,s&&(Le(s,0,f/2-h/2,d,h),s.style.cursor=b?nc:""),o.cursor=b?nc:"";var C=i.clientWidth/2,y=i.clientHeight;ue(k,y,y),Le(k,C-y-q,0,y,y),p=De(k),Ee(p,0,0,1),r.rotation=0,aj(p,m,0,0,y,y),p.restore(),ue(l,y,y),Le(l,C+q,0,y,y),p=De(l),Ee(p,0,0,1),r.rotation=M,aj(p,m,0,0,y,y),p.restore()}o.background=g}});var Dq=function(a){this.sv=a,this.addListeners()};ki(Dq,b,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(a){var b=this,c=b.sv,d=c._dividerDiv,e=c._60O,f=c._61O,g=c._status,h=a.target;if(h===e)g===Ia?c.setStatus("cl"):"cr"===g&&c.setStatus(Ia);else if(h===f)g===Ia?c.setStatus("cr"):"cl"===g&&c.setStatus(Ia);else if(Ue(a)&&(h===d||h===c._coverDiv)&&(wh(a),c.isDraggable())){var i=(c.getLeftView(),c.getRightView(),b.maskDiv=qe());if(i.style.left=0,i.style.top=0,i.style.width=c.getWidth()+"px",i.style.height=c.getHeight()+"px",c.getView().appendChild(i),!c.isContinuousLayout()){var j=b.resizeDiv=qe();j.style.left=d.style.left,j.style.top=d.style.top,j.style.width=d.style.width,j.style.height=d.style.height,j.style.opacity=c.getDragOpacity(),j.style.background=c.getDividerBackground(),ve(b.getView(),j)}b._lastAbsPosition=c._22o,b._86o=vd(c)?Th(a).x:Th(a).y,ei(b,a)}},handleWindowTouchMove:function(a){Ue(a)&&this.update(a,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(a){var b=this;b.update(a,!0),b.sv.setStatus(Ia),b.maskDiv&&fi(b.maskDiv),b.resizeDiv&&fi(b.resizeDiv),b.maskDiv=b.resizeDiv=i},handle_mousedown:function(a){Nh(a)&&this.handle_touchstart(a)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},update:function(a,b){var c=this,d=c.sv,e=vd(d)?d.getWidth():d.getHeight(),f=d._dividerSize,g=c._lastAbsPosition-c._86o;vd(d)?(g+=Th(a).x,g>e-f&&(g=e-f),0>g&&(g=0),c.resizeDiv&&(c.resizeDiv.style.left=g+za)):(g+=Th(a).y,g>e-f&&(g=e-f),0>g&&(g=0),c.resizeDiv&&(c.resizeDiv.style.top=g+za)),b&&e!==f&&(1===d._82O?d.setPosition(g,1):-1===d._82O?d.setPosition(g-e+f,1):d.setPosition(g/(e-f),1));
}}),yq.TabView=function(){var a=this,b=a._view=pe(1,a),c=a._91O=qe(1),d=a._tabModel=new fj,e=d.sm(),f=a.invalidate;a._7o=new bj,a._canvas=re(c),ve(b,c),ve(b,a._92O=qe(1)),e.setSelectionMode(ka),e.ms(a.handleSelectionChange,a),d.mm(f,a),d.mh(f,a),d.md(f,a),a._interactor=new Eq(a),a.iv()},zq("TabView",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",bb,ab,"tabHPadding","tabBackground","selectWidth",qb,"moveBackground","insertColor"],_tabHPadding:0,_tabPosition:qa,_tabHeight:kh,_tabGap:l.tabViewTabGap,_labelColor:l.tabViewLabelColor,_labelFont:l.tabViewLabelFont,_tabBackground:l.tabViewTabBackground,_selectWidth:l.tabViewSelectWidth,_selectBackground:l.tabViewSelectBackground,_moveBackground:l.tabViewMoveBackground,_insertColor:l.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(a,b,c){var d,e=this._tabModel;return a instanceof Aq?(d=a,b&&d.setView(b)):(d=new Aq,d.setName(a),d.setView(b)),e.add(d),c&&e.sm().ss(d),d},getLabel:function(a){return a.toLabel()},onPropertyChanged:function(a){this.iv()},_7Q:function(a){this._23o=a,this.iv()},get:function(a){var b=this,c=b._tabModel;if(Dd(a))return c._roots.get(a);if(Cd(a)){var d;return c.each(function(c){a===b.getLabel(c)&&(d=c)}),d}return a instanceof Aq?a:i},select:function(a){this._tabModel.sm().ss(this.get(a))},remove:function(a){var b=this;if(a=b.get(a)){var c=b._tabModel,d=c._roots.indexOf(a);b._tabModel.remove(a),b.selectByIndex(--d)}},getCurrentTab:function(){return this._8o},hideTabView:function(a,b){b.parentNode===this._92O&&(Pd(b)?(b.style.display=ya,b._tab_=a):fi(b),ah())},showTabView:function(a,b){Pd(b)&&(b.style.display="block",b._tab_=a),b.parentNode!==this._92O&&(ve(this._92O,b),ah())},_24o:function(){var a,b=this,c=b._8o,d=b._9o,e=b._tabModel.sm().ld();e&&(a=Ke(e.getView())),a!==d&&(d&&(c.getView()&&c.getView().endEditing&&c.getView().endEditing(),b.hideTabView(c,d)),a&&b.showTabView(e,a)),b._8o=e,b._9o=a,c!==e&&b.onTabChanged(c,e)},onTabClosing:function(a){return!0},onTabChanged:function(a,b){},onTabClosed:function(a,b){this.selectByIndex(--b)},selectByIndex:function(a){var b=this,c=b._tabModel,d=c.size();if(d&&!c.sm().ld()){a==i&&(a=0),a>=d&&(a=d-1),0>a&&(a=0);for(var e=a;e>=0;e--){var f=b.get(e);if(!f.isDisabled())return b.select(f),f}for(e=a+1;d>e;e++)if(f=b.get(e),!f.isDisabled())return b.select(f),f}},getTabWidth:function(a){var b=this.getTabHPadding(),c=4+2*b,d=yh(a.getIcon());d&&(c+=Zi(d,a)+4);var e=this.getLabel(a);return e&&(c+=Mh(this.getLabelFont(a),e).width+4),a.isClosable()&&(c+=10),c},drawTab:function(a,b,c,d,e,f,g){var h,i=this,j=i._tabPosition,k=this.getTabHPadding(),l=c+4+k,m=i._selectWidth,n=yh(b.getIcon()),o=b.isDisabled(),p=i.getLabelColor(b),q=i.getLabelFont(b),r=i.getLabel(b),s=i._selectBackground,t=j===oa+"-vertical",u=j===pa+"-vertical";(t||u)&&(l=d+4+k),o&&(a.globalAlpha=Vg),Df(a,c,d,e,f,g),b===i._8o&&m&&(j===qa?Df(a,c,d+f-m,e,m,s):j===oa?Df(a,c+e-m,d,m,f,s):j===pa?Df(a,c,d,m,f,s):t?Df(a,c+e-m,d,m,f,s):u?Df(a,c,d,m,f,s):Df(a,c,d,e,m,s));var v=e/2;if(t&&(Fe(a,v,d+f/2),Ge(a,M),Fe(a,-v,-d-f/2)),n){var w=$i(n,b),x=Zi(n,b);if(t||u){var y=c+e/2,z=l+w/2;Fe(a,y,z),Ge(a,O),Fe(a,-y,-z),Ah(a,n,c+e/2,l+w/2,b,i),Fe(a,y,z),Ge(a,-O),Fe(a,-y,-z),l+=w+4}else Ah(a,n,l+x/2,d+f/2,b,i),l+=x+4}return t||u?(Fe(a,e/2,l+e/2),Ge(a,O),Fe(a,-e/2,-l-e/2),Lh(a,r,q,p,c,l,f,e),Fe(a,e/2,l+e/2),Ge(a,-O),Fe(a,-e/2,-l-e/2)):Lh(a,r,q,p,l,d,e,f),t&&(Fe(a,v,d+f/2),Ge(a,-M),Fe(a,-v,-d-f/2)),b.isClosable()&&(h=u?{x:c+e-12,y:d+f-12,width:12,height:12}:{x:c+e-12,y:d+2,width:12,height:12},this.drawCloseIcon(b,a,p,h)),o&&(a.globalAlpha=1),h},drawCloseIcon:function(a,b,c,d){var e=d.x,f=d.y;b.strokeStyle=c,b.lineWidth=1,b.beginPath(),b.moveTo(e+2,f+8),b.lineTo(e+8,f+2),b.moveTo(e+8,f+8),b.lineTo(e+2,f+2),b.stroke()},getTabAt:function(a){var b=this._interactor._8Q(a);return b?b.tab:null},validateImpl:function(){var a=this;a._24o();var b,c=a._canvas,d=a._tabPosition,e=a._91O,f=a._92O,g=a._tabModel,h=a.getWidth(),i=a.getHeight(),j=a._tabHeight,k=a._7o,l=a._tabGap,m=d===qa,n=d===oa,o=d===pa,p=d===oa+"-vertical",q=d===pa+"-vertical",r=a._23o,s=0;if((n||o)&&g._roots.each(function(b){s=E(a.getTabWidth(b),s)}),m?(Le(e,0,0,h,j),b={x:0,y:j,width:h,height:E(0,i-j)}):n?(Le(e,0,0,s,i),b={x:s,y:0,width:E(0,h-s),height:i}):o?(Le(e,h-s,0,s,i),b={x:0,y:0,width:E(0,h-s),height:i}):p?(Le(e,0,0,j,i),b={x:j,y:0,width:E(0,h-j),height:i}):q?(Le(e,h-j,0,j,i),b={x:0,y:0,width:E(0,h-j),height:i}):(Le(e,0,i-j,h,j),b={x:0,y:0,width:h,height:E(0,i-j)}),Le(f,b),p||q){a._9o&&(b.x=0,Le(a._8o.getView(),b)),ue(c,j,i);var t=De(c),u=0;if(Ee(t,0,a.ty(),1),t.clearRect(0,0,j,i),k.clear(),g._roots.each(function(b){if(b.isVisible()){var c,d=a.getTabWidth(b);r&&r.tab===b||(c=a.drawTab(t,b,0,u,j,d,a._tabBackground)),k.add({_75o:c,tab:b,startY:u,endY:u+d,height:d}),u+=d+l}}),a._23Q=E(0,u-l),r){var v=r.position;a.drawTab(t,r.tab,0,r.startY,j,r.height,a._moveBackground),Df(t,0,v,j,1,a._insertColor)}if(t.restore(),a._selectionChanged){a._selectionChanged=!1;for(var w=a.ty(),x=0;x<k.size();x++){var y=k.get(x);if(y.tab===a._8o){if(y.endY+w<0){a.ty(-y.startY);break}if(y.startY+w>i){a.ty(i-y.endY);break}}}}a.ty(a.ty())}else if(n||o){a._9o&&(b.x=0,Le(a._8o.getView(),b)),ue(c,s,i);var t=De(c),u=0;if(Ee(t,0,a.ty(),1),t.clearRect(0,0,s,i),k.clear(),g._roots.each(function(b){if(b.isVisible()){var c;r&&r.tab===b||(c=a.drawTab(t,b,0,u,s,j,a._tabBackground)),k.add({_75o:c,tab:b,startY:u,endY:u+j,height:j}),u+=j+l}}),a._23Q=E(0,u-l),r){var v=r.position;a.drawTab(t,r.tab,0,r.startY,s,r.height,a._moveBackground),Df(t,0,v,s,1,a._insertColor)}if(t.restore(),a._selectionChanged){a._selectionChanged=!1;for(var w=a.ty(),x=0;x<k.size();x++){var y=k.get(x);if(y.tab===a._8o){if(y.endY+w<0){a.ty(-y.startY);break}if(y.startY+w>i){a.ty(i-y.endY);break}}}}a.ty(a.ty())}else{a._9o&&(b.y=0,Le(a._8o.getView(),b)),ue(c,h,j);var t=De(c),z=0;if(Ee(t,a.tx(),0,1),t.clearRect(0,0,h,j),k.clear(),g._roots.each(function(b){if(b.isVisible()){var c,d=a.getTabWidth(b);r&&r.tab===b||(c=a.drawTab(t,b,z,0,d,j,a._tabBackground)),k.add({_75o:c,tab:b,startX:z,endX:z+d,width:d}),z+=d+l}}),a._64I=E(0,z-l),r){var v=r.position;a.drawTab(t,r.tab,r.startX,0,r.width,j,a._moveBackground),ge(t,a._insertColor,v,0,j)}if(t.restore(),a._selectionChanged){a._selectionChanged=!1;for(var A=a.tx(),x=0;x<k.size();x++){var y=k.get(x);if(y.tab===a._8o){if(y.endX+A<0){a.tx(-y.startX);break}if(y.startX+A>h){a.tx(h-y.endX);break}}}}a.tx(a.tx())}for(var B=[],C=f.children,x=0;x<C.length;x++){var D=C[x],F=D._tab_;F&&!g.contains(F)&&B.push(D)}B.forEach(function(a){f.removeChild(a)})}});var Eq=function(a){this.tv=a,this.addListeners()};ki(Eq,b,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(a){this.handleScroll(a,a.wheelDelta/40*10)},handle_DOMMouseScroll:function(a){this.handleScroll(a,10*-a.detail)},handleScroll:function(a,b){wh(a);var c=this.tv,d=c._tabPosition;!c._40o()||d!==qa&&d!==ra||c.tx(this.tv.tx()+b),!c._41o()||d!==oa&&d!==pa&&d!==oa+"-vertical"&&d!==pa+"-vertical"||c.ty(this.tv.ty()+b)},_8Q:function(a){var b,c,d=this.tv,e=d._tabPosition,f=d._7o;if(e===qa||e===ra){var g=d.lp(a).x;for(b=0;b<f.size();b++)if(c=f.get(b),c.startX<=g&&g<=c.endX)return c}else if(e===oa||e===pa||e===oa+"-vertical"||e===pa+"-vertical"){var h=d.lp(a).y;for(b=0;b<f.size();b++)if(c=f.get(b),c.startY<=h&&h<=c.endY)return c}return i},isClickable:function(a){var b=this.tv,c=b._tabPosition,d=this._73o=this._8Q(a);return b._40o()&&(c===qa||c===ra)||b._41o()&&(c===oa||c===pa||c===oa+"-vertical"||c===pa+"-vertical")?!0:d&&(!d.tab.isDisabled()||b.isMovable())},handle_mousemove:function(a){var b=this;Pe?b._74o=b._8Q(a):b.getView().style.cursor=b.isClickable(a)?oc:""},handle_mousedown:function(a){this.handle_mousemove(a),this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.tv,d=c._tabPosition;wh(a),Nh(a)&&b.isClickable(a)&&(d===qa||d===ra?(b.x=Th(a).x,b.lp=c.lp(a),b.tx=c.tx()):(b.y=Th(a).y,b.lp=c.lp(a),b.ty=c.ty()),ei(b,a))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b,c=this,d=c.tv,e=d._tabPosition,f=c._73o;if(e===qa||e===ra){if(b=Th(a).x-c.x,!c._25o&&!c.moving&&G(b)>2&&(d._40o()&&!Sh(a)?c._25o=1:f&&d.isMovable()&&(c.moving=1)),c._25o)d.tx(c.tx+b);else if(c.moving){var g=c.lp.x+b,h=d._tabGap/2;d._7o.each(function(a){var c=a.endX,e=g-a.startX<c-g;g>=a.startX&&c>=g&&d._7Q({tab:f.tab,startX:f.startX+b,width:f.width,front:e,insertTab:a.tab,position:e?E(0,a.startX-h):F(d._64I,c+h)})})}}else if(b=Th(a).y-c.y,!c._25o&&!c.moving&&G(b)>2&&(d._41o()&&!Sh(a)?c._25o=1:f&&d.isMovable()&&(c.moving=1)),c._25o)d.ty(c.ty+b);else if(c.moving){var i=c.lp.y+b,h=d._tabGap/2;d._7o.each(function(a){var c=a.endY,e=i-a.startY<c-i;i>=a.startY&&c>=i&&d._7Q({tab:f.tab,startY:f.startY+b,height:f.height,front:e,insertTab:a.tab,position:e?E(0,a.startY-h):F(d._23Q,c+h)})})}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b.tv,d=c._tabPosition,e=c.getTabModel(),f=e._roots,g=b._73o;if(b.moving){var h=c._23o;if(h&&h.insertTab!==h.tab){var j=h.tab,k=f.remove(j),l=f.indexOf(h.insertTab);l>=0&&(h.front||l++,l<=f.size()&&(f.add(j,l),e._38I(j,k,l)))}c._7Q(i),delete b.moving}else if(!b._25o&&g){j=g.tab;var m=b._74o;if(!m||m.tab===j)if(!j.isDisabled()&&Yh(g._75o,b.lp)){var n=function(){var a=f.indexOf(j);e.remove(j),c.onTabClosed(j,a)};c.onTabClosing(j,n)&&n()}else j.isDisabled()||c._8o===j||e.sm().ss(j)}d===qa||d===ra?b._25o=b._73o=b._74o=b.x=b.lp=b.tx=i:b._25o=b._73o=b._74o=b.y=b.lp=b.ty=i}}),yq.PropertyView=function(a){var b=this;b._view=pe(1,b),b._canvas=re(b._view),ve(b._view,b._79O=qe()),b._rows=new bj,b._28o=new bj,b._26o={},b._26Q={};var c=b._propertyModel=new fj,d=b.ivm;c.mm(d,b),c.md(d,b),c.mh(d,b),b.dm(a?a:new fj),new Fq(b)},zq("PropertyView",b,{ms_ac:[bb,cb,ab,Gb,Hb,"categorizable",vb,Fb,Bb,Cb,Db,tb,ub,sb,"selectRowIndex",qb,"background",wb,Ab,yb,zb,xb],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:id,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:hh,_background:l.propertyViewBackground,_expandIcon:l.propertyViewExpandIcon,_collapseIcon:l.propertyViewCollapseIcon,_scrollBarColor:lh,_scrollBarSize:mh,_autoHideScrollBar:Zg,_selectBackground:l.propertyViewSelectBackground,_rowHeight:ih,_rowLineVisible:l.propertyViewRowLineVisible,_rowLineColor:l.propertyViewRowLineColor,_10I:.5,_columnLineVisible:l.propertyViewColumnLineVisible,_columnLineColor:l.propertyViewColumnLineColor,_labelColor:l.propertyViewLabelColor,_labelSelectColor:l.propertyViewLabelSelectColor,_labelFont:l.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(a){0>a&&(a=0),a>1&&(a=1);var b=this,c=b._10I;b._10I=a,b.fp("columnPosition",c,a)},getPropertyName:function(a){return a.toLabel()},getLabelFont:function(a,b,c){return this._labelFont},getLabelColor:function(a,b,c){return c===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(a,b){return this._labelFont},getPropertyColor:function(a,b){return b===this._selectRowIndex?this._labelSelectColor:a.getColor()||this._labelColor},getCategoryFont:function(a){return this._labelFont},getCategoryColor:function(a){return this._labelColor},adjustTranslateX:function(a){return 0},adjustTranslateY:function(a){var b=this.getHeight()-this._59I;return b>a&&(a=b),a>0?0:A(a)},isExpanded:function(a){if(!a)return!0;var b=this._26o[a];return b?b.isExpanded:!(this._26Q[a]===!1)},toggle:function(a){var b=this;b.isExpanded(a)?b.collapse(a):b.expand(a)},expandAll:function(){this.validate();for(var a in this._26o)this.expand(a)},expand:function(a){if(a&&a!==ya){var b=this,c=b._26o[a];c&&!c.isExpanded&&(c.isExpanded=!0,b.onExpanded(a),b.ivm())}},onExpanded:function(a){},collapseAll:function(){this.validate();for(var a in this._26o)this.collapse(a)},collapse:function(a){if(a&&a!==ya){var b=this,c=b._26o[a];c&&c.isExpanded&&(c.isExpanded=!1,b.onCollapsed(a),b.ivm())}},onCollapsed:function(a){},getCategoryName:function(a){if(!this.isCategorizable())return ya;var b=a.getCategoryName();return b?b:ya},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(a){var b=this,c=b._dataModel;c!==a&&(c&&(c.umd(b.handlePropertyChange,b),b._selectionModel||c.sm().ums(b.handleSelectionChange,b)),b._dataModel=a,a.md(b.handlePropertyChange,b),b._selectionModel?b._selectionModel._21I(a):a.sm().ms(b.handleSelectionChange,b),b.fp(Qb,c,a))},isVisible:function(a){return this._visibleFunc?this._visibleFunc(a):!0},onPropertyChanged:function(a){var b=this,c=a.property;tq[c]?b.ivm():b.iv(),c===Pb&&b._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:cj},handlePropertyChange:function(a){this._27o===a.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var a=this;a._96I||(a.setSelectRowIndex(-1),a._96I=1,a.iv())},redraw:function(){this.iv()},validateModel:function(){var a=this,b=a._rows,d=a._28o,e={},f=new bj,g=a._27o;a.updateCurrentData(),g!==a._27o&&a.endEditing(),b.clear(),d.clear(),a.getRawProperties().each(function(b){if(a.isVisible(b)){f.add(b);var g=a.getCategoryName(b);e[g]||(d.add(g,g===ya?0:c),e[g]={isExpanded:a.isExpanded(g),properties:new bj})}}),a._sortFunc&&f.sort(a._sortFunc);for(var h in a._26o)a._26Q[h]=a.isExpanded(h);a._26o=e,d.each(function(c){c!==ya&&b.add(c);var d=e[c];d.isExpanded&&f.each(function(e){a.getCategoryName(e)===c&&(d.properties.add(e),b.add({property:e,data:a._27o}))},a)})},validateImpl:function(){var a=this;a._76o(),a._96I&&(a.validateModel(),delete a._96I);var b=a._canvas,c=a.getWidth(),d=a.getHeight(),e=-a.ty(),f=a._rowHeight,g=a._indent,h=c-g,j=a._rows,k=j.size(),l=a._9I=g+h*a._10I,m=a._59I=k*f;ue(b,c,d),a._29I={x:0,y:e,width:c,height:d},a._31I=B(e/f),a._14I=C((e+d)/f),a._31I<0&&(a._31I=0),a._14I>k&&(a._14I=k);var n,o=De(b),p=a._background;Ee(o,0,-e,1),o.beginPath(),o.rect(0,e,c,d),o.clip(),o.clearRect(0,e,c,d),a._93db(o),p&&Df(o,0,0,g,m,p);for(var q=a._31I;q<a._14I;q++){var r=j.get(q),e=f*q;if(Cd(r))p&&Df(o,g,e,h,f,p),n=yh(a.isExpanded(r)?a._expandIcon:a._collapseIcon),n&&Bh(o,n,bc,0,e,g,f),o.save(),o.beginPath(),o.rect(g,e,h,f),o.clip(),a.drawCategoryName(o,r,q,g,e,h,f),o.restore();else{var s=r.property,t=r.data,n=yh(s.getIcon()),u=a._selectRowIndex===q?a.getSelectBackground():i;if(n&&Bh(o,n,bc,0,e,g,f),u&&Df(o,g,e,h,f,u),o.save(),o.beginPath(),o.rect(g,e,l-g,f),o.clip(),a.drawPropertyName(o,s,q,g,e,l-g,f),o.restore(),!a.isEditing(t,s)){var v=l+1,w=c-l-1;o.save(),o.beginPath(),o.rect(v,e,w,f),o.clip(),a._87o(a.drawPropertyValue(o,s,a.getValue(t,s),q,v,e,w,f,t),q,v,e,w,f),o.restore()}}a._rowLineVisible&&Df(o,g,e+f-1,h,1,a._rowLineColor)}a._columnLineVisible&&(Df(o,l,0,1,m,a._columnLineColor),Df(o,c-1,0,1,m)),a._92db(o),a._93I(),o.restore(),a.ty(a.ty())},drawCategoryName:function(a,b,c,d,e,f,g){Lh(a,b,this.getCategoryFont(b),this.getCategoryColor(b),d,e,f,g)},drawPropertyName:function(a,b,c,d,e,f,g){return b.drawPropertyName?void b.drawPropertyName(a,b,c,d,e,f,g,this):void Lh(a,this.getPropertyName(b),this.getPropertyFont(b,c),this.getPropertyColor(b,c),d,e,f,g)},drawPropertyValue:function(a,b,c,d,e,f,g,h,i){return b.drawPropertyValue?b.drawPropertyValue(a,b,c,d,e,f,g,h,i,this):void vq(a,c,b,this.getLabelFont(b,c,d),this.getLabelColor(b,c,d),e,f,g,h,i,this)},isPropertyEditable:function(a,b){return a.isEditable()&&this.isEditable()},setProperties:function(a){this._propertyModel.clear(),this.addProperties(a)},addProperties:function(a){if(a){var b=this._propertyModel;a.forEach(function(a){if(!(a instanceof Cq)){var c=Hh(a.className);a=vh(c?c:Cq,a)}b.add(a)})}},getRowIndexAt:function(a){var b=this,c=B(b.lp(a).y/b._rowHeight);return c>=0&&c<b._rows.size()?c:-1},getPropertyAt:function(a){var b=this,c=b.getRowIndexAt(a);return c>=0?b._rows.get(c).property:i},getToolTip:function(a){var b=this,c=b.getPropertyAt(a),d=b._27o;return c&&d?c.getToolTip(d,b._9I<b.lp(a).x,b):i}});var Fq=function(a){this.pv=a,this.addListeners()};ki(Fq,b,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(a){this.getView().style.cursor=a},clear:function(){var a=this;a._62O=a.cp=a.ty=a.p=i,a.setCursor(ja)},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.pv;wh(a),c.setFocus(a)&&(Nh(a)?(b.cp=Th(a),b.ty=c.ty(),b.p=c.getColumnPosition(),b.handle_touchmove(a)):c.setSelectRowIndex(c.getRowIndexAt(a)))},handleWindowMouseUp:function(a){this.clear()},handleWindowTouchEnd:function(a){this.clear()},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){var b=this;if(b.cp&&!b._62O){var c=b.pv,d=c.lp(a),e=d.x,f=d.y,g=c._indent,h=c.getRowIndexAt(a),i=c._9I;if(h>=0){var j=c._rowHeight,k=j*h,l=c._rows.get(h),m=l.property;if(Cd(l))yh(c.isExpanded(l)?c._expandIcon:c._collapseIcon)&&e>=0&&g>=e&&f>=k&&k+j>=f?c.toggle(l):Qh(a)&&c.toggle(l);else if(e>i&&c.isPropertyEditable(m,a)){var n={x:i+1,y:k,width:c.getWidth()-i-1,height:j},o={x:n.x+c.tx(),y:n.y+c.ty(),width:n.width,height:n.height},p=0,q=c._29I;n.y<q.y?p=n.y-q.y:n.y+j>q.y+q.height&&(p=n.y+j-q.y-q.height),p&&(c.ty(c.ty()-p),o.y-=p),c.beginEditing({data:l.data,property:m,value:c.getValue(l.data,m),event:a,rect:n,editorRect:o,view:c})}}c.setSelectRowIndex(h)}b.clear()},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.pv,d=b.ty,e=b.cp,f=Th(a),g=b._62O;if("p"===g)c.setTranslateY(d+f.y-e.y);else if("c"===g){var h=c.getWidth()-c._indent;if(h>16){var i=b.p-(e.x-f.x)/h,j=16/h;j>i&&(i=j),i>1-j&&(i=1-j),c.setColumnPosition(i)}}else"s"===g&&c.setTranslateY(d+(e.y-f.y)*c._59I/c._29I.height)},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(a){if(!Pe&&Nh(a)){var b=this,c=b.pv,d=G(c.lp(a).x-c._9I)<=(ia?8:3);b.cp?b._62O||(d?(b._62O="c",ei(b)):G(Th(a).y-b.cp.y)>=2&&(b._62O=b.isV(a)?"s":"p",ei(b))):(d?b.setCursor(mc):b.setCursor(ja),b.isV(a)&&c._43o())}},isV:function(a){var b=this.pv,c=b._29I;return b._41o()&&c.x+c.width-b.lp(a).x<ph},handle_mousewheel:function(a){this.handleScroll(a,a.wheelDelta/40)},handle_DOMMouseScroll:function(a){2===a.axis&&this.handleScroll(a,-a.detail)},handleScroll:function(a,b){var c=this.pv;wh(a),c.endEditing(),c.translate(0,b*c.getRowHeight())},handle_keydown:function(a){var b=this.pv,c=b._rows.size(),d=b._selectRowIndex+(ef(a)?-1:1);(ef(a)||gf(a))&&(0>d&&(d=0),d>=c&&(d=c-1),b.setSelectRowIndex(d))}}),yq.ListView=function(a){this._5o(a),new Gq(this)},zq("ListView",b,{ms_ac:[bb,cb,ab,wb,vb,Ab,yb,Fb,Bb,tb,ub,sb,rb,qb],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:hh,_rowHeight:ih,_rowLineVisible:l.listViewRowLineVisible,_rowLineColor:l.listViewRowLineColor,_scrollBarColor:lh,_scrollBarSize:mh,_autoMakeVisible:Yg,_autoHideScrollBar:Zg,_selectBackground:l.listViewSelectBackground,_labelColor:l.listViewLabelColor,_labelSelectColor:l.listViewLabelSelectColor,_labelFont:l.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(a){var b=this,c=b._checkMode;b._checkMode=a,b.fp(Eb,c,a)},drawRow:function(a,b,c,d,e,f,g){var h=this,i=0,j=h._indent,k=h.getIconWidth(b);h.drawRowBackground(a,b,c,d,e,f,g),h._checkMode&&(Ah(a,yh(h.getCheckIcon(b)),i+j/2,e+g/2,b,h),i+=j),h.drawIcon(a,b,i,e,k,g),h.drawLabel(a,b,i+k,e,g)}});var Gq=function(a){this.list=a,this._lastSelectDataTime=qd(),this.addListeners()};ki(Gq,b,{ms_listener:1,getView:function(){return this.list._view},clear:function(a){var b=this,c=b.list;a&&"d"===b._62O&&!b.dragCancel&&c.handleDragAndDrop(a,"end"),c.draggingData&&(c.draggingData=null,c.redraw()),b.dragCancel=b._62O=b._isV=b._isH=b.cp=b.tx=b.ty=i},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.list;if(wh(a),c.setFocus(a)){var d=c.getDataAt(a);b.cp=Th(a),b.tx=c.tx(),b.ty=c.ty(),Nh(a)?d&&c.handleDragAndDrop&&!b.isV(a)&&!b.isH(a)&&(c.draggingData=d,c.redraw(),c.handleDragAndDrop(a,"prepare")):(d&&b._33o(a,d),b.clear(a))}},handleWindowMouseUp:function(a){this.clear(a)},handleWindowTouchEnd:function(a){this.clear(a)},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(a){var b=this,c=b.list;if(!b._isV&&!b._isH&&b.cp&&!b._62O){var d=c.getDataAt(a);d?(c.isCheckMode()?b._34o(a,d):b._33o(a,d),Qh(a)?c.onDataDoubleClicked(d,a):c.onDataClicked(d,a)):c.handleBackgroundClick(a)}b.clear(a)},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.list,d=b._62O,e=b.tx,f=b.ty,g=b.cp,h=Th(a),i=c._29I;"p"===d?c.setTranslate(e+h.x-g.x,f+h.y-g.y):"v"===d?c.ty(f+(g.y-h.y)*c._59I/i.height):"h"===d?c.tx(e+(g.x-h.x)*c._91I/i.width):"d"===d&&(b.dragCancel||c.handleDragAndDrop(a,"between"))},handle_mousemove:function(a){this.handle_touchmove(a)},handle_touchmove:function(a){if(!Pe&&Nh(a)){var b=this,c=b.list;if(b._isV=b.isV(a),b._isH=b.isH(a),b.cp){if(!b._62O){if(Vh(Th(a),b.cp)<2)return;b._isV?b._62O="v":b._isH?b._62O="h":c.draggingData&&!this.dragCancel?(b._62O="d",c.handleDragAndDrop(a,"begin")):b._62O="p",b._62O&&"d"!==b._62O&&c.draggingData&&(c.draggingData=null,c.redraw()),ei(b)}}else b._isV&&c._43o(),b._isH&&c._42o()}},isV:function(a){var b=this.list,c=b._29I;return b._41o()&&c.x+c.width-b.lp(a).x<ph},isH:function(a){var b=this.list,c=b._29I;return b._40o()&&c.y+c.height-b.lp(a).y<ph},handle_mousewheel:function(a){this.handleScroll(a,a.wheelDelta/40,a.wheelDelta!==a.wheelDeltaX)},handle_DOMMouseScroll:function(a){this.handleScroll(a,-a.detail,1)},handleScroll:function(a,b,c){var d=this.list;wh(a),d.endEditing&&d.endEditing(),c&&d._41o()?d.translate(0,b*d.getRowHeight()):d._40o()&&d.translate(10*b,0)},handle_keydown:function(a){if(!l.isInput(a.target)){var b,c=this.list,d=c.sm(),e=c._rows,f=e.size();if(We(a))c.selectAll();else if(Xe(a))c.handleDelete&&c.handleDelete(a);else if(kf(a))"d"!==this._62O||this.dragCancel||(c.handleDragAndDrop(a,"cancel"),this.dragCancel=!0);else if(hf(a))c.isCheckMode()&&(b=c.getFocusData(),b&&c.checkData(b));else if(ef(a)||gf(a)){var g=c.isCheckMode();if(b=g?c.getFocusData():d.ld()){var h=c.getRowIndex(b);h>=0&&(ef(a)?0!==h&&(b=e.get(h-1),g?c.setFocusData(b):d.ss(b)):h!==f-1&&(b=e.get(h+1),g?c.setFocusData(b):d.ss(b)))}else f>0&&(b=e.get(0),g?c.setFocusData(b):d.ss(b))}}},_34o:function(a,b){var c=this.list,d=c.lp(a).x;return d>=0&&d<=c._indent?void c.checkData(b):void c.setFocusData(b)},_33o:function(a,b){var c=this.list,d=c.sm(),e=d.ld();if(Sh(a))c.isSelected(b)?d.rs(b):d.as(b);else if(Rh(a))if(e)for(var f=c.getRowIndex(e),g=c.getRowIndex(b);f!==g;)f+=g>f?1:-1,d.as(c._rows.get(f));else d.ss(b);else if(Nh(a)){var h=qd();if(d.contains(b)){var i=h-this._lastSelectDataTime;c.handleDataDoubleSelect&&i>500&&1500>i&&c.handleDataDoubleSelect(a,b)}d.ss(b),this._lastSelectDataTime=h}else d.contains(b)||d.ss(b)}}),yq.TreeView=function(a){var b=this;b._35o(),b._5o(a),new Hq(b)},zq("TreeView",b,{ms_ac:[bb,cb,ab,"rootVisible",Eb,"rootData",Fb,Bb,tb,ub,sb,vb,wb,Ab,yb,Cb,Db,rb,qb,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:i,_indent:hh,_rowHeight:ih,_rowLineVisible:l.treeViewRowLineVisible,_rowLineColor:l.treeViewRowLineColor,_scrollBarColor:lh,_scrollBarSize:mh,_autoHideScrollBar:Zg,_expandIcon:l.treeViewExpandIcon,_collapseIcon:l.treeViewCollapseIcon,_autoMakeVisible:Yg,_selectBackground:l.treeViewSelectBackground,_labelColor:l.treeViewLabelColor,_labelSelectColor:l.treeViewLabelSelectColor,_labelFont:l.treeViewLabelFont,_doubleClickToToggle:l.treeViewDoubleClickToToggle,drawRow:function(a,b,c,d,e,f,g){var h=this;h.drawRowBackground(a,b,c,d,e,f,g),h._97I(a,b,c,0,e,f,g)},isOnToggleIcon:function(a){var b=this.getDataAt(a);if(b){var c=this.getIndent(),d=this.lp(a).x;if(yh(this.getToggleIcon(b))){var e=c*this.getLevel(b);if(d>=e&&e+c>=d)return!0}}return!1}});var Hq=function(a){Wd(Hq,this,[a])};ki(Hq,Gq,{toggle:function(a,b,c,d){var e=this.list,f=e.lp(a).x;if(yh(e.getToggleIcon(b))){var g=c*d;if(f>=g&&g+c>=f)return e.toggle(b),!0}return e.isDoubleClickToToggle()&&Qh(a)?(e.toggle(b),!0):!1},_34o:function(a,b){var c=this.list,d=c.lp(a).x,e=c._levelMap[b._id],f=c._indent,g=f*(e+1);return d>=g&&g+f>=d?void c.checkData(b):void(this.toggle(a,b,f,e)||c.setFocusData(b))},_33o:function(a,b){var c=this,d=c.list;if(!c.toggle(a,b,d._indent,d.getLevel(b)))if(Rh(a)){var e=d.sm();if(e.size()>0){for(var f=d._rows,g=null,h=0,i=f.size();i>h;h++)if(d.isSelected(f.get(h))){g=h;break}for(var j=null,h=f.size()-1;h>=0;h--)if(d.isSelected(f.get(h))){j=h;break}var k,l,m=d.getRowIndex(b);for(g>m?(k=m-1,l=g):m>j?(k=j,l=m):(k=g,l=j);k!==l;)k++,e.as(d._rows.get(k))}else e.ss(b)}else Hq.superClass._33o.call(c,a,b)},handle_keydown:function(a){if(df(a)||ff(a)){var b=this.list,c=b._rows,d=b.isCheckMode(),e=b.sm(),f=d?b.getFocusData():e.ld();f?f.hasChildren()&&(df(a)?b.collapse(f):b.expand(f)):c.size()>0&&(f=c.get(0),d?b.setFocusData(f):e.ss(f))}else Hq.superClass.handle_keydown.call(this,a)}});var Iq=yq.TableView=function(a){this._98I(),this._5o(a),new Jq(this)};zq("TableView",b,{ms_ac:[bb,cb,ab,"sortMode",Gb,Hb,wb,Ab,yb,zb,xb,"sortColumn",Fb,Bb,tb,ub,sb,rb,qb],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Ib,_editable:!0,_batchEditable:!1,_rowHeight:ih,_rowLineVisible:l.tableViewRowLineVisible,_rowLineColor:l.tableViewRowLineColor,_columnLineVisible:l.tableViewColumnLineVisible,_columnLineColor:l.tableViewColumnLineColor,_scrollBarColor:lh,_scrollBarSize:mh,_autoHideScrollBar:Zg,_autoMakeVisible:Yg,_selectBackground:l.tableViewSelectBackground,_labelColor:l.tableViewLabelColor,_labelSelectColor:l.tableViewLabelSelectColor,_labelFont:l.tableViewLabelFont,getCheckColumn:function(){var a=this;if(!a._31o){var b=a._31o=new Bq;b.setEditable(!0),b.setWidth(40),b.getValue=a.getCheckColumValue,b.drawCell=a.drawCheckColumnCell}return a._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(a){var b=this,c=b._39o,d=b.getCheckColumn();a!==b.isCheckMode()&&(a?c.add(d,0):c.remove(d),b.fp(Eb,!a,a))},getCheckColumValue:function(a,b,c){return c.isSelected(a)},drawCheckColumnCell:function(a,b,c,d,e,f,g,h,i){Ah(a,i.getCheckIcon(b),e+g/2,f+h/2,b,i)}});var Jq=function(a){Wd(Jq,this,[a])};ki(Jq,Gq,{_34o:function(a,b){var c=this.list,d=c._31o;if(c.isCellEditable(b,d,a)){var e=c._3Q(d),f=c.lp(a).x;if(e&&f>=e.startX&&f<e.startX+d.getWidth())return void c.checkData(b)}c._37O(b,a),c.setFocusData(b)},_33o:function(a,b){this.list._37O(b,a),Jq.superClass._33o.apply(this,arguments)}});var Kq=yq.TreeTableView=function(a){var b=this,c=b._4o=new Bq;b._35o(),b._98I(),b._5o(a),c.setDisplayName("Name"),c.setEditable(!0),c.setWidth(180),c.drawCell=Lq,c.getValue=Mq,b._39o.add(c),new Nq(b)},Lq=function(a,b,c,d,e,f,g,h,i){i._97I(a,b,c,e,f,g,h)},Mq=function(a,b,c){return c.getLabel(a)};zq("TreeTableView",b,{ms_ac:[bb,cb,ab,"sortMode",Gb,Hb,vb,Eb,"rootData","rootVisible",Fb,Bb,"sortColumn",Cb,Db,tb,ub,sb,rb,yb,wb,Ab,zb,xb,qb,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Ib,_checkMode:i,_editable:!0,_batchEditable:!1,_indent:hh,_rowHeight:ih,_rowLineVisible:l.treeTableViewRowLineVisible,_rowLineColor:l.treeTableViewRowLineColor,_columnLineVisible:l.treeTableViewColumnLineVisible,_columnLineColor:l.treeTableViewColumnLineColor,_expandIcon:l.treeTableViewExpandIcon,_collapseIcon:l.treeTableViewCollapseIcon,_scrollBarColor:lh,_scrollBarSize:mh,_autoHideScrollBar:Zg,_autoMakeVisible:Yg,_selectBackground:l.treeTableViewSelectBackground,_labelColor:l.treeTableViewLabelColor,_labelSelectColor:l.treeTableViewLabelSelectColor,_labelFont:l.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Nq=function(a){Wd(Nq,this,[a])};ki(Nq,Gq,{_34o:function(a,b){var c=this.list,d=c._4o,e=c._3Q(d),f=c.lp(a).x;if(e){var g=c._indent,h=e.startX+g*c.getLevel(b);if(yh(c.getToggleIcon(b))&&f>=h&&h+g>=f)return void c.toggle(b);if(c.isCellEditable(b,d)&&(h+=g,f>=h&&h+g>=f))return void c.checkData(b)}c._37O(b,a),c.setFocusData(b)},_33o:function(a,b){var c=this.list,d=c.lp(a).x;if(yh(c.getToggleIcon(b))){var e=c._3Q(c._4o);if(e){var f=c._indent,g=e.startX+f*c.getLevel(b);if(d>=g&&g+f>=d)return void c.toggle(b)}}c._37O(b,a),Nq.superClass._33o.apply(this,arguments)}});var Oq=yq.TableHeader=function(a){var b=this,c=b._view=pe(1,b),d=b._39o=a.getColumnModel(),e=b.iv;b.tv=b._tableView=a,b._60I=new bj,b._canvas=re(c),c.style.background=l.tableHeaderBackground||"",c.style.height=jh+za,d.mm(e,b),d.md(e,b),d.mh(e,b),a.mp(function(a){pq[a.property]&&b.iv()},b),new Pq(b),b.iv()};zq("TableHeader",b,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",bb,ab,vb,"moveBackground","insertColor",zb,xb,"resizable","movable"],_checkIcon:Pa,_movable:!0,_resizable:!0,_labelColor:l.tableHeaderLabelColor,_labelFont:l.tableHeaderLabelFont,_columnLineColor:l.tableHeaderColumnLineColor,_columnLineVisible:l.tableHeaderColumnLineVisible,_sortDescIcon:l.tableHeaderSortDescIcon,_sortAscIcon:l.tableHeaderSortAscIcon,_moveBackground:l.tableHeaderMoveBackground,_insertColor:l.tableHeaderInsertColor,_indent:hh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(a){return a.toLabel()},getLabelFont:function(a){return this._labelFont},getLabelColor:function(a){return a.getColor()||this._labelColor},getLabelAlign:function(a){return a._align},onPropertyChanged:function(a){this.iv()},_5Q:function(a){this._61I=a,this.iv()},getLogicalPoint:function(a){return ci(a,this._canvas,this.tv.tx())},validateImpl:function(){var a=this,b=a._canvas,c=a.getWidth(),d=a.getHeight(),e=a.tv,f=a._60I,g=a._61I,h=-e.tx(),i=0;(c!==b.clientWidth||d!==b.clientHeight)&&ue(b,c,d),f.clear(),a._39o._roots.each(function(a){if(a.isVisible()){var b=i+a.getWidth();h+c>=i&&b>=h&&f.add({column:a,startX:i}),i=b}});var j=De(b);if(Ee(j,-h,0,1),j.beginPath(),j.rect(h,0,c,d),j.clip(),j.clearRect(h,0,c,d),f.each(function(b){var c=b.column,e=b.startX,f=c.getWidth();f>0&&(j.save(),j.beginPath(),j.rect(e,0,f,d),j.clip(),g&&g.column===c||a.drawColumn(j,c,e,0,f,d),a._columnLineVisible&&Df(j,e+f-1,0,1,d,a._columnLineColor),j.restore())}),g){var k=g.column,i=g.startX,l=g.position,m=k.getWidth();j.save(),j.beginPath(),j.rect(i,0,m,d),j.clip(),j.fillStyle=a._moveBackground,j.fill(),a.drawColumn(j,k,i,0,m,d),j.restore(),ge(j,a._insertColor,l,0,d)}j.restore()},_6Q:function(a){var b=this.tv;return b._31o===a&&b.sm().getSelectionMode()===la},drawColumn:function(a,b,c,d,e,f){var g=this,h=g.tv,i=yh(b.getIcon()),j=g.getLabelAlign(b);if(g._6Q(b)){var k=yh(g._checkIcon);Ah(a,k,c+e/2,d+f/2,b,g)}else{var l=g.getLabel(b),m=g.getLabelFont(b),n=g.getLabelColor(b),o=Mh(m,l).width,p=i?g._indent:0;j===oa?(i&&Bh(a,i,bc,c,d,p,f),Lh(a,l,m,n,c+p,d,e,f,oa)):j===pa?(i&&Bh(a,i,bc,c+e-o-p,d,p,f),Lh(a,l,m,n,c,d,e,f,pa)):(i&&Bh(a,i,bc,c+(e-o-p)/2,d,p,f),Lh(a,l,m,n,c+(e-o+p)/2,d,0,f,oa))}if(b.isSortable()&&h.getSortColumn()===b&&(i=yh(b.getSortOrder()===Jb?g._sortAscIcon:g._sortDescIcon))){var q=Zi(i,b)/2+2;Ah(a,i,j===pa?c+q:c+e-q,d+f/2,b,h)}}});var Pq=function(a){var b=this;b.th=a,b.tv=a._tableView,b.addListeners()};ki(Pq,b,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(a){this.getView().style.cursor=a},handle_mousemove:function(a){if(!Pe){var b=this;delete b._29o,b.setCursor(ja);for(var c=b.th,d=c._60I,e=c.lp(a).x,f=d.size()-1;f>=0;f--){
var g=d.get(f),h=g.column,i=g.startX+h.getWidth();if(c.isResizable()&&G(i-e)<=(ia?10:3))return b._29o=g,void b.setCursor(mc);e>g.startX&&i>e&&(b._29o=g),(h.isClickable()||h.isSortable()||c.isMovable()||b.tv.getCheckColumn&&h===b.tv.getCheckColumn())&&e>g.startX&&i>e&&b.setCursor(oc)}}},handle_mousedown:function(a){this.handle_touchstart(a)},handle_touchstart:function(a){var b=this;wh(a),b.tv.endEditing(),b.handle_mousemove(a),b._29o&&(b.x=Th(a).x,b.lx=b.th.lp(a).x,b.w=b._29o.column.getWidth(),ei(b,a))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.th,d=b.getView().style.cursor,e=b._29o,f=Th(a).x-b.x;if(b.resizing||b.moving||(d===mc?b.resizing=1:c.isMovable()&&d===oc&&G(f)>2&&(b.moving=1)),b.resizing)e.column.setWidth(b.w+f);else if(b.moving){var g=b.lx+f;c._60I.each(function(a){var b=a.startX,d=b+a.column.getWidth();if(g>=b&&d>=g){var h={column:e.column,startX:e.startX+f,front:d-g>g-b,insertColumn:a.column};h.front?h.position=b:h.position=d,c._5Q(h)}})}},_16Q:function(a,b){var c=this,d=c.tv,e=c.th,f=e._checkIcon;if(e._6Q(a)){var g=yh(f),h=c.lx,i=a.getWidth(),j=Zi(g,a);if(h>=b+i/2-j&&b+i/2+j>=h){e.setCheckIcon(f===Oa?Pa:Oa);var k=d.sm(),l=d._rows;return f===Oa?k.rs(l):k.ss(l),d.onCheckColumnClicked(a),!0}}return!1},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b.tv,d=b.th,e=b._29o;if(b.moving){var f=d._61I;if(f&&f.insertColumn!==f.column){var g=f.column,h=c.getColumnModel()._roots,j=h.remove(g),k=h.indexOf(f.insertColumn);k>=0&&(f.front||k++,k<=h.size()&&(h.add(g,k),c.getColumnModel()._38I(g,j,k)))}d._5Q(i),delete b.moving}else if(!b.resizing&&e){g=e.column;var l=d.lp(a).x,m=e.startX,n=!0;if(d.onColumnClicked){var o=d.onColumnClicked(g,a,m);o===!1&&(n=!1)}if(n&&l>=m&&l<=m+g.getWidth()&&!b._16Q(g,m)){if(g.isSortable()){var p=c.getSortMode(),q=g.getSortOrder();p===Ib?c.getSortColumn()===g?(q===Kb&&c.setSortColumn(i),g.setSortOrder(q===Jb?Kb:Jb)):c.setSortColumn(g):"bistate"===p&&(c.getSortColumn()===g?g.setSortOrder(q===Jb?Kb:Jb):c.setSortColumn(g))}c.onColumnClicked(g,a,m)}}b._29o=b.resizing=b.x=b.lx=b.w=i}}),yq.TablePane=function(a){this.init(new Iq(a))},zq("TablePane",b,{ms_v:1,_44o:1}),yq.TreeTablePane=function(a){this.init(new Kq(a))},zq("TreeTablePane",b,{ms_v:1,_44o:1}),yq.Toolbar=function(a){var b=this,c=b._view=pe(1,b),d=c.style;d.background=l.toolbarBackground||"",d.height=kh+za,b._canvas=re(c),b._30o=new bj,b._90I=new bj,b.setItems(a||[]),c.handleGroupSelectedChanged=function(a){if(a.isSelected()){var c=a.getGroupId();null!=c&&b._items.forEach(function(b){var d=b.element;d&&d!==a&&d.setSelected&&d.getGroupId&&d.getGroupId()===c&&d.setSelected(!1)})}},new Qq(b)},zq("Toolbar",b,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[Ha,bb,ab,cb,qb,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:l.toolbarLabelColor,_labelSelectColor:l.toolbarLabelSelectColor,_labelFont:l.toolbarLabelFont,_selectBackground:l.toolbarSelectBackground,_itemGap:l.toolbarItemGap,_separatorColor:l.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(a){return this._64I},getToolTip:function(a){var b=this.getItemInfoAt(a);return b?b.item.toolTip:i},getLabelColor:function(a){return a&&a.selected&&a.type!==Oa&&a.type!==Qa?this._labelSelectColor:this._labelColor},onPropertyChanged:function(a){this.iv(),a.property===Ha&&this._items.forEach(function(a){oe(a)})},redraw:function(){this.iv()},addItem:function(a,b){var c=this._items;b==i?c.push(a):c.splice(b,0,a),this.fp(Ha,i,c)},removeItem:function(a){if(a)for(var b=this._items,c=0;c<b.length;c++)a===b[c]&&(b.splice(c,1),this.fp(Ha,i,b))},removeItemById:function(a){if(a!=i)for(var b=this._items,c=0;c<b.length;c++)if(a===b[c].id){var d=b.splice(c,1)[0];return this.fp(Ha,i,b),d}},getItemById:function(a){if(a!=i)for(var b=this._items,c=0;c<b.length;c++){var d=b[c];if(a===d.id)return d}},setItemVisible:function(a,b){var c=this.getItemById(a);c&&(c.visible=b)},getItemInfos:function(){return this._30o},getItemInfoAt:function(a){var b=this,c=0,d=b._30o,e=b.lp(a),f=e.x,g=e.y;if(g>=0&&g<=b.getHeight())for(;c<d.size();c++){var h=d.get(c);if(h.startX<=f&&f<=h.endX)return h}return i},drawItem:function(a,b,c,d,e){if(b.visible===!1)return 0;if(Gd(b.visible)&&!b.visible())return 0;var f=this,g=b.disabled;g&&(a.globalAlpha=Vg);var h=f.drawItemImpl(a,b,c,d,e),i=f._itemGap;return g&&(a.globalAlpha=1),this._currentItem!==b||"separator"===b||b.separator===!0||b.unfocusable||Kf(a,f._separatorColor,c-i/2,0,h+i,d),h},drawItemImpl:function(a,b,c,d,e){var f=this,g=f._view,h=f._itemGap,j=d/2,k=b.type,l=b.element,m=b.label;Cd(l)&&(m=l,l=i);var n,o=f.getLabelFont(b),p=f.getLabelColor(b),q=b.selected,r=yh(b.icon),s=Zi(r,b),t=0,u=s+(m?Mh(o,m).width:0);if("separator"===b||b.separator===!0)return ge(a,f._separatorColor,c,d/4,j),1;if(l){r&&Ah(a,r,c+s/2,j,b,f),Lh(a,m,o,p,c+s,0,0,d);var v=Ke(l);e||f._90I.add(v),v.parentNode!==g&&ve(g,v),l.iv&&l.iv(),l.validate&&l.validate();var w=v.getBoundingClientRect(),x=w.width,y=v.style;return te(v),y.left=f.tx()+c+u+za,y.top=(d-w.height)/2+za,u+x}return k===Qa?n=yh(q?Ra:Sa):k===Oa&&(n=yh(q?Oa:Pa)),n?(t=Zi(n,b),Ah(a,n,c+t/2,j,b,f),c+=t,u+=t):q&&Df(a,c-h/2,0,u+h,d,f.getSelectBackground(b)),r&&Ah(a,r,c+s/2,j,b,f),Lh(a,m,o,p,c+s,0,0,d),u},validateImpl:function(){var a=this,b=a._canvas,c=a.getWidth(),d=a.getHeight(),e=a._30o,f=a._items;ue(b,c,d);var g=De(b),h=a._itemGap,i=h/2;Ee(g,a.tx(),0,1),g.clearRect(0,0,c,d);var j=a._90I;a._90I=new bj,e.clear(),f.forEach(function(b){var c=a.drawItem(g,b,i,d);e.add({item:b,startX:i,endX:i+c,width:c}),c&&(i+=c+h)}),j.each(function(b){a._90I.contains(b)||fi(b)});var k=a._64I;a._64I=E(0,i),g.restore(),a._stickToRight?(a._65O=0,g=De(b),i=c-a._64I+h,Ee(g,0,0,1),g.clearRect(0,0,c,d),e.clear(),f.forEach(function(b){var c=a.drawItem(g,b,i,d,!0);e.add({item:b,startX:i,endX:i+c,width:c}),c&&(i+=c+h)}),g.restore()):a.tx(a.tx()),k!==a._64I&&a.onSumWidthChanged(k,a._64I)},onSumWidthChanged:function(a,b){},handleClick:function(a,b){var c=this,d=a.type,e=a.action,f=a.groupId,g=a.selected;a.disabled||(f!=i?g||(a.selected=!0,this._items.forEach(function(b){b.groupId===f&&a!==b&&(b.selected=!1)}),e&&a.action(a,c,b)):d===Oa||"toggle"===d?(a.selected=!g,e&&a.action(a,c,b)):e&&a.action(a,c,b)),ah(),c.iv()}});var Qq=function(a){this.tb=a,this.addListeners()};ki(Qq,b,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(a){this.handleScroll(a,a.wheelDelta/40*10)},handle_DOMMouseScroll:function(a){this.handleScroll(a,10*-a.detail)},handleScroll:function(a,b){wh(a);var c=this.tb;c.isScrollable()&&!c._stickToRight&&(c.tx(c.tx()+b),Oe())},handle_mousemove:function(a){var b=this;Pe||b.setItem(a)},handle_mouseout:function(a){var b=this;a.target===b.getView()?b.tb.setCurrentItem(i):b.handle_mousemove(a)},handle_mousedown:function(a){this.handle_mousemove(a),this.handle_touchstart(a)},handle_touchstart:function(a){var b=this,c=b.tb,d=a.target;Nh(a)&&(d===b.getView()||d===c._canvas)&&(wh(a),c.setFocus(a)&&(this.setItem(a,!0),(c.isScrollable()||b.info&&!b.info.item.disabled)&&(b.x=Th(a).x,b.tx=c.tx(),ei(b,a))))},handleWindowMouseMove:function(a){this.handleWindowTouchMove(a)},handleWindowTouchMove:function(a){var b=this,c=b.tb;if(!c._stickToRight){var d=Th(a).x-b.x;!b._25o&&G(d)>2&&c.isScrollable()&&(b._25o=1),b._25o&&c.tx(b.tx+d)}},handleWindowMouseUp:function(a){this.handleWindowTouchEnd(a)},handleWindowTouchEnd:function(a){var b=this,c=b.tb,d=b.info,e=b.tb.getItemInfoAt(a);if(!b._25o&&d){var f=d.item;e&&e.item===f&&c.handleClick(f,a)}b._25o=b.x=b.tx=i,b.setItem()},setItem:function(a,b){var c=this,d=c.tb,e=c.info=a?d.getItemInfoAt(a):i,f=e?e.item:i;d.setCurrentItem(f),b&&f&&Gd(f.onDown)&&f.onDown(a)}}),yq.BorderPane=function(){this._view=pe(1,this),this.iv()},zq("BorderPane",b,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(a,b){this._12o("leftView",a),b!=i&&this.setLeftWidth(b)},getRightView:function(){return this._rightView},setRightView:function(a,b){this._12o("rightView",a),b!=i&&this.setRightWidth(b)},getTopView:function(){return this._topView},setTopView:function(a,b){this._12o("topView",a),b!=i&&this.setTopHeight(b)},getBottomView:function(){return this._bottomView},setBottomView:function(a,b){this._12o("bottomView",a),b!=i&&this.setBottomHeight(b)},getCenterView:function(){return this._centerView},setCenterView:function(a){this._12o("centerView",a)},_12o:function(a,b){var c=this,d="_"+a,e=c._view,f=c[d];f!==b&&(f&&fi(f.getView?f.getView():f),c[d]=b,b&&(b.getView?ve(e,b.getView(),1):ve(e,b,1)),c.fp(a,f,b))},onPropertyChanged:function(a){this.iv()},validateImpl:function(){var a=this,b=a._topView,c=a._bottomView,d=a._leftView,e=a._rightView,f=a._centerView,g=a.getWidth(),h=a.getHeight(),j=0,k=0,l=g,m=h,n=0,o=0,p=0,q=0;b&&(n=a._topHeight==i?Ae(b):a._topHeight,k=n),c&&(o=a._bottomHeight==i?Ae(c):a._bottomHeight,m=h-o),d&&(p=a._leftWidth==i?ze(d):a._leftWidth,j=p),e&&(q=a._rightWidth==i?ze(e):a._rightWidth,l=g-q);var r=E(0,l-j),s=E(0,m-k);b&&Le(b,0,0,g,n),c&&Le(c,0,m,g,o),d&&Le(d,0,k,p,s),e&&Le(e,l,k,q,s),f&&Le(f,j,k,r,s)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);